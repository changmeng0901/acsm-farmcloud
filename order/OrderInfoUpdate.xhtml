<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:s="http://jboss.com/products/seam/taglib"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich" 
    xmlns:a="http://richfaces.org/a4j"  
    template="/layout/order_template_new.xhtml">
<ui:define name="body">
<link rel="stylesheet" type="text/css" media="screen" href="#{request.contextPath}/asset/css/bootstrap-select.min.css"/>
	 <link href="#{request.contextPath}/asset/css/datetimepicker.css" rel="stylesheet"/>
	 <link rel="stylesheet" type="text/css" href="#{request.contextPath}/asset/css/checkBox/skinBlue.css"/>
	<script src="../asset/js/utils.js" type="text/javascript"></script>
	<script type="text/javascript" src="#{request.contextPath}/asset/js/checkBox/icheck.js"></script>
    <script type="text/javascript" src="#{request.contextPath}/asset/new/bootstrap-select.min.js"></script>
	<script type="text/javascript" src="#{request.contextPath}/asset/new/bootstrap-datetimepicker.js"></script>
	<script type="text/javascript" src="#{request.contextPath}/asset/new/bootstrap-datetimepicker.zh-CN.js"></script>
<td valign="top" >
	<style>
	.input-append.date .add-on i, .input-prepend.date .add-on i {
    cursor: pointer;
    height: 14px;
    margin-left: -19px;
    margin-top: 7px;
    width: 14px;
	}
		.fap_div{text-align:left;font-family:"宋体"; padding-left:40px;}
		.rich-inplace-view{ border:none; border-bottom-width:0px;}
		.rich-inplace-view{ border-bottom-width:0px; border:1px solid #d5d5d5;}
		.dr-table-footercell {
		    background: none repeat scroll 0 0 #FFFFFF;
		    border-bottom: 1px solid #C0C0C0;
		    border-right: 1px solid #C0C0C0;
		    color: #000000;
		    font-family: Arial,Verdana,sans-serif;
		    font-size: 14px;
		    font-weight: bold;
		    height: 35px;
		    padding: 4px;
		    text-align: right;
		}
		.stripe3 th a{
		    color: #171717;
		    font-family: "宋体";
		    font-size: 12px;
		
		}
		.dr-table {
		    border-left: 1px solid #C0C0C0;
		    border-right: 1px solid #C0C0C0;
		}
		.dr-sb-shadow {
		    border: 1px solid;
		    height: auto;
		    position: absolute;
		    width: 100%;
		    z-index: 1;
		}
		.dr-pnl-b tr{
		 	height:26px; line-height:26px;
		}
		.dr-rich-tool-tip {
		    background-color: #FAE6B0;
		    border: 1px solid #E5973E;
		    display: none;
		    float: left;
		    font-family: Arial,Verdana,sans-serif;
		    font-size: 11px;
		    padding: 7px;
		    position: absolute;
		    min-height: 100px;
		}
		.dr-pnl{border-style:none;border:none; width: 100%; padding:0;}
		.dr-pnl-b{font-size:12px; width: 100%; padding:0;}
		.dr-sb-ext-decor-2 {
		    background-color: #FFFFFF;
		    border:1px solid #bed6f8;
		}
		.dr-sb-common-container {
		    text-align: center;
		}
		.dr-table-cell {
		    border-bottom: 1px solid #C0C0C0;
		    border-right: 1px solid #C0C0C0;
		    color: #000000;
		    font-family: Arial,Verdana,sans-serif;
		    background-color:
		    font-size: 11px;
		    padding: 4px;
		}
		.dr-sb-int-sel {
		    background-color: #BED6F8;
		    background-image:none;
		    color: #000000;
		    font-family: Arial,Verdana,sans-serif;
		    font-size: 11px;
		}
		.search_table .input{width:157px;}
		.dr-pnl{background:none}
		.td_img_big{width:75px; height:75px; border:1px solid #f0f0f0; display:block;}	
		.td_img{width:40px; height:40px; border:1px solid #f0f0f0; display:block;}
		.list_td {background: url("../asset/images/order/calls_y8.jpg") repeat-y scroll right center rgba(0, 0, 0, 0);}
			.lis2_table {width: 100%;}
			.right_b{height:auto;}
			.left_b{height:auto;}
			.list_block {margin-bottom:0px;}
			.dr-pnl{border:0px;}
			.dr-pnl{border-style:none;border:none; width: 100%; padding:0;}
			.st_6td{text-align:left;}
			
	.cathAll01 .icheckbox_minimal-blue{float:left; margin:7px 10px;}
	.catd{ padding:5px 9px; line-height:25px; font-size:12px; text-align:center;}
	.carp input{ width:45px; height:18px; text-align:center;border:1px solid #ccc;}
	
	.fr{float:right;}
    .r_ulli1{float:right;}
    .address{width: 450px;} 
    
	</style>
	<div class="right_c">
	<h:form id="submitOrderSearch">
		<div class="r_title">
        	<div class="r_t_l">
			<s:link propagation="none"  view="#{sessionTake.urlTemp}" style="text-decoration:none;color:black;" value="工作 "></s:link>
			&#160;&gt;&#160;&#160;<font size="3">配送信息</font><rich:messages styleClass="messages"></rich:messages></div>
        </div>

	<table width="100%" cellpadding="0" cellspacing="0" style=" margin-top:-3px; *margin-top:-3px; _margin-top:-9px;">
   		<tr>
   			
   			<td align="center" valign="top" >
   				<div class="rigtjr">
   					<div class="con_left">
						<div id="rightPanel" class="con_right">
							<div class="call_com">
								<div class="list_block">   
									<div class="list_title list_title01">客户基本信息</div>
									
								<div >
									<div class="list_td">
							    		<!--添加客户基本信息模板  -->
											<ui:include src="/order/MemberInfoTemplateInfo.xhtml" >
											</ui:include>
									</div>
								</div>
	                       <div class="clear"></div>
                           </div> 
                           <div class="list_block" style="margin-top: 20px;margin-bottom:25px;">
									<div class="list_title list_title01">销售人</div>
								<div >
									<div class="list_td" style="float: left;">
							    		<h:outputText value="无" rendered="#{generateOrderDetailsHome.instance.farmerInfoId.name eq null}"/>
							    		<h:outputText value="#{generateOrderDetailsHome.instance.farmerInfoId.name}" rendered="#{generateOrderDetailsHome.instance.farmerInfoId.name ne null}"/>
									</div>
									
								</div>
							
	                       <div class="clear"></div>
                           </div> 
                   			<div style="margin-bottom: 10px"></div>
                   				<rich:panel id="deliverAddressTable" style="border:none;">
	                   				<div class="list_block">
	                   					<div class="list_title list_title03">收货人信息</div>
	                   					
	                   						
	                        				<div class="people_02">
	                           				<ul>
	                           					<a:repeat id="deliverAddresseList" var="_d" value="#{generateOrderDetailsHome.deliverAddresseList}" rowKeyVar="rowIndex">
                               							<li id="addressLi#{rowIndex}">
					                                    	<table width="100%">
					                                        	<tr>
					                                                <td width="20">
					                                                	<input type="radio" class="#{_d.lastUsed?'tClass':'fClass'}" name="delivery" id="delivery#{_d.deliverAddressId}" value="#{_d.deliverAddressId}" onclick="closeDiv(#{rowIndex},#{_d.deliverScope});"/>
					                                                </td>
					                                                <td align="left">
					                                                    <span class="address">#{_d.address}</span>
					                                                    <span class="font_name">收件人111:#{_d.consignee}</span>
					                                                    <span class="font_name">联系方式:#{_d.phone}</span>
					                                                    <span class="delete"   style="#{_d.addressMode eq 0?'':'display:none;'}">
					                                                    	<a href="javascript:void(0);" onclick="updateAddress(#{rowIndex},#{_d.deliverAddressId});">修改</a>
				                                                    	</span>
					                                                </td>
					                                            </tr>
					                                        </table>
			                                   			</li>
                           						</a:repeat>
                           						<s:fragment rendered="#{generateOrderDetailsHome.deliverAddresseList.size() > 0}">
                           							<li>
				                                    	<table width="100%">
				                                        	<tr>
				                                                <td width="20">
				                                                	<input type="radio" name="delivery" id="delivery0" value="0" onclick="clcarAreaCallBack();"/>
				                                                </td>
				                                                <td align="left">
				                                                    <span class="address">添加新地址...</span>
				                                                </td>
				                                            </tr>
				                                        </table>
		                                   			</li>
                           						</s:fragment>
                           						<s:fragment rendered="#{generateOrderDetailsHome.deliverAddresseList.size() == 0}">
                           							<li>
				                                    	<table width="100%">
				                                        	<tr>
				                                                <td width="20">
				                                                	<input type="radio" name="delivery" id="delivery0" value="0" checked="checked" onclick="clcarAreaCallBack();"/>
				                                                </td>
				                                                <td align="left">
				                                                    <span class="address">添加新地址...</span>
				                                                </td>
				                                            </tr>
				                                        </table>
		                                   			</li>
                           						</s:fragment>
	                           				</ul>
	                               			<div style="padding-left:100px; padding-top:20px; display: none;" id="addDeliverAddressDiv">
	                               				<div class="message" style="display: none;">
		   											<span class="label"><font color="FF6600"></font>配送范围：</span>
	                                       			<div class="field" >
	                                           			<span class="span_area" style="width: 250px; display: block;">
															<h:selectOneMenu class="selectpicker" id="deliverScope" style="width:146px;" value="#{generateOrderDetailsHome.deliverScope}">
																<f:selectItem itemLabel="五环内" itemValue="1"></f:selectItem>
																<f:selectItem itemLabel="五环外" itemValue="2"></f:selectItem>
															</h:selectOneMenu>
	                                           			</span>
		    										</div>
	                               				</div>
	                                   			<div class="message">
	                                         		<span class="label_new"><font color="FF6600" style="margin-right: 5px;">*</font>收<i style="display:inline-block;width:6px;"></i>货<i style="display:inline-block;width:6px;"></i>人：</span>
	                                       			<div class="field">
	                                       				 <h:inputText id="consignee" styleClass="form-control nw221" value="#{generateOrderDetailsHome.consignee}"/>
	                                         		</div>
	                               				</div>
	                                   			<div class="message">
	                                           		<span class="label_new"><font color="FF6600" style="margin-right: 5px;">*</font>手<i style="display:inline-block;width:24px;"></i>机：</span>
                                          			<div class="field">
                                          				<h:inputText id="phone" styleClass="form-control nw221" value="#{generateOrderDetailsHome.phone}" />
                                            		</div>
                                  				</div>
                                  				<div class="message">
	                                           		<span class="label_new"><font color="FF6600"></font>邮<i style="display:inline-block;width:24px;"></i>编：</span>
                                          			<div class="field">
                                          				<h:inputText styleClass="form-control nw221" id="zipCode" value="#{generateOrderDetailsHome.zipCode}" />
                                            		</div>
                                  				</div>
                                  				<div class="message">
	                                           		<span class="label_new"><font color="FF6600"></font>固定电话：</span>
                                          			<div class="field">
                                          				<h:inputText styleClass="form-control nw221" id="tel" value="#{generateOrderDetailsHome.tel}" />
                                            		</div>
                                  				</div>
                                  				<div class="message" style="height:95px;">
                                         			<span class="label_new"><font color="FF6600" style="margin-right: 5px;">*</font>详细地址：</span>
	                                       			<div class="field">
	                                       				<h:inputTextarea id="address" styleClass="form-control nw420" rows="3" value="#{generateOrderDetailsHome.address}" />                				
                                         			</div>
	                           					</div>
                                  				<input type="hidden" id="deliverAddId" value=""/>
	                                   			<div class="message">
	                                   				<a style="float:left; margin-left:20px; margin-top:10px;" href="javascript:void(0);" onclick="if(!saveAddress()){return false;};">
                   										<img src="../asset/images/sale.jpg" width="91" height="25"/>
                   									</a>
                                  				</div>
	                               				<div class="clear"></div>
                              				</div>
	                           			</div>
	                   				</div>
                   				</rich:panel>
                   			<div style="margin-bottom: 10px"></div>
						    	<div class="list_block">   
									<div class="list_title list_title04">配送方式</div>
										<dl class="psfs">
		                                	<dd style="background:none;">
		                                		<table>
		                                			<tr >
		                                				<td style="width: 400px;"><span><div style="float: left;">配送时间：</div>
		                                				 <div class="input-append date form_datetime " style="float: left;">
													    <h:inputText id="deliverDate" styleClass="new_time" value="#{generateOrderDetailsHome.deliverDate}"/>
													    <span class="add-on"><i class="icon-th"></i></span>
													    </div>
		                                				</span></td>
		                                				<td style="width: 300px;">
			                                				<h:selectOneMenu value="#{generateOrderDetailsHome.timeSlot}" id="deliverSlot" class="deliverSlot selectpicker" style="width:140px;">
																<f:selectItem itemLabel="全天" itemValue="0"></f:selectItem>
																<f:selectItem itemLabel="上午" itemValue="1"></f:selectItem>
																<f:selectItem itemLabel="下午" itemValue="2"></f:selectItem>
															</h:selectOneMenu>
														</td>
		                                			</tr>
		                                		</table>
	                                    		
		                                    </dd>
		                                    <dd style="color:#999999; background:none;">提示客户：我们会努力按照您指定的时间配送，但因天气、交通等各类因素影响，您的订单有可能会有延误现象！</dd>
		                                </dl>
		                                <dl class="psfs">
		                                	<dd style="width:60px; height:69px; line-height:69px; float:left; background:none;">
		                                		备注：
		                                	</dd>
		                                	<dd style="float:left; padding-left:0px; background:none;">
		                                		<h:inputTextarea id="orderRemark" styleClass="big" cols="90" rows="8" value="#{generateOrderDetailsHome.orderRemark}" />
		                                    </dd>
		                                </dl>
			                       <div class="clear"></div>
			                   </div>
		                   		<div class="list_block">   
						    		<rich:panel id="payPanel" style="border:none;">
									<div class="list_title list_title05">收款方式</div>
										<dl class="psfs" style="background: url(../images/list_line_07.jpg) repeat-x scroll center bottom rgba(0, 0, 0, 0);" >
	                                		<dt>
	                                			<input type="radio" name="payMode" id="payMode1" value="1" checked="checked"  data="1"/>余额支付
	                                			<span class="spafo">帐户余额支付</span>
                                			</dt>
	                               		</dl>
	                                	<dl class="psfs" >
	                                		<dt style=" background:none;"><input type="radio" name="payMode" id="payMode2"  value="2" data="2"/>货到付款</dt>
		                                    <dd id="payTypeDd1" style="display: none; background:none;">
		                                    	<span style="margin-left:20px;">
		                                    		<input type="radio" name="payType" id="payType1" value="1"/>现金支付
		                                    	</span>
		                                    </dd>
		                                    <dd id="payTypeDd2" style="display: none; background:none;">
		                                    	<span style="margin-left:20px;"><input type="radio" name="payType" id="payType2" value="2"/>POS支付</span>
		                                    </dd>
		                                    <dd id="payTypeDd3" style="display: none; background:none;">
	                                    		<span style="margin-left:20px;"><input type="radio" name="payType" id="payType3" value="3"/>支票支付</span>
	                                    	</dd>
	                               		</dl>
										<dl class="psfs">
	                                		<dt>
	                                			<input type="radio" name="payMode" id="payMode9" value="9" data="1"/>转账
	                                			<span class="spafo">帐户转账支付</span>
                                			</dt>
	                                	</dl>
	                                	<s:fragment rendered="false">
										<dl class="psfs">
		                                	<dt>
		                                		<input type="radio" name="payMode" id="payMode5" value="5" data="5"/>赊销
		                                		<span class="spafo">赊销帐户金额</span>
	                                		</dt>
		                                </dl>
		                                </s:fragment>
		                                </rich:panel>
		                                <dl class="psfs" >
		                                <dd id="saleDayPanel" style="display: none;">
		                               	<table>
	                                		<tr>
	                                		  <td>
	                                		  	<span>赊销日期：&#160;&#160;</span>
	                                			</td>
	                                		   <td>
	                                		   
	                                		   </td>
	                                		   <td>
	                                		     <span class="spafo">天</span>
	                                		   </td>
	                                		</tr>
	                                	</table>
		                               </dd>
		                               </dl>
	                               		 <dl class="psfs" id="lipin">
	                                		<dt>
	                                			<input type="radio" name="payMode" id="payMode10" value="10" checked="checked" data="10"/>礼品赠送
	                                			<span class="spafo"></span>
                                			</dt>
	                               		</dl>
	                               	<div style="margin-bottom: 10px"></div>
			                       	<div class="clear"></div>
		                   		</div>
		                   		<div class="list_block "> 
							<div class="list_title list_title02">商品信息</div>
	                        	<div style="width: 98%;height: 40px;" >
	                        		<span style="float: left; margin-left: 15px; font-size: 14px; margin-top: 2px;">名称/编号：</span>
	                        		<input type="text" id="searchName" value="" class="form-control nw300 srarchfont" style="float: left;"/>
	                        		<a href="javascript:void(0);" onclick="searchButton();" class="btn btn-primary" style="float: left;margin-left:10px;">
	                        			搜索
	                        		</a>
	                        	</div>
	                        	<rich:spacer height="30" />
	                        	<rich:panel style="width:100%;" id="showPanel">
	                        		<div style="width:99%; margin:0 auto; padding-right:12px; [;text-align:left;]; background: url(../asset/images/order/next_bg_24.jpg) repeat-x; color:#4e4d4d; border-top:1px solid #ccc; border-right:1px solid #ccc; float: left;">	
					           	 		<table width="100%" border="0" cellpadding="0" cellspacing="0" style=" border-collapse:collapse; width:99.2%; width: -moz-calc(100% - 16px); float:left;">
											<tr>
							                	<th width="5%" class="cath cathAll01">
							                	<input type="checkbox" name="productCheckAll" id="productCheckAll" value="0" style="vertical-align:middle"/>&#160;</th>
							                    <th width="5%" class="cath">类型</th>
							                    <th width="15%" class="cath">商品名称</th>
							                    <th width="15%" class="cath">商品编号</th>
							                    <th width="15%" class="cath">商品规格</th>
							                    <th width="15%" class="cath">商品库存</th>
							                    <th width="15%" class="cath">商品价格</th>
							                    <th width="15%" class="cath">促销价格</th>
								    		</tr>
							        	</table>
							        	<div style="width:101%; height:298px; overflow-y:auto; overflow-x:auto; margin:0 auto; border:1px solid #ccc; border-right:0px solid #ccc;">	
										<table width="100%" border="0" cellpadding="0" cellspacing="0" id="showProduct">
											<a:repeat value="#{generateOrderDetailsHome.showProductList}" var="_showProduct">
												<tr>
								                	<td class="catd" width="5%">
								                		<input type="checkbox" onclick="selectedOne();" name="productCheck" id="productCheck" value="#{_showProduct.shoppingId},#{_showProduct.shoppingType}|" style="vertical-align:middle"/>&#160;
								                	</td>
								                    <td class="catd" width="5%">
								                    	<h:outputText value="商品" rendered="#{_showProduct.shoppingType == 1}"/>
										                <h:outputText value="礼品卡" rendered="#{_showProduct.shoppingType == 2 and _showProduct.type == 1}"/>
										                <h:outputText value="宅配卡" rendered="#{_showProduct.shoppingType == 2 and _showProduct.type == 2}"/>
										                <h:outputText value="储值卡" rendered="#{_showProduct.shoppingType == 2 and _showProduct.type == 3}"/>
								                    </td>
								                    <td class="catd" width="15%">
								                    	<h:outputText value="#{_showProduct.name}"/>
								                    </td>
								                    <td class="catd" width="15%">
								                    	<h:outputText value="#{_showProduct.productCode}"/>
								                    </td>
								                    <td class="catd" width="15%">
								                    	<h:outputText value="#{_showProduct.productUnit}"/>
								                    </td>
								                    <td class="catd" width="15%">
								                    	<h:outputText value="#{_showProduct.storageNum}"/>
								                    </td>
								                    <td class="catd" width="15%">
								                    	<s:fragment rendered="#{_showProduct.promotionPrice == 0}">
										            		￥<h:outputText value="#{_showProduct.productPrice}"><f:convertNumber pattern="#0.00"/></h:outputText>
										            	</s:fragment>
										            	<s:fragment rendered="#{_showProduct.promotionPrice != 0}">
										            		￥<h:outputText style="text-decoration:line-through;" value="#{_showProduct.productPrice}"><f:convertNumber pattern="#0.00"/></h:outputText>
										            	</s:fragment>
								                    </td>
								                    <td class="catd" width="15%">
								                    	<s:fragment rendered="#{_showProduct.promotionPrice != 0}">
								                    		￥<h:outputText value="#{_showProduct.promotionPrice}"><f:convertNumber pattern="#0.00"/></h:outputText>
								                    	</s:fragment>
								                    	<s:fragment rendered="#{_showProduct.promotionPrice == 0}">
								                    		-
								                    	</s:fragment>
								                    </td>
								                </tr>
											</a:repeat>
						                </table>
									</div>     
									</div>
									
						            <rich:spacer height="20px"/>
					            </rich:panel>
					           
						    	<div style="width:98%;">
						    		<a style="float: right; margin-right: 20px;margin-top: 20px;" href="javascript:void(0);" onclick="if(!submitProduct()){return false;};" class="btn btn-success">
						    		添加
                               		</a>
						    	</div>
	                       	<div class="clear"></div>
	               		</div> 	
	                   
	                   
		                   		
		                   		
		                   		<div class="list_block">   
									<div class="list_title list_title07">商品清单</div>            
									<div class="car_list">
										<rich:dataTable width="100%" id="cartList" var="_cartList" styleClass="car_table" value="#{generateOrderDetailsHome.cartList}" 
								              onRowMouseOver="this.style.backgroundColor='#e5f6ec'" onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'" rowKeyVar="index">
									       <h:column>
								        	<f:facet name="header">商品编号</f:facet>
								            <center>
								            	<h:outputText value="#{_cartList.productCode}"/>
								            </center>
								        </h:column>
								        <h:column>
								        	<f:facet name="header">商品</f:facet>
								        	<center>
								        		<h:outputText value="#{_cartList.name}"/>
							        		</center>
								        </h:column>
								        <h:column>
								        	<f:facet name="header">类型</f:facet>
								            <center>
								            	<h:outputText value="商品" rendered="#{_cartList.shoppingType == 1}"/>
								            	<h:outputText value="礼品卡" rendered="#{_cartList.shoppingType == 2 and _cartList.type == 1}"/>
								            	<h:outputText value="宅配卡" rendered="#{_cartList.shoppingType == 2 and _cartList.type == 2}"/>
								            	<h:outputText value="储值卡" rendered="#{_cartList.shoppingType == 2 and _cartList.type == 3}"/>
								            </center>
								        </h:column>
								        <h:column>
								            <f:facet name="header">商品数量</f:facet>
								            <center>
							                    <table width="100%" border="0" cellpadding="0">
				                                    <tr>
					                                    <td width="35%" align="right"><a href="javascript:void(0);" onclick="updateNum(#{_cartList.shoppingId},#{_cartList.storageNum},#{_cartList.shoppingType},2);"><img src="../asset/images/order/no_24.jpg" width="15" height="15" /></a></td>
					                                    <td width="30%" class="carp" align="center" valign="middle">
					                                    	<input onblur="updateNum(#{_cartList.shoppingId},this.value,#{_cartList.shoppingType},3);" style="text-align：center;" id="number#{_cartList.productCode}" type="text" value="#{_cartList.storageNum}"/>
					                                    </td>
					                                    <td width="35%" align="left"><a href="javascript:void(0);" onclick="updateNum(#{_cartList.shoppingId},#{_cartList.storageNum},#{_cartList.shoppingType},1);"><img src="../asset/images/order/no_27.jpg" width="15" height="15" /></a></td>
				                                    </tr>
			                                    </table>
								            </center>
								        </h:column>
								        <h:column>
								        	<f:facet name="header">商品规格</f:facet>
								            <center>
								            	<h:outputText value="#{_cartList.productUnit}" rendered="#{_cartList.shoppingType == 1}"/>
								            	<h:outputText value="张" rendered="#{_cartList.shoppingType == 2}"/>
								            </center>
								        </h:column>
								        <h:column>
								        	<f:facet name="header">商品原价</f:facet>
								            <center>
								            	￥<h:outputText value="#{_cartList.productPrice}"><f:convertNumber pattern="#0.00"/></h:outputText>
								            </center>
								        </h:column>
								        <h:column>
								        	<f:facet name="header">商品单价</f:facet>
								            <center>
								            	￥<input id="priceInput#{_cartList.shoppingId}" onblur="updateDiscount(1,#{_cartList.shoppingId},this.value,#{_cartList.shoppingType},#{_cartList.productPrice});" style="text-align：center; width:45px; height:18px; text-align:center;border:1px solid #ccc;" type="text"  value="#{_cartList.unitPrice}"/>
								            </center>
								        </h:column>
								         <h:column>
								        	<f:facet name="header">折扣率</f:facet>
								            <center>
								            	<input onblur="updateDiscount(2,#{_cartList.shoppingId},this.value,#{_cartList.shoppingType},#{_cartList.productPrice});" style="text-align：center; width:45px; height:18px; text-align:center;border:1px solid #ccc;" type="text" value="#{_cartList.discount}"/>%
								            </center>
								        </h:column>
								        <h:column>
								        	<f:facet name="header">单品总价</f:facet>
								            <center>
								            	￥<h:outputText value="#{_cartList.total}"><f:convertNumber pattern="#0.00"/></h:outputText>
								            </center>
								        </h:column>
								        <rich:column styleClass="action" width="10%" >
								            <f:facet name="header">操作</f:facet>
								            	<table class="ps" align="center">
             		  										<tr>
                    											<td>
										            		<a href="javascript:void(0);" onclick="delOneProduct(#{index});">删除</a>
				            							</td>
			            							</tr>
		            							</table>
								        </rich:column>
									    </rich:dataTable>
									     <rich:panel id="totalPenal" style="width:100%;">
								    <table class="car_table"  width="100%" style="border-top: none; border-color: #ccc;">
								    	<tr>
		                                    <td colspan="11" style="border-bottom:none; padding-bottom:10px;">
		                                       <div class="car_dl"><a href="javascript:void(0);" onclick="if(confirm('确定要清空购物车？清空后商品采购详情无法还原！'))clearProductAll();">清空购物车</a></div>
		                                       <div class="car_ul">
		                                       <ul>
			                                           <li>共#{generateOrderDetailsHome.totalNum}件商品</li>
			                                           <li>
			                                           		<span class="car_span">商品金额：</span>
			                                           		<span class="car_text2">￥</span>
		                                           			<span class="list_font car_span">
					                                            <b>
					                                           		<h:outputText id="productAccount" value="#{generateOrderDetailsHome.productAccount}"><f:convertNumber pattern="#0.00"/></h:outputText>
																</b>
															</span>
													   </li>
													   <li style="display: none;">
				                                           <span class="car_span">优惠金额：</span>
				                                           <span class="car_text2">￥</span>
				                                           <b>
					                                         -<h:outputText id="discount" value="#{generateOrderDetailsHome.productAccount - generateOrderDetailsHome.discountMoney}"><f:convertNumber pattern="#0.00"/></h:outputText>
				                                           </b>
			                                           </li> 
			                                           <li>
				                                           <span class="car_span">运费：</span>
				                                           <span class="car_text2">￥</span>
				                                           <b>
				                                           <span class="list_font car_span"  id="deliverAccount" ><h:outputText value="#{generateOrderDetailsHome.instance.deliverAccount}"><f:convertNumber pattern="#0.00" /></h:outputText></span>
				                                           </b>
			                                           </li>
			                                       </ul>
		                                       </div>
		                                    </td>
	                                    </tr>
	                                    <tr>
		                                    <td align="right"  style="background:#e5f6fd; height:35px; line-height:35px; padding-right:20px;" colspan="11">
			                                    	应付总额：<span class="car_text4">￥</span>
			                                    	
			                                    	<span class="car_text3">
			                                    		<h:outputText id="showTotal" value="#{generateOrderDetailsHome.total}"><f:convertNumber pattern="#0.00"/></h:outputText>
			                                    	</span>
			                                    </td>
	                                    </tr>
								    </table>
								    </rich:panel>
								     
                                		<div class="car_button">
                                			
                                				<h:inputHidden id="orderInfoOrderInfoId" value="#{generateOrderDetailsHome.orderInfoOrderInfoId}"/>
												<h:inputHidden id="submitInvoiceId" value="#{generateOrderDetailsHome.invoiceId}"/>
												<h:inputHidden id="submitContractId" value="#{generateOrderDetailsHome.contractId}"/> 
												<h:inputHidden id="submitOrderRemark" value="#{generateOrderDetailsHome.orderRemark}"/> 
												<h:inputHidden id="submitInvoiceFlag" value="#{generateOrderDetailsHome.invoiceFlag}"/> 
												<h:inputHidden id="submitContractFlag" value="#{generateOrderDetailsHome.contractFlag}"/> 
												<h:inputHidden id="payMode" value="#{generateOrderDetailsHome.payMode}"/> 
												<h:inputHidden id="payType" value="#{generateOrderDetailsHome.payType}"/> 
												<h:inputHidden id="saleTime" value="#{generateOrderDetailsHome.saleTime}"/> 
												<h:inputHidden id="timeSlot" value="#{generateOrderDetailsHome.timeSlot}"/> 
												<h:inputHidden id="deliverScopes" value="#{generateOrderDetailsHome.deliverScope}"/> 
												<h:inputHidden id="deliverAccounts" value="#{generateOrderDetailsHome.deliverAccount}"/>
												<h:inputHidden id="deliverAddId" value="#{generateOrderDetailsHome.deliverAddId}"/> 
												<h:inputHidden id="total" value="#{generateOrderDetailsHome.total}"/> 
												<h:inputHidden id="discountMoney" value="#{generateOrderDetailsHome.discountMoney}"/> 
												<s:button id="cancel" styleClass="btn btn-default" value="返回" propagation="end" view="/order/OrderInfoList.xhtml"/>
												&#160;
												<h:commandButton id="save" onclick="if(!saveOrders()){return false;};"  styleClass="btn btn-primary" value="提交订单" action="#{generateOrderDetailsHome.updateOrder}" />
                                		</div>
                        			</div>
             					</div>
							</div>		
						</div>
                   	</div>
                    <div class="clear"></div>
				</div>
			</td>
		</tr>
   	</table>
	</h:form>
	<h:form id="refreshShowFrom">
    	<a:commandLink id="refreshShow" action="#{generateOrderDetailsHome.refreshShow}" reRender="showPanel" eventsQueue="eventsQueue" ></a:commandLink>
   	</h:form>
     <h:form id="refreshCartFrom">
    	<a:commandLink id="refreshCart" action="#{generateOrderDetailsHome.refreshCart}" reRender="cartList"  eventsQueue="eventsQueue" ></a:commandLink>
   	</h:form>
   	<h:form id="refreshTotalFrom">
    	<a:commandLink id="refreshToral" action="#{generateOrderDetailsHome.refreshCart}" reRender="totalPenal,rejs" oncomplete="logInfo();" eventsQueue="eventsQueue" ></a:commandLink>
   	</h:form>
<rich:panel id="rejs" >
<script src="../asset/js/utils.js" type="text/javascript"></script>	
<script type="text/javascript">
var accountFlag = #{generateOrderDetailsHome.accountFlag};
var productAccount = #{generateOrderDetailsHome.productAccount};
</script>
</rich:panel>
<script type="text/javascript">
//<![CDATA[
     var delScope;
     logInfo = function() {
        var flag = #{generateOrderDetailsHome.deliverAddresseList.size() > 0};
        if (flag) {
        	jquery("#addDeliverAddressDiv").css("display", "none");
		}else {
			jquery("#addDeliverAddressDiv").css("display", "");
		}
		
        var contractFlag = #{generateOrderDetailsHome.contractFlag};
        if (contractFlag == true) {
    		jquery("#contractTr").css("display", "");
		}else {
			jquery("#contractTr").css("display", "none");
		}

        var flag = #{generateOrderDetailsHome.invoiceInfoList.size() > 0};
        if (flag) {
        	jquery("#addInvoiceDiv").css("display", "none");
		}else {
			jquery("#addInvoiceDiv").css("display", "");
		}
		var oldPayMode = #{generateOrderDetailsHome.payMode};
   		if (oldPayMode != 2 && oldPayMode != 3 && oldPayMode != 4) {
   			jquery("input[name='payMode']:checked").removeAttr("checked");
   			jquery("#payMode" + oldPayMode).iCheck("check"); 
   			jquery("#payTypeDd1").css("display", "none");
   			jquery("#payTypeDd2").css("display", "none");
   			jquery("#payTypeDd3").css("display", "none");
   		}else {
   			jquery("input[name='payMode']:checked").removeAttr("checked");
   			jquery("#payMode" + oldPayMode).iCheck("check"); 
   			var oldPayType = #{generateOrderDetailsHome.payType};
   			jquery("#input[name='payType']:checked").removeAttr("checked");
   			jquery("#payType" + oldPayType).iCheck("check"); 
   			jquery("#payTypeDd1").css("display", "");
   			jquery("#payTypeDd2").css("display", "");
   			jquery("#payTypeDd3").css("display", "");
   			
   		}
       	var deliverAccount = 0;
       	var discount = document.getElementById("submitOrderSearch:discount").innerHTML;
       	if (accountFlag == true) {
       		var deliverScope = #{generateOrderDetailsHome.deliverScope};
       		//var deliverScope = jquery('select[name="deliverScope"]').val();
       		if (deliverScope == 1) {
   				var total = productAccount - discount + #{generateOrderDetailsHome.instance.deliverAccount};
   				deliverAccount = #{generateOrderDetailsHome.instance.deliverAccount};
   				document.getElementById("submitOrderSearch:total").value = total.toFixed(2);
   				document.getElementById("submitOrderSearch:discountMoney").value = discount;
   				document.getElementById("deliverAccount").innerHTML = deliverAccount.toFixed(2);
   				document.getElementById("submitOrderSearch:showTotal").innerHTML = total.toFixed(2);
   				document.getElementById("submitOrderSearch:deliverScopes").value = 1;
   				document.getElementById("submitOrderSearch:deliverAccounts").value = #{generateOrderDetailsHome.instance.deliverAccount};
   			}else {
   				var total = productAccount - discount + #{generateOrderDetailsHome.instance.deliverAccount};
   				deliverAccount = #{generateOrderDetailsHome.instance.deliverAccount}; 
   				document.getElementById("submitOrderSearch:total").value = total.toFixed(2);
   				document.getElementById("submitOrderSearch:discountMoney").value = discount;
   				document.getElementById("deliverAccount").innerHTML = deliverAccount.toFixed(2);
   				document.getElementById("submitOrderSearch:showTotal").innerHTML = total.toFixed(2);
   				document.getElementById("submitOrderSearch:deliverScopes").value = 2;
   				document.getElementById("submitOrderSearch:deliverAccounts").value = #{generateOrderDetailsHome.instance.deliverAccount};
   			}
   		}else {
   			deliverAccount = 0;
   			document.getElementById("submitOrderSearch:total").value = productAccount.toFixed(2) - discount;
   			document.getElementById("submitOrderSearch:discountMoney").value = discount;
   			document.getElementById("deliverAccount").innerHTML = deliverAccount.toFixed(2);
   			document.getElementById("submitOrderSearch:showTotal").innerHTML = productAccount.toFixed(2) - discount;
   			document.getElementById("submitOrderSearch:deliverScopes").value = 1;
   			document.getElementById("submitOrderSearch:deliverAccounts").value = 0.00;
   		}
    }
    function checkDeliverScope(deliverScope){
    	var accountFlag = #{generateOrderDetailsHome.accountFlag};
    	var productAccount = #{generateOrderDetailsHome.productAccount};
    	var deliverAccount = 0;
    	var discount = document.getElementById("submitOrderSearch:discount").innerHTML;
//    	if (accountFlag == true) {
//  		if (deliverScope.value == 1) {
//				var total = productAccount - discount + 20;
//				var deliverAccount = 20;
//				document.getElementById("submitOrderSearch:total").value = total.toFixed(2);
//				document.getElementById("submitOrderSearch:discountMoney").value = discount;
//				document.getElementById("deliverAccount").innerHTML = deliverAccount.toFixed(2);
//				document.getElementById("submitOrderSearch:showTotal").innerHTML = total.toFixed(2);
//				document.getElementById("submitOrderSearch:deliverScopes").value = 1;
//				document.getElementById("submitOrderSearch:deliverAccounts").value = 20.00;
//			}else {
//				var total = productAccount - discount + 40;
//				var deliverAccount = 40;
//				document.getElementById("submitOrderSearch:total").value = total.toFixed(2);
//				document.getElementById("submitOrderSearch:discountMoney").value = discount;
//				document.getElementById("deliverAccount").innerHTML = deliverAccount.toFixed(2);
//				document.getElementById("submitOrderSearch:showTotal").innerHTML = total.toFixed(2);
//				document.getElementById("submitOrderSearch:deliverScopes").value = 2;
//				document.getElementById("submitOrderSearch:deliverAccounts").value = 40.00;
//			}
//		}else {
//			var deliverAccount = 0;
//			document.getElementById("submitOrderSearch:total").value = productAccount.toFixed(2) - discount;
//			document.getElementById("submitOrderSearch:discountMoney").value = discount;
//			document.getElementById("deliverAccount").innerHTML = deliverAccount.toFixed(2);
//			document.getElementById("submitOrderSearch:showTotal").innerHTML = productAccount.toFixed(2)- discount;
//			document.getElementById("submitOrderSearch:deliverScopes").value = 1;
//			document.getElementById("submitOrderSearch:deliverAccounts").value = 0.00;
//		}
    }

   

    function showAddDiv(deliverAddId){
		jquery("#addDeliverAddressDiv").css("display", "");
		jquery(".on_more").removeClass("on_more");
    }

	//修改折扣信息
	function updateDiscount(priceOrDiscount,productId, discount, shoppingType,productPrice){
		if(priceOrDiscount == 1){//修改的是单价
			if(!isNaN(discount) > 0 && !isNaN(productPrice)){
				var dis = discount/productPrice*100;
				var disTwo = dis.toFixed();
				jquery("#discountInput"+productId).val(disTwo);
				modifyDiscount(productId, parseFloat(discount).toFixed(2), parseFloat(disTwo), shoppingType);
			}
		}else{//修改的是折扣率
			discount = parseInt(discount);
			if(!isNaN(discount) && !isNaN(productPrice)){
				if (Number(discount) > 100 || Number(discount) < 0) {
					alert("请输入0-100的数字...");
				}else {
					var dis = discount/100*productPrice;
					var disTwo = dis.toFixed(2);
					jquery("#priceInput"+productId).val(disTwo);
					modifyDiscount(productId,parseFloat(disTwo), parseFloat(discount).toFixed(), shoppingType);
				}
			}else {
				alert("请输入0-100的数字...");
			}
		}
		return false;
		
		
	}
	
    function clcarAreaCallBack(){
    	document.getElementById('submitOrderSearch:deliverScope').value = "1"
	    document.getElementById('submitOrderSearch:consignee').value = "";
		document.getElementById('submitOrderSearch:phone').value = "";
	    document.getElementById('submitOrderSearch:tel').value = "";
		document.getElementById('submitOrderSearch:address').value = "";
		document.getElementById('submitOrderSearch:zipCode').value = "";
		document.getElementById('deliverAddId').value = "";
    	showAddDiv("2");
    }

    function delAddress(deliverAddId){
    	deleteAddress(deliverAddId);
	}
	//修改配送地址
	var index;
	var deliId;
	
	function putAddressComplete(data){
		var data = eval("(" + data + ")");
		if (data != null && data != '') {
			document.getElementById('submitOrderSearch:consignee').value = data.consignee;
			document.getElementById('submitOrderSearch:phone').value = data.phone;
			document.getElementById('submitOrderSearch:tel').value = data.tel;
			document.getElementById('submitOrderSearch:zipCode').value = data.zipCode;
			document.getElementById('submitOrderSearch:address').value = data.address;
			document.getElementById('submitOrderSearch:deliverScope').value = data.deliverScope;
		}
		 showAddDiv('2');
		 jquery(".on_more").removeClass("on_more");
		 jquery("#addressLi" + index).addClass("on_more");
		 jquery("#delivery"+deliId).attr("checked",true);
	}
    

    function delAddressComplete(data){
		var flag = #{generateOrderDetailsHome.deliverAddresseList.size() > 0};
        if (flag) {
        	jquery("#addDeliverAddressDiv").css("display", "none");
		}else {
			jquery("#addDeliverAddressDiv").css("display", "");
		}
	}
    
    function saveAddress(){
        var consignee = document.getElementById('submitOrderSearch:consignee').value;
        var phone = document.getElementById('submitOrderSearch:phone').value;
        var tel = document.getElementById('submitOrderSearch:tel').value;
        var zipCode = document.getElementById('submitOrderSearch:zipCode').value;
        var address = document.getElementById('submitOrderSearch:address').value;
        var deliverScope = document.getElementById('submitOrderSearch:deliverScope').value;//加配送范围
        var address =  document.getElementById('submitOrderSearch:address').value;
        delScope = deliverScope; 
        
        checkDeliverScope(delScope);//计算运费
        if (consignee == '') {
			alert("请填写收货人信息...");
			return false;
		}
        if (phone == '') {
			alert("请填写手机信息...");
			return false;
		}

		if (phone == ''){
			alert("手机号码不能为空...");
			return false;
		}

		var mobileData = /^((0{0,1}(17[0-9]|14[0-9]|13[0-9]|15[0-9]|18[0-9])[0-9]{8})+)$/;
		var phoneFlag = mobileData.test(phone);
		if (!phoneFlag) {
			alert("手机号码格式不正确...");
			return false;
		}

        //if (zipCode == '') {
			//alert("请填写邮编信息...");
			//return false;
		//}

        if (isNaN(zipCode)) {
			alert("邮编必须为数字...");
			return false;
		}
		
        if (address == '') {
			alert("请填写地址信息...");
			return false;
		}
        if (address == '') {
			alert("请填写地址信息...");
			return false;
		}else if(address.length > 50){
			alert("地址信息字数长度不能超过50！");
			jquery('.zzbutton').attr('onclick','if(!saveAddress())return false;');
			return false;
		}
        var deliverAddId = document.getElementById('deliverAddId').value;
        if('' == deliverAddId){
        	addNewAddress(consignee, phone, tel, zipCode, address,Number(deliverScope));//如果deliverAddId为空则走添加方法
        }else{
        	updateNewsAddress(Number(deliverAddId),consignee, phone, tel, zipCode, address,Number(deliverScope));//如果deliverAddId不为空则走更新方法
        }
		
		return true;
	}
    function addAddressComplete(data){
		var flag = #{generateOrderDetailsHome.deliverAddresseList.size() > 0};
        if (flag) {
        	jquery("#addDeliverAddressDiv").css("display", "none");
		}else {
			jquery("#addDeliverAddressDiv").css("display", "");
		}
        refreshAddress();
	}
    function updateAddressComplete(){
    	refreshAddress();
	}
    function updateAddress(obj,deliverAddId){
		index = obj;
		deliId = deliverAddId;
		jquery(".on_more").removeClass("on_more");
		jquery("#addressLi" + obj).addClass("on_more");
		document.getElementById('deliverAddId').value = deliverAddId;
		upAddress(Number(deliverAddId));//查询配送地址
	}
    function closeDiv(obj,scope){
    	delScope = scope;
		jquery("#addDeliverAddressDiv").css("display", "none");
		jquery("#consignee").val("");
		jquery("#phone").val("");
		jquery("#tel").val("");
		jquery("#zipCode").val("");
		jquery("#address").val("");
		jquery(".on_more").removeClass("on_more");
		jquery("#addressLi" + obj).addClass("on_more");
		checkDeliverScope(delScope);//计算运费（原来在 配送范围 的onchange事件中）
    }

    jquery("input[name='payMode']:radio").on("ifChecked",function(event){
    	var flag = document.getElementById("payMode1").checked;
    	        
    	        var fg = document.getElementById("payMode10").checked;
    			var obj = jquery(this).attr("data");
    	    	if (obj == 2) {
    	    		jquery("#payTypeDd1").css("display", "");
    				jquery("#payTypeDd2").css("display", "");
    				jquery("#payTypeDd3").css("display", "");
    				jquery("#saleDayPanel").css("display", "none");
    			} else if (obj == 5) {
    				jquery("#payTypeDd1").css("display", "none");
    				jquery("#payTypeDd2").css("display", "none");
    				jquery("#payTypeDd3").css("display", "none");
    				jquery("#saleDayPanel").css("display", "");
    			}else {
    				jquery("#payTypeDd1").css("display", "none");
    				jquery("#payTypeDd2").css("display", "none");
    				jquery("#payTypeDd3").css("display", "none");
    				jquery("#saleDayPanel").css("display", "none");
    			}

    			if(obj == 10){
    				document.getElementById("submitOrderSearch:total").value = 0;
    				document.getElementById("submitOrderSearch:discountMoney").value = 0;
    				document.getElementById("deliverAccount").innerHTML = "0.00";
    				document.getElementById("submitOrderSearch:showTotal").innerHTML = "0.00";
    				document.getElementById("submitOrderSearch:deliverScopes").value = 1;
    				document.getElementById("submitOrderSearch:deliverAccounts").value = 0;
    			}else{
    				var accountFlag = #{generateOrderDetailsHome.accountFlag};
    		    	var productAccount = #{generateOrderDetailsHome.productAccount};
    		    	var deliverAccount = 0;
    		    	var discount = document.getElementById("submitOrderSearch:discount").innerHTML;
    		    	if (accountFlag == true) {
    		    		//var deliverScope = jquery('select[name="deliverScope"]').val();
    		    		var deliverScope = delScope;
    		    		if (deliverScope == 1) {
    						var total = productAccount - discount + 20;
    						deliverAccount = 20;
    						document.getElementById("submitOrderSearch:total").value = total.toFixed(2);
    						document.getElementById("submitOrderSearch:discountMoney").value = discount;
    						document.getElementById("deliverAccount").innerHTML = deliverAccount.toFixed(2);
    						document.getElementById("submitOrderSearch:showTotal").innerHTML = total.toFixed(2) ;
    						document.getElementById("submitOrderSearch:deliverScopes").value = 1;
    						document.getElementById("submitOrderSearch:deliverAccounts").value = 20.00;
    					}else if(deliverScope == 2){
    						var total = productAccount - discount + 40;
    						deliverAccount = 40;
    						document.getElementById("submitOrderSearch:total").value = total.toFixed(2);
    						document.getElementById("submitOrderSearch:discountMoney").value = discount;
    						document.getElementById("deliverAccount").innerHTML = deliverAccount.toFixed(2);
    						document.getElementById("submitOrderSearch:showTotal").innerHTML = total.toFixed(2);
    						document.getElementById("submitOrderSearch:deliverScopes").value = 2;
    						document.getElementById("submitOrderSearch:deliverAccounts").value = 40.00;
    					}
    				}else {
    					deliverAccount = 0;
    					document.getElementById("submitOrderSearch:total").value = productAccount.toFixed(2) - discount;
    					document.getElementById("submitOrderSearch:discountMoney").value = discount;
    					document.getElementById("deliverAccount").innerHTML = deliverAccount.toFixed(2);
    					document.getElementById("submitOrderSearch:showTotal").innerHTML = productAccount.toFixed(2) - discount;
    					document.getElementById("submitOrderSearch:deliverScopes").value = 1;
    					document.getElementById("submitOrderSearch:deliverAccounts").value = 0.00;
    				}
    			}
    		});
	
    function saveOrders(){
    	var deliveryId = jQuery("input[name='delivery']:checked").val();
		if (deliveryId == 0 || deliveryId == null) {
			alert("请选择配送地址信息....");
			return false;
		}
        var orderRemark = document.getElementById("submitOrderSearch:orderRemark").value;
        document.getElementById("submitOrderSearch:submitOrderRemark").value = orderRemark;
        document.getElementById("submitOrderSearch:discountMoney").value = document.getElementById("submitOrderSearch:discount").innerHTML;
        document.getElementById("submitOrderSearch:deliverAddId").value = deliveryId;
        
        var payMode = jQuery("input[name='payMode']:checked").val();
        document.getElementById("submitOrderSearch:payMode").value = payMode;
        var payType = jQuery("input[name='payType']:checked").val();
        document.getElementById("submitOrderSearch:payType").value = payType;

        var deliverDate = jQuery("#submitOrderSearch\\:deliverDate").val();
        var deliverDate1 = document.getElementById("submitOrderSearch:deliverDate").value;
		if(deliverDate1 = undefined || deliverDate1 == null || deliverDate1 == ""){
			document.getElementById("productMsg").innerHTML = "请选择配送日期!";
			jquery("#myModal").modal('show');
			return false;
		}
        document.getElementById("submitOrderSearch:deliverDate").value = deliverDate;
        var timeSlot = jquery(".deliverSlot").val();
        document.getElementById("submitOrderSearch:timeSlot").value = timeSlot;
    	return true;
	}
    function updateNum(productId, num, shoppingType, type){
		if (type == 1) {
			var number = num+1;
			modifyProductNum(productId,number, shoppingType);
		}else if(type == 2){
			if (num > 1) {
				
				var number = num-1;
				modifyProductNum(productId,number, shoppingType);
			}else {
				alert("至少购买一个商品...");
				refreshCartAction();
			}
		}else if (type == 3) {
			modifyProductNum(productId,num,shoppingType);
		}
	}

  	//清空购物车
	function clearProductAll(){
		if(confirm('确定删除吗？')){
		clearCartAll();
		}
	}

	//删除单个
	function delOneProduct(index){
		if(confirm('确定删除吗？')){
		clearOneProduct(index);
		}
	}
	//全选事件
    function selectedAll(obj){
		jquery("input[name='productCheck']").prop("checked", obj.checked);
	}
  	//单选事件
    function selectedOne(){
    	var str = "";
    	jquery("input[name='productCheck']:checked").each(function(){
          	str += jquery(this).val();
      	});
      	
      	if (str == '') {
      		jquery("#productCheckAll").removeAttr("checked");
		}
	}
  //添加选中商品到购物车
    function submitProduct(){
    	 var str = "";
     	jquery("input[name='productCheck']:checked").each(function(){
           	str += jquery(this).val();
       	});
		if (str != '') {
			var values = '{"resultDatas":[';
			var temp = str.split("|"); 
			for ( var i = 0; i < temp.length-1; i++) {
				var splitStr = temp[i].split(","); 
				var pid = splitStr[0];
				var type = splitStr[1];
				values += '{"pid":' + pid + ', "type":' + type + '},';
			}
	    	values = values.substring(0, values.length-1) + ']}';
	    	addCheckedProduct(values);
	    	return true;
		}else {
			alert("请选择至少一个商品...");
			return false;
		}
		
    }
  //刷新
	function refreshCartAction(){
		document.getElementById("refreshCartFrom:refreshCart").click();
		document.getElementById("refreshTotalFrom:refreshToral").click();
	}
	//搜索商品
    function searchButton(){
		var searchName = jquery("#searchName").val();
		showListFiltel(searchName);
    }
	//搜索商品回调
    function searchOnComplete(){
    	document.getElementById("refreshShowFrom:refreshShow").click();
    }
    jquery(".rich-calendar-input").addClass("form-control nw221");
	jquery(".rich-calendar-input").removeClass("rich-calendar-input");

	
//]]>
</script>

<script type="text/javascript">
				jquery(".form_datetime").datetimepicker({
			    format: "yyyy-mm-dd",
			    autoclose: true,
				 weekStart: 1,
				  //startDate: "2014-08-14 10:00",
				 language:  'zh-CN',
				 minView:2,
			    pickerPosition: "bottom-left"
			    });
			  window.onload = function () {
			    jquery('.selectpicker').selectpicker();
			  };
			  function initAddress(){
				  jquery("input[name=delivery]").iCheck({
					    checkboxClass: 'icheckbox_minimal-blue',
					    radioClass: 'iradio_minimal-blue',
					    increaseArea: '20%' // optional
					  });
				  jquery(".check_box").on('ifChecked', function(event){
					  jquery(this).click()
					})
					 jquery("#delivery0").on('ifChecked', function(event){
						 clcarAreaCallBack();
					})
			  }
			  jquery(document).ready(function(){
				  logInfo();
				  jquery("input").iCheck({
					    checkboxClass: 'icheckbox_minimal-blue',
					    radioClass: 'iradio_minimal-blue',
					    increaseArea: '20%' // optional
					  });
				  
				  jquery(".check_box").on('ifChecked', function(event){
					  jquery(this).click()
					})
					 jquery("#delivery0").on('ifChecked', function(event){
						 clcarAreaCallBack();
					});

					jquery('input[name=productCheckAll]').on("ifClicked", function(event){
						if (this.checked) {
							jquery("input[name='productCheck']").iCheck("uncheck"); 
						} else {
							jquery("input[name='productCheck']").iCheck("check"); 
						}
					});

					var len = jquery(".tClass").length;
					if(len > 0){
						jquery(".tClass").iCheck('check');
					}
			  });
			</script>
</div>
</td>
	<a:form>
   		<a:queue requestDelay="10" ignoreDupResponses="true"/>
		<a:jsFunction name="addNewAddress" action="#{generateOrderDetailsHome.addNewAddress}" oncomplete="addAddressComplete(data);" >
			<a:actionparam name="consignee" assignTo="#{generateOrderDetailsHome.consignee}"/>
			<a:actionparam name="phone" assignTo="#{generateOrderDetailsHome.phone}"/>
			<a:actionparam name="tel" assignTo="#{generateOrderDetailsHome.tel}"/>
			<a:actionparam name="zipCode" assignTo="#{generateOrderDetailsHome.zipCode}"/>
			<a:actionparam name="address" assignTo="#{generateOrderDetailsHome.address}"/>
			<a:actionparam name="deliverScope" assignTo="#{generateOrderDetailsHome.deliverScope}"/>
		</a:jsFunction>
		<a:jsFunction name="updateNewsAddress" action="#{generateOrderDetailsHome.updateNewAddress}" oncomplete="updateAddressComplete();" >
			<a:actionparam name="deliverAddId" assignTo="#{generateOrderDetailsHome.deliverAddId}"/>
			<a:actionparam name="consignee" assignTo="#{generateOrderDetailsHome.consignee}"/>
			<a:actionparam name="phone" assignTo="#{generateOrderDetailsHome.phone}"/>
			<a:actionparam name="tel" assignTo="#{generateOrderDetailsHome.tel}"/>
			<a:actionparam name="zipCode" assignTo="#{generateOrderDetailsHome.zipCode}"/>
			<a:actionparam name="address" assignTo="#{generateOrderDetailsHome.address}"/>
			<a:actionparam name="deliverScope" assignTo="#{generateOrderDetailsHome.deliverScope}"/>
		</a:jsFunction>
		<a:jsFunction name="deleteAddress" action="#{generateOrderDetailsHome.deleteAddress}" oncomplete="delAddressComplete(data);" >
			<a:actionparam name="deliverAddId" assignTo="#{generateOrderDetailsHome.deliverAddId}"/>
		</a:jsFunction>
		<a:jsFunction name="upAddress" action="#{generateOrderDetailsHome.getDeliverAddress}" data="#{generateOrderDetailsHome.delAddress}" oncomplete="putAddressComplete(data);" >
			<a:actionparam name="deliverAddId" assignTo="#{generateOrderDetailsHome.deliverAddId}"/>
		</a:jsFunction>
		<a:jsFunction name="refreshAddress" action="#{generateOrderDetailsHome.refreshAddress}" reRender="deliverAddressTable">
		</a:jsFunction>
		<a:jsFunction name="modifyDiscount" action="#{generateOrderDetailsHome.modifyDiscount}" ignoreDupResponses="true" oncomplete="refreshCartAction();">
			<a:actionparam name="productId" assignTo="#{generateOrderDetailsHome.productId}"/>
			<a:actionparam name="unitPrice" assignTo="#{generateOrderDetailsHome.unitPrice}"/>
			<a:actionparam name="discount" assignTo="#{generateOrderDetailsHome.discount}"/>
			<a:actionparam name="shoppingType" assignTo="#{generateOrderDetailsHome.shoppingType}"/>
		</a:jsFunction>
		
		
		<a:jsFunction name="modifyProductNum" action="#{generateOrderDetailsHome.modifyProductNum}" ignoreDupResponses="true" oncomplete="refreshCartAction();" >
			<a:actionparam name="productId" assignTo="#{generateOrderDetailsHome.productId}"/>
			<a:actionparam name="num" assignTo="#{generateOrderDetailsHome.num}"/>
			<a:actionparam name="shoppingType" assignTo="#{generateOrderDetailsHome.shoppingType}"/>
		</a:jsFunction>
		<a:jsFunction name="clearOneProduct" action="#{generateOrderDetailsHome.clearOneProduct}" oncomplete="refreshCartAction();" >
			<a:actionparam name="index" assignTo="#{generateOrderDetailsHome.index}"/>
		</a:jsFunction>
		<a:jsFunction name="clearCartAll" action="#{generateOrderDetailsHome.clearCartAll}" oncomplete="refreshCartAction();" ></a:jsFunction>
		<a:jsFunction name="addCheckedProduct" action="#{generateOrderDetailsHome.addCheckedProduct}" ignoreDupResponses="true" oncomplete="refreshCartAction();">
			<a:actionparam name="resultTree" assignTo="#{generateOrderDetailsHome.resultTree}"/>
		</a:jsFunction>
		<a:jsFunction name="showListFiltel" action="#{generateOrderDetailsHome.showListFiltel}" ignoreDupResponses="true" oncomplete="searchOnComplete();" >
			<a:actionparam name="searchName" assignTo="#{generateOrderDetailsHome.searchName}"/>
		</a:jsFunction>
	</a:form>
</ui:define>
</ui:composition>
