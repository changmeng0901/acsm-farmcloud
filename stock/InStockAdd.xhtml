<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
     xmlns:s="http://jboss.com/products/seam/taglib"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:a="http://richfaces.org/a4j"
    xmlns:c="http://java.sun.com/jstl/core"
    template="/layout/template_new.xhtml">
	<!-- 选择物料弹出框 开始 -->
	<ui:define name="foot">
	<ui:include src="/stock/SelectGoodsModel.xhtml"></ui:include>
	</ui:define>
	<!-- 选择物料弹出框 --> 
	<!-- 添加原料弹出框 开始 -->
	<ui:define name="addGoods">
	<ui:include src="/stock/AddMaterial.xhtml"></ui:include>
	</ui:define>
	<!-- 添加原料弹出框 --> 
	<!-- 添加商品弹出框 开始 -->
	<ui:define name="addProduct">
	<ui:include src="/stock/AddProduct.xhtml"></ui:include>
	</ui:define>
	<!-- 添加商品弹出框 --> 
	<!-- 添加辅料弹出框 开始 -->
	<ui:define name="addAccess">
	<ui:include src="/stock/AddAccess.xhtml"></ui:include>
	</ui:define>
	<!-- 添加商品弹出框 -->   
<ui:define name="body">
<link rel="stylesheet" type="text/css" href="#{request.contextPath}/asset/css/commons/commons.css"/>
<link rel="stylesheet" type="text/css" href="#{request.contextPath}/asset/css/stock/InventoryFile.css"/>
<style>
	.listtr .bootstrap-select:not([class*=span]):not([class*=col-]):not([class*=form-control]):not(.input-group-btn){
		width: 110px;
	}
</style>
	#{inStockHome.init()}
        <td valign="top">
        <div class="inbentory_file_main">
        	<div class="maskbox" style="width:100%;display:none; z-index:1000; position: fixed; top:0; left:0; background:#000; opacity:0; filter:alpha(opacity:0);" id="mydialog"></div>
        	<!-- 库存左侧二级导航 -->
            <div class="inbentory_level_wap">
                <div class="inbentory_level">
                    <strong class="inben_first inben_first1 ">
                        <a href="javascript:;" onclick="window.open('#{request.contextPath}/stock/InventoryFile.seam','_self')" ><i class="icon_L icon_kcda"></i>库存档案</a>
                    </strong>
                    <strong class="inben_first inben_first2">
                        <a href="javascript:;"><i class="icon_L icon_rkgl"></i>入库管理</a><b class="b_arrow"></b>
                    </strong>
                    <ol class="inben_second">
                        <li class="sed_item" onclick="window.open('#{request.contextPath}/stock/InStorageList.seam','_self')" ><i class="icon_sed"></i>入库明细</li>
                        <li class="sed_item  sed_cur" onclick="window.open('#{request.contextPath}/stock/InStockAdd.seam','_self')"><i class="icon_sed"></i>入库单</li>
                    </ol>
                    <strong class="inben_first inben_first2">
                        <a href="javascript:;"><i class="icon_L icon_ckgl"></i>出库管理</a><b class="b_arrow"></b>
                    </strong>
                    <ol class="inben_second">
                        <li class="sed_item" onclick="window.open('#{request.contextPath}/stock/OutStorageList.seam','_self')"><i class="icon_sed"></i>出库明细</li>
                        <li class="sed_item" onclick="window.open('#{request.contextPath}/stock/OutStorage.seam','_self')"><i class="icon_sed"></i>出库单</li>
                    </ol>
                    <strong class="inben_first inben_first2">
                        <a href="javascript:;"><i class="icon_L icon_zkgl"></i>在库管理</a><b class="b_arrow"></b>
                    </strong>
                    <ol class="inben_second">
                        <li class="sed_item" onclick="window.open('#{request.contextPath}/stock/ExpireWarning.seam','_self')"><i class="icon_sed"></i>过期预警</li>
                        <li class="sed_item" onclick="window.open('#{request.contextPath}/stock/AllocationRecord.seam','_self')"><i class="icon_sed"></i>调拨记录</li>
                        <li class="sed_item" onclick="window.open('#{request.contextPath}/stock/AllocationBill.seam','_self')"><i class="icon_sed"></i>调拨单</li>
                        <h:panelGroup rendered="#{sessionTake.tempType eq 9}">
			<li class="sed_item" onclick="window.open('#{request.contextPath}/stock/StorageRecord.seam','_self')"><i class="icon_sed"></i>贮藏记录</li>
			</h:panelGroup>
                    </ol>
                    <strong class="inben_first inben_first2">
                        <a href="javascript:;"><i class="icon_L icon_pdgl"></i>盘点管理</a><b class="b_arrow"></b>
                    </strong>
                    <ol class="inben_second">
                        <li class="sed_item" onclick="window.open('#{request.contextPath}/stock/InventoryRecord.seam','_self')"><i class="icon_sed"></i>盘点记录</li>
                        <li class="sed_item" onclick="window.open('#{request.contextPath}/stock/InventoryBill.seam','_self')"><i class="icon_sed"></i>盘点单</li>
                    </ol>
                </div>
                <i class="collapse_btn"></i>
            </div>
            <!-- 库存左侧二级导航 -->
            <!-- 库存档案右侧 -->
            <div class="inbentory_content">
                <div class="breadNav_wap clear">
                    <div class="breadNav_lt" style="margin-left:20px;"><a href="#">采销存</a><span>&gt;</span><a href="#">库存</a><span>&gt;</span><strong id="titleName">入库单</strong></div>
                </div>
                <div class="inbentory_search_wap">
                <!-- 商品入库 -->
                    <div class="search_header search_header2 clear">
                    	<div class="clear">
                    	<h:inputHidden value="#{inStockHome.storageChangeFormId}" id="storageChangeFormIdEdit"/>
                            <div class="search_selected fl">
                                <dl style="width:265px;" class="se_selt180 fl">
                                    <dt style="width:80px;">物料类型</dt>
                                    <dd class="inline_block bootSelt180">
	                                    <rich:panel id="goodsTypePanel" style="margin:0; border:none; padding: 0;">
	                                    <h:inputHidden value="#{inStockHome.inStockType}" id="refreshPageStorageType"/>
	                                        <select class="selectpicker" style="display: none;" id="goodsType" onchange="changeGoodsType()">
	                                            <option selected="selected" value="-1">请选择</option>
		                                            <a:repeat value="#{inStockHome.initGoodsType()}" var="_sc" rowKeyVar="_index">
		                                            	<s:fragment rendered="#{inStockHome.goodsType ne null and inStockHome.goodsType eq _sc.id}">
		                                             		<option value="#{_sc.id}" selected="selected">
									   						<s:fragment rendered="#{_sc.id eq 3}">商品</s:fragment>
															<s:fragment rendered="#{_sc.id ne 3}">#{_sc.name}</s:fragment>									   
							  					 			</option>
						  								</s:fragment>
										  				<s:fragment rendered="#{inStockHome.goodsType eq null or inStockHome.goodsType ne _sc.id}">
					                                             	<option value="#{_sc.id}">
										   						<s:fragment rendered="#{_sc.id eq 3}">商品</s:fragment>
																<s:fragment rendered="#{_sc.id ne 3}">#{_sc.name}</s:fragment>									   
										  					 </option>
										  				</s:fragment>
				 					 				</a:repeat>
	                                        </select>
	                                     </rich:panel>
                                    </dd>
                                </dl>
                                <dl style="width:265px;" class="se_selt180 fl">
                                    <dt style="width:80px;">入库类型</dt>
                                    <dd class="inline_block bootSelt180">
                                    <rich:panel id="selectItem" style="margin:0; border:none; padding: 0;">
                                    	<h:inputHidden value="#{inStockHome.inStockType}" id="hiddenInStockTypeEdit"/>
                                			<div class="btn-group bootstrap_select fr groupselect_add" style="margin-left:5px;">
					                            <button type="button" class="btn dropdown-toggle selectpicker btn-default" data-toggle="dropdown"><span class="filter-option" id="inStockType" myInStockTypeId="-1">请选择</span><span class="caret"></span></button>
												<div class="dropdown-menu">
													<ul class="dropdown-menu inner" role="menu" id="inStockTypeUl">
														<li myId="-1" onclick="inStockTypeLiClick(this)" class="selected">请选择</li>
														<a:repeat value="#{inStockHome.inStorageTypeList}" var="storage">
																<li myId="#{storage.id}" onclick="inStockTypeLiClick(this)">#{storage.name}</li>
														</a:repeat>
												  	</ul>
													<span class="new_mater" data-toggle="modal" data-target="#addInStockTypeModel" onclick="inStockTypeModel()">
			                                        				<img src="#{request.contextPath}/asset/images/stock/inventory/InventoryFile_add1.jpg" />添加入库类型
			                                       			</span>
											  	</div>
					                        </div>
                                    </rich:panel>
                                    </dd>
                                </dl>
                                <dl style="width:265px;" class="se_selt180 fl" id="supplierdiv">
                                    <dt style="width:80px;">供应商</dt>
                                    <dd class="inline_block bootSelt180">
                                        <select class="selectpicker"  id="purchaseId"  onchange="purchaseChange()">
                                            <option  value="-1">请选择</option>
                                            <a:repeat value="#{inStockHome.initSupplier()}" var="supplier">
                                            	<s:fragment rendered="#{inStockHome.purchase ne null and inStockHome.purchase eq supplier.memberInfoId}">
													<option value="#{supplier.memberInfoId}" selected="selected">#{supplier.realname}</option>
												</s:fragment>
												<s:fragment rendered="#{inStockHome.purchase eq null or inStockHome.purchase ne supplier.memberInfoId}">
													<option value="#{supplier.memberInfoId}" >#{supplier.realname}</option>
												</s:fragment>
											</a:repeat>
                                        </select>
                                    </dd>
                                </dl>
                                <dl style="width:265px;" class="se_selt180 fl" id="outStockdiv" >
                                    <dt style="width:80px;">出库编码</dt>
                                    <dd class="inline_block bootSelt180">
                                    <rich:panel id="refreshOutStockCode" style="margin:0; border:none; padding: 0;">
                                        <select class="selectpicker" data-live-search="true" style="display: none;" id="outStockCode"  onchange="outStorageToInner()">
                                            <option  value="-1">请选择</option>
                                            <a:repeat value="#{inStockHome.outStockCodeList}" var="ios">
                                            	<s:fragment rendered="#{inStockHome.outStockCode ne null and inStockHome.outStockCode eq ios[0]}">
													<option value="#{ios[0]}" selected="selected">#{ios[1]}</option>
												</s:fragment>
												<s:fragment rendered="#{inStockHome.outStockCode eq null or inStockHome.outStockCode ne ios[0]}">
													<option value="#{ios[0]}" >#{ios[1]}</option>
												</s:fragment>
											</a:repeat>
                                        </select>
                                      </rich:panel>
                                    </dd>
                                </dl>
                                <dl style="width:265px;" class="se_selt180 fl">
                                    <dt style="width:80px;">仓库</dt>
                                    <dd class="inline_block bootSelt180" >
                                    <rich:panel id="showPanel" style="margin:0; border:none; padding: 0;">
                                       	<select class="selectpicker" style="display: none;" id="storageRoom" onchange="onChangeBefore()">
                                           	<option value="-1">请选择</option>
                                           	<a:repeat value="#{inStockHome.storageRoomList}" var="storage">
                                           		<s:fragment rendered="#{inStockHome.storageRoomId eq storage[0]}">
													<option value="#{storage[0]}"  selected="selected">#{storage[1]}</option>
												</s:fragment>
												<s:fragment rendered="#{inStockHome.storageRoomId ne storage[0]}">
													<option value="#{storage[0]}"  >#{storage[1]}</option>
												</s:fragment>
											</a:repeat>
                                       	</select>
                                    </rich:panel>
                                    </dd>
                                </dl>
                                <dl style="width:265px;" class="se_selt180 fl">
                                    <dt style="width:80px;">经办人</dt>
                                    <dd class="inline_block bootSelt180">
                                    <rich:panel id="showOperator" style="margin:0; border:none; padding: 0;">
                                        <select class="selectpicker" style="display: none;" id="operator" onchange="operatorChange()">
                                            <option value="-1">请选择</option>
                                            <a:repeat value="#{inStockHome.initOperatorListInOut()}" var="operator">
                                           		<s:fragment rendered="#{inStockHome.operater eq operator[0]}">
												<option value="#{operator[0]}" selected="selected">#{operator[1]}</option>
											</s:fragment>
											<s:fragment rendered="#{inStockHome.operater ne operator[0]}">
												<option value="#{operator[0]}" >#{operator[1]}</option>
											</s:fragment>
										</a:repeat>
                                        </select>
                                    </rich:panel>
                                    </dd>
                                </dl>
                            </div>
                        </div>
                        <div class="clear">
                            <div class="search_selected fl">
                                <dl style="width:265px;" class="se_selt180 fl">
                                    <dt style="width:80px;">入库日期</dt>
                                    <dd class="inline_block bootSelt180">
                                       	<div class="fl" style="width:180px;">
                                          		<div class="input-append date  form_datetime_second" style="position:relative;" >
                                           		<input size="26" type="text" value="#{inStockHome.storageDate}" readonly="readonly" style="border-radius:4px;" id="inStorageTime" onchange="inStorageDateChange()"/> 
                                           		<span class="add-on" style="position:absolute; right:10px; top:3px;"><i class="icon-th" style="margin:0;"></i></span>
                                           	</div>
                                       	</div>
                                    </dd>
                                </dl>
                               	<textarea class="danju_textarea fl" id="comments" onchange="commentsChange()">
                               		<h:outputText rendered="#{inStockHome.comment eq null}" >
                               			暂无备注信息
                               		</h:outputText>
                               		<h:outputText rendered="#{inStockHome.comment ne null}">
                               			#{inStockHome.comment}
                               		</h:outputText>
                               	</textarea>
                            </div>
                            <div class="search_selected fl" style="margin-left:38px;">
                               	<button class="btn btn-success"  disabled="disabled" id="addButton" onclick="showAddModel()" title="请选择入库的物料类型及入库类型！">添加物料</button>
                            </div>
                        </div>
                    </div>
                    <rich:panel id="goodsList" style="margin:0; border:none; padding: 0;">
                    <table class="inventory_modal_table mt20" width="100%" cellpadding="0" cellspacing="0" style="min-width:1120px-;" id="goodsTable">
                    	<tr name="trHead" >
                    		<s:fragment rendered="#{inStockHome.storageChangeFormId eq null or  inStockHome.storageChangeFormId eq 0}">
	                        	<th width="3%">序号</th>
	                            <th width="10%">物料编号</th>
	                            <th width="11%" id='replaceClick'> 物料名称 <a  class="scancode_btn #{inStockHome.scanCodeFlag eq 0 ? 'scan_no' : ''}" onclick="scancodeSwitch(this,'scan_no')" href="javascript:;" id="scandCodeSwitch">扫描条码</a></th>
	                            <th width="10%">物料等级</th>
	                            <th width="6%">来源</th>
	                            <th width="8%">单位规格</th>
	                            <th width="6%">入库量</th>
	                            <th width="8%">入库总重量（kg）</th>
	                            <th width="8%">保质期（天）</th>
	                            <th width="8%">物料单价（元）</th>
	                            <th width="8%">物料总价（元）</th>
	                            <th width="10%" >库存批次号</th>
	                            <th width="6%" >现存量</th>
	                           	<th  style="display:none">物料id</th>
	                           	<th  style="display:none">单位id</th>
	                           	<th  style="display:none">批次id</th>
	                            <th width="2%">操</th>
	                            <th width="2%">作</th>
	                       </s:fragment>
	                       <s:fragment rendered="#{inStockHome.storageChangeFormId ne null and  inStockHome.storageChangeFormId ne 0}">
	                        	<th width="5%">序号</th>
	                            <th width="10%">物料编号</th>
	                            <th width="12%" id='replaceClick'> 物料名称 <a  class="scancode_btn #{inStockHome.scanCodeFlag eq 0 ? 'scan_no' : ''}" onclick="scancodeSwitch(this,'scan_no')" href="javascript:;" id="scandCodeSwitch">扫描条码</a></th>
	                            <th width="10%">物料等级</th>
	                            <th width="6%">来源</th>
	                            <th width="8%">单位规格</th>
	                            <th width="6%">入库量</th>
	                            <th width="12%">入库总重量（kg）</th>
	                            <th width="8%">保质期（天）</th>
	                            <th width="9%">物料单价（元）</th>
	                            <th width="9%">物料总价（元）</th>
	                            <th style="display:none">库存批次号</th>
	                            <th style="display:none">现存量</th>
	                           	<th  style="display:none">物料id</th>
	                           	<th  style="display:none">单位id</th>
	                           	<th  style="display:none">批次id</th>
	                            <th width="2%">操</th>
	                            <th width="2%">作</th>
	                       </s:fragment>
                        </tr>
                        <a:repeat value="#{inStockHome.inStorageList}" var="_batch" rowKeyVar="_index">
                        <tr class="#{(_index + 1)%2 eq 0 ? 'even' : 'odd' }  listtr" id="goodsTr_#{_index}">
                        	<td class='td_line' height='46' id='numTd_#{_index}'>#{_index + 1}</td>
                            <td class="td_line" id='goodsCodeTd_#{_index}'>#{_batch[1]}</td>
                            <td class="td_line td_mater" id='goodsNameTd_#{_index}'>
                            	<div class="mater_name_block" style="#{_batch[0] eq null ? 'display:none' : ''};" id="mater_name_block_#{_index}" >
                                	<div class="mater_name_hd" id="mater_name_hd_#{_index}">
                                    	<input type="text" id="searchAndSao_#{_index}" onkeyup='searchLi(this,event,1)' style="text-align:center;" name ="searchAndSao" value="#{_batch[2]}"/>
                                        <i class="add_mater"  data-toggle="modal" data-target="#AddMaterial" onclick="showAddModel()"></i>
                                    </div>
                                	<div class="mater_name_bd" id="mater_name_bd_#{_index}" style="min-width: 10%;z-index:9999">
                                    	<ul class="mater_name_list" id="goodsNameUl_#{_index}" >
                                       		<a:repeat value="#{inStockHome.goodsNameList}" var="_goods" rowKeyVar="_row">
                                       			<li name="goodsNameLi" onclick="selectGoods(this)" class="material_li material_li_#{_row + 1}"  myattr="#{_goods[0]}">#{_goods[1]}</li>
                                       		</a:repeat>
                                        </ul>
                                        <ul class='mater_name_list3' id="goodsNameUl2_#{_index}" style='display:none'>
                                        	<a:repeat value="#{inStockHome.goodsNameList}" var="_g" rowKeyVar="_r">
                                       			<li name="goodsNameLi" onclick="selectGoods(this)" class="material_li_#{_r + 1}"  myattr="#{_g[0]}">#{_g[1]}</li>
                                       		</a:repeat>
                                        </ul>
                                        <span class="new_mater"  onclick="showAddModel()">
                                        	<img src="#{request.contextPath}/asset/images/stock/inventory/InventoryFile_add1.jpg" />新增物料
                                        </span>
                                    </div>
                                </div>
                            </td>
                            <td class="td_line" id='levelNameTd_#{_index}'>
                            	<s:fragment rendered="#{_batch[11] ne null}">
	                            	<select id="goodslevels_#{_index}" class="selectpicker" onchange="changeLevel(this)" >
	                            		 <a:repeat value="#{_batch[11]}" var="_level" rowKeyVar="_row">
	                            		 	<s:fragment rendered="#{_batch[3] eq _level[0]}">
	                            		 		<option value="#{_level[0]}" selected="selected">#{_level[1]}</option>
	                            		 	</s:fragment>
	                            		 	<s:fragment rendered="#{_batch[3] ne _level[0]}">
	                            		 		<option value="#{_level[0]}">#{_level[1]}</option>
	                            		 	</s:fragment>
	                            		 </a:repeat>
	                            	</select>
	                            	<div style="display:none" class="levelnone">
	                            		<ul>
	                            			<a:repeat value="#{_batch[11]}" var="_level" rowKeyVar="_row">
	                            				<li class="levelli" levelid="#{_level[0]}" levelprice="#{_level[2]}" levelname="#{_level[1]}" stocknum="#{_level[4]}">
	                            					<ul>
		                            					<a:repeat value="#{_level[3]}" var="_lbatch" rowKeyVar="_ix">
		                            						<li batchid="#{_lbatch[0]}">#{_lbatch[1]}</li>
		                            					</a:repeat>
	                            					</ul>
	                            				</li>
	                            			</a:repeat>
	                            		</ul>
                            		</div>
                            	</s:fragment>
                            	<s:fragment rendered="#{_batch[11] eq null and _batch[0] ne null}">
                            		--
                            	</s:fragment>
                            </td>
                            <td class="td_line" id='sourceTd_#{_index}'>
                            	<s:fragment rendered="#{_batch[12] ne null}">
	                            	<select id="goodsSource_#{_index}" class="selectpicker" onchange="changeTunnel()">
	                            		 <a:repeat value="#{_batch[12]}" var="_source" rowKeyVar="_row">
	                            		 	<s:fragment rendered="#{_batch[4] eq _source[0]}">
	                            		 		<option value="#{_source[0]}" selected="selected">#{_source[1]}</option>
	                            		 	</s:fragment>
	                            		 	<s:fragment rendered="#{_batch[4] ne _source[0]}">
	                            		 		<option value="#{_source[0]}">#{_source[1]}</option>
	                            		 	</s:fragment>
	                            		 </a:repeat>
	                            	</select>
	                            	<div style="display:none" class="sourcenone">
	                            		<ul>
	                            			<a:repeat value="#{_batch[12]}" var="_source" rowKeyVar="_row">
	                            				<li class="sourceli" sourceid="#{_source[0]}">#{_source[1]}</li>
	                            			</a:repeat>
	                            		</ul>
                            		</div>
                            	</s:fragment>
                            	<s:fragment rendered="#{_batch[12] eq null and _batch[0] ne null}">
                            		--
                            	</s:fragment>
                            </td>
                            <td class="td_line" id='speciTd_#{_index}'>#{_batch[5]}</td>
                            <td class="td_line" id='inStockNumTd_#{_index}'>
                            	<input type="text" class="form-control" style="text-align:center;#{_batch[0] ne null ? '' : 'display:none'}" value="#{_batch[6]}" onfocus="oldValue(this);" onkeyup="clearNoNum(this,1);" onblur="calculateOnePrice(this)" maxlength="10"/>
                            </td>
                            <td class="td_line" id='weightTd_#{_index}'>
                           		<input type="text" class="form-control"  name="total_weight"  style="text-align:center;#{_batch[0] ne null ? '' : 'display:none'}" value="#{_batch[7]}" onfocus="oldValue(this);" onkeyup="clearNoNum(this,2);" onblur="calculateWeight()" maxlength="10"/>
                            </td>
                            <td class="td_line" id='shelfLifeTd_#{_index}'>
                           		<input type="text" class="form-control" style="text-align:center;#{_batch[0] ne null ? '' : 'display:none'}" value="#{_batch[8]}" onfocus="oldValue(this);" onkeyup="clearNoNum(this,3);" onblur="saveSelfList()" maxlength="9"/>
                            </td>
                            <td class="td_line" id='priceTd_#{_index}'>
                           		<input type="text" class="form-control" style="text-align:center;#{_batch[0] ne null ? '' : 'display:none'}" value="#{_batch[9]}" onfocus="oldValue(this);" onkeyup="clearNoNum(this,4);" onblur="calculateOnePrice(this)" maxlength="10"/>
                            </td>
                            <td class="td_line" id='totolPriceTd_#{_index}'>
                           		<input type="text" class="form-control" name="total_price" style="text-align:center;#{_batch[0] ne null ? '' : 'display:none'}" value="#{_batch[10]}" onfocus="oldValue(this);" onkeyup="clearNoNum(this,5);" onblur="calculatePrice()" maxlength="10"/>
                            </td>
                          <td class="td_line" id='batchTd_#{_index}' style="#{inStockHome.storageChangeFormId eq null ? '' : 'display:none'}">
                           		<s:fragment rendered="#{_batch[15] ne null }">
	                            	<select id="batchSel_#{_index}" class="selectpicker" multiple="multiple">
	                            		 <a:repeat value="#{_batch[15]}" var="_owebatch" rowKeyVar="_dex">
	                            		 		<option value="#{_owebatch[0]}">#{_owebatch[1]}</option>
	                            		 </a:repeat>
	                            	</select>
	                            	<div style="display:none" class="batchone">
	                            		<ul>
	                            			<a:repeat value="#{_batch[15]}" var="_obatch">
	                            				<li class="batchli" batchid="#{_obatch[0]}">#{_obatch[1]}</li>
	                            			</a:repeat>
	                            		</ul>
                            		</div>
                            	</s:fragment>
                            </td>
                            <td class="td_line" id='stockNumTd_#{_index}' style="#{inStockHome.storageChangeFormId eq null ? '' : 'display:none'}">
                           		#{_batch[16]}
                            </td> 
                             <!-- <td class="td_line" id='batchTd_#{_index}' style="display:none">
                           		<s:fragment rendered="#{_batch[15] ne null }">
	                            	<select id="batchSel_#{_index}" class="selectpicker" multiple="multiple">
	                            		 <a:repeat value="#{_batch[15]}" var="_owebatch" rowKeyVar="_dex">
	                            		 		<option value="#{_owebatch[0]}">#{_owebatch[1]}</option>
	                            		 </a:repeat>
	                            	</select>
	                            	<div style="display:none" class="batchone">
	                            		<ul>
	                            			<a:repeat value="#{_batch[15]}" var="_obatch">
	                            				<li class="batchli" batchid="#{_obatch[0]}">#{_obatch[1]}</li>
	                            			</a:repeat>
	                            		</ul>
                            		</div>
                            	</s:fragment>
                            </td>
                            <td class="td_line" id='stockNumTd_#{_index}' style="display:none">
                           		#{_batch[16]}
                            </td> -->
                            <td class="td_line" id='goodsIdtd_#{_index}' style="display:none">#{_batch[0]}</td>
                            <td class="td_line" id='unitIdTd_#{_index}' style="display:none">#{_batch[13]}</td>
                            <td class="td_line" id='batchIdTd_#{_index}' style="display:none">#{_batch[14]}</td>
                            <td id='copyTd_#{_index}'>
                            	<a class='icon_link' href='javascript:;' name='copGoods' style="#{_batch[0] ne null ? '' : 'display:none'}"  onclick="copyGoods(#{_index})"><img src='/asset/images/stock/commons/tableIco_copy2.png' /></a>
                            </td>
                            <td id='delTd_#{_index}'>
                            	<a class='icon_link' href='javascript:;' style="#{_batch[0] ne null ? '' : 'display:none'}" onclick="delGoods(#{_index})"><img src='/asset/images/stock/commons/tableIco_delect2.png' /></a>
                            </td>
                        </tr>
                        </a:repeat>
                    </table>
                     </rich:panel>
                      <rich:panel id="total" style="margin:0; border:none; padding: 0;">
                    	<div class="total_price mt10">
                    		合计<p class="text_name">入库总重量：<em id="allWeight"></em>kg</p>
                        	<p class="text_name">物料总价：<em id="allPrice"></em>元</p>
                   		</div>
                    </rich:panel>
                   <div class="pt10" style="text-align:right;">
                    <h:form id="add" style="display:none">
    					<h:inputHidden value="#{inStockHome.goodsType}" id="goodsType"/>
    					<h:inputHidden value="#{inStockHome.inStockType}" id="inStockType"/>
    					<h:inputHidden value="#{inStockHome.storageRoomId}" id="storageRoomId"/>
    					<h:inputHidden value="#{inStockHome.purchase}" id="purchase"/>
    					<h:inputHidden value="#{inStockHome.outStockCode}" id="outStockCode"/>
    					<h:inputHidden value="#{inStockHome.operater}" id="operater"/>
    					<h:inputHidden value="#{inStockHome.storageDate}" id="storageDate"/>
    					<h:inputHidden value="#{inStockHome.comment}" id="comment"/>
    					<h:inputHidden value="#{inStockHome.goodsJsonOld}" id="goodsJsonOld"/>
    					<h:commandButton id="commit" styleClass="btn btn-primary fl"  style="display:none"  value="新增提交"  action="#{inStockHome.materialInStorageFind()}">
    					</h:commandButton> 
    				</h:form>
    				
    				<h:form id="save" style="display:none">
    					<h:inputHidden value="#{inStockHome.storageChangeFormId}" id="storageChangeFormIdEdit"/>
    					<h:inputHidden value="#{inStockHome.goodsType}" id="goodsTypeEdit"/>
    					<h:inputHidden value="#{inStockHome.inStockType}" id="inStockTypeEdit"/>
    					<h:inputHidden value="#{inStockHome.storageRoomId}" id="storageRoomIdEdit"/>
    					<h:inputHidden value="#{inStockHome.purchase}" id="purchaseEdit"/>
    					<h:inputHidden value="#{inStockHome.outStockCode}" id="outStockCodeEdit"/>
    					<h:inputHidden value="#{inStockHome.operater}" id="operaterEdit"/>
    					<h:inputHidden value="#{inStockHome.storageDate}" id="storageDateEdit"/>
    					<h:inputHidden value="#{inStockHome.comment}" id="commentEdit"/>
    					<h:inputHidden value="#{inStockHome.goodsJsonOld}" id="goodsJsonOldEdit"/>
    					<h:commandButton id="update" styleClass="btn btn-primary fl"  style="display:none"  value="编辑提交"  action="#{inStockHome.materialInStorageUpdate()}">
    					</h:commandButton> 
    				</h:form>
    					<h:outputText rendered="#{inStockHome.storageChangeFormId eq null }">
                    		<input type="button" class="btn btn-primary"   value="提交" onclick="submitSave()" id="submitButton"/>
                    	</h:outputText>
                    	<h:outputText rendered="#{inStockHome.storageChangeFormId ne null }">
                    		<input type="button"  class="btn btn-primary"  value="提交"  onclick="editSave()" id="updateButton"/>
                    	</h:outputText>
                    	<h:outputText rendered="#{inStockHome.storageChangeFormId eq null }">
                    		<input type="button"  class="btn btn-default"  onclick="clearpage()" value="取消"/>
                    	</h:outputText>
                    	<h:outputText rendered="#{inStockHome.storageChangeFormId ne null }">
                    		<s:button view="/stock/InStorageList.seam" value="返回" styleClass="btn btn-default fr" id="bn_left6" style="margin-left:10px" propagation="none">
								<f:param name="storageRoomId" value="#{inStockHome.paraStorageRoomId}" />
								<f:param name="goodsType2" value="#{inStockHome.paraGoodsType}" />
								<f:param name="beginTime" value="#{inStockHome.paraBeginTime}" />
								<f:param name="endTime" value="#{inStockHome.paraEndTime}" />
								<f:param name="operaterId" value="#{inStockHome.paraOperaterId}" />
								<f:param name="storageType" value="#{inStockHome.paraStorageType}" />
								<f:param name="thisPage" value="#{inStockHome.paraThisPage}" />
								<f:param name="searchStr" value="#{inStockHome.paraSearchStr}" />
							</s:button>
                    	</h:outputText>
                    </div>
                <!-- 商品入库 -->
                </div>
            </div>
            <!-- 库存档案右侧 -->
        </div>
<div class="modal fade" id="addInStockTypeModel" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
<div class="modal-dialog material_dialog">
 <!--  (6)添加入库类型 -->
    <div class="modal-content modal_content modal_stockType"  id="addInStockTypeDiv">
    	<div class="modal-header clear">
            <h4 class="modal-title fl">添加入库类型</h4>
            <i class="i_close"></i>
        </div>
    	<div class="modal-body clear">
	    	<table class="edit_infor_table" width="100%" cellpadding="0" cellspacing="0" style="width:100%;">
	    		<tr>
	    			<td class="td_lt">入库类型名称：</td>
	    			<td class="td_rt"><input class="form-control" type="text" id="inStockTypeAddName" value="" style="width:200px;" maxlength="15"/></td>
	    		</tr>
	    		<tr>
	    			<td class="td_lt">描述：</td>
	    			<td class="td_rt"><textarea rows="5" cols="30" id="inStockTypeDesc"></textarea></td>
	    		</tr>
	    	</table>
    	</div>
    	<div class="modal-footer">
            <!-- <input type="text" style="display:none" id="noneId" value=""/> -->
    		<input type="button" class="btn btn-primary" id="buttonStockType" value="确定" onclick="submitInStockType()"/>
    		<input type="button" class="btn btn-default"    data-dismiss="modal" id="buttonCancel" value="取消" />
        </div>
    </div>
  </div>
  </div>         
    <div class="box_back" id="login" style="display: none; z-index: 1000;position: absolute;left: 0;top: 0;right: 0;bottom: 0;background: rgba(0,0,0,0.5);">
		<div id="login2" style="width: 128px;height: 168px;margin: -84px auto 0 -64px;position: absolute;left: 50%;top: 50%;">
			<img src="../asset/images/loginda.gif" />
		</div>
	</div>     
</td>    

<a:form>
	<a:jsFunction name="initStorageRoom" action="#{inStockHome.initStorageRoom()}"   reRender="showStorage"  >
		<a:actionparam name="goodsType" assignTo="#{inStockHome.goodsType}"/>
	</a:jsFunction>
	<a:jsFunction name="selectItemInit" action="#{inStockHome.selectItemInit()}"   reRender="selectItem,showPanel"   data="#{inStockHome.inStockType}" oncomplete="changeGoodsTypeOncomplete(data)">
		<a:actionparam name="goodsType" assignTo="#{inStockHome.goodsType}"/>
		<a:actionparam name="inStockType" assignTo="#{inStockHome.inStockType}"/>
	</a:jsFunction>
	<a:jsFunction name="initOutStockCode" action="#{inStockHome.initOutStockCode}"   reRender="refreshOutStockCode" oncomplete="outStockComplete()">
		<a:actionparam name="goodsType" assignTo="#{inStockHome.goodsType}"/>
	</a:jsFunction>
	<a:jsFunction name="outStorageInStock"  action="#{inStockHome.outStorageInStock()}"  reRender="showPanel,showOperator,goodsList"  oncomplete="initGoodsNameComplete()">
		<a:actionparam name="goodsType" assignTo="#{inStockHome.goodsType}"/>
		<a:actionparam name="inStockType" assignTo="#{inStockHome.inStockType}"/>
		<a:actionparam name="storageChangeFormId" assignTo="#{inStockHome.storageChangeFormId}"/>
	</a:jsFunction>
	<a:jsFunction name="initGoodsNameList" action="#{inStockHome.initGoodsNameList()}"  reRender="goodsList"   oncomplete="initGoodsNameComplete()" >
		<a:actionparam name="goodsType" assignTo="#{inStockHome.goodsType}"/>
		<a:actionparam name="inStockType" assignTo="#{inStockHome.inStockType}"/>
		<a:actionparam name="scanCodeFlag" assignTo="#{inStockHome.scanCodeFlag}"/>
	</a:jsFunction>
	<a:jsFunction name="changeGoodsNameInnerInfo" action="#{inStockHome.changeGoodsNameInnerInfo}"     data="#{inStockHome.goodsInfoJson}"  oncomplete="expList(data)">
		<a:actionparam name="goodsType" assignTo="#{inStockHome.goodsType}"/>
		<a:actionparam name="inStockType" assignTo="#{inStockHome.inStockType}"/>
		<a:actionparam name="goodsInfoId" assignTo="#{inStockHome.goodsInfoId}"/>
		<a:actionparam name="no" assignTo="#{inStockHome.no}"/>
	</a:jsFunction>
	<a:jsFunction name="findGoodsInfo" action="#{inStockHome.findGoodsInfo}"   data="#{inStockHome.goodsInfoJson}"  oncomplete="expList(data)">
		<a:actionparam name="goodsType" assignTo="#{inStockHome.goodsType}"/>
		<a:actionparam name="inStockType" assignTo="#{inStockHome.inStockType}"/>
		<a:actionparam name="no" assignTo="#{inStockHome.no}"/>
		<a:actionparam name="goodsCode" assignTo="#{inStockHome.goodsCode}"/>
	</a:jsFunction>
	<a:jsFunction name="addInStockType" action="#{inStockHome.addInStockType()}"   reRender="selectItem"   oncomplete="addInStockTypeComplete()">
		<a:actionparam name="inStockTypeName" assignTo="#{inStockHome.inStockTypeName}"/>
		<a:actionparam name="inStockTypeDesc" assignTo="#{inStockHome.inStockTypeDesc}"/>
		<a:actionparam name="goodsType" assignTo="#{inStockHome.goodsType}"/>
		<a:actionparam name="inStockType" assignTo="#{inStockHome.inStockType}"/>
	</a:jsFunction>
	<a:jsFunction name="pageEcho" action="#{inStockHome.pageEcho()}"   reRender="goodsTypePanel,showPanel,refreshOutStockCode,goodsList"   data="#{inStockHome.goodsJsonOld}" oncomplete="pageEchoComplete(data)">
		<a:actionparam name="goodsType" assignTo="#{inStockHome.goodsType}"/>
		<a:actionparam name="inStockType" assignTo="#{inStockHome.inStockType}"/>
		<a:actionparam name="storageRoomId" assignTo="#{inStockHome.storageRoomId}"/>
		<a:actionparam name="outStockCode" assignTo="#{inStockHome.outStockCode}"/>
		<a:actionparam name="goodsJsonOld" assignTo="#{inStockHome.goodsJsonOld}"/>
		<a:actionparam name="scanCodeFlag" assignTo="#{inStockHome.scanCodeFlag}"/>
	</a:jsFunction>
	<a:jsFunction name="inventoryMemory" action="#{inStockHome.inventoryMemory()}" data="#{inStockHome.memorySCF}" reRender="goodsTypePanel,showPanel" oncomplete="stockEchoComplete(data)">
	</a:jsFunction>
	<a:jsFunction name="initInstorageList" action="#{inStockHome.initInstorageList()}"  reRender="goodsList"  oncomplete="clearComplete()">
	</a:jsFunction>
	
</a:form>

<script type="text/javascript" src="#{request.contextPath}/asset/js/stock/InventoryFile.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/stock/InStockAdd.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/icheck.js"></script>
<script type="text/javascript">
	var stockEchoFlag = "#{sessionTake.stockEcho}";
	var inStockType = "#{inStockHome.inStockType}";
</script>
</ui:define>
</ui:composition>


