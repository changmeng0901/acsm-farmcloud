<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:c="http://java.sun.com/jstl/core"
	template="/layout/template_inventory.xhtml">
<ui:define name="body">
<link rel="stylesheet" type="text/css" href="#{request.contextPath}/asset/css/commons/commons.css"/>
<link rel="stylesheet" type="text/css" href="#{request.contextPath}/asset/css/stock/InventoryFile.css"/>
<style >
.form_datetime_second{ position:relative; width:100%;}
.form_datetime_second .add-on{	position:absolute;	right:5px;	top:10px;	width:14px;	height:14px;	}
.form_datetime_second .add-on .icon-th{	display:block;	width:14px;	height:14px;	margin:0;	}
.form_datetime_second .add-on .icon-th { background-position: -240px 0;	}
.search_header2 .form_datetime_second input{
	height:24px;
	line-height:20px;
	padding-top:0;
	padding-bottom:0;
	border:0;
	border-top:1px solid #fff;
	border-bottom:1px solid #ddd;
	border-radius:0;
	} 

</style>
	#{outStorageList.auditInit()}
		<td valign="top">
            <div class="inbentory_file_main">
            <!-- 出库详细记录右侧 -->
                <div class="inbentory_content">
                    <div class="breadNav_wap clear">
                        <div class="breadNav_lt" style="margin-left:20px;"><a href="#">采销存</a><span>&gt;</span><a href="OutStorageDetail.html">出库明细</a><span>&gt;</span><strong>出库明细记录</strong></div>
                    </div>
                    <div class="inbentory_search_wap">
                    <!-- 原料出库 -->
                    	<div class="material_infor_title clear">
                        	<strong class="text_title">原料出库</strong>
                            <i id="ylck_btn" class="ylck_btn"></i>
                        </div>
                        <div id="ylck_content" style="overflow:hidden;">
                        <div class="material_table clear">
                        	<dl class="li_item col-lg-6 col-md-6 col-sm-6 col-xs-6">
                            	<dt class="dl_dt">
                                	<img src="#{request.contextPath}/asset/images/stock/inventory/StorageDetailRecords_icon1.png" />出库编号
                                </dt>
                                <dd class="dl_dd">
                                	<p class="text_num"><h:outputText
											value="#{outStorageList.storageChangeForm.name}" /></p>
                                </dd>
                            </dl>
                        	<dl class="li_item col-lg-6 col-md-6 col-sm-6 col-xs-6">
                            	<dt class="dl_dt">
                                	<img src="#{request.contextPath}/asset/images/stock/inventory/StorageDetailRecords_icon2.png" />出库类型
                                </dt>
                                <dd class="dl_dd">
                                	<p class="text_num"><h:outputText
											value="#{outStorageList.getStorageTypeName(outStorageList.storageChangeForm.storageChangeTypeId.storageChangeTypeId,outStorageList.storageChangeForm.storageType)}" /></p>
                                </dd>
                            </dl>
                            <dl class="li_item col-lg-6 col-md-6 col-sm-6 col-xs-6">
                            	<dt class="dl_dt">
                                	<img src="#{request.contextPath}/asset/images/stock/inventory/StorageDetailRecords_icon3.png" />仓<span class="space_two12"></span>库
                                </dt>
                                <dd class="dl_dd">
                                	<p class="text_num"><h:outputText
											value="#{outStorageList.storageChangeForm.storageRoom.name}" /></p>
                                </dd>
                            </dl>
                            <dl class="li_item col-lg-6 col-md-6 col-sm-6 col-xs-6">
                            	<dt class="dl_dt">
                                	<img src="#{request.contextPath}/asset/images/stock/inventory/StorageDetailRecords_icon4.png" />经<span class="space_harf12"></span>办<span class="space_harf12"></span>人
                                </dt>
                                <dd class="dl_dd">
                                	<p class="text_num"><h:outputText
											value="#{outStorageList.storageChangeForm.operater.name}" /></p>
                                </dd>
                            </dl>
                            <dl class="li_item col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            	<dt class="dl_dt">
                                	<img src="#{request.contextPath}/asset/images/stock/inventory/StorageDetailRecords_icon5.png" />入库时间
                                </dt>
                                <dd class="dl_dd">
                                	<p class="text_num"><h:outputText
											value="#{outStorageList.storageChangeForm.createTime}">
											<s:convertDateTime type="both" dateStyle="short"
												pattern="yyyy-MM-dd HH:mm" />
										</h:outputText></p>
                                </dd>
                            </dl>
                            <dl class="li_item col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            	<dt class="dl_dt">
                                	<img src="#{request.contextPath}/asset/images/stock/inventory/StorageDetailRecords_icon6.png" />备<span class="space_two12"></span>注
                                </dt>
                                <dd class="dl_dd">
                                	<p class="text_num"><h:outputText
												value="#{outStorageList.storageChangeForm.comment}" /></p>
                                </dd>
                            </dl>
                        </div>
                        <table class="inventory_modal_table mt20" width="100%" cellpadding="0" cellspacing="0">
                        	<tr>
                                <th  width="5%">序号</th>
								<th  width="2%"></th>
								<th  width="10%">批次编号</th>
								<th  width="10%">物料名称</th>
								<th  width="10%">来源</th>
								<th  width="8%">等级</th>
								<th  width="8%">规格</th>
								<th  width="7%">保质期</th>
								<th  width="8%">出库数量</th>
								<th  width="13%">出库总数量（kg）</th>
								<th  width="8%">单价（元）</th>
								<th  width="10%">小计（元）</th>
                            </tr>
                           <a:repeat value="#{outStorageList.storageDetaiList}"
									var="_gpcr" rowKeyVar="_index" id="xx">
									<tr class="#{_index % 2 == 0 ? 'even' : 'odd'}">
										<td height="48" width="5%" align="center">#{_gpcr[0]}</td>
										<td width="2%">
											<span>
												<img class="ccc" style="display:#{_gpcr[14] ne null and _gpcr[15] eq '0'? 'none':'block'}" title="商品信息中无此原料构成商品" src="../asset/images/orderManage/order_ico101.png" />
											</span>
										</td>
										<td width="10%" align="center">
											<h:inputHidden value="#{_gpcr[14]}" id="shangpinid#{_index}"/>
											<h:inputHidden value="#{_gpcr[15]}" id="shangpindelete#{_index}"/>
											#{_gpcr[1]}
										</td>
										<td width="10%" align="center" id="wuliaoname#{_index}">#{_gpcr[2]}</td>
										<td width="10%" align="center"><h:outputText value="--"
												rendered="#{null eq _gpcr[13]}" /> <h:outputText
												value="#{ _gpcr[13]}" rendered="#{null ne  _gpcr[13]}" /></td>
										<td width="8%" align="center"><h:outputText value="--"
												rendered="#{null eq  _gpcr[12]}" /> <h:outputText
												value="#{ _gpcr[12]}" rendered="#{null ne  _gpcr[12]}" /></td>
										<td width="8%" align="center"> 
										<s:fragment rendered="#{_gpcr[8] eq 1}">
											<s:fragment rendered="#{_gpcr[7] gt 6 and _gpcr[7] lt 12}">
													#{sessionTake.harvestUnit eq 1? '斤':'公斤（kg）'}
											</s:fragment> 
											<s:fragment rendered="#{_gpcr[7] lt 7 or _gpcr[7] gt 11}">
													#{_gpcr[6]}
											</s:fragment> 														
									    </s:fragment> 
									    <s:fragment rendered="#{_gpcr[8] ne 1}">
														#{_gpcr[10]}#{_gpcr[6]}
											<s:fragment rendered="#{_gpcr[11] ne null and _gpcr[11] ne ''}">
														/#{_gpcr[11]}
											</s:fragment>
										</s:fragment> 
										</td>
											<td width="7%" align="center">#{_gpcr[3]}天</td>
										<td width="8%" align="center"><s:fragment
												rendered="#{_gpcr[8] eq 1}">
												<!-- h:outputText
													value="#{unitStranfer.stockNumInTranferByEnterprise(sessionTake.harvestUnit,_gpcr[8],_gpcr[7],_gpcr[5])}">
													<f:convertNumber pattern="#.###" />
												</h:outputText> -->
												<h:outputText rendered="#{_gpcr[7] ge 7 and _gpcr[7] le 11}" >
								                        	<h:outputText value="#{stringUtil.changeFloatMe(_gpcr[5],3)}" rendered="#{sessionTake.harvestUnit eq 1}">
								                            	<f:convertNumber pattern="#####.###"/>
								                            </h:outputText>
								                            <h:outputText value="#{_gpcr[5]}" rendered="#{sessionTake.harvestUnit ne 1}">
								                            	<f:convertNumber pattern="#####.###"/>
								                            </h:outputText>
										                </h:outputText>
											            <h:outputText value="#{unitStranfer.outStranfer(_gpcr[7],_gpcr[5])}" rendered="#{_gpcr[7] lt 7 or _gpcr[7] gt 11}" >
											                   	<f:convertNumber pattern="#####.###"/>
											            </h:outputText>
											</s:fragment> <s:fragment rendered="#{_gpcr[8] ne 1}">
												<h:outputText value="#{_gpcr[5]}">
													<f:convertNumber pattern="#.###" />
												</h:outputText>
											</s:fragment>
											</td>
										
										<td width="13%"><h:outputText
												value="#{_gpcr[16]}">
												<f:convertNumber pattern="#0.00" /></h:outputText></td>
										<td width="8%" align="center">￥
										<s:fragment rendered="#{_gpcr[8] eq 1}">
											<h:outputText
													value="#{unitStranfer.outStranferPrice(9,_gpcr[9])}" rendered="#{sessionTake.harvestUnit eq 1}">
													<f:convertNumber pattern="#0.00" />
												</h:outputText>
												<h:outputText
													value="#{_gpcr[9]}" rendered="#{sessionTake.harvestUnit ne 1}">
													<f:convertNumber pattern="#0.00" />
												</h:outputText>
										</s:fragment>
										<s:fragment rendered="#{_gpcr[8] ne 1}">
											<h:outputText
													value="#{_gpcr[9]}" >
													<f:convertNumber pattern="#0.00" />
												</h:outputText>
										</s:fragment>
										</td>
										<td width="10%" align="center">￥
											<s:fragment rendered="#{_gpcr[8] eq 1}">
												<h:outputText
													value="#{unitStranfer.outStranferPrice(9,_gpcr[20])}" rendered="#{sessionTake.harvestUnit eq 1}">
													<f:convertNumber pattern="#0.00" />
												</h:outputText>
												<h:outputText
													value="#{_gpcr[20]}" rendered="#{sessionTake.harvestUnit ne 1}">
													<f:convertNumber pattern="#0.00" />
												</h:outputText>
											</s:fragment>
											<s:fragment rendered="#{_gpcr[8] ne 1}">
												<h:outputText
														value="#{_gpcr[20]}" >
														<f:convertNumber pattern="#0.00" />
													</h:outputText>
											</s:fragment>
										</td>
									</tr>
								</a:repeat>
                        </table>
                        </div>
                    <!-- 原料出库 -->
                    </div>
                    <h:form id="saveFrom">
                    <div class="inbentory_search_wap">
                    <!-- 商品入库 -->
                    	<div class="material_infor_title clear">
                        	<strong class="text_title">商品入库</strong>
                        </div>
                        <div class="search_header search_header2 clear">
                        	<div class="clear">
                                <div class="search_selected fl">
                               		<dl style="width:265px;" class="se_selt180 fl">
                                        <dt style="width:265px;text-align: left">仓库： #{outStorageList.storageChangeFormInByOut.storageRoom.name}</dt>
                                    </dl>
                                    <dl style="width:265px;" class="se_selt180 fl">
                                        <dt style="width:265px;text-align: left">入库类型： #{outStorageList.storageChangeFormInByOut.storageChangeTypeId.name}</dt>
                                    </dl>
                                </div>
                                <div class="search_selected fl">
                                    
                                    <dl style="width:265px;" class="se_selt180 fl">
                                        <dt style="width:265px;text-align: left">经办人： #{outStorageList.storageChangeFormInByOut.operater.name}</dt>
                                         
                                    </dl>
                                    <dl style="width:265px;" class="se_selt180 fl">
                                        <dt style="width:265px;text-align: left">入库时间：#{outStorageList.storageDate}</dt>
                                    </dl>
                                </div>
                            </div>
                            <div class="clear">
                                <div class="search_selected fl">
                                    <textarea class="danju_textarea fl" id="commentArea">#{outStorageList.storageChangeFormInByOut.comment}</textarea>
                                </div>
                            </div>
                        </div>
                        <h:panelGroup id="harListId">
                        <table class="inventory_modal_table mt20" id="tbr" width="100%" cellpadding="0" cellspacing="0" style="min-width:1120px-;">
                        	<tr>
								<th  width="10%">商品编号</th>
								<th  width="12%">商品名称</th>
								<th width="11%">来源</th>
								<th  width="12%">单位规格</th>
								<th  width="11%">入库量</th>
								<th  width="10%">入库总重量</th>
								<th  width="10%">保质期(天)</th>
								<th  width="10%">商品单价</th>
								<th  width="10%">小计</th>
                            </tr>
                            <a:repeat value="#{outStorageList.storageGoodsInOutList}"
									var="_sgio" rowKeyVar="_index" id="bb">
									<tr class="cm_nottt #{_index % 2 == 0 ? 'alt' : ''}" id="repeattr#{_index}">
										<td height="48" width="10%" align="center">#{_sgio[7]} </td>
										<td height="48" width="12%" align="center">
											 #{_sgio[6]}
										</td>
										<td height="48" width="11%" align="center">#{_sgio[8]}</td>
										<td height="48" width="12%" align="center">
											<h:panelGroup rendered="#{_sgio[5] eq '' or _sgio[5] eq null}">
											#{_sgio[4]}#{_sgio[2]}
											</h:panelGroup>
											<h:panelGroup rendered="#{_sgio[5] ne '' and _sgio[5] ne null}">
											#{_sgio[4]}#{_sgio[2]}/#{_sgio[5]}
											</h:panelGroup>
										</td>
										<td height="48" width="11%" align="center">
											 <h:outputText value="#{_sgio[1]}"><f:convertNumber pattern="#0.000"/></h:outputText>
										</td>
										<td height="48" width="10%" align="center">
											 <h:outputText value="#{_sgio[9]}"><f:convertNumber pattern="#0.00"/></h:outputText>
										</td>
										<td height="48" width="10%" align="center">
											 <h:outputText value="#{_sgio[0]}"><f:convertNumber pattern="#0.00"/></h:outputText>
										</td>
										<td height="48" width="10%" align="center">￥
											 <h:outputText value="#{_sgio[3]}"><f:convertNumber pattern="#0.00"/></h:outputText>
										</td>
										<td height="48" width="10%" align="center" >￥
												 <h:outputText value="#{_sgio[1] * _sgio[3]}"><f:convertNumber pattern="#0.00"/></h:outputText>
										</td>
									</tr>
								</a:repeat>
                        </table>
                        </h:panelGroup>
                        <div class="pt10" style="text-align:center;">
                        <h:inputHidden id="storageDateHidden" value="#{outStorageList.storageDate}"/>
                        	<a:commandButton id="pass" value="审核通过" styleClass="btn btn-primary"  action="#{outStorageList.auditPass()}"/>
                          	&#160;
                          	<a:commandButton id="fail" value="审核不通过" styleClass="btn btn-default"  action="#{outStorageList.auditFail()}"/>
                          	<s:button view="/stock/OutStorageList.seam" value="下次审核" styleClass="btn btn-default" id="bn_left6" >
										<f:param name="storageChangeFormId" value="#{_batch[0]}" />
										<f:param name="storageRoomId" value="#{outStorageList.storageRoomId}" />
										<f:param name="goodsType" value="#{outStorageList.goodsType}" />
										<f:param name="beginTime" value="#{outStorageList.beginTime}" />
										<f:param name="endTime" value="#{outStorageList.endTime}" />
										<f:param name="operaterId" value="#{outStorageList.operaterId}" />
										<f:param name="storageType" value="#{outStorageList.storageType}" />
										<f:param name="searchStr" value="#{outStorageList.searchStr}" />
										<f:param name="thisPage" value="#{outStorageList.thisPage}" />
							</s:button>
                        </div>
                    <!-- 商品入库 -->
                    </div>
                  </h:form>
                </div>
            <!-- 入库详细记录右侧 -->
            </div>   
            </td>    
<script type="text/javascript" src="#{request.contextPath}/asset/js/stock/InventoryFile.js"></script>
</ui:define>
</ui:composition>