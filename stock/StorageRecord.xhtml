<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
     xmlns:s="http://jboss.com/products/seam/taglib"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:a="http://richfaces.org/a4j"
    xmlns:c="http://java.sun.com/jstl/core"
    template="/layout/template_inventory.xhtml">
<ui:define name="body">
    <!-- 储藏记录列表 -->
    <link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/bootstrap/bootstrap.min.css" />
    <link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/bootstrap/bootstrap-select.min.css" />
    <link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/bootstrap/bootstrap-datetimepicker.css" />
    <link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/bootstrap/skinBlue.css" />
    <link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/style.css"/>
    <link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/commons/commons.css"/>
    <link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/stock/InventoryFile.css" />
<style type="text/css">
/*搜索小图标*/
    input[type=text].form-control {
    height: 34px;
    line-height: 20px;
    padding: 6px 30px;
    box-sizing: border-box;
    font-family: '微软雅黑';
    color:'#ababab';
    background:  url('../images/commons/cjsearch_bg.png') 8px center no-repeat;
}
/*搜索小图标*/
.inbentory_file_main .breadNav_wap {
    background-color: #fff;
    border: 0;
}
</style>
<style >
.search_header2 .form_datetime_second input{
	height:24px;
	line-height:20px;
	padding-top:0;
	padding-bottom:0;
	border:0;
	border-top:1px solid #fff;
	border-bottom:1px solid #ddd;
	border-radius:0;
	} 
.form_datetime_second{ position:relative; width:100%;}
.form_datetime_second .add-on{	position:absolute;	right:5px;	top:10px;	width:14px;	height:14px;	}
.form_datetime_second .add-on .icon-th{	display:block;	width:14px;	height:14px;	margin:0;	}
.form_datetime_second .add-on .icon-th { background-position: -240px 0;	}
.baseFile_onload{ display:block; float:left; width:130px; height:130px; margin:25px 50px 25px 0;border:none;background: url("/asset/images/farmingIco15.jpg") no-repeat scroll 0 0; cursor:pointer;}
.addbg{
        background:#87A900;
    }
</style>
#{storageRecordList.storageRecordInit()}
<td valign="top">
	<div class="inbentory_file_main">
		<div class="maskbox" style="width:100%;display:none; z-index:1000; position: fixed; top:0; left:0; background:#000; opacity:0; filter:alpha(opacity:0);" id="mydialog"></div>
		<!-- 库存左侧二级导航 -->
			<div class="inbentory_level_wap">
				<div class="inbentory_level">
					<strong class="inben_first inben_first1">
						<a href="javascript:;" onClick="window.open('#{request.contextPath}/stock/InventoryFile.seam','_self')" ><i class="icon_L icon_kcda"></i>库存档案</a>
					</strong>
					<strong class="inben_first inben_first2">
						<a href="javascript:;"><i class="icon_L icon_rkgl"></i>入库管理</a><b class="b_arrow"></b>
					</strong>
					<ol class="inben_second">
						<li class="sed_item" onClick="window.open('#{request.contextPath}/stock/InStorageList.seam','_self')" ><i class="icon_sed"></i>入库明细</li>
						<li class="sed_item" onClick="window.open('#{request.contextPath}/stock/InStockAdd.seam','_self')"><i class="icon_sed"></i>入库单</li>
					</ol>
					<strong class="inben_first inben_first2">
						<a href="javascript:;"><i class="icon_L icon_ckgl"></i>出库管理</a><b class="b_arrow"></b>
					</strong>
					<ol class="inben_second">
						<li class="sed_item" onClick="window.open('#{request.contextPath}/stock/OutStorageList.seam','_self')"><i class="icon_sed"></i>出库明细</li>
						<li class="sed_item" onClick="window.open('#{request.contextPath}/stock/OutStorage.seam','_self')"><i class="icon_sed"></i>出库单</li>
					</ol>
					<strong class="inben_first inben_first2">
						<a href="javascript:;"><i class="icon_L icon_zkgl"></i>在库管理</a><b class="b_arrow"></b>
					</strong>
					<ol class="inben_second">
						<li class="sed_item" onClick="window.open('#{request.contextPath}/stock/ExpireWarning.seam','_self')"><i class="icon_sed"></i>过期预警</li>
						<li class="sed_item" onClick="window.open('#{request.contextPath}/stock/AllocationRecord.seam','_self')"><i class="icon_sed"></i>调拨记录</li>
						<li class="sed_item" onClick="window.open('#{request.contextPath}/stock/AllocationBill.seam','_self')"><i class="icon_sed"></i>调拨单</li>
						<h:panelGroup rendered="#{sessionTake.tempType eq 9}">
						<li class="sed_item sed_cur" onClick="window.open('#{request.contextPath}/stock/StorageRecord.seam','_self')"><i class="icon_sed"></i>贮藏记录</li>
						</h:panelGroup>
					</ol>
					<strong class="inben_first inben_first2">
						<a href="javascript:;"><i class="icon_L icon_pdgl"></i>盘点管理</a><b class="b_arrow"></b>
					</strong>
					<ol class="inben_second">
						<li class="sed_item" onClick="window.open('#{request.contextPath}/stock/InventoryRecord.seam','_self')"><i class="icon_sed"></i>盘点记录</li>
						<li class="sed_item " onClick="window.open('#{request.contextPath}/stock/InventoryBill.seam','_self')"><i class="icon_sed"></i>盘点单</li>
					</ol>
				</div>
			<i class="collapse_btn"></i>
		</div>
		<!-- 库存左侧二级导航 -->
                <!-- 库存档案右侧 -->
                <div class="inbentory_content">
                    <div class="breadNav_wap clear" >   
                        <div class="breadNav_lt" style="margin-left:20px;line-height: 48px;"><a href="#">采销存</a><span>&gt;</span><a href="#">库存</a><span>&gt;</span><strong>贮藏记录</strong>
                        </div>
                    </div>
                    <div class="inbentory_search_wap" >
                    	<!-- 库存档案搜索头部 -->
                        	 <div class="search_header clear">
                                <div class="clear" style="position:relative; padding-right:125px;">
                                    <div class="search_selected fl">
                                        <dl style="width:265px;" class="se_selt180 fl">
                                            <dt style="width:80px;">仓库</dt>
                                            <dd class="inline_block bootSelt180">                         
                                         		<h:selectOneMenu styleClass="selectpicker" id="_stoRoomId" onchange="changeStoRoomId()">
                                               		<f:selectItem itemLabel="请选择" itemValue="请选择" ></f:selectItem>
                                               		<s:selectItems value="#{storageRecordList.stoRoomList}" var="_room"  label="#{_room[1]}" itemValue="#{_room[0]}" > 
                                                	</s:selectItems>
                                         		</h:selectOneMenu>  
                                            </dd>
                                        </dl>
                                    </div>
                                    <div class="search_selected fl">
                                        <dl style="width:340px;" class="se_selt180 fl">
                                            <dd class="inline_block bootSelt180">
                                                <input id = "goodsNameId" type="text" style="width:250px;font-size:12px;" value="请输入物料名称" class="form-control mr5 fl" />
                                            	<input id = "searchGoodsButton" type="button" onclick="searchGoodsChange()" value="搜索" class="btn btn-primary" />
                                            </dd>
                                        </dl>
                                        <a class="fr" style="position:absolute; right:17px;font-size:12px; bottom:5px; margin-top:8px; width:90px;" href="/stock/StorageRecordAdd.seam">
                                        	<input type="button" value="添加储藏记录" class="btn btn-primary" style="padding:11px 9px; text-align: center; line-height: 2px;" /></a>
                                    </div>
                                </div>
                            </div>
                            <!-- 库存档案搜索列表 -->
                            <h:panelGroup id="storageRecordShow">
                     		<h:inputHidden value="#{storageRecordList.selectPageNum}" id="selectPageNum"/>
                            <table class="inventory_modal_table mt20" width="100%" cellpadding="0" cellspacing="0" style="border:1px solid #e8eff1">
                            	<tr>
                                	<th>序号</th>
                                    <th>物料编号</th>
                                    <th>物料名称</th>
                                    <th>仓库</th>
                                    <th>上次操作时间</th>
                                    <th>操作</th>
                                </tr>
                                <a:repeat value="#{storageRecordList.stoRecordList}" var="_stor" rowKeyVar="_index">
                                <tr class="odd" style="border-bottom:1px solid #e8eff1">
                                	<td>#{_index+1}</td>
                                    <td>#{_stor[1]}</td>
                                    <td>#{_stor[2]}</td>
                                    <td>#{_stor[3]}</td>
                                    <td>#{_stor[4]} - #{_stor[6]}</td>                                  
                                    <td>
                            			<s:link propagation="none"  styleclass="list_view"  id="batchId" view="/stock/StorageRecordBatch.xhtml" value = "查看" title="查看" >
                                	 		<f:param name="stoRoomIdStr" value="#{_stor[5]}" /> 
                                	 		<f:param name="goodsId" value="#{_stor[0]}" />    	 	
                                	 	</s:link>                                                       					
                                    </td>
                                </tr> 
                                </a:repeat>                                                                                                                                                
                            </table> 
                      <!-- 分页 -->
					  <div class="pageModel_wap" style="padding:50px 0 30px;">
						<h:form id="pageFrom" rendered="#{null ne storageRecordList.stoRecordList and storageRecordList.stoRecordList.size() gt 0}">
							<table style="height:30px; margin:40px auto 0 auto;" cellpadding="0" cellspacing="0">
								<tr>
									<s:fragment rendered="#{!storageRecordList.hasPreviousPage }">
										<td><img src="#{request.contextPath}/asset/images/page_68.jpg" width="4" height="32" /></td>
									</s:fragment>
									<s:fragment rendered="#{storageRecordList.hasPreviousPage and storageRecordList.totalPages > 1}">
										<td><img src="#{request.contextPath}/asset/images/page_67.jpg" width="4" height="32" /></td>
										<td class="td_t_b">
											<a:commandLink style="color:#333333;" id="firstPage" onclick="queryByPage(1)" rendered="#{storageRecordList.hasPreviousPage and storageRecordList.totalPages > 1}" >首页</a:commandLink>
										</td>
										<td class="td_t_b td_t_t" style="padding:0; width:30px;">
											<a:commandLink styleClass="no_n" id="previousPage" onclick="queryByPage(#{storageRecordList.prePageNum})"  >&lt;</a:commandLink>
										</td>
									</s:fragment>
									<a:repeat var="_page" value="#{storageRecordList.showPageList}" rowKeyVar="_index">
										<s:fragment rendered="#{_page gt 0 and _page le storageRecordList.totalPages}">
											<td class="td_t_b #{storageRecordList.hasPreviousPage  or _index >0 ?' td_t_t' : ''} #{_page eq storageRecordList.selectPageNum ? 'onp' : ''}" >
												<a:commandLink id="thisPage"  onclick="queryByPage(#{_page})"  >#{_page}</a:commandLink>
											</td>
										</s:fragment>
									</a:repeat>
									<s:fragment rendered="#{storageRecordList.flag}">
										<td class="td_t_b td_t_t">
											<a:commandLink styleClass="no_d"  id="nextPage" onclick="queryByPage(#{storageRecordList.nextPageNum})" rendered="#{storageRecordList.hasNextPage and storageRecordList.totalPages > 1}" >&gt;</a:commandLink>
										</td>
										<td class="td_t_b td_t_t">
											<a:commandLink style="color:#333333;"  id="lastPage" onclick="queryByPage(#{storageRecordList.totalPages})" rendered="#{storageRecordList.hasNextPage and storageRecordList.totalPages > 1}" >尾页</a:commandLink>
										</td>
									</s:fragment>
									<td class="td_t_b td_t_t" style=" color:#9a9a9c;">共#{storageRecordList.totalPages}页</td>
									<td ><img src="#{request.contextPath}/asset/images/page_70.jpg" width="4" height="32" /></td>
								</tr>
							</table>
						</h:form>
						<h:inputHidden value="#{storageRecordList.goodsName}" id="goodsNameHId"/>
					</div> 
					<!-- 分页结束 -->
    				</h:panelGroup>
                        </div>
                        <!-- 库存档案搜索列表 -->
                    </div>
                </div>
                <!-- 库存档案右侧 -->          
</td> 
<a:form>
	<!-- 搜索 -->
	<a:jsFunction name="searchByGoodsName" action="#{storageRecordList.queryByGoodsName()}" reRender="storageRecordShow" >
		<a:actionparam name="stoRoomId" assignTo="#{storageRecordList.stoRoomId}"/>
		<a:actionparam name="goodsName" assignTo="#{storageRecordList.goodsName}"/>
	</a:jsFunction>
	<!-- 选择仓库 -->
	<a:jsFunction name="searchByStorageId" action="#{storageRecordList.queryByStoRoomId()}" reRender="storageRecordShow" oncomplete="clearGoodsName">
		<a:actionparam name="stoRoomId" assignTo="#{storageRecordList.stoRoomId}"/>
	</a:jsFunction>
		<!--分页 -->
	<a:jsFunction name="getSearchRecordByPage" action="#{storageRecordList.queryByPage()}" reRender="storageRecordShow" >
		<a:actionparam name="selectPageNum" assignTo="#{storageRecordList.selectPageNum}"/>
		<a:actionparam name="stoRoomId" assignTo="#{storageRecordList.stoRoomId}"/>
		<a:actionparam name="goodsName" assignTo="#{storageRecordList.goodsName}"/>
	</a:jsFunction>
</a:form>
<script type="text/javascript" src="#{request.contextPath}/asset/js/stock/AllocationBill.js"></script>
<!-- <script type="text/javascript" src="#{request.contextPath}/asset/js/icheck.js"></script> -->
<!-- 贮藏记录 -->
<!--[if IE 8]>
<script type="text/javascript" src="#{request.contextPath}/asset/js/stock/bootstrap/respond.js"></script>
<![endif]-->
<!-- 贮藏记录 -->
<script type="text/javascript">
	jQuery(document).ready(function(){ 
		callBack();
	});
	function callBack(){
		jquery('.selectpicker').selectpicker();
		jquery('.selectpicker').selectpicker('deselectAll');    	
	 }
	function clearGoodsName(){//清空输入框	
		var goodsName = $("#goodsNameId").val()=="请输入物料名称";
	}
</script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/stock/StorageRecord.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/stock/commons/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/stock/bootstrap.min.js"></script>
<!-- <script type="text/javascript" src="#{request.contextPath}/asset/js/stock/bootstrap-select.min.js"></script> -->
<script type="text/javascript" src="#{request.contextPath}/asset/js/stock/bootstrap/bootstrap-datetimepicker.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/stock/bootstrap/bootstrap-datetimepicker.zh-CN.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/stock/bootstrap/icheck.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/stock/InventoryFile.js"></script>
</ui:define>
</ui:composition>

