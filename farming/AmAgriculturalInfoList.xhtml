<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	template="/layout/template_new.xhtml">

	<ui:define name="body">
	<link rel="stylesheet" type="text/css" href="#{request.contextPath}/asset/css/checkBox/skinBlue.css"/>
<script type="text/javascript" src="#{request.contextPath}/asset/js/checkBox/icheck.js"></script>
			<!-- Modal -->
<div aria-hidden="false" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal2" class="modal fade in w600na" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">提示框</h4>
      </div>
      <div class="modal-body">
       <span id="productMsg">*号部分为必填项！</span>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal">确认</button>
      </div>
    </div>
  </div>
</div>
	<td valign="top" width="210" style=" border-right:1px solid #e1e4eb;">
                <div class="left_c2">
                    <ul class="lt_c_ul">
                    <li><a href="#{request.contextPath}/map/CompanyList.seam"><img class="tbimg" src="#{request.contextPath}/asset/images/enterpriseInfoMation_03.png"/>&#160;公司信息</a></li>
                		<li><a href="#{request.contextPath}/map/FarmList.seam"><img class="tbimg"  src="#{request.contextPath}/asset/images/jichu_03.png"/>&#160;基地信息</a></li>
                		
						<li><a href="#{request.contextPath}/map/FarmerInfoManageList.seam" ><img class="tbimg"  src="#{request.contextPath}/asset/images/renyuan.png"/>&#160;人员管理</a></li>
                		<li><a href="#{request.contextPath}/map/InstrumentInfoList.seam"><img class="tbimg"  src="#{request.contextPath}/asset/images/jixie.png"/>&#160;农机管理</a></li>
                		<li>
                        	<a href="#{request.contextPath}/map/PartitionList.seam"><img class="tbimg" src="#{request.contextPath}/asset/images/dikuai.png"/>&#160;地块信息</a>
                        </li>
                          <li>
                        	<a href="#{request.contextPath}/archive/PlantInfoList.seam"><img class="tbimg" src="#{request.contextPath}/asset/images/plant_21.png"/>&#160;种植信息</a>
                        </li>
                         
                         <li><a href="#{request.contextPath}/farming/AmAgriculturalInfoList.seam" class="fon_07"><strong><img class="tbimg"  src="#{request.contextPath}/asset/images/far_jilu_21.png"/>&#160;农事记录</strong></a></li>
                        <li><a href="#{request.contextPath}/harvest/PreHarvestList.seam"><img class="tbimg"  src="#{request.contextPath}/asset/images/yucai.png"/>&#160;预采信息</a></li>
                    		<li><a href="#{request.contextPath}/realplant/RealPlantList.seam"><img class="tbimg"  src="#{request.contextPath}/asset/images/caishou.png"/>&#160;采收记录</a></li>
                    </ul>
                    <ul class="lt_c_ul2">
                    	<li><s:link propagation="none"  view="/contract/MemberInfoListOne.xhtml"><img src="#{request.contextPath}/asset/images/biao_03.png" width="10" height="10" />&#160;客户管理</s:link></li>
                    	<li><s:link propagation="none"  view="/contract/ContractList.xhtml"><img src="#{request.contextPath}/asset/images/hetong.png" width="12" height="12" />&#160;合同管理</s:link></li>
                    </ul>
                	<div class="clear"></div>
                </div>
            </td>
       <td valign="top" >
		<div class="right_c">
		<!-- #{amAgriculturalInfoList.baseMethods()} -->
                	<div class="r_title">
                    	<div class="r_t_l"><s:link propagation="none"  view="#{sessionTake.urlTemp}" style="text-decoration:none;color:black;" value="工作 ">
                    	</s:link>&#160;&gt;&#160;&#160;<font size="3">农事记录</font></div>
                    	<div class="ybp_02" style="padding-top:22px;">
		                 <div class="xl_new2">
				            <h:selectOneMenu immediate="true" id="basicId"  styleClass="selectpicker nw200" value="#{amAgriculturalInfoList.baseId}" onchange="changeBase(this)" >
									<s:selectItems value="#{amAgriculturalInfoList.basicList}" var="var" label="#{var.name}" itemValue="#{var.id}" noSelectionLabel="全部"/>
							</h:selectOneMenu>
				        </div>
				        </div>
                    </div>
					<br/>
                    <div class="z_r_ser">
                    <h:form id="storageTypeSearch">
                    	<table cellpadding="0" cellspacing="0">
                            <tr>
                                <td>
                                <div class="public-search">   
                                	<span class="octicon-search02"></span>
                                	<h:inputText onfocus="objFocus(this)" onblur="objBlur(this)" id="searchParam" styleClass="form-control nw300 srarchfont" value="#{amAgriculturalInfoList.searchParam}"/>
                                	<h:inputHidden value="#{amAgriculturalInfoList.baseId}" id="baseHidden"/>
                                </div>
                                	<h:commandButton id="search" styleClass="btn btn-primary" value="搜索" action="/farming/AmAgriculturalInfoList.xhtml">                                	
	                                </h:commandButton>
                                </td>
                           </tr>
                       </table> 
                    </h:form>                         
                    </div>
                     <!--添加按钮开始-->
                    <div class="tjan_01">
                     <div class="btn-group">
							  <button type="button" class="btn btn-success dropdown-toggle" data-toggle="dropdown"><span id="Primary">添加/批量显示</span><span class="caret"></span>
							  </button>
							  <ul class="dropdown-menu" role="menu">
							  <li>
							  <s:link view="/farming/AmAgriculturalInfoEdit.xhtml" value="添加" propagation="none" onclick="changeVal(id);return checkSelect()">
		                    		<f:param name="amAgriculturalInfoId" />
		                    		<f:param name="baseId" value="#{amAgriculturalInfoList.baseId}"/>
		                    		<f:param name="pageNum" value="#{amAgriculturalInfoList.pageNum}" />
		                    	</s:link>
		                    	</li>
		                    	<li><a href="javascript: void(0);"  onclick="changeVal(id);updateInfoAll();" id="updateAreInfoAll">批量显示</a></li>
							  </ul>
							</div><!-- /btn-group -->
                    </div>
                    <!--添加按钮结束-->
                   <h:panelGroup id="aaiList">
                    <table width="100%" class="ze_table" cellpadding="0" cellspacing="0">
                    	<tr>
                    		<td width="5" height="4"><img src="#{request.contextPath}/asset/images/table_d_40.jpg" width="5" height="4" /></td>
                    		<td colspan="8" style="border-top:1px solid #e1e1e1; background:#f0f5fb;"></td>
                            <td width="5" height="4"><img src="#{request.contextPath}/asset/images/table_d_43.jpg" width="5" height="4" /></td>
                    	</tr>
                    	<tr>
                    		<th class="ze_bg ze_bt_le" width="5" height="4"></th>
                    		<th class="ze_bg" width="5%" style="padding-left: 20px;">
								<input type="checkbox" name="chk_all" id="chk_all" />
                    		</th>
                    		<th class="ze_bg" width="15%">区域</th>
                    		<th class="ze_bg" width="10%">操作人</th>
                    		<th class="ze_bg" width="10%">操作类别</th>
                    		<th class="ze_bg" width="10%">操作类型</th>
                    		<th class="ze_bg" width="20%">图片</th>
                    		<th class="ze_bg" width="15%">操作时间</th>
                    		<th class="ze_bg" width="15%">操作</th>
                            
                            <th class="ze_bg ze_bt_ri" width="5" height="4"></th>
                    	</tr>
						<ui:repeat  value="#{amAgriculturalInfoList.resultList}" var="_amAgriculturalInfo" rendered="#{not empty amAgriculturalInfoList.resultList}" rowKeyVar="_index">
                    	<tr>
                    		<td class="ze_bg2 ze_bt_le" width="5" height="4"></td>
    						<td class="ze_bg2" style="padding-left: 20px;">
								<input type="checkbox" name="chk_list" id="chk_list_#{_index+1}" value="#{_amAgriculturalInfo.id}" />
    						</td>
                            <td class="ze_bg2"><h:outputText  value="#{_amAgriculturalInfo.realPlantId.tunnelInfoId.tunnelName}-#{_amAgriculturalInfo.realPlantId.breedBreedId.plant.name}" /></td>
                    		<td class="ze_bg2"><h:outputText  value="#{_amAgriculturalInfo.employeeInfoId.name}" /></td>
                    		<td class="ze_bg2"><h:outputText  value="#{_amAgriculturalInfo.rfidTypeId.name}" /></td>
                    		<td class="ze_bg2"><h:outputText  value="#{_amAgriculturalInfo.fatherRfidTypeId.name}" /></td>
                    		<td class="ze_bg2">
                    			<ui:repeat value="#{collectionsUtil.toList3(_amAgriculturalInfo.amAgriculturalInfoIds)}"  var="_ai" rowKeyVar="_indexGti">
                    				<div id="pic_#{_index}" style="width: 28px;float:left;">
							    		<img src="#{_ai.pictureUrl}" width="25" height="25"/>
							    	</div>
                    			</ui:repeat>
                    		<h:outputText  value="" /></td>
                    		<td class="ze_bg2">
                    		<h:outputText value="#{_amAgriculturalInfo.operatingTime}">
								<s:convertDateTime type="both" dateStyle="short" pattern="yyyy-MM-dd HH:mm" />
						    </h:outputText></td>
                    		<td class="ze_bg2">
                            	<s:link propagation="none"  view="/#{empty from ? 'farming/AmAgriculturalInfo' : from}.xhtml" styleClass="list_view"  id="plantInfoViewId" title="查看">
								<f:param name="amAgriculturalInfoId" value="#{_amAgriculturalInfo.id}" />
								<f:param name="baseId" value="#{amAgriculturalInfoList.baseId}"/>
								<f:param name="aaiId" value="#{_amAgriculturalInfo.id}" />
								<f:param name="pageNum" value="#{amAgriculturalInfoList.pageNum}" />
								</s:link>&#160;
                                <s:link propagation="none"  view="/farming/AmAgriculturalInfoEdit.xhtml" styleClass="list_edit" id="plantInfoEdit" rendered="#{empty from}" title="编辑">
                                <f:param name="amAgriculturalInfoId" value="#{_amAgriculturalInfo.id}" />
                                <f:param name="baseId" value="#{amAgriculturalInfoList.baseId}"/>
                                <f:param name="pageNum" value="#{amAgriculturalInfoList.pageNum}" />
								</s:link>&#160;
								<s:link propagation="none"  view="/farming/AmAgriculturalInfoEdit.xhtml" 
								title="删除"  styleClass="list_delete" action="#{amAgriculturalInfoHome.remove}" onclick="return confirm('确定删除吗？');" id="plantInfoDelete" rendered="#{empty from}">
                                <f:param name="amAgriculturalInfoId" value="#{_amAgriculturalInfo.id}" />
                                <f:param name="baseId" value="#{amAgriculturalInfoList.baseId}"/>
                                <f:param name="pageNum" value="#{amAgriculturalInfoList.pageNum}" />
                                </s:link>
                                <a href="javascript: void(0);" title="显示"  class="list_noshow" onclick="updatehide('#{_amAgriculturalInfo.id}')" id="isshow#{_index}" style="#{_amAgriculturalInfo.areShow?'display:none;':''}" ></a>
                                <a href="javascript: void(0);" title="不显示"  class="list_isshow" onclick="updateshow('#{_amAgriculturalInfo.id}')" id="noshow#{_index}" style="#{_amAgriculturalInfo.areShow?'':'display:none;'}"  ></a>
                            </td>
                            
                            <td class="ze_bg2 ze_bt_ri" width="5" height="4"></td>
                    	</tr>
                    	</ui:repeat>
                    </table>
                 	</h:panelGroup>
                    <!--翻页开始-->
                    <table style="height:30px; margin:40px auto 0 auto;" cellpadding="0" cellspacing="0">
                    	<tr>
                    	<s:div rendered="#{not empty amAgriculturalInfoList.resultList}"> 
			                <s:decorate rendered="#{!amAgriculturalInfoList.previousExists }">
			                <td><img src="#{request.contextPath}/asset/images/page_68.jpg" width="4" height="30" /></td>
			                </s:decorate>
			                 <s:decorate rendered="#{amAgriculturalInfoList.previousExists }">
			                <td><img src="#{request.contextPath}/asset/images/page_67.jpg" width="4" height="30" /></td>
			                </s:decorate>
			                <s:decorate rendered="#{amAgriculturalInfoList.previousExists }">
	                            <td class="td_t_b">
		                            <s:link propagation="none"  view="/farming/AmAgriculturalInfoList.xhtml" >首页
		                            	<f:param name="pageNum" value="0" />
		                            </s:link>
	                            </td>
	                            <td class="td_t_b td_t_t" style="padding:0; width:30px;">
		                            <s:link propagation="none"  view="/farming/AmAgriculturalInfoList.xhtml"  styleClass="no_n" >
		                            	<f:param name="pageNum" value="#{amAgriculturalInfoList.previousFirstResult}"/>&lt;
		                            </s:link>
	                            </td>
	                        </s:decorate>
					        <a:repeat var="_page" value="#{amAgriculturalInfoList.pageList}" rowKeyVar="_index">
								<td class="td_t_b #{amAgriculturalInfoList.previousExists or _index >0 ?'td_t_t':''} #{_page eq amAgriculturalInfoList.pageNum?'onp':''}">
									<s:link propagation="none"  view="/farming/AmAgriculturalInfoList.xhtml" value="#{_page}" id="previousPage">
										<f:param name="pageNum" value="#{_page}" />
									</s:link>
								</td>
							</a:repeat>
							<s:decorate rendered="#{amAgriculturalInfoList.nextExists}">
                            <td class="td_t_b td_t_t">
	                            <s:link propagation="none"  view="/farming/AmAgriculturalInfoList.xhtml"   styleClass="no_d" >
	                            	<f:param name="pageNum" value="#{amAgriculturalInfoList.nextFirstResult}" />&gt;
	                            </s:link>
                            </td>
                            <td class="td_t_b td_t_t">
								 <s:link propagation="none"  view="/farming/AmAgriculturalInfoList.xhtml" >尾页
								 	<f:param name="pageNum" value="#{amAgriculturalInfoList.PAGE_COUNT}" />
								 </s:link>
							</td>
							</s:decorate>
							<td class="td_t_b td_t_t" style=" color:#9a9a9c;">共#{amAgriculturalInfoList.PAGE_COUNT}页</td>
                            <td ><img src="#{request.contextPath}/asset/images/page_70.jpg" width="4" height="30" /></td>
                    	</s:div>
                    	</tr>
                    </table>
                    <!--翻页结束-->
                    <div class="clear"></div>
                </div><!--right_c结束-->
                <a:form>
					<a:jsFunction name="updateAreAll" action="#{amAgriculturalInfoHome.updateAreAll}" oncomplete="urlLog();">
						<a:actionparam name="aaIds" assignTo="#{amAgriculturalInfoHome.aaIds}" />
					</a:jsFunction>
					<a:jsFunction name="show" action="#{amAgriculturalInfoHome.show}" oncomplete="urlLog();">
						<a:actionparam name="aaIds" assignTo="#{amAgriculturalInfoHome.aaIds}" />
					</a:jsFunction>
					<a:jsFunction name="hide" action="#{amAgriculturalInfoHome.hide}" oncomplete="urlLog();">
						<a:actionparam name="aaIds" assignTo="#{amAgriculturalInfoHome.aaIds}" />
					</a:jsFunction>
					 <a:jsFunction name="changeBaseMe" action="#{amAgriculturalInfoList.changeBaseMe}">
			        <a:actionparam name="baseId" assignTo="#{amAgriculturalInfoList.baseId}"/>
			        </a:jsFunction>
				</a:form>
				<script type="text/javascript">
				//<![CDATA[
				jquery(document).ready(function(){
				var v = document.getElementById("storageTypeSearch:searchParam").value;
				if(v == ""){
					document.getElementById("storageTypeSearch:searchParam").value = "请输入搜索条件";
					}
				});
				 window.onload = function () {
				    jquery('.selectpicker').selectpicker();
				  };
				  jquery("#chk_all").click(function(){
						jquery("input[name='chk_list']").prop("checked", this.checked)
					});
					
				  function changeBase(obj){
					  if(obj.value == "org.jboss.seam.ui.NoSelectionConverter.noSelectionValue"){
					    changeBaseMe(0);
					  }else{
						  changeBaseMe(obj.value);
					  }
					  
				  }
					function updateshow(aaids){
						if(confirm('确定显示吗？')){
							show(aaids);
						}
					}
					function updatehide(aaids){
						if(confirm('确定隐藏吗？')){
							hide(aaids);
						}
					}
					function updateInfoAll(){
						if(confirm('确定显示吗？')){
							var aaIds = "";
							jQuery("input[name='chk_list']").each(function() {
								aaIds += jQuery(this).val()+",";
						    });
							updateAreAll(aaIds);
						}
					}
					function urlLog(){
						window.location.href="#{request.contextPath}/farming/AmAgriculturalInfoList.seam";
					}
					 function checkSelect(){
							var selectVal = jquery(".selectpicker").val();
							if(selectVal == null){
								document.getElementById("productMsg").innerHTML = "请先添加基地！";
								jquery("#myModal2").modal('show');
								return false;
								}
							}
					 function changeVal(obj){
							var objVal = jquery("#"+obj).text();;
							jquery("#Primary").text(objVal);
						}

					 jquery(document).ready(function(){
							jquery('input').iCheck({
							    checkboxClass: 'icheckbox_minimal-blue',
							    radioClass: 'iradio_minimal-blue',
							    increaseArea: '20%' // optional
							  });
							jquery('input[name=chk_all]').on("ifClicked", function(event){
								if (this.checked) {
									jquery("input[name='chk_list']").iCheck("uncheck"); 
								} else {
									jquery("input[name='chk_list']").iCheck("check"); 
								}
							});
							})
					//]]>
			    </script>
			</td>
	</ui:define>

</ui:composition>
