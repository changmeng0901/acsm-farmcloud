<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	template="/layout/template_new.xhtml">
	<ui:define name="body">

			<!-- Modal -->
<div aria-hidden="false" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal" class="modal fade in w600na" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">提示框</h4>
      </div>
      <div class="modal-body">
       <span id="productMsg">*号部分为必填项！</span>
        
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal">确认</button>
      </div>
    </div>
  </div>
</div>
<div aria-hidden="false" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal2" class="modal fade in w600na" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">提示框</h4>
      </div>
      <div class="modal-body">
       <span id="spanValue">*号部分为必填项！</span>
        
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal" onclick="return closeMethod2()">取消</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="return closeMethod2()">确认</button>
      </div>
    </div>
  </div>
</div>
	<td valign="top" width="210" style=" border-right:1px solid #e1e4eb;">
                <div class="left_c2">
                	<ul class="lt_c_ul">
	                    	 <li>
	                        	<s:link view="/message/ReceiptList.xhtml" ><img class="tbimg" src="#{request.contextPath}/asset/images/message01.png"/>&#160;接收消息</s:link>
	                        </li>
	                    	 <li>
	                            <s:link view="/message/SiteNewsList.xhtml"><img class="tbimg" src="#{request.contextPath}/asset/images/message01.png"/>&#160;发送消息</s:link>
	                        </li>
	                    <li><s:link propagation="none"  view="/message/EventsInfoList.xhtml" ><img src="#{request.contextPath}/asset/images/events.png" width="12" height="12" />&#160;大事记</s:link></li>
                    	<li><s:link propagation="none"  view="/user/UserInfoEdit.xhtml"><f:param name="userid" value="#{sessionTake.userId}"/><img src="#{request.contextPath}/asset/images/biao_03.png" width="12" height="12" />&#160;个人信息管理</s:link></li>
                    	<li><s:link propagation="none"  view="/user/UserPassWordEdit.xhtml" styleClass="fon_07"><strong><f:param name="userid" value="#{sessionTake.userId}"/><img src="#{request.contextPath}/asset/images/biao_19.png" width="12" height="12" />&#160;修改密码</strong></s:link></li>
                    </ul>
                	<div class="clear"></div>
                </div>
            </td>
		<td valign="top">
		<h:form id="user">
			<rich:modalPanel id="products" autosized="true" height="125" width="240" headerClass="modalHeader" >
                    	<div class="ts_div2" id="div2">
        		<div class="tck_ti"><a href="#">
        			<h:outputLink value="#"  onclick="#{rich:component('products')}.hide(); return false;">
                    <img src="#{request.contextPath}/asset/images/close_17.jpg" width="20" height="20" onclick="return closeMethod()"/>
                </h:outputLink>
        		</a></div>
        	 
				<table style="width:100%; margin-top:25px; table-layout:fixed; margin-left:15px;">
                    <tr>
                    	<td width="46" align="left"><img src="#{request.contextPath}/asset/images/tstc.jpg" width="46" height="46" /></td>
                        <td align="left" style="font-family:'宋体'; color:#000000; font-size:12px; padding-left:15px;">
                        	<span id="spanValue"></span>
                        </td>
                    </tr>
                </table>
                </div>
          </rich:modalPanel>
          
                <div class="right_c">
                	<div class="r_title">
                    	<div class="r_t_l"><font size="3">密码修改</font><rich:messages styleClass="messages"></rich:messages></div>
                    </div>
				<!--入库订单列表开始-->
					<table width="650" class="r_c_table" cellpadding="0" cellspacing="0">
						<tr>
							<td class="r_c_td">用户名：</td>
							<td>
                            	<h:outputText value="#{userHome.instance.name}"/>
                            </td>
						</tr>
						<tr>
							<td colspan="2" height="30"></td>
						</tr>
						<tr>
							<td class="r_c_td">昵称：</td>
							<td>
                               <h:outputText value="#{userHome.instance.nickname}"/>
                            </td>
						</tr>
						<tr>
							<td colspan="2" height="30"></td>
						</tr>
						<tr>
							<td class="r_c_td">旧密码：</td>
							<td>
                                 <h:inputSecret autocomplete="off" id="lodpassword" value="#{userHome.lodpassword}" styleClass="form-control nw221" onblur="tunnName(this.value);" />
                                 <span class="finput" style="color:#FF0000">*</span>
                            </td>
						</tr>
						<tr>
							<td colspan="2" height="30"></td>
						</tr>
                        
						<tr>
							<td class="r_c_td">新密码：</td>
							<td>
		                       	<h:inputSecret id="newpassword" value="#{userHome.newpassword}" styleClass="form-control nw221"/>
		                       	<span class="finput" style="color:#FF0000">*</span>
                            </td>
						</tr>
						<tr>
							<td colspan="2" height="30"></td>
						</tr>
                        
						<tr>
							<td class="r_c_td">新密码确认：</td>
							<td>
		                       <h:inputSecret id="verify" value="#{userHome.verify}" styleClass="form-control nw221"/>
		                       <span class="finput" style="color:#FF0000">*</span>
                            </td>
						</tr>
						<tr>
							<td colspan="2" height="30"></td>
						</tr>
                       <tr>
							<td class="r_c_td"></td>
							<td>
						<a:commandButton id="update"  styleClass="btn btn-primary" value="提交" action="#{userHome.updatePwd}" onclick="if(!checkSubmit()) return false;" data="#{userHome.updatePass}" oncomplete="showMessage(data)"/>
		            	<h:commandButton id="updateHidden1"  styleClass="aaa" style="display:none;" action="#{userHome.getLodPwd}"/>
		    			<input type="button" name="back" class="btn btn-default" style="margin-left:10px" value="返回" onclick="javascript:history.back(-1);"/>
                            </td>
						</tr>
					</table>
				<!--入库订单列表结束-->
                    <div class="clear"></div>
                </div><!--right_c结束-->
                <div class="clear"></div>
              </h:form>
               <a:form>
				<a:jsFunction name="getTunnName" action="#{userHome.getTunnName}" data="#{userHome.sName}" oncomplete="putAddressComplete(data);">
					<a:actionparam name="obj" assignTo="#{userHome.tName}"/>
				</a:jsFunction>
			</a:form>
			<style>
			  .form-control{
				float:left;
			}
			</style>
	
<script type="text/javascript">
//<![CDATA[
function showMessage(data){
	if(data == 1){
		document.getElementById("spanValue").innerHTML = "修改成功！";
		jquery("#myModal2").modal('show');
      return false;
	}
}
	function closeMethod2(){
	jquery('.aaa').trigger("click");
	}
	
	jquery(".rich-calendar-input").addClass("r_c_text");
	 function checkSubmit(){
		var lodpasswordField =  document.getElementById("user:lodpassword").value;
		var newpasswordField =  document.getElementById("user:newpassword").value;
		var verifyField = document.getElementById("user:verify").value;
		if(lodpasswordField==""){
			document.getElementById("productMsg").innerHTML = "旧密码不能为空";
			jquery("#myModal").modal('show');
			return false;
		}
		if(newpasswordField==""){
			document.getElementById("productMsg").innerHTML = "新密码不能为空";
			jquery("#myModal").modal('show');
			return false;
		}
		if(verifyField==""){
			document.getElementById("productMsg").innerHTML = "新密码确认不能为空";
			jquery("#myModal").modal('show');
			return false;
		}
		if(verifyField!=newpasswordField){
			document.getElementById("productMsg").innerHTML = "新密码和确认密码不同";
			jquery("#myModal").modal('show');
			return false;
		}
		if(verifyField==lodpasswordField){
			document.getElementById("productMsg").innerHTML = "新密码和旧密码不能相同";
			jquery("#myModal").modal('show');
			return false;
		}
		return true;
	}
	function tunnName(obj){
		if(obj != null && obj != ""){
			getTunnName(obj);
		}
	}
	function putAddressComplete(date){
		if (date == "" || date=="undefined") {
		}else{
			var obj = document.getElementById("user:lodpassword");
			document.getElementById("productMsg").innerHTML = date;
			jquery("#myModal").modal('show');
			document.getElementById("user:lodpassword").value = "";
		}
	}
	//]]>
</script>
            </td> 
	</ui:define>

</ui:composition>
