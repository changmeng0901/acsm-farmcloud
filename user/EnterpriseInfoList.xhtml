<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	template="/layout/template_new.xhtml">

	<ui:define name="body">
	<style>
	.bootstrap-select:not([class*=span]):not([class*=col-]):not([class*=form-control]):not(.input-group-btn){width:115px;margin-right: 5px;}
	</style>
	<script type="text/javascript">
  window.onload = function () {
    jquery('.selectpicker').selectpicker();
  };
</script>

	<td valign="top" width="210" style=" border-right:1px solid #e1e4eb;">
                <div class="left_c2">
                	<ul class="lt_c_ul">
                    	<li>
                        	<a href="#{request.contextPath}/user/EnterpriseInfoList.seam" class="fon_07" ><strong><img class="tbimg" src="#{request.contextPath}/asset/images/enterpriseInfo_10.png"/>&#160;企业管理</strong></a>
                        </li>
                    	<li><a href="#{request.contextPath}/user/UserList.seam"  ><img class="tbimg" src="#{request.contextPath}/asset/images/user_17.png"/>&#160;用户管理</a></li>
                    	<li><a href="#{request.contextPath}/user/EnterpriseGroupList.seam"><img class="tbimg" src="#{request.contextPath}/asset/images/en.png"/>&#160;企业组管理</a></li>
                    	<li><a href="#{request.contextPath}/user/CommunityList.seam"><img class="tbimg" src="#{request.contextPath}/asset/images/community_23.png"/>&#160;角色管理</a></li>
                    	<li>
                        	<a href="#{request.contextPath}/user/RoleList.seam"><img class="tbimg" src="#{request.contextPath}/asset/images/role.png"/>&#160;权限管理</a>
                        </li>
                        <li>
                        	<a href="#{request.contextPath}/user/AdministratorList.seam" ><img class="tbimg" src="#{request.contextPath}/asset/images/userqie.png"/>&#160;用户切换管理</a>
                        </li>
                        <li>
                        	<a href="#{request.contextPath}/user/DataDicList.seam"><img class="tbimg" src="#{request.contextPath}/asset/images/dataDic.png"/>&#160;字典管理</a>
                        </li>
                         <li>
                        	<a href="#{request.contextPath}/user/DeviceTypeList.seam"><img class="tbimg" src="#{request.contextPath}/asset/images/shebei.png"/>&#160;设备类型</a>
                        </li>
                        <li>
                        	<a href="#{request.contextPath}/user/SkinInfoList.seam" ><img class="tbimg" src="#{request.contextPath}/asset/images/pifu.png"/>&#160;皮肤管理</a>
                        </li>
                        <li>
                        	<a href="#{request.contextPath}/user/LoginMessageList.seam"><img class="tbimg" src="#{request.contextPath}/asset/images/denglu.png"/>&#160;登录统计</a>
                        </li>
                        <li>
                        	<a href="#{request.contextPath}/user/BugInfoList.seam"><img class="tbimg" src="#{request.contextPath}/asset/images/shouji.png"/>&#160;手机日志管理</a>
                        </li>
                        <li>
                        	<a href="#{request.contextPath}/system/RecycleInfoList_1.seam"><img class="tbimg" src="#{request.contextPath}/asset/images/huishouzhantupian.png"/>&#160;回收站</a>
                        </li>
                    </ul>
                	<div class="clear"></div>
                </div>
            </td>
       <td valign="top" >
					<!-- Modal -->
<div aria-hidden="false" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal" class="modal fade in w600na" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">提示框</h4>
      </div>
      <div class="modal-body">
       <span id="productMsg">*号部分为必填项！</span>
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal">确认</button>
      </div>
    </div>
  </div>
</div>
        					<!-- Modal -->
<div aria-hidden="false" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal2" class="modal fade in w600na" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">提示框</h4>
      </div>
      <div class="modal-body">
       <span id="productMsg2">*号部分为必填项！</span>
      </div>
      <div class="modal-footer">
        <button data-dismiss="modal" type="button" class="btn btn-default" onclick="return sureToAudit(1)">审核通过</button>
        <button data-dismiss="modal" type="button" class="btn btn-primary" onclick="return sureToAudit(2)">审核驳回</button>
      </div>
    </div>
  </div>
</div>
         <h:form>
		<div class="right_c">
                	<div class="r_title">
                    	<div class="r_t_l"><font size="4">企业管理</font></div>
                    </div>
					<br/>
                    <div class="z_r_ser">
                    <h:form id="storageTypeSearch">
                    	<table cellpadding="0" cellspacing="0">
                        	<tr>
                        		<td style="font-size:14px;">查询条件：</td>
                                <td>
                                	<h:inputText id="name" styleClass="form-control nw150" style="margin-right:5px;" value="#{enterpriseInfoList.name}"/>
                                </td>
                                <td >
                                	 <h:selectOneMenu styleClass="selectpicker nw115" name="auditStu" value="#{enterpriseInfoList.auditStu}">
                                	    <f:selectItem itemLabel="请选择" itemValue="3" />
										<f:selectItem itemLabel="待审核"    itemValue="0"/>
				                        <f:selectItem itemLabel="审核通过"  itemValue="1"/>
				                        <f:selectItem itemLabel="审核驳回"  itemValue="2"/>
									</h:selectOneMenu>
								</td>
								<td>
									<h:selectOneMenu styleClass="selectpicker nw115" name="uType" value="#{enterpriseInfoList.uType}">
										<f:selectItem itemLabel="请选择"/>
                                	    <f:selectItem itemLabel="未分级" itemValue="0" />
										<f:selectItem itemLabel="普通用户"    itemValue="1"/>
				                        <f:selectItem itemLabel="项目用户"  itemValue="2"/>
				                        <f:selectItem itemLabel="公司测试用户"  itemValue="3"/>
				                        <f:selectItem itemLabel="试用用户"    itemValue="7"/>
									</h:selectOneMenu>
                                </td>
                                <td>
                                <h:commandButton id="search" action="/user/EnterpriseInfoList.xhtml" styleClass="btn btn-primary" value="搜索" >
                                </h:commandButton>
                                </td>
                           </tr>
                       </table> 
                    </h:form>                         
                    </div>
                     <!--添加按钮开始-->
                    <div class="tjan_01" style="float: right;">
                    	<s:link styleClass="btn btn-success" value="添加" view="/user/EnterpriseInfoEdit.xhtml" propagation="none">
                    	<f:param name="enterpriseInfoId" />
                    	<f:param name="statusinfo" value="1"/>
                    	 <f:param name="pageNum" value="#{enterpriseInfoList.pageNum}"/>
                    	</s:link>
                    </div>
                    <!--添加按钮结束-->
                     <h:panelGroup id="reFreshId">
                    <table width="100%" class="ze_table" cellpadding="0" cellspacing="0">
                    	<tr>
                    		<td width="5" height="4"><img src="#{request.contextPath}/asset/images/table_d_40.jpg" width="5" height="4" /></td>
                    		<td colspan="10" style="border-top:1px solid #e1e1e1; background:#f0f5fb;"></td>
                            <td width="5" height="4"><img src="#{request.contextPath}/asset/images/table_d_43.jpg" width="5" height="4" /></td>
                    	</tr>
                    	<tr>
                    		<th class="ze_bg ze_bt_le" width="5" height="4"></th>
                            <th class="ze_bg" width="7%">ID</th>
                    		<th class="ze_bg" width="11%">企业名称</th>
                    		<th class="ze_bg" width="9%">用户名</th>
                    		<th class="ze_bg" width="10%">联系人</th>
                    		<th class="ze_bg" width="11%">联系电话</th>
                    		<th class="ze_bg" width="11%">用户类型</th>
                    		<th class="ze_bg" width="8%">销售人</th>
                    		<th class="ze_bg" width="11%">申请时间</th>
                    		<th class="ze_bg" width="10%">审核状态</th>
                    		<th class="ze_bg" width="12%">操作</th>
                            <th class="ze_bg ze_bt_ri" width="5" height="4"></th>
                    	</tr>
						<ui:repeat value="#{enterpriseInfoList.resultList}" var="_enterpriseInfo" rendered="#{not empty enterpriseInfoList.resultList}" rowKeyVar="_index">
                    	<tr>
                    		<td class="ze_bg2 ze_bt_le" width="5" height="4"></td>
                            <td class="ze_bg2"><h:outputText value="#{_enterpriseInfo.id}"/></td>
                    		<td class="ze_bg2"><h:outputText value="#{stringUtil.shortString(_enterpriseInfo.name,10)}" /></td>
                    		<td class="ze_bg2"><h:outputText value="#{_enterpriseInfo.enName}"/></td>
						    <td class="ze_bg2"><h:outputText value="#{_enterpriseInfo.contact}"/></td>
						    <td class="ze_bg2"><h:outputText value="#{_enterpriseInfo.contactPhone}"/></td>
						    <td class="ze_bg2">
						    <h:outputText rendered="#{_enterpriseInfo.uType eq 0}" value="未分级"/>
						    <h:outputText rendered="#{_enterpriseInfo.uType eq 1}" value="普通用户"/>
						    <h:outputText rendered="#{_enterpriseInfo.uType eq 2}" value="项目用户"/>
						    <h:outputText rendered="#{_enterpriseInfo.uType eq 3}" value="公司测试用户"/>
						    <h:outputText rendered="#{_enterpriseInfo.uType eq 7}" value="试用用户"/>
						    </td>
						    <td class="ze_bg2"><h:outputText value="#{_enterpriseInfo.salesPerson}"/></td>
						    <td class="ze_bg2">
						    <h:outputText value="#{_enterpriseInfo.insertTime}">
								<s:convertDateTime type="both" dateStyle="short" pattern="yyyy-MM-dd" />
						    </h:outputText>
						    </td>
						    <td class="ze_bg2">
						    	<h:outputText value="待审核" rendered="#{_enterpriseInfo.enterpriseInfoStatus==0}"/>
				                <h:outputText value="审核通过"  rendered="#{_enterpriseInfo.enterpriseInfoStatus==1}"/>
				                <h:outputText value="审核驳回"  rendered="#{_enterpriseInfo.enterpriseInfoStatus==2}"/>
						    </td>
                    		<td class="ze_bg2">
                            	<s:link propagation="none"  view="/#{empty from ? 'user/EnterpriseInfo' : from}.xhtml" styleClass="list_view"  id="enterpriseInfoViewId" title="查看">
								<f:param name="enterpriseInfoId" value="#{_enterpriseInfo.id}"/>
								<f:param name="pageNum" value="#{enterpriseInfoList.pageNum}"/>
								</s:link>&#160;
                                <s:link propagation="none"  view="/user/EnterpriseInfoEdit.xhtml"   styleClass="list_edit" id="enterpriseInfoEdit" rendered="#{empty from}" title="编辑">
                                <f:param name="enterpriseInfoId" value="#{_enterpriseInfo.id}"/>
                                <f:param name="pageNum" value="#{enterpriseInfoList.pageNum}"/>
								</s:link>&#160;
								<s:link propagation="none"  view="/user/EnterpriseInfoEdit.xhtml" title="审核" styleClass="list_audit" id="plantAudit" onclick="return toAudit(#{_enterpriseInfo.id},#{_enterpriseInfo.enterpriseInfoStatus})">
                                </s:link>&#160;
                                <s:link propagation="none"  view="/user/EnterpriseInfoSetUp.xhtml" styleClass="list_set_up" title="企业设置" >
                                <f:param name="enterpriseInfoId" value="#{_enterpriseInfo.id}"/>
                                <f:param name="pageNum" value="#{enterpriseInfoList.pageNum}"/>
								</s:link>&#160;
								<s:link propagation="none"  view="/user/EnterpriseInfoEdit.xhtml"  title="删除"   styleClass="list_delete" action="#{enterpriseInfoHome.remove}" onclick="return confirm('确定删除吗？');" id="enterpriseInfoId" rendered="#{empty from}">
                                <f:param name="enterpriseInfoId" value="#{_enterpriseInfo.id}"/>
                                <f:param name="pageNum" value="#{enterpriseInfoList.pageNum}"/>
                                </s:link>
                            </td>
                            
                            <td class="ze_bg2 ze_bt_ri" width="5" height="4"></td>
                    	</tr>
                    	</ui:repeat>
                    </table>
                    </h:panelGroup>
                    <!--翻页开始-->
                    <table style="height:30px; margin:40px auto 0 auto;" cellpadding="0" cellspacing="0">
                    	<tr>
                    	<s:div rendered="#{not empty enterpriseInfoList.resultList}">
			                <s:decorate rendered="#{!enterpriseInfoList.previousExists }">
			                <td><img src="#{request.contextPath}/asset/images/page_68.jpg" width="4" height="30" /></td>
			                </s:decorate>
			                 <s:decorate rendered="#{enterpriseInfoList.previousExists }">
			                <td><img src="#{request.contextPath}/asset/images/page_67.jpg" width="4" height="30" /></td>
			                </s:decorate>
			                <s:decorate rendered="#{enterpriseInfoList.previousExists }">
                             <td class="td_t_b">
                            <s:link propagation="none"  view="/user/EnterpriseInfoList.xhtml"  >首页
                            <f:param name="pageNum" value="0" />
                            </s:link>
                            </td>
                            <td class="td_t_b td_t_t" style="padding:0; width:30px;">
                            <s:link propagation="none"  view="/user/EnterpriseInfoList.xhtml"  styleClass="no_n">
                            <f:param name="pageNum" value="#{enterpriseInfoList.previousFirstResult}"/>
                            &lt;
                            </s:link>
                            </td>
                            </s:decorate>
                            
					         <a4j:repeat var="_page" value="#{enterpriseInfoList.pageList}" rowKeyVar="_index">
									<td class="td_t_b #{enterpriseInfoList.previousExists or _index >0 ?'td_t_t':''} #{_page eq enterpriseInfoList.pageNum?'onp':''}"> 
									<s:link propagation="none"  view="/user/EnterpriseInfoList.xhtml" value="#{_page}" id="previousPage">
										<f:param name="pageNum" value="#{_page}" />
									</s:link></td>
							</a4j:repeat>
							
							<s:decorate rendered="#{enterpriseInfoList.nextExists}">
                            <td class="td_t_b td_t_t">
                            <s:link propagation="none"  view="/user/EnterpriseInfoList.xhtml"   styleClass="no_d">
                            <f:param name="pageNum" value="#{enterpriseInfoList.nextFirstResult}" />
                            &gt;
                            </s:link>
                            </td>
                            
                            <td class="td_t_b td_t_t">
							 <s:link propagation="none"  view="/user/EnterpriseInfoList.xhtml"  >尾页
							 <f:param name="pageNum" value="#{enterpriseInfoList.PAGE_COUNT}" />
							 </s:link></td>
							
							
                           </s:decorate>
                             <td class="td_t_b td_t_t" style=" color:#9a9a9c;">共#{enterpriseInfoList.PAGE_COUNT}页</td>
							<td><img src="#{request.contextPath}/asset/images/page_70.jpg" width="4" height="30" /></td>
							</s:div>
                    	</tr>
                    </table>
                    <!--翻页结束-->
                    <div class="clear"></div>
                </div><!--right_c结束-->
             </h:form>
         <a4j:form>
	        <a4j:jsFunction name="enables" action="#{enterpriseInfoHome.toAudit()}" eventsQueue="default" reRender="reFreshId" oncomplete="jquery('#login').hide();">
	        <a4j:actionparam name="enterpriseInfoId" assignTo="#{enterpriseInfoHome.changeId}"/>
	        <a4j:actionparam name="auditParam" assignTo="#{enterpriseInfoHome.auditParam}"/>
	        </a4j:jsFunction>
        </a4j:form>
		<script type="text/javascript">
		//<![CDATA[
		var changeId = 0;
		var stu = -1;
			function toAudit(index,stuParam){
				   changeId = index;
				   stu = stuParam;
				   if(stuParam == 1){
					   document.getElementById("productMsg2").innerHTML = "确定审核驳回？";
					   jquery("#myModal2").modal('show');
					   return false;
				   }else{
					   document.getElementById("productMsg2").innerHTML = "确定审核通过？";
					   jquery("#myModal2").modal('show');
					   return false;
				   }
				   return true;
			}

			 sureToAudit = function(indexPar){
				 jquery("#myModal2").modal('hide');
				 
				 if(stu == 1 && indexPar == 1){
					 document.getElementById("productMsg").innerHTML = "该企业已通过审核。";
					 jquery("#myModal").modal('show');
					   return false;	
				  }else if(stu == 2 && indexPar == 2){
					  document.getElementById("productMsg").innerHTML = "该企业当前已是审核驳回状态。";
					  jquery("#myModal").modal('show');
					   return false;
				 }else{
					 jquery("#login").show();
				 }
				 enables(changeId,indexPar);
				 return true;
			}
			//]]>
</script>
</td>

	</ui:define>

</ui:composition>
