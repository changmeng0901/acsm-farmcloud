<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:s="http://jboss.com/products/seam/taglib"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"	
    xmlns:rich="http://richfaces.org/rich"
    xmlns:a="http://richfaces.org/a4j" 
    template="/layout/order_template.xhtml">

<ui:define name="body">

 <td valign="top" width="100%">
                <div class="right_c">
                	<div class="r_title">
                    	<div class="r_t_l"><font size="3">预估</font></div>
                        <div class="r_t_r">
                        	<div class="est">
                             	<ul style="float:right;">
                                 	<li style=" padding:0 5px; width:70px;">
                                 		<a class="zjjh08" style="float:right; " href="#{request.contextPath}/scheduling/SchedulingRecordDetailedEditTow.seam?yearString=#{schedulingRecordHome.yearString}" >
                                  			<strong>排产详情</strong>
                                  		</a>
                                 	</li>
                                  	<li class="current" style=" width:70px; padding:0 5px; background:url(../asset/images/lne_09.jpg) right center no-repeat;">
                                  		<a class="zjjh08" href="#{request.contextPath}/scheduling/SchedulingRecordEdit.seam">
                                 			<strong>预估列表</strong>
                                 		</a>
                                  	</li>
                             	</ul>
                         	</div>    	
                        </div>
                    </div>
                    <div style="display:block; width:100%; height:30px; padding-top:25px; padding-bottom:9px;">
						<div class="uboxstyle3" style=" overflow:hidden; float:left; width:170px;" >
						<h:form id="year">
							<div style="min-width:45px; font-size:14px; float:left; height:30px; line-height:30px;">时间：</div>
							<h:selectOneMenu style="width:146px;" value="#{schedulingRecordHome.yearString}" onchange="jquery('#login').show();this.form.submit();" valueChangeListener="#{schedulingRecordHome.getListByYear}" >
	                        	<f:selectItems value="#{schedulingRecordHome.yearStrings}"></f:selectItems>
	                        	<a:support event="onchange" reRender="yearlist" eventsQueue="default" ajaxSingle="true" bypassUpdates="true" oncomplete="login2();"/>
	                        </h:selectOneMenu>
	                    </h:form>
	                 </div>
	                   <!--复选框开始-->
	                   	<div style="float:left; width:250px;">
                                <div class="pc_ul six4 la_aa" style="border-bottom:none; margin-bottom:0px; padding-top:6px; padding-bottom:0;">
                                	<div style="min-width:45px; font-size:14px; float:left; height:18px; line-height:18px;">选择列：</div>
                                    <div style="float:left; margin-right:5px;">
                                        <span style="float:left">
                                        <input type="checkbox" id="cc1" name="aa" checked="checked" style="display:none;" />
                                        <a id="one" href="javascript:void(0);" class="a" onclick="a(this)" aa="aa"></a>
                                        </span>
                                        <span class="pc_span" style="line-height:18px; font-size:14px;">订单</span>
                                    </div> 
                                    <div style="float:left; margin-right:5px;">   
                                        <span style="float:left">
                                        <input type="checkbox" id="cc2" name="aa" checked="checked" style="display:none;" />
                                        <a href="javascript:void(0);" class="a" onclick="b(this)" aa="aa"></a>
                                        </span>
                                         <span class="pc_span" style="line-height:18px; font-size:14px;">计划</span>
                                   </div>   
                                   <div style="float:left; margin-right:5px;">   
                                        <span style="float:left">
                                        <input type="checkbox" id="cc3" name="aa" checked="checked" style="display:none;" />
                                        <a href="javascript:void(0);"  class="a" onclick="c(this)" aa="aa"></a>
                                        </span>
                                        <span class="pc_span" style="line-height:18px; font-size:14px;">差异</span>
                                    </div>    
                                </div>
                      </div>          
                      <!--复选框结束--> 
	               </div>     
                <div style="padding-top:10px; overflow:hidden;">
                		
                		
                    	<h:panelGroup id="yearlist">
                        <div style="width:150px; float:left; border-bottom:1px solid #ddd; border-right:1px solid #ddd;" id="divleft">
                        <table cellpadding="0" cellspacing="0" class="khtable_01" width="150" height="80">
                                <tr>
                                    <td rowspan="2" class="kh2_td kh_th_font kh_th_bg" width="50">序号</td>
                                    <td rowspan="2" class="kh2_td kh_th_font kh_th_bg" width="100" style="border-right:none;">名称</td>
                                </tr>
                         </table>       
                            <table cellpadding="0" cellspacing="0" class="khtable_01" width="150" style="  border-top:1px solid #ddd;" >
                            	<a:repeat value="#{schedulingRecordHome.pList}" var="_plantInfo" rowKeyVar="_plantindex">
	                                <tr>
	                                    <td class="pc_tdleft kh_td_font kh_leftbg" width="50">#{_plantindex+1}</td>
	                                    <td class="pc_tdleft kh_td_font kh_leftbg" width="100">#{_plantInfo.name}</td>
	                                </tr>
	                            </a:repeat>
                             </table>
                        </div>
                        <div id="scroll1" >  
                              <table class="_div_tab" cellpadding="0" cellspacing="0" style="border-bottom:1px solid #ddd;">
                                    <tr>
                                       <a:repeat value="#{schedulingRecordHome.dateTime}" var="_dateTime" rowKeyVar="_dateTimeindex">
                                        <td valign="top" class="divtd">
                                            <table cellpadding="0" cellspacing="0" class="khtable_02"  >
                                                <tr>
                                                    <td colspan="3" class="kh_td kh_th_font #{_dateTimeindex % 2 == 0 ? 'kh_each_thbg':'kh_each_thbg02'} __title" height="40" style="border-right:0px solid #ddd;">#{schedulingRecordHome.srdByDateTime.get(_dateTime)}月</td>
                                                </tr>
                                                <tr>
                                                    <td class="kh_td kh_th_font #{_dateTimeindex % 2 == 0 ? 'kh_each_thbg':'kh_each_thbg02'} dingd" height="40" style="border-right:0px solid #ddd;" >订单</td>
                                                    <td class="kh_td kh_th_font #{_dateTimeindex % 2 == 0 ? 'kh_each_thbg':'kh_each_thbg02'} jih" style="border-right:0px solid #ddd;">计划</td>
                                                    <td class="kh_td kh_th_font #{_dateTimeindex % 2 == 0 ? 'kh_each_thbg':'kh_each_thbg02'} chay" style="border-right:0px solid #ddd;">差异</td>
                                                </tr>
                                            
                                            	<a:repeat value="#{schedulingRecordHome.pmMap.get(_dateTime)}" var="_pmInfo" >
                                                <tr>
                                                    <td class="pc_td kh_td_font #{_dateTimeindex % 2 == 0 ? 'kh_each_tdbg':'kh_each_tdbg02'} dingd pctd">
                                                    #{processOrdersHome.getFloatbyTow(_pmInfo.purchases)}
                                                    </td>
                                                    <td class="pc_td kh_td_font #{_dateTimeindex % 2 == 0 ? 'kh_each_tdbg':'kh_each_tdbg02'} jih pctd">
                                                    #{processOrdersHome.getFloatbyTow(_pmInfo.srsum)}
                                                    </td>
                                                    <td class="pc_td kh_td_font #{_dateTimeindex % 2 == 0 ? 'kh_each_tdbg':'kh_each_tdbg02'} pc_Arial chay pctd">#{processOrdersHome.getFloatbyTow(_pmInfo.srsum - _pmInfo.purchases)}</td>
                                                </tr>
                                                </a:repeat>
                                            </table>
                                          </td>
										</a:repeat>
                                    </tr>
                                 </table>   
    
						</div> 
                        <div style="width:171px; float:left; border-bottom:1px solid #ddd; border-right:1px solid #ddd; [;width:169px;] *width:171px; "> 
                            <table width="169" height="80" cellspacing="0" cellpadding="0" style="border-bottom:none;" class="khtable_01">
                               <tr>
                               		<td rowspan="2" class="kh2_td kh_th_font kh_th_bg" width="70" style="border-right:none;">状态 </td>
                                    <td width="99" style="border-bottom:none;" class="kh_td kh_th_font kh_th_bg" rowspan="2">操作</td>
                               </tr>
                        	</table>
                            <table cellpadding="0" cellspacing="0" class="khtable_01" width="169" style=" border-top:1px solid #ddd;">
                            	<a:repeat value="#{schedulingRecordHome.pList}" var="_productInfo" rowKeyVar="_index">
                                <tr>
                                	<td class="pc_tdleft kh_td_font kh_leftbg" width="70">#{_productInfo.srStauts eq 1 ?'已预估':'未预估'}</td>
                                    <td class="pc_td kh_td_font kh_leftbg" width="98">
                                    	<s:link propagation="none"  view="/scheduling/SchedulingRecordDetailedEdit.xhtml" styleClass="list_yugu" title="预估"  id="schedulingRecordDetailedId">
											<f:param name="plantId" value="#{_productInfo.plantId}" />
											<f:param name="yearString" value="#{schedulingRecordHome.yearString}" />
											<f:param name="srId" value="0" />
										</s:link>&#160;
                                    </td>
                                </tr>
                                </a:repeat>
                             </table>
                        </div>
                        </h:panelGroup>
                </div>    
                <div style=" height:33px; text-align:right; margin:15px 5px;"> 
				    	<s:button id="cancel" style="width:97px; height:32px;" image="../asset/images/order/retu_11.jpg" propagation="end" view="/contract/ContractList.xhtml">
				    	</s:button>
					</div>


                  <div class="clear"></div>
                </div><!--right_c结束-->
                
<script type="text/javascript" src="#{request.contextPath}/asset/js/map/jquery-1.4.2.min.js"> </script> 
<script type="text/javascript" src="#{request.contextPath}/asset/js/map/jquery-ui.js"></script>        
<script type="text/javascript" src="#{request.contextPath}/asset/js/map/jquery-ui-select.js"> </script> 
<link href="#{request.contextPath}/asset/css/examples.css" rel="stylesheet" type="text/css" />
<script  type="text/javascript">
jquery(document).ready(function(){  
	var onLoadWidth = document.body.clientWidth;
	var divwidth2 = onLoadWidth-463;
	var sizesum = #{schedulingRecordHome.dateTime.size};
	var alltd = sizesum * 65*3;
	jquery('#scroll1').css("width",divwidth2+ "px"); 
	if(divwidth2 > alltd){
		jquery('.khtable_02').css("width",(parseInt(divwidth2/sizesum)+1)+ "px");
	}else{
		jquery('.pctd').css("width","65px");
		
	}
	_$("select").selectmenu({style:'dropdown'});
	_$(".rich-calendar-input").addClass("r_c_text_date");
    _$(".rich-calendar-input").removeClass("rich-calendar-input");
    _$(".ui-selectmenu-dropdown").addClass("small2");
    _$(".ui-selectmenu-dropdown").removeClass("ui-selectmenu-dropdown");
    _$(".ui-selectmenu-menu").addClass("ui-selectmenu-menusmall2");
    _$(".ui-selectmenu-menu").removeClass("ui-selectmenu-menu");
});

jquery(window).resize(function(){
	login2();
});

jquery(document).ready(function(){  
	var onLoadHeight = document.body.clientHeight;
	jquery("._div_tab").css("height",jquery("#divleft").height()+1);	
});

function login2(){
	var onLoadWidth = document.body.clientWidth;
	jquery('#scroll1').css("width",(onLoadWidth-363)+ "px");
	jquery("#login").hide();
}

function isIE7(){
	return navigator.userAgent.split(";")[1].toLowerCase().indexOf("msie 7.0")=="-1"?false:true;
}
 if(isIE7()){
       jquery(document).ready(function(){  
		var onLoadHeight = document.body.clientHeight;
		jquery("#scroll1").css("height",jquery("#divleft").height());
		jquery("._div_tab").css("height",jquery("#divleft").height());
	});

}



</script>
<script  type="text/javascript">
//<![CDATA[
function onclickone(obj){
	var flag =true;
	for(var i = 1;i<4;i++){
		if(jquery("#cc"+i).is(':checked')){
			flag = false;
			break;
		}
	}
	if(flag){
		return "false";
	}else{
		return "true";
	}
}
function a (obj){
		if(jquery(obj).attr("aa")=="aa"){
			jquery(".dingd").css("display","none");
			jquery(obj).attr("aa","").attr("class","b");
			jquery("#cc1").attr("checked","");
		}else{
			jquery(".dingd").css("display","");
			jquery(obj).attr("aa","aa").attr("class","a");
			jquery("#cc1").attr("checked","checked");
		}
		if (onclickone() == "false") {
			alert("显示种类最少一种");
			jquery(".dingd").css("display","");
			jquery(obj).attr("aa","aa").attr("class","a");
			jquery("#cc1").attr("checked","checked");
		}
		checktitle();
	
}
function b (obj){
	if (onclickone() == "true") {
		if(jquery(obj).attr("aa")=="aa"){
			jquery(".jih").css("display","none");
			jquery(obj).attr("aa","").attr("class","b");
			jquery("#cc2").attr("checked","");
		}else{
			jquery(".jih").css("display","");
			jquery(obj).attr("aa","aa").attr("class","a");
			jquery("#cc2").attr("checked","checked");
		}
		if (onclickone() == "false") {
			alert("显示种类最少一种");
			jquery(".jih").css("display","");
			jquery(obj).attr("aa","aa").attr("class","a");
			jquery("#cc2").attr("checked","checked");
		}
		checktitle();
	}
}
function c (obj){
	if (onclickone() == "true") {
		if(jquery(obj).attr("aa")=="aa"){
			jquery(".chay").css("display","none");
			jquery(obj).attr("aa","").attr("class","b");
			jquery("#cc3").attr("checked","");
		}else{
			jquery(".chay").css("display","");
			jquery(obj).attr("aa","aa").attr("class","a");
			jquery("#cc3").attr("checked","checked");
		}
		if (onclickone() == "false") {
			alert("显示种类最少一种");
			jquery(".chay").css("display","");
			jquery(obj).attr("aa","aa").attr("class","a");
			jquery("#cc3").attr("checked","checked");
		}
		checktitle();
	}
}

function checktitle(){
	var xx = jquery("[name='aa'][checked]").length;
	jquery(".__title").each(function(){
		jquery(this).attr("colSpan",xx);
	});
	onclickone();
}
//]]>
</script>
            </td>    
    <!--右边结束-->
<!--选择表格js开始-->
</ui:define>
</ui:composition>
