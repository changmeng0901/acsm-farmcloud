<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
     xmlns:s="http://jboss.com/products/seam/taglib"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:a="http://richfaces.org/a4j"
    xmlns:c="http://java.sun.com/jstl/core"
    template="/layout/template.xhtml">

<ui:define name="body">
<td valign="top" width="100%">
<style>
 .dr-mpnl-pnl{padding:0;}
 .dr-mpnl-pnl-b{color:none;padding:0; font-family:"微软雅黑";}
 .dr-insldr td{padding:0;}
 .font_td{font-size:14px;}
 .dr-insldr{width:255px!important;}
  
 .bgc1,.str_label,.bgc2{text-align:right; }
 .dr-mpnl-pnl-b{font-size:12px;}
 .all_te{width:auto; *width:65px;}
 .all_da{margin-left:0px;}

 .all_da {table-layout:fixed;}
  
 </style>
                <div class="right_c">
                	<div class="r_title">
                    	<div class="r_t_l">
						<s:link propagation="none"  view="#{sessionTake.urlTemp}" style="text-decoration:none;color:black;" value="工作 ">
                        </s:link>
						&#160;&gt;&#160;&#160;<font size="3">出库管理</font><rich:messages styleClass="messages"></rich:messages></div>
                    </div>
                    				<!--出库订单列表开始-->
                     <h:form id="scfInfo">
                	<div class="all_d3">
                	<div class="all_da all_w01">
                    	<table>
                            <tr>
                                <td class="all_te">出库类型：</td>
                                <td>
                                    <h:selectOneMenu immediate="true" id="storageChangeTypeId" style="width:146px;" value="#{deliveryHomeTow.scfInfo.storageChangeTypeId}">
							<s:selectItems value="#{deliveryHomeTow.getStorageChangeTypeList()}" var="var" label="#{var.name}" />
							<s:convertEntity />
						</h:selectOneMenu>
                                </td>
                            </tr>
                        </table>
                    </div>
                    	<div class="all_da all_w01">
                        	<table>
                            	<tr>
                                	<td class="all_te">出库时间：</td>
                                    <td> 
                                    	<s:decorate id="createTimeField" template="../layout/edit.xhtml">
											<rich:calendar id="createTime" value="#{deliveryHomeTow.scfInfo.createTime}" datePattern="yyyy-MM-dd HH:mm"/>
										</s:decorate>
                                    </td>
                            	</tr>
                            </table>
                        </div>
                    	<div class="all_da all_w01">
                        <table>
                                <tr>
                                    <td class="all_te">出库编码：</td>
                                    <td>
                                        <h:inputText value="#{deliveryHomeTow.scfInfo.name}" styleClass="r_c_text"/>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    	<div class="all_da all_w01">
                        	<table>
                                <tr>
                                    <td class="all_te">经&#160;&#160;手&#160;&#160;人：</td>
                                    <td>
                                   		<h:inputText value="#{deliveryHomeTow.scfInfo.operater}" styleClass="r_c_text"/>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="clear"></div>
                   </div>
                    <!--添加按钮开始-->
                    <div class="tjan_04" >
                    	<a href="#" onclick="#{rich:component('product')}.show();return false;"><img src="../asset/images/tj_03.jpg" width="44" height="30" /></a>
                    </div>
                    <h:panelGroup id="persistList"> 
                    <table width="100%" class="ze_table" cellpadding="0" cellspacing="0">
                    	<tr>
                    		<td width="5" height="4"><img src="../asset/images/table_d_40.jpg" width="5" height="4" /></td>
                    		<td colspan="9" style="border-top:1px solid #e1e1e1; background:#f0f5fb;"></td>
                            <td width="5" height="4"><img src="../asset/images/table_d_43.jpg" width="5" height="4" /></td>
                    	</tr>
                    	<tr>
                    		<th class="ze_bg ze_bt_le" width="5" height="4"></th>
                    		<th class="ze_bg">序号</th>
                    		<th class="ze_bg">品名</th>
                    		<th class="ze_bg">货物编码</th>
                    		<th class="ze_bg">物料名称</th>
                    		<th class="ze_bg">生产日期</th>
                    		<th class="ze_bg">保质期(天)</th>
                    		<th class="ze_bg">出库数量</th>
                    		<th class="ze_bg">库房</th>
                    		<th class="ze_bg">操作</th>
                            <th class="ze_bg ze_bt_ri" width="5" height="4"></th>
                    	</tr>
						<a:repeat value="#{deliveryHomeTow.pgbList}" var="_pgb" rendered="#{not empty deliveryHomeTow.pgbList}" rowKeyVar="_index">
	                        <tr>
	                        	<td class="ze_bg2 ze_bt_le" width="5" height="4"></td>
	                            <td class="ze_bg">0#{_index+1}</td>
	                            <td class="ze_bg">#{_pgb.goodsBatch.goodsInfoId.name}</td>
	                            <td class="ze_bg">#{_pgb.goodsBatch.batchCode}</td>
	                            <td class="ze_bg">#{_pgb.goodsBatch.goodsInfoId.name}</td>
	                            <td class="ze_bg">
	                            	<h:outputText value="#{_pgb.goodsBatch.produceDate}">
										<s:convertDateTime type="both" dateStyle="short" pattern="yyyy-MM-dd " />
									</h:outputText>
	                            </td>
	                            <td class="ze_bg">#{_pgb.goodsBatch.expirationDate}</td>
	                            <td class="ze_bg">#{_pgb.deliveryNum}(#{_pgb.goodsBatch.goodsInfoId.goodsSpec})</td>
	                            <td class="ze_bg"></td>
	                            <td class="ze_bg2">
	                            	 <s:link propagation="none"  view="/goods/Delivery.xhtml"    styleClass="list_delete" action="#{deliveryHomeTow.removepgb(_index)}" title="删除" onclick="return confirm('确定删除吗？');" id="wareHousingHomeDelete" rendered="#{empty from}">
	                                </s:link>
	                            </td>
	                            <td class="ze_bg2 ze_bt_ri" width="5" height="4"></td>
	                    	</tr>
	                    </a:repeat>
                    </table>
                    </h:panelGroup>
                    <!--按钮开始-->
                    <div class="ckd_button">
                    	<h:commandButton id="persist"  styleClass="edit_save" action="#{deliveryHomeTow.persist}" />
		            	<s:button view="/goods/Materials.seam" styleClass="edit_back" id="bn_left6" style="margin-left:10px" />
                    </div>
                    <!--按钮结束-->
                    <div class="clear"></div>
                    </h:form>
                </div><!--right_c结束-->
               
                <rich:modalPanel id="product" autosized="true" height="173" width="350" headerClass="modalHeader" >
						<div class="tck_div" style="width: 350px;">
       						<div class="tck_ti" style="width: 350px;">
       							<h:outputLink value="#" onclick="#{rich:component('product')}.hide(); return false;">
                    				<img src="../asset/images/close_17.jpg" width="20" height="20"/>
				                </h:outputLink>
				        	</div>
				        	<h:panelGroup id="gbInfo"> 
       						<h:form id="goodsBatch" >
								<table class="tck_table" style="width: 350px;">
									<tr>
										<td class="bgc1" width="8%" >物料批次&#160;</td>
										<td width="42%" ><h:inputHidden id="relationId" value="#{deliveryHomeTow.palletGoodsBatchId}" />
										 <s:decorate id="batchCodeField" template="../layout/edit.xhtml">
											<h:panelGrid columns="2" border="0" cellpadding="0" cellspacing="0">
								                <h:inputText styleClass="r_c_text" id="batchCode" value="#{deliveryHomeTow.batchCode}" onclick="#{rich:component('memberFiltelBox1')}.callSuggestion(true)"/>
								                <h:graphicImage value="../asset/images/arrow.png" width="17" height="22" onclick="#{rich:component('memberFiltelBox1')}.callSuggestion(true)"/>
								            </h:panelGrid>
								            <rich:suggestionbox eventsQueue="default" height="200" width="600"  usingSuggestObjects="true"
											 onobjectchange="assignRecommendId(#{rich:component('memberFiltelBox1')});" 
											 suggestionAction="#{deliveryHomeTow.getpgbListInfo()}" var="_pgb" for="batchCode" fetchValue="#{_pgb.bcode}" id="memberFiltelBox1" tokens=",">
												<f:facet name="header">
													<rich:columnGroup>
														<rich:column >
															<h:outputText value="物料批次"/>
														</rich:column>
														<rich:column >
															<h:outputText value="商品名"/>
														</rich:column>
														<rich:column >
															<h:outputText value="所在托盘"/>
														</rich:column>
														<rich:column >
															<h:outputText value="数量"/>
														</rich:column>
														<rich:column >
															<h:outputText value="入库时间"/>
														</rich:column>
														<rich:column >
															<h:outputText value="所在货架"/>
														</rich:column>
														<rich:column >
															<h:outputText value="所在区域"/>
														</rich:column>
														<rich:column >
															<h:outputText value="所在库房"/>
														</rich:column>
													</rich:columnGroup>
												</f:facet>
												<h:column>
													<h:outputText value="#{_pgb.bcode eq null ?'':_pgb.bcode }"/>
												</h:column>
												<h:column>
													<h:outputText value="#{_pgb.piName eq null ?'':_pgb.piName}"/>
												</h:column>
												<h:column>
													<h:outputText value="#{_pgb.spName eq null ?'':_pgb.spName}"/>
												</h:column>
												<h:column>
													<h:outputText value="#{_pgb.gnum eq null ?'暂无':_pgb.gnum}"/>
												</h:column>
												<h:column>
													<h:outputText value="#{_pgb.insertTime eq null ?'':_pgb.insertTime}">
														<s:convertDateTime type="both" dateStyle="short" pattern="yyyy-MM-dd " />
													</h:outputText>
												</h:column>
												<h:column>
													<h:outputText value="#{_pgb.sgName eq null ?'':_pgb.sgName}"/>
												</h:column>
												<h:column>
													<h:outputText value="#{_pgb.saName eq null ?'':_pgb.saName}"/>
												</h:column>
												<h:column>
													<h:outputText value="#{_pgb.srName eq null ?'':_pgb.srName }"/>
												</h:column>
											</rich:suggestionbox>
										</s:decorate>
										</td>
									</tr>
									
									<tr>
										<td class="bgc1" width="8%">出库数量&#160;</td>
										<td width="42%"><h:inputText value="#{deliveryHomeTow.pgb.deliveryNum}"  styleClass="r_c_text"/></td>
									<tr>
									</tr>
										<td class="bgc1">操作人&#160;</td>
										<td><h:inputText value="#{deliveryHomeTow.pgb.operaterInfo}"  styleClass="r_c_text"/></td>
									</tr>
								</table>
								<div style="text-align:center;">
						            	<a:commandButton id="persist" value="保存"  image="../images/safe.jpg"   style="width:74px;height:26px; margin-right:10px;" action="#{deliveryHomeTow.persistList}" reRender="persistList,gbInfo" oncomplete="#{rich:component('product')}.hide();www();" eventsQueue="default"/>
						    			<h:outputLink value="#" onclick="#{rich:component('product')}.hide(); return false;"><img class="er_buttton" src="../images/button_17.jpg" width="74" height="26" /></h:outputLink>
						    	</div>
							</h:form>
							</h:panelGroup>
				       </div>
				   </rich:modalPanel>
				  
				<!--出库订单列表结束-->
            </td>    
    <!--右边结束-->
 <!--添加按钮结束-->
<script type="text/javascript">
//<![CDATA[
           
         
    jquery(".rich-calendar-input").addClass("r_c_text_date");
	jquery(".rich-calendar-input").removeClass("rich-calendar-input");
	
    www = function(){
	    jquery(".ui-selectmenu").remove();
	    jquery(".ui-selectmenu-menu").remove();
    	jquery('select').selectmenu({style:'dropdown'})
    	jquery(".rich-calendar-input").addClass("r_c_text_date");
    	jquery(".rich-calendar-input").removeClass("rich-calendar-input");
    }
    function assignRecommendId(ccsu){
        if( ccsu.getSelectedItems().pluck('pgbId') != "" &&  ccsu.getSelectedItems().pluck('pgbId') != null){
			document.getElementById("goodsBatch:relationId").value = ccsu.getSelectedItems().pluck('pgbId');
        }
	}
  //]]>
	</script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/superfish.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/supersubs.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/hoverIntent.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/jquery.flot.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/jquery-ui.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/jquery-ui-select.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/customInput.jquery.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/jquery.dataTables.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/jquery.fancybox-1.3.4.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/jquery.filestyle.mini.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/jquery-ui-timepicker-addon.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/jquery.treeview.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/jquery.tipsy.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/jquery.wysiwyg.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/inline.js"></script>
</ui:define>

</ui:composition>
