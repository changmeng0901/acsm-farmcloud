<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j"
	template="/layout/template_new.xhtml">

<ui:define name="body">
	<link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/agricultural/easyFarm.css" />
            <style>
            .farmingInputs_add3 {
    background:  url("#{request.contextPath}/asset/images/farmingIco15.jpg") ;
    border: medium none;
    float: left;
    height: 130px;
    width: 130px;
}

.farmingInputs_mini {
    background-clip: padding-box;
    background-color: #fff;
    border: 1px solid rgba(0, 0, 0, 0.2);
    border-radius: 6px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
    left: 0;
    outline: 0 none;
    position: absolute;
    top: 54px;
    width: 346px;
    z-index: 10;
}

.farmingInputs_miniHd .butt {
    background:url("#{request.contextPath}/asset/images/farmingIco16.jpg");
    border: medium none;
    float: right;
    height: 11px;
    margin-top: 3px;
    width: 11px;
}
.farmingInputs_add2 {
    background: url("#{request.contextPath}/asset/images/farmingIco14.jpg");
    border: medium none;
    float: left;
    height: 34px;
    width: 34px;
}

.farmingInputs{ position: relative; margin:0 10px 10px 0;}
.farmingInputs .closeInputs{ position: absolute; right:0; top:0;}
.mark-modal-bl{ position: fixed; left:0; top:0; z-index:1; display:none; width:100%; height:100%; background:#000;opacity:0.5;filter:alpha(opacity=50);}
.bootstrap-select.btn-group .dropdown-menu.inner{height:114px;}

/* 添加投入品弹窗 */
.farmingInputs_mini{ position:absolute; top:54px; left:0; z-index:10; width:346px; border:1px solid #e5e5e5; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5); background-clip: padding-box; background-color: #fff; border: 1px solid rgba(0, 0, 0, 0.2); border-radius:6px; outline: 0 none;}
.farmingInputs_mini{ display:none;}
.farmingInputs_miniHd{ overflow:hidden; border-bottom:1px solid #e5e5e5; min-height:16.43px; padding:15px;}
.farmingInputs_miniHd h3{ float:left; font-size:14px; margin:0;}
.farmingInputs_miniHd .butt{ float:right; width:11px; height:11px; margin-top:3px; background:url(../images/farmingIco16.jpg) no-repeat; border:none; zoom:1;}
.farmingInputs_miniHd .butt:hover, .farmingInputs_miniHd .butt:focus{ background-image:url(../images/farmingIco17.jpg); zoom:1;}
.inputs_table p{ margin: 0; padding: 0;}
.farmingInputs_miniFt{ padding:15px; border-top: 1px solid #e5e5e5; text-align:right; overflow:hidden;}
.farmingInputs_miniFt .butt{ margin-left:5px; float:right;}
</style>
            <td valign="top">
            
    <h:form id="farmingPush">
            <div class="right_c" style="min-height:30px; padding-bottom:20px;">
            	<!-- 面包屑导航 开始 -->
                <div class="r_title clear" style="margin-top:0; padding-top:20px;">
                    <div class="r_t_l fl">生产<span style="padding:0 5px;">&gt;</span><font size="3">农事推送</font></div>
                </div>
                <!-- 面包屑导航 结束 -->
                 <!-- #{farmingPushHome.begins()} -->
                <!-- #{farmingPushHome.editFarmingPushInfo()} -->
                <table class="messageTable" width="100%" cellpadding="0" cellspacing="0" style="width:964px; margin:40px auto 20px; font-size:12px;">
                	<tr>
                    	<td class="pr10" align="right" width="110">所属作物</td>
                        <td width="262">#{farmingPushHome.plantObj.floristicsId.name}</td>
                        <td class="pr10" align="right" width="110">品种名称</td>
                        <td colspan="2">全部</td>
                    </tr>
                    <tr>
                    	<td class="pr10" align="right" width="110">种植标准</td>
                        <td width="262">
                        	<span class="bootSelt21">
	                            <h:selectOneMenu id="dataDicId"  styleClass="selectpicker nw200" value="#{farmingPushHome.ddId}">
										<s:selectItems value="#{farmingPushHome.ddList}" var="var" label="#{var.name}" itemValue="#{var.dataDicId}"/>
								</h:selectOneMenu>
                            </span>
                        </td>
                        <td class="pr10" align="right" width="110">种植环境</td>
                        <td>
                        	<span class="bootSelt21">
                            	<h:selectOneMenu id="plantEnvId"  styleClass="selectpicker nw200" value="#{farmingPushHome.plantEnvId}">
										<s:selectItems value="#{farmingPushHome.petList}" var="var" label="#{var.name}" itemValue="#{var.id}"/>
								</h:selectOneMenu>
                            </span>
                        </td>
                    </tr>
                </table>
                <!-- 定植前 开始 -->
                <div class="baseTtlH3 mt10 clear" style="margin:20px 30px 0">
					 <h3 style="background:none; font-size:16px;">定植前</h3>             
                </div>
                <h:panelGroup id="farmingBefore">
                <div id="nullFarming" style="display:none;">
                <div class="messageTable_wap" style="border-bottom:1px dashed #ddd;">
	                <table class="messageTable" width="100%" cellpadding="0" cellspacing="0" style="width:964px; margin:40px auto 20px; font-size:12px;">
	                	<tr>
	                    	<td class="pr10" align="right" width="110">选择时间</td>
	                        <td width="262">
	                        	<span class="bootSelt21">
	                                    <select style="display: none;" class="selectpicker dayselect" id="" name="day_before" data-live-search="true">
                                            <a4j:repeat value="#{farmingPushHome.dayBefore}" var="day">
                                            <option value="#{day.value}">#{day.label}</option>
                                            </a4j:repeat>
                                        </select>
	                            </span>
	                        </td>
	                        <td class="pr10" align="right" width="110">农事内容</td>
	                        <td width="262">
	                        	<span class="bootSelt21">
	                                    <select style="display: none;" class="selectpicker artselect" id="" name="art_before" data-live-search="true">
                                            <a4j:repeat value="#{farmingPushHome.artList}" var="art">
                                            <option value="#{art[0]}">#{art[1]}</option>
                                            </a4j:repeat>
                                        </select>
	                            </span>
	                        </td>
	                        <td align="center">
	                        	<a class="btn btn-success mr5 bef" id="0" onclick="addFarming(this.id)">添加</a>
		                        <a class="btn btn-default delete" id="0" href="javascript:;" onclick="delFarming(this.id,1)">删除</a>
	                        </td>
	                    </tr>
	                     <tr>
		                       <td class="pr10" align="right" width="110" style="vertical-align:top; padding-top: 56px;">操作工时</td> 
		                       <td width="262" style="vertical-align:top; padding-top: 51px;">
		                       	<input type="text" class="form-control workTime"  style="width:220px; color:#333; float:left;"/>
		                       		<span style="float: left;margin-left: 3px;margin-top: 7px;">小时</span>
		                       </td>
		                        <td class="pr10" align="right" width="110" style="vertical-align:top; padding-top: 56px;">投入品</td>
		                        <td colspan="2" class="trp" >
		                            <s:div  styleClass="farmingInputs_wp  refInpB0">
                                            <div class="farmingInputs_add" style="position:static;">
                                            	<input type="button" class="farmingInputs_add3" style="margin-bottom:25px;" onclick="addRecord(this,'before')"></input>
                               				</div>
                                      </s:div>
		                        </td>
		                    </tr>
	                    <tr>
	                    	<td class="pr10" align="right" width="110">规范操作</td>
	                        <td colspan="4">
	                        	<span class="bootTextarea">
	                           <textarea class="form-control area_textarea operation_area" id="operationBefore" name="operation_before" style="width:260px;" />
	                            </span>
	                        </td>
	                    </tr>
	                </table>
	                </div>
	             </div>
	             	<h:panelGroup  rendered="#{empty farmingPushHome.beforeList}">
	                <div class="messageTable_wap before_div" id="before_0" style="border-bottom:1px dashed #ddd;">
	                <table class="messageTable" width="100%" cellpadding="0" cellspacing="0" style="width:964px; margin:40px auto 20px; font-size:12px;">
	                	<tr>
	                    	<td class="pr10" align="right" width="110">选择时间</td>
	                        <td width="262">
	                        	<span class="bootSelt21">
										<select style="display: none;" class="selectpicker dayselect" id="" name="day_before" data-live-search="true">
                                            <a4j:repeat value="#{farmingPushHome.dayBefore}" var="day">
                                            <option value="#{day.value}">#{day.label}</option>
                                            </a4j:repeat>
                                        </select>
	                            </span>
	                        </td>
	                        <td class="pr10" align="right" width="110">农事内容</td>
	                        <td width="262">
	                        	<span class="bootSelt21">
										<select style="display: none;" class="selectpicker artselect" id="" name="art_before" data-live-search="true">
                                            <a4j:repeat value="#{farmingPushHome.artList}" var="art">
                                            <option value="#{art[0]}">#{art[1]}</option>
                                            </a4j:repeat>
                                        </select>
	                            </span>
	                        </td>
	                        <td align="center">
	                        	<a class="btn btn-success mr5" id="0" onclick="addFarming(this.id)">添加</a>
		                        <a class="btn btn-default delete" id="0" href="javascript:;" onclick="delFarming(this.id,1)">删除</a>
	                        </td>
	                    </tr>
	                     <tr>
		                       <td class="pr10" align="right" width="110" style="vertical-align:top; padding-top: 56px;">操作工时</td> 
		                       <td width="262" style="vertical-align:top; padding-top: 51px;">
		                       	<input type="text" class="form-control workTime"  style="width:220px; color:#333; float:left;"/>
		                       		<span style="float: left;margin-left: 3px;margin-top: 7px;">小时</span>
		                       </td>
		                        <td class="pr10" align="right" width="110" style="vertical-align:top; padding-top: 56px;">投入品</td>
		                        <td colspan="2" class="trp" >
		                            <s:div  styleClass="farmingInputs_wp refInpB0">
                                    	<a4j:repeat value="#{farmingPushHome.beforeRecordList}" var="var"  rowKeyVar="row">
                                    	<div class="farmingInputs fl">
                                            	<a class="farmingInputs_pic" href="javascript:;">
                                            	<s:fragment rendered="#{var.inputsInfoId.packingImagesUrl ne null and var.inputsInfoId.packingImagesUrl ne ''}"><img src="#{var.inputsInfoId.packingImagesUrl}"  style="width:128px;height:128px"/></s:fragment> 
												<s:fragment rendered="#{var.inputsInfoId.packingImagesUrl eq null or var.inputsInfoId.packingImagesUrl eq ''}"><img src="#{request.contextPath}/asset/images/inputs/tourupin.jpg"  style="width:128px;height:128px"/></s:fragment>  
                                            	<p>#{var.inputsInfoId.name} #{var.amount}<s:fragment rendered="#{var.inputsInfoId.packSpec ne null}">#{var.inputsInfoId.packSpec}</s:fragment><s:fragment rendered="#{var.inputsInfoId.packSpec eq null}">#{var.inputsInfoId.unitInfo.name}</s:fragment></p>
                                            	</a>
                                                <em class="closeInputs" onclick="delRecordList(this,#{row})"><img src="#{request.contextPath}/asset/images/clo_04.jpg" /></em>
                                            </div>
                                    	</a4j:repeat>
                                            <div class="farmingInputs_add" style="position:static;">
                                            	<input type="button" class="farmingInputs_add3" style="margin-bottom:25px;" onclick="addRecord(this,'before')"></input>
                               				</div>
                                      </s:div>
		                        </td>
		                    </tr>
	                    <tr>
	                    	<td class="pr10" align="right" width="110">规范操作</td>
	                        <td colspan="4">
	                        	<span class="bootTextarea">
	                            <textarea class="form-control area_textarea operation_area" id="operationBefore" name="operation_before" style="width:260px;" />
	                            </span>
	                        </td>
	                    </tr>
	                </table>
	                </div>
	                </h:panelGroup>
                   <a4j:repeat value="#{farmingPushHome.beforeList}" rendered="#{not empty farmingPushHome.beforeList}" var="_var" rowKeyVar="_index">
		                <div class="messageTable_wap before_div" style="border-bottom:1px dashed #ddd;" id="before_#{_index}">
		                <table class="messageTable" width="100%" cellpadding="0" cellspacing="0" style="width:964px; margin:40px auto 20px; font-size:12px;">
		                	<tr>
		                    	<td class="pr10" align="right" width="110">选择时间</td>
		                        <td width="262">
		                        	<span class="bootSelt21">
										<select style="display: none;" class="selectpicker dayselect" id="day_before_#{_index}" name="day_before" data-live-search="true">
                                            <a4j:repeat value="#{farmingPushHome.dayBefore}" var="day">
                                            <h:panelGroup rendered="#{_var[0] eq day.value}">
                                            <option value="#{day.value}" selected="selected">#{day.label}</option>
                                            </h:panelGroup>
                                            <h:panelGroup rendered="#{_var[0] ne day.value}">
                                            <option value="#{day.value}">#{day.label}</option>
                                            </h:panelGroup>
                                            </a4j:repeat>
                                        </select>
		                            </span>
		                        </td>
		                        <td class="pr10" align="right" width="110">农事内容</td>
		                        <td width="262">
		                        	<span class="bootSelt21">
										<select style="display: none;" class="selectpicker artselect" id="art_before_#{_index}" name="art_before" data-live-search="true">
                                            <a4j:repeat value="#{farmingPushHome.artList}" var="art">
                                             <h:panelGroup rendered="#{_var[1] eq art[0]}">
                                              <option value="#{art[0]}" selected="selected">#{art[1]}</option>
                                            </h:panelGroup>
                                            <h:panelGroup rendered="#{_var[1] ne art[0]}">
                                            <option value="#{art[0]}">#{art[1]}</option>
                                            </h:panelGroup>
                                            </a4j:repeat>
                                        </select>
		                            </span>
		                        </td>
		                        <td align="center">
		                        	<a class="btn btn-success mr5" id="#{_index}" onclick="addFarming(#{_index})">添加</a>
		                        	<a class="btn btn-default delete" id="#{_index}" href="javascript:;" onclick="delFarming(#{_index},1)">删除</a>
		                        </td>
		                    </tr>
		                    <tr>
		                       <td class="pr10" align="right" width="110" style="vertical-align:top; padding-top: 56px;">操作工时</td> 
		                       <td width="262" style="vertical-align:top; padding-top: 51px;">
		                       	<input type="text" class="form-control workTime"  style="width:220px; color:#333; float:left;" value="#{_var[4]}"></input>
		                       		<span style="float: left;margin-left: 3px;margin-top: 7px;">小时</span>
		                       </td>
		                        <td class="pr10" align="right" width="110" style="vertical-align:top; padding-top: 56px;">投入品</td>
		                        <td colspan="2" class="trp" >
		                           <s:div  styleClass="farmingInputs_wp refInpB0">
		                           <h:panelGroup rendered="#{_var[3] !=null &amp;&amp; _var[3] !=''}">
                                    	<a4j:repeat value="#{_var[3].split(',')}" var="var"  rowKeyVar="row">
                                    	<div class="farmingInputs fl">
                                            	<a class="farmingInputs_pic" href="javascript:;"><img src="#{var}" width="128" height="128" /></a>
                                                <em class="closeInputs" onclick="delRecordList(this,#{row})"><img src="#{request.contextPath}/asset/images/clo_04.jpg" /></em>
                                            </div>
                                    	</a4j:repeat>
                                    	</h:panelGroup>
                                            <div class="farmingInputs_add" style="position:static;">
                                            	<input type="button" class="farmingInputs_add3" style="margin-bottom:25px;" onclick="addRecord(this,'before')"></input>
                               				</div>
                                      </s:div>
		                        </td>
		                    </tr>
		                    <tr>
		                    	<td class="pr10" align="right" width="110">规范操作</td>
		                        <td colspan="4">
		                        	<span class="bootTextarea">
		                            <textarea class="form-control area_textarea operation_area" id="operationBefore_#{_index}" name="operation_before" style="width:260px;" >#{_var[2]}</textarea>
		                            </span>
		                        </td>
		                    </tr>
		                </table>
		                </div>
	                </a4j:repeat>
	             </h:panelGroup>
                <!-- 定植前 结束 -->
                <!-- 定植后 开始 -->
                
                <div class="baseTtlH3 mt10 clear" style="margin:20px 30px 0">
					 <h3 style="background:none; font-size:16px;">定植后</h3>             
                </div>
                
                <h:panelGroup id="farmingAfter">
                <div id="nullFarmingAfter" style="display: none;">
                	
                <div class="messageTable_wap" style="border-bottom:1px dashed #ddd;">
                	<table class="messageTable" width="100%" cellpadding="0" cellspacing="0" style="width:964px; margin:40px auto 20px; font-size:12px;">
	                	<tr>
	                    	<td class="pr10" align="right" width="110">选择时间</td>
	                        <td width="262">
	                        	<span class="bootSelt21">
									    <select style="display: none;" class="selectpicker dayselect" id="" name="day_after" data-live-search="true">
                                            <a4j:repeat value="#{farmingPushHome.dayAfter}" var="day">
                                            <option value="#{day.value}">#{day.label}</option>
                                            </a4j:repeat>
                                        </select>
	                            </span>
	                        </td>
	                        <td class="pr10" align="right" width="110">农事内容</td>
	                        <td width="262">
	                        	<span class="bootSelt21">
									<select style="display: none;" class="selectpicker artselect" id="" name="art_after" data-live-search="true">
                                            <a4j:repeat value="#{farmingPushHome.artList}" var="art">
                                            <option value="#{art[0]}">#{art[1]}</option>
                                            </a4j:repeat>
                                        </select>
	                            </span>
	                        </td>
	                        <td align="center">
	                        	<a class="btn btn-success mr5 las" id="0" onclick="addFarmingAfter(this.id)">添加</a>
			                        	<a class="btn btn-default delete" id="0" href="javascript:;"  onclick="delFarming(this.id,2)">删除</a>
	                        </td>
	                    </tr>
	                     <tr>
		                       <td class="pr10" align="right" width="110" style="vertical-align:top; padding-top: 56px;">操作工时</td> 
		                       <td width="262" style="vertical-align:top; padding-top: 51px;">
		                       	<input type="text" class="form-control workTime"  style="width:220px; color:#333; float:left;"/>
		                       		<span style="float: left;margin-left: 3px;margin-top: 7px;">小时</span>
		                       </td>
		                        <td class="pr10" align="right" width="110" style="vertical-align:top; padding-top: 56px;">投入品</td>
		                        <td colspan="2" class="trp" >
		                            <s:div  styleClass="farmingInputs_wp  refInp0">
                                            <div class="farmingInputs_add" style="position:static;">
                                            	<input type="button" class="farmingInputs_add3" style="margin-bottom:25px;" onclick="addRecord(this,'after')"></input>
                               				</div>
                                      </s:div>
		                        </td>
		                    </tr>
	                    <tr>
	                    	<td class="pr10" align="right" width="110">规范操作</td>
	                        <td colspan="4">
	                        	<span class="bootTextarea">
	                            	<textarea class="form-control area_textarea operation_area" id="operationAfter_#{_index}" name="operation_before" style="width:260px;" />
	                            </span>
                        </td>
                    </tr>
                </table>
                </div>
                	</div>
                	 <h:panelGroup rendered="#{empty farmingPushHome.afterList}">
                	 	<div class="messageTable_wap after_div" id="after_0" style="border-bottom:1px dashed #ddd;">
                <table class="messageTable" width="100%" cellpadding="0" cellspacing="0" style="width:964px; margin:40px auto 20px; font-size:12px;">
                	<tr>
                    	<td class="pr10" align="right" width="110">选择时间</td>
                        <td width="262">
                        	<span class="bootSelt21">
	                             <select style="display: none;" class="selectpicker dayselect" id="" name="day_after" data-live-search="true">
                                            <a4j:repeat value="#{farmingPushHome.dayAfter}" var="day">
                                            <option value="#{day.value}">#{day.label}</option>
                                            </a4j:repeat>
                                        </select>
                            </span>
                        </td>
                        <td class="pr10" align="right" width="110">农事内容</td>
                        <td width="262">
                        	<span class="bootSelt21">
								<select style="display: none;" class="selectpicker artselect" id="" name="art_after" data-live-search="true">
                                            <a4j:repeat value="#{farmingPushHome.artList}" var="art">
                                            <option value="#{art[0]}">#{art[1]}</option>
                                            </a4j:repeat>
                                        </select>
                            </span>
                        </td>
                        <td align="center">
                        	<a class="btn btn-success mr5" id="0" onclick="addFarmingAfter(this.id)">添加</a>
		                        	<a class="btn btn-default delete" id="0" href="javascript:;"  onclick="delFarming(this.id,2)">删除</a>
                        </td>
                    </tr>
                     <tr>
		                       <td class="pr10" align="right" width="110" style="vertical-align:top; padding-top: 56px;">操作工时</td> 
		                       <td width="262" style="vertical-align:top; padding-top: 51px;">
		                       	<input type="text" class="form-control workTime"  style="width:220px; color:#333; float:left;"/>
		                       		<span style="float: left;margin-left: 3px;margin-top: 7px;">小时</span>
		                       </td>
		                        <td class="pr10" align="right" width="110" style="vertical-align:top; padding-top: 56px;">投入品</td>
		                        <td colspan="2" class="trp" >
		                           <s:div  styleClass="farmingInputs_wp  refInp0">
                                    	<a4j:repeat value="#{farmingPushHome.afterRecordMap.get('1')}" var="var"  rowKeyVar="row">
                                    	<div class="farmingInputs fl">
                                            	<a class="farmingInputs_pic" href="javascript:;">
	                                            	<s:fragment rendered="#{var.inputsInfoId.packingImagesUrl ne null and var.inputsInfoId.packingImagesUrl ne ''}"><img src="#{var.inputsInfoId.packingImagesUrl}"  style="width:111px;height:89px"/></s:fragment> 
													<s:fragment rendered="#{var.inputsInfoId.packingImagesUrl eq null or var.inputsInfoId.packingImagesUrl eq ''}"><img src="#{request.contextPath}/asset/images/wt003.jpg"  style="width:111px;height:89px"/></s:fragment>  
	                                            	<p>#{var.inputsInfoId.name} #{var.amount}<s:fragment rendered="#{var.inputsInfoId.packSpec ne null}">#{var.inputsInfoId.packSpec}</s:fragment><s:fragment rendered="#{var.inputsInfoId.packSpec eq null}">#{var.inputsInfoId.unitInfo.name}</s:fragment></p>
                                            	</a>
                                                <em class="closeInputs" onclick="delRecordList(this,#{row})"><img src="#{request.contextPath}/asset/images/clo_04.jpg" /></em>
                                            </div>
                                    	</a4j:repeat>
                                            <div class="farmingInputs_add" style="position:static;">
                                            	<input type="button" class="farmingInputs_add3" style="margin-bottom:25px;" onclick="addRecord(this,'after')"></input>
                               				</div>
                                      </s:div>
		                        </td>
		                    </tr>
                    <tr>
                    	<td class="pr10" align="right" width="110">规范操作</td>
                        <td colspan="4">
                        	<span class="bootTextarea">
                            <textarea class="form-control area_textarea operation_area" id="" name="operation_before" style="width:260px;" />
                            </span>
                        </td>
                    </tr>
                </table>
                </div>
                	 </h:panelGroup>
                	 <a4j:repeat value="#{farmingPushHome.afterList}" rendered="#{not empty farmingPushHome.afterList}" var="_var" rowKeyVar="_index">
		                <div class="messageTable_wap after_div" style="border-bottom:1px dashed #ddd;" id="after_#{_index}">
		                <table class="messageTable" width="100%" cellpadding="0" cellspacing="0" style="width:964px; margin:40px auto 20px; font-size:12px;">
		                	<tr>
		                    	<td class="pr10" align="right" width="110">选择时间</td>
		                        <td width="262">
		                        	<span class="bootSelt21">
										<select style="display: none;" class="selectpicker dayselect" id="day_after_#{_index}" name="day_After" data-live-search="true">
                                            <a4j:repeat value="#{farmingPushHome.dayAfter}" var="day">
                                            <h:panelGroup rendered="#{_var[0] eq day.value}">
                                            <option value="#{day.value}" selected="selected">#{day.label}</option>
                                            </h:panelGroup>
                                            <h:panelGroup rendered="#{_var[0] ne day.value}">
                                            <option value="#{day.value}">#{day.label}</option>
                                            </h:panelGroup>
                                            </a4j:repeat>
                                        </select>
                                        
		                            </span>
		                        </td>
		                        <td class="pr10" align="right" width="110">农事内容</td>
		                        <td width="262">
		                        	<span class="bootSelt21">
										<select style="display: none;" class="selectpicker artselect" id="art_after_#{_index}" name="art_after" data-live-search="true">
                                            <a4j:repeat value="#{farmingPushHome.artList}" var="art">
                                             <h:panelGroup rendered="#{_var[1] eq art[0]}">
                                              <option value="#{art[0]}" selected="selected">#{art[1]}</option>
                                            </h:panelGroup>
                                            <h:panelGroup rendered="#{_var[1] ne art[0]}">
                                            <option value="#{art[0]}">#{art[1]}</option>
                                            </h:panelGroup>
                                            </a4j:repeat>
                                        </select>
		                            </span>
		                        </td>
		                        <td align="center">
		                        	<a class="btn btn-success mr5" id="#{_index}" onclick="addFarmingAfter(#{_index})">添加</a>
		                        	<a class="btn btn-default delete" id="#{_index}" href="javascript:;" onclick="delFarming(#{_index},2)">删除</a>
		                        </td>
		                    </tr>
		                     <tr>
		                       <td class="pr10" align="right" width="110" style="vertical-align:top; padding-top: 56px;">操作工时</td> 
		                       <td width="262" style="vertical-align:top; padding-top: 51px;">
		                       	<input type="text" class="form-control workTime"  style="width:220px; color:#333; float:left;" value="#{_var[4]}"></input>
		                       		<span style="float: left;margin-left: 3px;margin-top: 7px;">小时</span>
		                       </td>
		                        <td class="pr10" align="right" width="110" style="vertical-align:top; padding-top: 56px;">投入品</td>
		                        <td colspan="2" class="trp" >
		                           <s:div  styleClass="farmingInputs_wp refInp0">
		                           		<h:panelGroup rendered="#{_var[3] !=null &amp;&amp; _var[3] !=''}">
                                    	<a4j:repeat value="#{_var[3].split(',')}" var="var"  rowKeyVar="row">
                                    	<div class="farmingInputs fl">                                 	
                                            	<a class="farmingInputs_pic" href="javascript:;">
                                            		<s:fragment rendered="#{var ne null and var ne '' and var ne 'null'}"><img src="#{var}"  style="width:128px;height:128px"/></s:fragment> 
													<s:fragment rendered="#{var eq null or var eq '' or var eq 'null'}"><img src="#{request.contextPath}/asset/images/inputs/tourupin.jpg"  style="width:128px;height:128px"/></s:fragment> 
                                            	</a>
                                                <em class="closeInputs" onclick="delRecordList(this,#{row})"><img src="#{request.contextPath}/asset/images/clo_04.jpg" /></em>
                                            </div>
                                    	</a4j:repeat>
                                    	</h:panelGroup>
                                            <div class="farmingInputs_add" style="position:static;">
                                            	<input type="button" class="farmingInputs_add3" style="margin-bottom:25px;" onclick="addRecord(this,'after')"></input>
                               				</div>
                                      </s:div>
		                        </td>
		                    </tr>
		                    <tr>
		                    	<td class="pr10" align="right" width="110">规范操作</td>
		                        <td colspan="4">
		                        	<span class="bootTextarea">
		                             <textarea class="form-control area_textarea operation_area" id="operationAfter_#{_index}" name="operation_After" style="width:260px;" >#{_var[2]}</textarea>
		                            </span>
		                        </td>
		                    </tr>
		                </table>
		                </div>
	                </a4j:repeat>
                </h:panelGroup>
                <!-- 定植后 结束 -->
                <input type="hidden" name="dayStr" id="dayStr" value=""/>
                <input type="hidden" name="artStr" id="artStr" value=""/>
                <input type="hidden" name="operationStr" id="operationStr" value=""/>
                <input type="hidden" name="dayAfterStr" id="dayAfterStr" value=""/>
                <input type="hidden" name="artAfterStr" id="artAfterStr" value=""/>
                <input type="hidden" name="operationAfterStr" id="operationAfterStr" value=""/>
                <input type="hidden" name="workTime" id="workTime" value=""/>
                <input type="hidden" name="artworkTime" id="artworkTime" value=""/>
                <input type="hidden" name="beforeInputindex" id="beforeInputindex" value=""/>
                <input type="hidden" name="afterInputindex" id="afterInputindex" value=""/>
                <div class="mes_mailBtn" style="margin:50px 0;">
                    <h:commandButton  data-toggle="modal" data-target="#myModal" id="persist"  styleClass="btn btn-primary" value="提交" action="#{farmingPushHome.persist}" rendered="#{farmingPushHome.addOrUpdate eq 1}" onclick="return checkSubmit();">
                    </h:commandButton>
         			<h:commandButton  data-toggle="modal" data-target="#myModal" id="update" styleClass="btn btn-primary" value="提交"  action="#{farmingPushHome.update}" rendered="#{farmingPushHome.addOrUpdate eq 2}" onclick="return checkSubmit();">
                    </h:commandButton>
 					&#160;<s:link view="/model/ModelDetail.xhtml" styleClass="btn btn-default" value="返回" id="bn_left6" style="margin-left:10px" >
 					<f:param name="plantPlantId" value="#{farmingPushHome.plantId}"/>
 					</s:link>
                </div>

            </div>
             
</h:form>
<!-- Modal -->
<div aria-hidden="false" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal" class="modal fade in w600na" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">提示框</h4>
      </div>
      <div class="modal-body">
       <span id="productMsg">*号部分为必填项！</span>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal">确认</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div aria-hidden="false" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal2" class="modal fade in w600na" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">提示框</h4>
      </div>
      <div class="modal-body">
       <span id="productMsg2">确定删除？</span>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal" onclick="sureDel(0)">取消</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="sureDel(1)">确认</button>
      </div>
    </div>
  </div>
</div>
<!-- 添加投入品 start -->
<div class="farmingInputs_mini modal-dialog" id="addInputRecord" style="z-index:101;position:fixed; left:50%; top:50%; width:828px; margin-left:-414px; margin-top:-300px;">
 <a4j:form ajaxSubmit="true" id="record_" autocomplete="on">
     <div class="farmingInputs_miniHd"><h3>添加投入品</h3><input type="button" class="butt" onclick="jquery('#addInputRecord').hide()"/></div>
          <div class="farmingInputs_miniBd" style="padding:0;height:462px;">
              <div class="box_padding20">
               	<div id="iradio-InputProductInfo">
                      <!-- 投入品搜索 -->
                      <div class="farminputs_search clear">
                           	<div class="public-search">
								<span class="octicon-search02"></span>
								<input class="form-control srarchfont" id="searchInputText" type="text" value="请输入查询内容" onfocus="FocusFn(this,'#333','请输入查询内容')" onblur="BlurFn(this,'#a8a8a8','请输入查询内容')"></input>
							</div>
							<p class="txt_name fl">投入品类型</p>
							<div class="inputs_selectpicker">
								<select class="selectpicker" id="inputType">
					                <option value="2">农药</option>
					                <option value="3">肥料</option>
					                <option value="5">种子</option>
					                <option value="4">其他</option>
					              </select>
					         </div>
              				<input type="button" class="btn btn-primary fl" onclick="searchInputs(1);" value="搜索"/>
          				</div>
					   <!-- 投入品表格上 -->
					    <h:panelGroup id="recordInputList">
					        <div class="inputs_table" id="inputs_table">
					             <table width="100%" cellpadding="0" cellspacing="0" id="inputsTable">
					                 <tr>
					                 	<th width="30" class="br_bt br_rt radius_lt"><span id="mn_checkall" class="mn_checkall" onclick="OutputCheckAll(this,'#inputs_table')"></span></th>
					                 	<th width="164" class="br_bt br_rt">投入品编号</th>
					                 	<th width="170" class="br_bt br_rt">投入品名称</th>
					                 	<th width="176" class="br_bt br_rt">投入品规格</th>
					                 	<th class="br_bt radius_lt">生产厂家</th>
					                 </tr>
					                 <a4j:repeat value="#{farmingPushHome.goodsInfoList}" var="var">
					                  <tr id="trp_#{var[0]}">
					                  	<td class="br_bt br_rt"><span class="mn_check" id="check_#{var[0]}" onclick="OutputCheck(this,'#inputs_table','#mn_checkall','#{var[0]}')"></span>
					                  		<input type="hidden" value="#{var[0]}"/>
					                  		<input type="hidden" value="#{var[9]}"/>
					                  	</td>
					                  	<td class="br_bt br_rt"><p class="ellipsis">#{var[11]}</p></td>
					                  	<td class="br_bt br_rt"><p class="ellipsis">#{var[1]}</p> </td>
					                  	<td class="br_bt br_rt"><p class="ellipsis">#{var[5]}#{var[10]}<s:fragment rendered="#{not empty var[7]}">/#{var[7]}</s:fragment></p></td>
					                  	<td class="br_bt"><p class="ellipsis">#{var[8]}</p></td>
					                  </tr>
					                 </a4j:repeat>
					              </table>
					        </div>
					     <!-- 分页 开始 -->
						   	<table class="pageModel-wap fr" cellpadding="0" cellspacing="0">
						        <tr>
						            <td>
						                <div style="width:auto;">
						                    <table class="pageModel" cellpadding="0" cellspacing="0">
						                        <tr>
						                            <td>
						                            	<s:fragment rendered="#{farmingPushHome.inputsPageNum ne 1 and farmingPushHome.inputsTotalPageNum gt 0}">
						                            		<span class="page_num"><a id="lastPage" href="javascript:inputsJump(1);">首页</a></span>
							                            	<span class="page_num"><a href="javascript:inputsJump(#{farmingPushHome.inputsPageNum-1});">&lt;&lt;</a></span>
							                            </s:fragment>
							                            <a4j:repeat value="#{farmingPushHome.inputsPageList}" var="_page">
							                            	<span class="page_num #{farmingPushHome.inputsPageNum eq _page? 'page_Cur':''}"><a href="javascript:inputsJump(#{_page});">#{_page}</a></span>
							                            </a4j:repeat>
							                            <s:fragment rendered="#{farmingPushHome.inputsPageNum ne farmingPushHome.inputsTotalPageNum and farmingPushHome.inputsTotalPageNum gt 0}">
							                            	<span class="page_num"><a href="javascript:inputsJump(#{farmingPushHome.inputsPageNum+1});">&gt;&gt;</a></span>
							                            	<span class="page_num"><a id="lastPage" href="javascript:inputsJump(#{farmingPushHome.inputsTotalPageNum});">尾页</a></span>
							                            </s:fragment>																						                               
						                                <span class="page_num pageCount page_last" style="border-right:0;"><a href="javascript:;" style="cursor:default;">共#{farmingPushHome.inputsTotalPageNum}页</a></span>
							                             </td>
							                    	</tr>
							                    </table>
							                </div>
							            </td>
							        </tr>
						    	</table>
						</h:panelGroup>
				</div>
			</div>
			<!-- 投入品表格下 -->
			<div class="box_padding20 br_dd mb20 clear">
				<div class="inputs_table mt20">
		           	<table width="100%" cellpadding="0" cellspacing="0" id="addInputsTable">
		                 <tr>
		                 	<th width="20%" class="br_bt br_rt radius_lt">序号</th>
		                 	<th width="20%" class="br_bt br_rt">投入品名称</th>
		                 	<th width="20%" class="br_bt br_rt">规格</th>
		                 	<th width="20%" class="br_bt br_rt">使用量</th>
		                 	<th class="br_bt radius_lt">操作</th>
		                 </tr>
		             </table>
		        </div>
			</div>
		</div>                                                                               
		<div class="farmingInputs_miniFt">        
		    <h:inputHidden value="#{farmingPushHome.indexId}" id="indexId"/>
		    <h:inputHidden value="#{farmingPushHome.indexName}" id="indexName"/>
		    <h:inputHidden value="#{farmingPushHome.inputsInfoData}" id="inputsInfoData"/>
		    <a4j:commandButton id="submitInputs" value="提交" onclick="if(!saveInput()) return false;document.getElementById('record_:submitInputs').disabled = true;" data="#{farmingPushHome.inputImages}"  oncomplete="saveHui(data);jquery('#addInputRecord').hide();jquery('.mark-modal-bl').hide();document.getElementById('record_:submitInputs').disabled = false;" action="#{farmingPushHome.addInputsRecord()}" styleClass="btn btn-success"/>
		    <input class="btn btn-default" onclick="jquery('#addInputRecord').hide();jquery('.mark-modal-bl').hide();" type="button" value="返回" style="margin-left:5px"></input>
		</div>
	</a4j:form>
</div>
<!-- 添加投入品 end -->


  </td> 
  
  <a4j:form id="formid" >

<a4j:jsFunction eventsQueue="mainQueue" name="searchInputsList" action="#{farmingPushHome.changeInputs()}" oncomplete="searchInputsList_next()" reRender="recordInputList">
	<a4j:actionparam name="record_type" assignTo="#{farmingPushHome.record_type}" />
	<a4j:actionparam name="dataStandard" assignTo="#{farmingPushHome.dataStandard}" />
	<a4j:actionparam name="searchInfo" assignTo="#{farmingPushHome.searchInfo}" />
	<a4j:actionparam name="inputsPageNum" assignTo="#{farmingPushHome.inputsPageNum}" />
</a4j:jsFunction>
<a4j:jsFunction name="deleteimg" action="#{farmingPushHome.deleteImg()}" data="#{farmingPushHome.inputImages}" oncomplete="deletdHui(data)">
	<a4j:actionparam name="indexId" assignTo="#{farmingPushHome.indexId}" />
	<a4j:actionparam name="inputIndex" assignTo="#{farmingPushHome.inputIndex}" />
	<a4j:actionparam name="indexName" assignTo="#{farmingPushHome.indexName}" />
</a4j:jsFunction>
<a4j:jsFunction eventsQueue="mainQueue" name="getUnitInfoName" action="#{farmingPushHome.getUnitInfoName()}" data="#{farmingPushHome.unitName}" oncomplete="getUnitInfoName_next(data)">
	<a4j:actionparam name="goodsInfoId" assignTo="#{farmingPushHome.goodsInfoId}" />
</a4j:jsFunction>
</a4j:form>
<div class="mark-modal-bl"></div>
<script type="text/javascript">
//<![CDATA[	
var m3="#{farmingPushHome.chongfu}";

if(m3!="" && m3 != "0"){
	document.getElementById("productMsg").innerHTML = m3;
	   jquery("#myModal").modal('show');
}
jquery(function(){

	// 下拉框 开始
	jquery('.selectpicker').selectpicker();
	

});
var beIndex=jquery("#farmingPush\\:farmingBefore").children(".messageTable_wap").length-1;
function addFarming(index){
	beIndex++;
	var h = jquery("#nullFarming").html();
	jquery("#before_"+index).after(h);
	
	jquery(".bef").eq(1).parents('.messageTable_wap').attr("id","before_"+beIndex);
	jquery(".bef").eq(1).parents('.messageTable_wap').attr("class","messageTable_wap before_div");
	jquery(".bef").eq(1).parents('.messageTable_wap').find(".mr5").attr("id",beIndex);
	jquery(".bef").eq(1).parents('.messageTable_wap').find(".refInpB0").attr("class","farmingInputs_wp refInpB"+beIndex);
	jquery(".bef").eq(1).parents('.messageTable_wap').find(".delete").attr("id",beIndex);
	jquery(".bef").eq(1).parents('.messageTable_wap').find(".dayselect").attr("id","day_before_"+beIndex);
	jquery(".bef").eq(1).parents('.messageTable_wap').find(".artselect").attr("id","art_before_"+beIndex);
	var lastVal = jquery("#before_"+beIndex).prev(".messageTable_wap").find(".dayselect").val();
	jquery("#day_before_"+beIndex).val(Number(lastVal)+1);
	jquery("#day_before_"+beIndex).selectpicker('refresh');
	jquery("#art_before_"+beIndex).selectpicker('refresh');
	jquery(".bef").eq(1).parents('.messageTable_wap').find(".btn-group").eq(1).css('display','none'); 
	jquery(".bef").eq(1).parents('.messageTable_wap').find(".btn-group").eq(3).css('display','none'); 
	jquery("#before_"+beIndex).find('.bef').attr('class','btn btn-success mr5');
	
	
	/*	var nextObj = jquery("#before_"+index).next(".messageTable_wap").length;//判断当前选中的div后是否还存在messageTable_wap元素
		var h = jquery("#nullFarming").html();
		jquery("#before_"+index).after(h);
		//jquery('.selectpicker').selectpicker();
		var len = jquery("#farmingPush\\:farmingBefore").children(".messageTable_wap").length;
		var num = len - 1;
		if(nextObj==0){
			jquery("#farmingPush\\:farmingBefore").children(".messageTable_wap").eq(num).attr("id","before_"+num);
			jquery("#farmingPush\\:farmingBefore").children(".messageTable_wap").eq(num).attr("class","messageTable_wap before_div");
			jquery("#farmingPush\\:farmingBefore").children(".messageTable_wap").eq(num).find(".mr5").attr("id",num);
			jquery("#farmingPush\\:farmingBefore").children(".messageTable_wap").eq(num).find(".delete").attr("id",num);
			jquery("#farmingPush\\:farmingBefore").children(".messageTable_wap").eq(num).find(".dayselect").attr("id","day_before_"+num);
			jquery("#farmingPush\\:farmingBefore").children(".messageTable_wap").eq(num).find(".artselect").attr("id","art_before_"+num);
			var lastVal = jquery("#before_"+num).prev(".messageTable_wap").find(".dayselect").val();
			jquery("#day_before_"+num).val(Number(lastVal)+1);
			jquery("#day_before_"+num).selectpicker('refresh');
			jquery("#art_before_"+num).selectpicker('refresh');
			jquery("#farmingPush\\:farmingBefore").children(".messageTable_wap").eq(num).find(".btn-group").eq(1).css('display','none'); 
			jquery("#farmingPush\\:farmingBefore").children(".messageTable_wap").eq(num).find(".btn-group").eq(3).css('display','none'); 
		}else{
			var index2 = Number(index) + 1;
			jquery("#farmingPush\\:farmingBefore").children(".messageTable_wap").eq(index2).attr("id","before_"+num);
			jquery("#farmingPush\\:farmingBefore").children(".messageTable_wap").eq(index2).attr("class","messageTable_wap before_div");
			jquery("#farmingPush\\:farmingBefore").children(".messageTable_wap").eq(index2).find(".mr5").attr("id",num);
			jquery("#farmingPush\\:farmingBefore").children(".messageTable_wap").eq(index2).find(".delete").attr("id",num);
			jquery("#farmingPush\\:farmingBefore").children(".messageTable_wap").eq(index2).find(".dayselect").attr("id","day_before_"+num);
			jquery("#farmingPush\\:farmingBefore").children(".messageTable_wap").eq(index2).find(".artselect").attr("id","art_before_"+num);
			jquery("#day_before_"+num).selectpicker('refresh');
			jquery("#art_before_"+num).selectpicker('refresh');
			jquery("#farmingPush\\:farmingBefore").children(".messageTable_wap").eq(index2).find(".btn-group").eq(1).css('display','none'); 
			jquery("#farmingPush\\:farmingBefore").children(".messageTable_wap").eq(index2).find(".btn-group").eq(3).css('display','none');
		}
	*/
}
var laIndex=jquery("#farmingPush\\:farmingAfter").children(".messageTable_wap").length-1;
function addFarmingAfter(index){
	laIndex++;
	var h = jquery("#nullFarmingAfter").html();
	jquery("#after_"+index).after(h);
	
	jquery(".las").eq(1).parents('.messageTable_wap').attr("id","after_"+laIndex);
	jquery(".las").eq(1).parents('.messageTable_wap').attr("class","messageTable_wap after_div");
	jquery(".las").eq(1).parents('.messageTable_wap').find(".mr5").attr("id",laIndex);
	jquery(".las").eq(1).parents('.messageTable_wap').find(".refInp0").attr("class","farmingInputs_wp refInp"+laIndex);
	jquery(".las").eq(1).parents('.messageTable_wap').find(".delete").attr("id",laIndex);
	jquery(".las").eq(1).parents('.messageTable_wap').find(".dayselect").attr("id","day_after_"+laIndex);
	jquery(".las").eq(1).parents('.messageTable_wap').find(".artselect").attr("id","art_after_"+laIndex);
	var lastVal = jquery("#after_"+laIndex).prev(".messageTable_wap").find(".dayselect").val();
	jquery("#day_after_"+laIndex).val(Number(lastVal)+1);
	jquery("#day_after_"+laIndex).selectpicker('refresh');
	jquery("#art_after_"+laIndex).selectpicker('refresh');
	jquery(".las").eq(1).parents('.messageTable_wap').find(".btn-group").eq(1).css('display','none'); 
	jquery(".las").eq(1).parents('.messageTable_wap').find(".btn-group").eq(3).css('display','none'); 
	jquery("#after_"+laIndex).find('.las').attr('class','btn btn-success mr5');
	
	/*var nextObj = jquery("#after_"+index).next(".messageTable_wap").length;//判断当前选中的div后是否还存在messageTable_wap元素
	var h = jquery("#nullFarmingAfter").html();
	jquery("#after_"+index).after(h);
	
	var len = jquery("#farmingPush\\:farmingAfter").children(".messageTable_wap").length;
	var num = len - 1;
	if(nextObj==0){
		jquery("#farmingPush\\:farmingAfter").children(".messageTable_wap").eq(num).attr("id","after_"+num);
		jquery("#farmingPush\\:farmingAfter").children(".messageTable_wap").eq(num).attr("class","messageTable_wap after_div");
		jquery("#farmingPush\\:farmingAfter").children(".messageTable_wap").eq(num).find(".mr5").attr("id",num);
		jquery("#farmingPush\\:farmingAfter").children(".messageTable_wap").eq(num).find(".delete").attr("id",num);
		jquery("#farmingPush\\:farmingAfter").children(".messageTable_wap").eq(num).find(".dayselect").attr("id","day_after_"+num);
		jquery("#farmingPush\\:farmingAfter").children(".messageTable_wap").eq(num).find(".artselect").attr("id","art_after_"+num);
		var lastVal = jquery("#after_"+num).prev(".messageTable_wap").find(".dayselect").val();
		jquery("#day_after_"+num).val(Number(lastVal)+1);
		jquery("#day_after_"+num).selectpicker('refresh');
		jquery("#art_after_"+num).selectpicker('refresh');
		jquery("#farmingPush\\:farmingAfter").children(".messageTable_wap").eq(num).find(".btn-group").eq(1).css('display','none'); 
		jquery("#farmingPush\\:farmingAfter").children(".messageTable_wap").eq(num).find(".btn-group").eq(3).css('display','none'); 
	}else{
		var index2 = Number(index) + 1;
		jquery("#farmingPush\\:farmingAfter").children(".messageTable_wap").eq(index2).attr("id","after_"+num);
		jquery("#farmingPush\\:farmingAfter").children(".messageTable_wap").eq(index2).attr("class","messageTable_wap after_div");
		jquery("#farmingPush\\:farmingAfter").children(".messageTable_wap").eq(index2).find(".mr5").attr("id",num);
		jquery("#farmingPush\\:farmingAfter").children(".messageTable_wap").eq(index2).find(".delete").attr("id",num);
		jquery("#farmingPush\\:farmingAfter").children(".messageTable_wap").eq(index2).find(".dayselect").attr("id","day_after_"+num);
		jquery("#farmingPush\\:farmingAfter").children(".messageTable_wap").eq(index2).find(".artselect").attr("id","art_after_"+num);
		jquery("#day_after_"+num).selectpicker('refresh');
		jquery("#art_after_"+num).selectpicker('refresh');
		jquery("#farmingPush\\:farmingAfter").children(".messageTable_wap").eq(index2).find(".btn-group").eq(1).css('display','none'); 
		jquery("#farmingPush\\:farmingAfter").children(".messageTable_wap").eq(index2).find(".btn-group").eq(3).css('display','none');
	}
	*/
}




function checkSubmit(){
	var arr=new Array(); //天数--定植前
	var arr2=new Array(); //操作内容
	var arr3=new Array(); //操作规范
	var arr7=new Array(); //操作工时
	
	var arr4=new Array(); //天数--定植后
	var arr5=new Array(); //操作内容
	var arr6=new Array(); //操作规范
	var arr8=new Array(); //操作工时

	var arr9=new Array(); 
	var arr10=new Array(); 
	var flag = true;
	var tishi = true;
	var test = /^\d+(\.\d{1,2})?$/;
	jquery(".before_div").each(function(i){
		
			var val = jquery(this).find(".dayselect").val();
			arr[i] = val;
			var val2 = jquery(this).find(".artselect").val();
			if(val2 == null || val2 == ""){
				document.getElementById("productMsg").innerHTML = "农事内容不能为空！";
				jquery("#myModal").modal('show');
				flag = false;
				return false;
			}
			arr2[i] = val2;
			
			var val3 = jquery(this).find(".operation_area").val();
			if(val3 == null || val3 == ""){
				document.getElementById("productMsg").innerHTML = "规范操作不能为空！";
				jquery("#myModal").modal('show');
				flag = false;
				return false;
			}else if(val3.length > 500){
				document.getElementById("productMsg").innerHTML = "规范操作内容不能超过500字！";
				jquery("#myModal").modal('show');
				flag = false;
				return false;
			}
			arr3[i] = val3;

			var val7 = jquery(this).find(".workTime").val();
			if(val7 == null || val7 == ""){
				document.getElementById("productMsg").innerHTML = "操作工时不能为空！";
				jquery("#myModal").modal('show');
				flag = false;
				return false;
			}else if(!test.test(val7)){
				document.getElementById("productMsg").innerHTML = "操作工时最多保留2位小数！";
				jquery("#myModal").modal('show');
				flag = false;
				return false;
			}
			
			arr7[i] = val7;

			var val9=jquery(this).find('.mr5').attr('id');
			arr9[i] = val9;
			
	});
	jquery(".after_div").each(function(i){
		var val = jquery(this).find(".dayselect").val();
		arr4[i] = val;
		var val2 = jquery(this).find(".artselect").val();
		if(val2 == null || val2 == ""){
			document.getElementById("productMsg").innerHTML = "农事内容不能为空！";
			jquery("#myModal").modal('show');
			flag = false;
			return false;
		}
		arr5[i] = val2;
		var val3 = jquery(this).find(".operation_area").val();
		if(val3 == null || val3 == ""){
			document.getElementById("productMsg").innerHTML = "规范操作不能为空！";
			jquery("#myModal").modal('show');
			flag = false;
			return false;
		}else if(val3.length > 500){
			document.getElementById("productMsg").innerHTML = "规范操作内容不能超过500字！";
			jquery("#myModal").modal('show');
			flag = false;
			return false;
		}
		arr6[i] = val3;

		var val8 = jquery(this).find(".workTime").val();
		if(val8 == null || val8 == ""){
			document.getElementById("productMsg").innerHTML = "操作工时不能为空！";
			jquery("#myModal").modal('show');
			flag = false;
			return false;
		}else if(!test.test(val8)){
			document.getElementById("productMsg").innerHTML = "操作工时最多保留2位小数！";
			jquery("#myModal").modal('show');
			flag = false;
			return false;
		}
		arr8[i] =val8;
		var val10=jquery(this).find('.mr5').attr('id');
		arr10[i] = val10;

		
	});

	jquery("#dayStr").val(arr);
	jquery("#artStr").val(arr2);
	jquery("#operationStr").val(arr3);
	jquery("#dayAfterStr").val(arr4);
	jquery("#artAfterStr").val(arr5);
	jquery("#operationAfterStr").val(arr6);
	jquery("#workTime").val(arr7);
	jquery("#artworkTime").val(arr8);
	jquery("#beforeInputindex").val(arr9);
	jquery("#afterInputindex").val(arr10);

	var ddenv='#{farmingPushHome.ddAndEnv}';
	if(flag && ddenv.split('_')[0] !="" && ddenv.split('_')[0]!=2){
		if(tishi){
			tishi=false;
			if(ddenv.split('_')[0]==1){
				if(confirm('确定将专家推送的种植方法覆盖为企业自定义的种植方法？')){
			 		return true;
			 	}
			}
			if(ddenv.split('_')[0]==3){
				if(confirm('确定将系统推送的种植方法覆盖为企业自定义的种植方法？')){
			 		return true;
			 	}
			}
			
			flag = false;
		 	return false;
		}
	}

	
	
	return flag;
}

var delId = "";
function delFarming(index,type){
	if(type==1){
		//定植前
		delId = "#before_"+index;
	}else{
		delId = "#after_"+index;
	}
	jquery("#myModal2").modal('show');
}

function sureDel(type){
	if(type == 1){
		jquery(delId).remove();
	}
	delId = "";
}

function addRecord(id,name){
	jquery(".mark-modal-bl").show();
	jquery('#record_\\:indexId').val(jquery(id).parents('.messageTable').find('.mr5').attr('id'));
	jquery('#record_\\:indexName').val(name);
	if(name=='before'){
		jquery('#record_\\:submitInputs').attr('reRender','refInpB'+jquery(id).parents('.messageTable').find('.mr5').attr('id'));
	}else{
		jquery('#record_\\:submitInputs').attr('reRender','refInp'+jquery(id).parents('.messageTable').find('.mr5').attr('id'));
	}
	jquery("#addInputsTable .Output_tr").remove();
	jquery('#inputType').selectpicker('val',2);
	jquery("#searchInputText").val("");
	searchInputs(1);
	jquery('#addInputRecord').show();
}

function getUnitInfoName_next(obj){
	jquery("#unitNameStr").empty().append(obj);
}
function isFloat(value){
	var mny =RegExp(/^([0-9]+(\.?))?[0-9]+$/);
	return mny.test(value);
}
function saveInput(){
	var trLength=jQuery("#addInputsTable tr").length;
	if(trLength<=1){
		alert("请选择投入品！");
		return false;
	}
	var inputsRecordStr='{"inputsDatas":[';
   	for(var i=1;i<trLength;i++){   	   	
   		var inputsId=jQuery("#addInputsTable tr:eq("+i+") td:eq(0) input:eq(0)").val();
   		var unitId=jQuery("#addInputsTable tr:eq("+i+") td:eq(0) input:eq(1)").val();
   		var inputsName=jQuery("#addInputsTable tr:eq("+i+") td:eq(1) p").html();
   		var useNum=jQuery("#addInputsTable tr:eq("+i+") td:eq(3) input:eq(0)").val();
			
   		if(null==useNum || ""==useNum){
   			alert(inputsName+"的使用量不能为空！");
   			return false;
   		}else if(!isFloat(useNum)){
   			alert("请输入正确的"+inputsName+"使用量！");
   			return false;
   		}else if(parseFloat(useNum)>9999999){
   			alert(inputsName+"的使用量不能大于9999999！");
   			return false;
   	   	}
   		inputsRecordStr+= "{'inputsId':'" +inputsId + "','useNum':'"+ useNum +"'},";	 		
   	}
   	inputsRecordStr = inputsRecordStr.substring(0, inputsRecordStr.length-1) + ']}';
   	jquery("#record_\\:inputsInfoData").val(inputsRecordStr);
	return true;
}

function saveHui(inUrl){
	var str="";
	var inUrls=inUrl.split(",");
	for (var i = 0; i < inUrls.length; i++) {
		var imgUrl=inUrls[i];
		if(imgUrl==""){
			imgUrl="#{request.contextPath}/asset/images/inputs/tourupin.jpg";
		}
		 str+="<div class='farmingInputs fl'><a class='farmingInputs_pic' href='javascript:;'><img src='"+imgUrl+"' width='128' height='128' /></a> <em class='closeInputs' onclick=delRecordList(this,"+i+")><img src='#{request.contextPath}/asset/images/clo_04.jpg' /></em> </div>";
	}
	if(jquery('#record_\\:indexName').val()=="before"){
		if(jquery('#record_\\:indexId').val()==0){
			jquery('.refInpB'+jquery('#record_\\:indexId').val()).eq(1).find('.fl').remove();
			  jquery('.refInpB'+jquery('#record_\\:indexId').val()).eq(1).prepend(str);
		}else{
			jquery('.refInpB'+jquery('#record_\\:indexId').val()).find('.fl').remove();
			jquery('.refInpB'+jquery('#record_\\:indexId').val()).prepend(str);
			
		}
		
	}else{
		if(jquery('#record_\\:indexId').val()==0){
			jquery('.refInp'+jquery('#record_\\:indexId').val()).eq(1).find('.fl').remove();
			jquery('.refInp'+jquery('#record_\\:indexId').val()).eq(1).prepend(str);
		}else{
			jquery('.refInp'+jquery('#record_\\:indexId').val()).find('.fl').remove();
			jquery('.refInp'+jquery('#record_\\:indexId').val()).prepend(str);
		}

		}
}

function delRecordList(ev,index){
	var name="before";
	if(jquery(ev).parents('.messageTable_wap').attr('class').indexOf('before_div')==-1){
		name="after"
	}
	deleteimg(jquery(ev).parents('.messageTable').find('.mr5').attr('id'),index,name);
	
}
function deletdHui(inUrl){
	var str="";
		var all=inUrl.split("_");
		var name=all[0];
		var index=all[1];
		if(all.length>2){
				var inUrls=all[2].split(",");
				for (var i = 0; i < inUrls.length; i++) {
					var inUrls2=inUrls[i].split("=");
					var imgUrl=inUrls2[1];
					if(imgUrl==""){
						imgUrl="#{request.contextPath}/asset/images/inputs/tourupin.jpg";
					}
					 str+="<div class='farmingInputs fl'><a class='farmingInputs_pic' href='javascript:;'><img src='"+imgUrl+"' width='128' height='128' /></a> <em class='closeInputs' onclick=delRecordList(this,"+inUrls2[0]+")><img src='#{request.contextPath}/asset/images/clo_04.jpg' /></em> </div>";
				}
			}
		if(name=="before"){
			if(index=="0"){
				jquery('.refInpB'+index).eq(1).find('.fl').remove();
				jquery('.refInpB'+index).eq(1).prepend(str);
			}else{
				jquery('.refInpB'+index).find('.fl').remove();
				jquery('.refInpB'+index).prepend(str);
				
			}
			
		}else{
			if(index==0){
				jquery('.refInp'+index).eq(1).find('.fl').remove();
				jquery('.refInp'+index).eq(1).prepend(str);
			}else{
				jquery('.refInp'+index).find('.fl').remove();
				jquery('.refInp'+index).prepend(str);
			}
	
			}
}
function clearNoNum(obj){
	obj.value = obj.value.replace(/[^\d.]/g,"");//清除“数字”和“.”以外的字符  
	obj.value = obj.value.replace(/^\./g,"");  //验证第一个字符是数字而不是. 
	obj.value = obj.value.replace(/\.{2,}/g,"."); //只保留第一个. 清除多余的.   
	obj.value = obj.value.replace(".","$#$").replace(/\./g,"").replace("$#$",".");
}

//新版添加农事投入品-----------
window.onload = function (){
	var searchStr = jQuery("#searchInfo_").val();
	if(searchStr == "" || searchStr == null){
		jQuery("#searchInfo_").val("请输入搜索条件");
		jQuery("#searchInfo_").css("color","#a8a8a8");
	}else if(searchStr == "请输入搜索条件"){
		jQuery("#searchInfo_").css("color","#a8a8a8");
	}else{
		jQuery("#searchInfo_").css("color","#000");
	}
}

//(1)删除投入品
function DeleteOutput(obj,inputsId){
	jQuery(obj).parents('.Output_tr').remove();
	jQuery("#check_"+inputsId).removeClass('checked');
	//取消全选
	if(jQuery("#mn_checkall").hasClass('checked')){   		
		jQuery("#mn_checkall").removeClass('checked');
	}
	resetIndex();  	
}
//添加投入品，由于删除，添加操作序号变乱，重新排序
function resetIndex(){
	var trLength=jQuery("#addInputsTable tr").length;
	for(var i=1;i<trLength;i++){
		jQuery("#addInputsTable tr:eq("+i+") td:eq(0) span").html(i);
  }
}
//(2-1)投入品表格复选框，全选功能
function OutputCheckAll(obj,oparents){
	if(jQuery(obj).hasClass('checked')){
		//取消全选
		jQuery(obj).removeClass('checked');
		jQuery(oparents).find('td .mn_check').removeClass('checked');
		//只取消本页的
		//jQuery("#addInputsTable .Output_tr").remove();
		var trLength=jQuery("#inputsTable tr").length;
		for(var i=0;i<trLength;i++){
			var inputIds=jQuery("#inputsTable tr:eq("+i+") td:eq(0) input:eq(0)").val();
			jQuery("#addtr_"+inputIds).remove();
  		}
		resetIndex();  	
	}else{   		
		//var trLength=jQuery("#inputsTable tr").length;
		//全选时，判断没有选中的添加到投入品，已添加的不在查询
		var inputIds="";   		
		var noCheckObj=jQuery("#inputs_table").find('td .mn_check ').not(".checked");
		var trLength=noCheckObj.length;
		
		for(var i=0;i<trLength;i++){
			//inputIds+=jQuery("#inputsTable tr:eq("+i+") td:eq(0) input:eq(0)").val()+",";
			inputIds=jQuery(noCheckObj).eq(i).siblings("input:eq(0)").val();
			storageCallback(inputIds);
      	} 
		//如果是空，则是没有选中状态,点击后全选
		jQuery(obj).addClass('checked');
		jQuery(oparents).find('td .mn_check').addClass('checked');
		//添加多个投入品，获取库存信息
		//jQuery("#login").show();
	}
}
var tableStr="";
//(2-2)如果有一个复选框没有选中，则全选按钮为取消状态，否则相反
function OutputCheck(obj,oparents,oAll,inputsId){
	if(jQuery(obj).hasClass('checked')){
		//取消全选
		jQuery(obj).removeClass('checked');
		//如果一个取消，那么全选为取消状态
		jQuery(oAll).removeClass('checked');
		jQuery('#addtr_'+inputsId).remove();
		resetIndex();  	
	}else{
		jQuery(obj).addClass('checked');
		//如果是空，则是没有选中状态,点击后选择
		var allNum = jQuery(oparents).find('td .mn_check').length;
		var allLen = jQuery(oparents).find('td .mn_check.checked').length;
		//alert('allNum:'+allNum+'allLen:'+allLen)
		//如果个数和选中的个数相等，则全选为选中状态
		if(allLen == allNum){
  		jQuery(oAll).addClass('checked');
		}else{
  		jQuery(oAll).removeClass('checked');
		}
		//添加一个投入品，获取库存信息
		jQuery("#login").show();
		storageCallback(inputsId);    		
	}
}
//添加投入品-获取库存信息回调
function storageCallback(inputsId){
	var rowNum=jQuery("#addInputsTable tr").length;
 	var inputName=jQuery("#trp_"+inputsId+" td:eq(2) p").html();
 	var unitName=jQuery("#trp_"+inputsId+" td:eq(3) p").html();
 	
 	tableStr="<tr class=\"Output_tr\" id='addtr_"+inputsId+"'>"+
	    	"<td class=\"br_bt br_rt\">"+
 		"<input type='hidden' value='"+inputsId+"'/>"+
	    		"<input type='hidden' value='' id='unit_"+inputsId+"'/><span>"+rowNum+"</<span></td>"+
 		"<td class=\"br_bt br_rt\"><p class=\"ellipsis\" title='"+inputName+"'>"+inputName+"</p></td>"+
		    "<td class=\"br_bt br_rt\"><p class=\"ellipsis\" title='"+unitName+"'>"+unitName+"</p></td>"+   	
	    	"<td class=\"br_bt br_rt\">"+
	    		"<input class=\"Output_input\"></input>"+
	    	"</td>"+
	    	"<td class=\"br_bt\">"+
	    		"<a href=\"javascript:;\" onclick=\"DeleteOutput(this,"+inputsId+")\">删除</a>"+
	    	"</td>"+
 	"</tr>";
 	jquery("#addInputsTable").append(tableStr);		
 	jquery("#login").hide();
}
//(3)获取焦点，失去焦点
function FocusFn(obj,oColor,txt_val){
	if(jQuery(obj).val()==txt_val){
		jQuery(obj).val('');
		jQuery(obj).css('color',oColor)
	}
}
function BlurFn(obj,oColor,txt_val){
	if(jQuery(obj).val()==''){
		jQuery(obj).val(txt_val);
		jQuery(obj).css('color',oColor)
	}
}
//投入品列表信息查询
function searchInputs(pageNum){
	var dataStandard=jquery("#farmingPush\\:dataDicId").val();		
	var inputType=jquery("#inputType").val();
	var searchText=jquery("#searchInputText").val();
	if(searchText=="请输入查询内容"){
		searchText="";
	}
	searchInputsList(inputType,dataStandard,searchText,pageNum);
	jquery("#login").show();
}
//翻页
function inputsJump(inputsPageNum){
	searchInputs(inputsPageNum);
}
function searchInputsList_next(){
	var trLength=jQuery("#inputsTable tr").length;
	for(var i=1;i<trLength;i++){
		var inputIds=jQuery("#inputsTable tr:eq("+i+") td:eq(0) input:eq(0)").val();
		if(jquery("#addtr_"+inputIds).length>0){
			jquery("#check_"+inputIds).addClass('checked');
		}
	}
	var allNum = jQuery("#inputs_table").find('td .mn_check').length;
	var allLen = jQuery("#inputs_table").find('td .mn_check.checked').length;
	//alert('allNum:'+allNum+'allLen:'+allLen)
	//如果个数和选中的个数相等，则全选为选中状态
	if(allLen == allNum && allNum>0){
		jQuery("#mn_checkall").addClass('checked');
	}else{
		jQuery("#mn_checkall").removeClass('checked');
	}
	jQuery("#login").hide();
}
//]]>
</script>
</ui:define>

</ui:composition>
