<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	template="/layout/template_new.xhtml">

	<ui:define name="body">
	<style>
	.ie-form-input-background-image-scroll-fix{*display:block !important;}
	.ts_div2{width:302px; height: 125px; border: 1px solid #81C5E9; margin: 0px auto; padding: 0 15px 15px;  background: url(#{request.contextPath}/asset/images/tck_bg_14.jpg) #ffffff repeat-x scroll center top;}
	.dr-mpnl-shadow{background:none;}
	.dr-mpnl-pnl{background:none; border:none;}
	.dr-mpnl-pnl-b{padding:0;}
	.dr-mpnl-shadow{top:0; left:0;}
	.rich-picklist-source-items{margin:0;}
	.sw80{width:80px;}
	.sw80 .bootstrap-select:not([class*="span"]):not([class*="col-"]):not([class*="form-control"]):not(.input-group-btn) {
    width: 80px;
}

	</style>
		<td valign="top">
		<h:form id="user">
		 <!-- Modal -->
<div aria-hidden="false" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal" class="modal fade in w600na" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">提示框</h4>
      </div>
      <div class="modal-body">
       <span id="spanValue">*号部分为必填项！</span>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal">确认</button>
      </div>
    </div>
  </div>
</div>
				<!-- #{schedulingModelInfoHome.methods()} -->
				<!-- #{schedulingModelInfoHome.getPlMethod()} -->
                <div class="right_c">
                	<div class="r_title">
                    	<div class="r_t_l"><s:link propagation="none"  view="#{sessionTake.urlTemp}" style="text-decoration:none;color:black;" value="工作 ">
                    	</s:link>&#160;&gt;&#160;&#160;<font size="3">作物模型</font></div>
                    </div>
                    <!---添加模型开始-->
                    <table cellpadding="0" cellspacing="0">
                    	<tr>
                    		<td class="sel_td">作物种类：</td>
                            <td class="sel_td" colspan="5">#{schedulingModelInfoHome.plant.name}</td>
                    	</tr>
                    	<tr>
                    		<td class="sel_td">种植品种：</td>
                            <td class="sel_td" colspan="5">
                                <div>
                                    <h:outputText value="#{schedulingModelInfoHome.breedObj.name}" />
                                </div>
                            </td>
                    	</tr>
                    	<tr>
                    		<td class="sel_td">种植标准：</td>
                            <td class="sel_td" colspan="5">
                                <div>
                                    <h:selectOneMenu styleClass="selectpicker" id="plantingPattern" style="margin:0 auto;"  value="#{schedulingModelInfoHome.plantingPattern}" onclick="getyyd()">
											<s:selectItems value="#{schedulingModelInfoHome.ddList}" var="var" label="#{var.name}" itemValue="#{var.dataDicId}"/>
									</h:selectOneMenu>
                                </div>
                            </td>
                    	</tr>
                    	<tr>
                    		<td class="sel_td">种植环境：</td>
                            <td class="sel_td" colspan="5">
                                <div>
                                    <h:selectOneMenu  id="plantEnvTypeId" styleClass="selectpicker" style="margin:0 auto;"  value="#{schedulingModelInfoHome.instance.plantEnvTypeId}" onclick="getyyd()">
											<s:selectItems value="#{schedulingModelInfoHome.getPlantEnvTypeMethod()}" var="var" label="#{var.name}"/>
											<s:convertEntity />
									</h:selectOneMenu>
                                </div>
                            </td>
                    	</tr>
                    	<tr>
                    		<td class="sel_td">定值时间：</td>
                            <td class="sel_td">
                                <div class="sw80">
                                    <h:selectOneMenu id="valueTime"  class="selectpicker" value="#{schedulingModelInfoHome.instance.valueTime}">
											<f:selectItem itemLabel="一月" itemValue="1" />
									        <f:selectItem itemLabel="二月" itemValue="2" />
									        <f:selectItem itemLabel="三月" itemValue="3" />
									        <f:selectItem itemLabel="四月" itemValue="4" />
									        <f:selectItem itemLabel="五月" itemValue="5" />
									        <f:selectItem itemLabel="六月" itemValue="6" />
									        <f:selectItem itemLabel="七月" itemValue="7" />
									        <f:selectItem itemLabel="八月" itemValue="8" />
									        <f:selectItem itemLabel="九月" itemValue="9" />
									        <f:selectItem itemLabel="十月" itemValue="10" />
									        <f:selectItem itemLabel="十一月" itemValue="11" />
									        <f:selectItem itemLabel="十二月" itemValue="12" />
								   </h:selectOneMenu> 
                                </div>
                            </td>
                            <td class="sel_td">
                                <div class="sw80" style="margin-left: 10px;">
                                    <h:selectOneMenu id="valueTenDays"  class="selectpicker"  value="#{schedulingModelInfoHome.instance.valueTenDays}">
											<f:selectItem itemLabel="上旬" itemValue="1" />
									        <f:selectItem itemLabel="中旬" itemValue="2" />
									        <f:selectItem itemLabel="下旬" itemValue="3" />
								   </h:selectOneMenu> 
                                </div>
                            </td>
                    	</tr>
                    	<tr>
                    		<td class="sel_td">采收开始：</td>
                            <td class="sel_td">
                                <div class="sw80">
                                    <h:selectOneMenu id="plantBeginTime"  class="selectpicker"  value="#{schedulingModelInfoHome.instance.plantBeginTime}">
											<f:selectItem itemLabel="一月" itemValue="1" />
									        <f:selectItem itemLabel="二月" itemValue="2" />
									        <f:selectItem itemLabel="三月" itemValue="3" />
									        <f:selectItem itemLabel="四月" itemValue="4" />
									        <f:selectItem itemLabel="五月" itemValue="5" />
									        <f:selectItem itemLabel="六月" itemValue="6" />
									        <f:selectItem itemLabel="七月" itemValue="7" />
									        <f:selectItem itemLabel="八月" itemValue="8" />
									        <f:selectItem itemLabel="九月" itemValue="9" />
									        <f:selectItem itemLabel="十月" itemValue="10" />
									        <f:selectItem itemLabel="十一月" itemValue="11" />
									        <f:selectItem itemLabel="十二月" itemValue="12" />
								   </h:selectOneMenu> 
                                </div>
                            </td>
                            <td class="sel_td">
                                <div class="sw80" style="margin-left: 10px;">
                                    <h:selectOneMenu id="plantBeginTenDays"  class="selectpicker" value="#{schedulingModelInfoHome.instance.plantBeginTenDays}">
											<f:selectItem itemLabel="上旬" itemValue="1" />
									        <f:selectItem itemLabel="中旬" itemValue="2" />
									        <f:selectItem itemLabel="下旬" itemValue="3" />
								   </h:selectOneMenu> 
                                </div>
                            </td>
                            
                    		<td class="sel_td">&#160;&#160;采收结束：</td>
                            <td class="sel_td">
                                <div class="sw80">
                                    <h:selectOneMenu id="plantEndTime"  class="selectpicker" value="#{schedulingModelInfoHome.instance.plantEndTime}">
											<f:selectItem itemLabel="一月" itemValue="1" />
									        <f:selectItem itemLabel="二月" itemValue="2" />
									        <f:selectItem itemLabel="三月" itemValue="3" />
									        <f:selectItem itemLabel="四月" itemValue="4" />
									        <f:selectItem itemLabel="五月" itemValue="5" />
									        <f:selectItem itemLabel="六月" itemValue="6" />
									        <f:selectItem itemLabel="七月" itemValue="7" />
									        <f:selectItem itemLabel="八月" itemValue="8" />
									        <f:selectItem itemLabel="九月" itemValue="9" />
									        <f:selectItem itemLabel="十月" itemValue="10" />
									        <f:selectItem itemLabel="十一月" itemValue="11" />
									        <f:selectItem itemLabel="十二月" itemValue="12" />
								   </h:selectOneMenu> 
                                </div>
                            </td>
                            <td class="sel_td">
                                <div class="sw80" style="margin-left: 10px;">
                                    <h:selectOneMenu id="plantEndTenDays"  class="selectpicker" value="#{schedulingModelInfoHome.instance.plantEndTenDays}">
											<f:selectItem itemLabel="上旬" itemValue="1" />
									        <f:selectItem itemLabel="中旬" itemValue="2" />
									        <f:selectItem itemLabel="下旬" itemValue="3" />
								   </h:selectOneMenu> 
                                </div>
                            </td>
                    	</tr>
                    </table>
                    <div class="sel_title">亩商品量（kg/亩）</div>
                    <table cellpadding="0" cellspacing="0" style="table-layout:fixed; border-collapse:collapse; width:540px;" id="yueTable"> 
                    	<tr>
                        	<td class="sel_tdline">1月份</td>
                            <td class="sel_tdbgc" align="center">
                                <h:inputText class="input_oute" id="yue1" value="#{schedulingModelInfoHome.instance.januaryMu}" onclick="clearyue(this);" onfocus="this.className='input_one';this.onmouseout=''" onblur="this.className='input_offe';this.onmouseout=function(){this.className='input_oute'};yichuyue(this);jisuan();" onmousemove="this.className='input_movee'" onmouseout="this.className='input_oute'"  onkeyup="clearNoNum(this)" >
                                </h:inputText>
                            </td>
                        	<td class="sel_tdline">2月份</td>
                            <td class="sel_tdbgc">
                            	<h:inputText class="input_oute" id="yue2" value="#{schedulingModelInfoHome.instance.februaryMu}" onclick="clearyue(this);" onfocus="this.className='input_one';this.onmouseout=''" onblur="this.className='input_offe';this.onmouseout=function(){this.className='input_oute'};yichuyue(this);jisuan();" onmousemove="this.className='input_movee'" onmouseout="this.className='input_oute'"  onkeyup="clearNoNum(this)"  >
                                </h:inputText>
                            </td>
                        	<td class="sel_tdline">3月份</td>
                            <td class="sel_tdbgc">
                           		<h:inputText class="input_oute" id="yue3" value="#{schedulingModelInfoHome.instance.marchMu}"   onclick="clearyue(this);" onfocus="this.className='input_one';this.onmouseout=''" onblur="this.className='input_offe';this.onmouseout=function(){this.className='input_oute'};yichuyue(this);jisuan();" onmousemove="this.className='input_movee'" onmouseout="this.className='input_oute'"  onkeyup="clearNoNum(this)" >
                           		
                                </h:inputText>
                            </td>
                    	</tr>
                    	<tr>
                        	<td class="sel_tdline">4月份</td>
                            <td class="sel_tdbgc">
                            	<h:inputText class="input_oute" id="yue4" value="#{schedulingModelInfoHome.instance.aprilMu}"  onclick="clearyue(this);"   onfocus="this.className='input_one';this.onmouseout=''" onblur="this.className='input_offe';this.onmouseout=function(){this.className='input_oute'};yichuyue(this);jisuan();" onmousemove="this.className='input_movee'" onmouseout="this.className='input_oute'"  onkeyup="clearNoNum(this)" >
                            	
                                </h:inputText>
                            </td>
                        	<td class="sel_tdline">5月份</td>
                            <td class="sel_tdbgc">
                            	<h:inputText class="input_oute" id="yue5" value="#{schedulingModelInfoHome.instance.mayMu}" onclick="clearyue(this);"  onfocus="this.className='input_one';this.onmouseout=''" onblur="this.className='input_offe';this.onmouseout=function(){this.className='input_oute'};yichuyue(this);jisuan();" onmousemove="this.className='input_movee'" onmouseout="this.className='input_oute'"  onkeyup="clearNoNum(this)">
                            	
                                </h:inputText>
                            </td>
                        	<td class="sel_tdline">6月份</td>
                            <td class="sel_tdbgc">
                            	<h:inputText class="input_oute" id="yue6" value="#{schedulingModelInfoHome.instance.juneMu}" onclick="clearyue(this);"  onfocus="this.className='input_one';this.onmouseout=''" onblur="this.className='input_offe';this.onmouseout=function(){this.className='input_oute'};yichuyue(this);jisuan();" onmousemove="this.className='input_movee'" onmouseout="this.className='input_oute'"  onkeyup="clearNoNum(this)" >
                            	
                                </h:inputText>
                            </td>
                    	</tr>
                    	<tr>
                        	<td class="sel_tdline">7月份</td>
                            <td class="sel_tdbgc">
                            	<h:inputText class="input_oute" id="yue7"  value="#{schedulingModelInfoHome.instance.julyMu}" onclick="clearyue(this);"  onfocus="this.className='input_one';this.onmouseout=''" onblur="this.className='input_offe';this.onmouseout=function(){this.className='input_oute'};yichuyue(this);jisuan();" onmousemove="this.className='input_movee'" onmouseout="this.className='input_oute'"  onkeyup="clearNoNum(this)" >
                                </h:inputText>
                            </td>
                        	<td class="sel_tdline">8月份</td>
                            <td class="sel_tdbgc">
                            	<h:inputText class="input_oute" id="yue8"  value="#{schedulingModelInfoHome.instance.augustMu}" onclick="clearyue(this);"  onfocus="this.className='input_one';this.onmouseout=''" onblur="this.className='input_offe';this.onmouseout=function(){this.className='input_oute'};yichuyue(this);jisuan();" onmousemove="this.className='input_movee'" onmouseout="this.className='input_oute'"  onkeyup="clearNoNum(this)" >
                            	
                                </h:inputText>
                            </td>
                        	<td class="sel_tdline">9月份</td>
                            <td class="sel_tdbgc">
                            	<h:inputText  class="input_oute" id="yue9" value="#{schedulingModelInfoHome.instance.septemberMu}" onclick="clearyue(this);"  onfocus="this.className='input_one';this.onmouseout=''" onblur="this.className='input_offe';this.onmouseout=function(){this.className='input_oute'};yichuyue(this);jisuan();" onmousemove="this.className='input_movee'" onmouseout="this.className='input_oute'"  onkeyup="clearNoNum(this)">
                            	
                                </h:inputText>
                            </td>
                    	</tr>
                    	<tr>
                        	<td class="sel_tdline">10月份</td>
                            <td class="sel_tdbgc">
                            	<h:inputText class="input_oute" id="yue10"  value="#{schedulingModelInfoHome.instance.octoberMu}"  onclick="clearyue(this);"  onfocus="this.className='input_one';this.onmouseout=''" onblur="this.className='input_offe';this.onmouseout=function(){this.className='input_oute'};yichuyue(this);jisuan();" onmousemove="this.className='input_movee'" onmouseout="this.className='input_oute'"  onkeyup="clearNoNum(this)">
                            	
                                </h:inputText>
                            </td>
                        	<td class="sel_tdline">11月份</td>
                            <td class="sel_tdbgc">
                            	<h:inputText class="input_oute" id="yue11"  value="#{schedulingModelInfoHome.instance.novemberMu}" onclick="clearyue(this);"  onfocus="this.className='input_one';this.onmouseout=''" onblur="this.className='input_offe';this.onmouseout=function(){this.className='input_oute'};yichuyue(this);jisuan();" onmousemove="this.className='input_movee'" onmouseout="this.className='input_oute'"  onkeyup="clearNoNum(this)">
                               		
                                </h:inputText>
                            </td>
                        	<td class="sel_tdline">12月份</td>
                            <td class="sel_tdbgc">
                            	<h:inputText class="input_oute"  id="yue12" value="#{schedulingModelInfoHome.instance.decemberMu}" onclick="clearyue(this);"  onfocus="this.className='input_one';this.onmouseout=''" onblur="this.className='input_offe';this.onmouseout=function(){this.className='input_oute'};yichuyue(this);jisuan();" onmousemove="this.className='input_movee'" onmouseout="this.className='input_oute'"  onkeyup="clearNoNum(this)" >
                                </h:inputText>
                            </td>
                    	</tr>
                        <tr>
                        	<td colspan="6" class="sel_all_l">总产量：<span id="total">#{schedulingModelInfoHome.total}</span>kg/亩
                        		<h:inputHidden id="total2" value="#{schedulingModelInfoHome.total}"/>
                        	</td>
                        </tr>
                    </table>
                    <div class="sel_but">
                    	<a:commandButton id="persist" styleClass="btn btn-primary" value="提交" rendered="#{!schedulingModelInfoHome.managed}" eventsQueue="default" onclick="jisuan();if(!checkSubmit()) return false;" action="#{schedulingModelInfoHome.persist}" data="#{schedulingModelInfoHome.chechParam}" oncomplete="checkComplete(data);"/>
                    	<h:commandButton id="update"  styleClass="btn btn-primary" value="提交" rendered="#{schedulingModelInfoHome.managed}" onclick="jisuan();if(!checkSubmit()) return false;" action="#{schedulingModelInfoHome.update}" />&#160;&#160;
                        <a  href="#{request.contextPath}/model/ModelInfoTwo.seam?plantPlantId=#{schedulingModelInfoHome.plantId}&amp;breedId=#{schedulingModelInfoHome.breedId}" class="btn btn-default" >返回
                        </a>
                    </div>
            <!--添加模型结束-->
            <div class="clear"></div>
		</div><!--right_c结束-->
                <div class="clear"></div>
              </h:form>
              <script type="text/javascript">
            //<![CDATA[
            function checkSubmit(){
            	var relut = checkMonths();
            	if(!relut)
            		return false;
            	
               
			   var yue1 = document.getElementById("user:yue1").value;
			   var startStr = document.getElementById("user:plantBeginTime").value;
               var endStr = document.getElementById("user:plantEndTime").value;
			   if(startStr=="1" && endStr=="1" && yue1 == ''){
				   document.getElementById("spanValue").innerHTML = "一月份亩商品量不能为空";
				   jquery("#myModal").modal('show');return false;
			   }	
			   return true;
			}

           function checkComplete(data){
				var dataStr = data;
				if(data == "no"){
					document.getElementById("spanValue").innerHTML = "该品种已添加过此类模型，请重新添加！";
					   jquery("#myModal").modal('show');return false;
				}
				return true;
           }
            
            function getyyd(){
			    var a = jquery(".ui-selectmenu ui-widget ui-state-default ui-corner-all small3 ui-selectmenu-dropdown").html();
		    }
            	jquery(document).ready(function(){
					jisuan();
				});
				
            function jisuan(){
  					var a1 = document.getElementById("user:yue1").value;
  					var a2 = document.getElementById("user:yue2").value;
  					var a3 = document.getElementById("user:yue3").value;
  					var a4 = document.getElementById("user:yue4").value;
  					var a5 = document.getElementById("user:yue5").value;
  					var a6 = document.getElementById("user:yue6").value;
  					var a7 = document.getElementById("user:yue7").value;
  					var a8 = document.getElementById("user:yue8").value;
  					var a9 = document.getElementById("user:yue9").value;
  					var a10 = document.getElementById("user:yue10").value;
  					var a11 = document.getElementById("user:yue11").value;
  					var a12 = document.getElementById("user:yue12").value;
  					var total = 0;
  					if(a1 != null && a1 != ""){
  						a1 = parseFloat(a1);
  					}else{
  						a1 = 0;
  					}
  					if(a2 != null && a2 != ""){
  						a2 = parseFloat(a2);
  					}else{
  						a2 = 0;
  					}
  					if(a3 != null && a3 != ""){
  						a3 = parseFloat(a3);
  					}else{
  						a3 = 0;
  					}
  					if(a4 != null && a4 != ""){
  						a4 = parseFloat(a4);
  					}else{
  						a4 = 0;
  					}
  					if(a5 != null && a5 != ""){
  						a5 = parseFloat(a5);
  					}else{
  						a5 = 0;
  					}
  					if(a6 != null && a6 != ""){
  						a6 = parseFloat(a6);
  					}else{
  						a6 = 0;
  					}
  					if(a7 != null && a7 != ""){
  						a7 = parseFloat(a7);
  					}else{
  						a7 = 0;
  					}
  					if(a8 != null && a8 != ""){
  						a8 = parseFloat(a8);
  					}else{
  						a8 = 0;
  					}
  					if(a9 != null && a9 != ""){
  						a9 = parseFloat(a9);
  					}else{
  						a9 = 0;
  					}
  					if(a10 != null && a10 != ""){
  						a10 = parseFloat(a10);
  					}else{
  						a10 = 0;
  					}
  					if(a11 != null && a11 != ""){
  						a11 = parseFloat(a11);
  					}else{
  						a11 = 0;
  					}
  					if(a12 != null && a12 != ""){
  						a12 = parseFloat(a12);
  					}else{
  						a12 = 0;
  					}
  					total = a1 + a2 + a3 + a4 + a5 + a6 + a7 + a8 + a9 + a10 + a11 + a12;
  					jquery("#total").html(total);
  					document.getElementById("user:total2").value=total;
              }
              var yue="";
              //触发事件清空数据
              function clearyue(obj){
                  var booParam = checkInput(obj.name);
                  if(booParam){
                      //alert(booParam);
                	  for(var i=1;12>=i;i++ ){
                          var tempyue="user:yue"+i;
    					if(obj.name==tempyue){
    						 if(document.getElementById(tempyue).value!=""){
    		            		  yue=document.getElementById(tempyue).value;
    		                   }
    							document.getElementById(tempyue).value="";
    						}
                      }
                      return true;
                  }else{
                	  //alert(booParam);
                	  document.getElementById("spanValue").innerHTML = "该月份不在采收开始和结束时间之内";
                	  document.getElementById(obj.name).value = "";
                	  jquery("#myModal").modal('show');
                	  return false;
                  }
              }

             function checkMonths(){
                 
            	 var result = true;
            	 var index = 0;
            	 jquery("#yueTable input").each(function(){
					if(index < 12){
						index++;
						var month = parseInt(this.name.replace("user:yue",""));
						var booParam  = checkInput(this.name);	
						 if(!booParam){
							 if(jquery(this).val() > 0){
				               	 if(confirm(month + "月份不在采收开始和结束时间之内,将清空！")){
			 						jquery(this).val("");
								 }else{
									 result = false;
									return false;
								 }
							}else{
								jquery(this).val("");
							}
		                 }
					}
               	 });
               	 
                 return result;
              }
			var str = "";
              function checkInput(obj){
                   obj = obj + "";
                  var objNumStr = obj.substring(8);
            	  var startStr = document.getElementById("user:plantBeginTime").value;
                  var endStr = document.getElementById("user:plantEndTime").value;
                  var objNum = parseInt(objNumStr);
                  var start = parseInt(startStr);
                  var end = parseInt(endStr);
                  //开始时间小于等于结束时间
                  if(start <= end){
					 if(objNum >= start && objNum <= end){
						 //str = str + ",";
						return true;
					 }else{
						return false;
					 }
                  }else{
					if(objNum <= end || objNum >= start){
						//str = str + ",";
						return true;
					}else{
						return false;
					}
                  }
              }
              
              //移除调用判断数据是否被更改
              function yichuyue(obj){
                 // alert(yue);
                  for(var i=1;12>=i;i++ ){
                      var tempyue="user:yue"+i;
                      if(obj.name==tempyue){
		            	  if(obj.value == ""){
		            		  document.getElementById(tempyue).value=yue;
		            		  
		                  }
		            	  yue="";
                      }
                  }
              }
              function clearNoNum(obj){   
      			obj.value = obj.value.replace(/[^\d.]/g,"");  //清除“数字”和“.”以外的字符  
      			obj.value = obj.value.replace(/^\./g,"");  //验证第一个字符是数字而不是. 
      			obj.value = obj.value.replace(/\.{2,}/g,"."); //只保留第一个. 清除多余的.   
      			obj.value = obj.value.replace(".","$#$").replace(/\./g,"").replace("$#$",".");
      		}
        		
            //]]>
              </script>
              <script type="text/javascript">
		
			  window.onload = function () {
			    jquery('.selectpicker').selectpicker();
			  };
			</script>
			
            </td> 
	</ui:define>

</ui:composition>
