<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
     xmlns:s="http://jboss.com/products/seam/taglib"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:a="http://richfaces.org/a4j"
    xmlns:c="http://java.sun.com/jstl/core"
    template="/layout/template_new.xhtml">
<ui:define name="head_next">
<link rel="stylesheet" type="text/css" href="#{request.contextPath}/asset/css/price.css"/>
</ui:define>
<ui:define name="body">
<!-- #{marketPriceHome.initAreaTwo()} #{marketPriceHome.initPlantListTwo()} #{marketPriceHome.initOneDayPriceList()}
 -->
<td valign="top" width="100%">
<div class="priceBg_tt">
            <div class="priceBg_bt">
            <div class="priceBg_lt">
            <div class="priceBg_rt">
            	<div class="price_wap">
                	<!-- 选择市场 开始 -->
                	<div class="priceSelt mt20 mb20">
                        <span class="bootSelt selt_xzzw">
                            <select class="selectpicker" data-live-search="true" id="plant_id" name="plant_id" multiple="multiple" onchange="changePlant_before(this)">
                            <a:repeat value="#{marketPriceHome.plantListTwo}"  var="var">
                            <option value="#{var[0]}">#{var[1]}</option>
                            </a:repeat>
                            </select>
                        </span>
                        <span class="bootSelt selt_xzrq">
                            <div class="input-append date form_datetime today"  style="position:relative;">
                            <input size="26" type="text" value="#{marketPriceHome.oneDay}" readonly="readonly" />
                            <span class="add-on"><i class="icon-th"></i></span>
                            </div>
                        </span>
                    </div>
                    <!-- 表格控件 开始 -->
                    <div class="nationalPrice_wap" style="height:600px;">
                    <p style="height:30px; line-height:30px; margin-bottom:5px; text-align:right; color:#e5e5e5; font-size:12px;">单位：元/斤</p>
                    <s:span id="priceList">
                    <table id="demoTable"  class=" sDefault sDefault-Main" cellpadding="0" cellspacing="0">
                         <tbody>
                            <tr>
                                <th>
                                <div class="zuowuTime">
                                <span class="price_lineL"></span>
                                <span class="price_lineR"></span>
                                <span class="price_lineT"></span>
                                <span class="price_lineB"></span>
                                    <span class="zuowu">作物</span>
                                    <span class="time">省份</span>
                                    <span class="xianBg"><img src="#{request.contextPath}/asset/images/price_bg10.png" width="145" height="50" /></span>
                                </div>
                                </th>
                                <a:repeat value="#{marketPriceHome.areaListTwo}" var="var" rowKeyVar="index">
                                 <th height="50"><span class="price_lineT"></span><span class="price_lineB"></span><s:span rendered="#{marketPriceHome.areaListTwo.size()==index+1}" styleClass="price_lineR"></s:span><span class="thText">#{var}</span></th>
                                </a:repeat>
                            </tr>
                            <a:repeat value="#{marketPriceHome.plantListTwo}" var="var" rowKeyVar="index">
	                            <tr>
	                                <td align="left">
	                                <span class="price_lineL"></span>
	                                <span class="price_lineR"></span>
	                                <s:span styleClass="price_lineB" rendered="#{marketPriceHome.plantListTwo.size()==index+1}"></s:span>
	                                <span class="zhezhaoWp">
	                                <img class="zhezhao" src="#{request.contextPath}/asset/images/zhezhao20.png" width="26" height="26" />
	                                <img class="zhezhaoImg" src="#{var[2]}@40h_40w|40-1ci.png" />
	                                </span>
	                                <span class="zhezhaoTxt">#{var[1]}</span>
	                                </td>
	                                <s:formattedText value="#{var[3]}"/>
	                            </tr>
                            </a:repeat>
                            <ui:fragment rendered="#{marketPriceHome.plantListTwo.size() == 0}"> 
                            	<tr style="visibility:hidden;height: 2px;">
	                                <td align="left">
	                                <span class="price_lineL"></span>
	                                <span class="price_lineR"></span>
	                                <span class="zhezhaoWp">
	                                <img class="zhezhao" src="#{request.contextPath}/asset/images/zhezhao20.png" width="26" height="26" />
	                                <img class="zhezhaoImg" src="#{var[2]}" />
	                                </span>
	                                <span class="zhezhaoTxt">#{var[1]}</span>
	                                </td>
	                                 <a:repeat value="#{marketPriceHome.areaListTwo}" var="var" rowKeyVar="index">
	                                 <td>--</td>
	                                 </a:repeat>
	                            </tr>
                            </ui:fragment>
                        </tbody>
                    </table>
                    </s:span>
                    </div>
                    <!-- 表格控件 结束 -->
                </div>
            </div>   
            </div>
            </div>
            </div>   
            <!-- 价格内容 结束 -->
            <script type="text/javascript" src="#{request.contextPath}/asset/js/contract/superTables_compressed.js"></script>
            	<link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/contract/superTables_compressed.css" />
            	<style>
            	.sDefault th, .sDefault td { border:none; height:50px; box-sizing:border-box;}
            	.sHeader{ background:none;}
            	.sBase .sFData,.sBase .sData{background:rgba(255,255,255,0);}
            	.nationalPrice_wap .zhezhaoWp{ margin-left:5px;}
            	.priceSelt .input-append .add-on{ right:0;}
            	</style>
<script type="text/javascript">
//<![CDATA[
          function resetTable(){
        	  new superTable("demoTable", {
        		  cssSkin: "sDefault",
        			cssSkin: "sDefault",
        			headerRows : 1,
        			fixedCols: 1,
        			colWidths:[
        			145,120,120,120,120,
        			120,120,120,120,
        			120,120,120,120,
        			120,120,120,120,
        			120,120,120,120,
        			120,120,120,120,
        			120,120,120,120,
        			120,120,120
        			]
        		})
          }  //表格控件
          jQuery(function(){
        	  	resetTable();
        		jQuery('.selectpicker').selectpicker({noneSelectedText:"全部"});  // 下拉菜单控件
        		jQuery(".form_datetime").datetimepicker({  // 时间控件 
        			format: "yyyy-mm-dd",  /* 控制显示格式，默认为空，显示小时分钟 */
        			autoclose: true,
        			weekStart: 1,
        			language:  'zh-CN',
        			startView: 3,
        			minView: 2,
        			maxView: 2,		
        			pickerPosition: "bottom-left"
        		}).on('changeDate', function(ev){
        		   	 var time = new Date(ev.date);
        			 if(time==null)
        				 time = new Date();
        			 time = time.format("yyyy-MM-dd");
        			 changeDate(time);
        		});
        		
        		change();
        		
        		jQuery(window).resize(function(){  // 改变浏览器窗口 
        			change();
        		});	
        		
        	});	
          
          function change(){   // 计算表格宽高一屏显示
  			var prHei = jQuery(window).height()-225;  //-225=-60-51-40-74
  			var prWid = jQuery(window).width()-77-91;
  			var tr_height_sum = 0;
  			jQuery("div.sData #demoTable tr").each(function(){
  				tr_height_sum += jQuery(this).height();
  			});
  			jQuery('.nationalPrice_wap').css({
  				'width' : prWid,
  				'height' : prHei
  			});
  			jQuery('.nationalPrice_wap .sData').css({  
  				'width' : prWid-145,
  				'height' : 	prHei - jQuery('.sFHeader').height() - 35,
  				'max-height' : tr_height_sum - 50+17
  			});
  			//jQuery('.sHeader').css('width' , prWid-17);
  			jQuery('.sFData').css('width' , prWid-17);
  			jQuery('.sFData').css('height' , jQuery('.sData').height()+50);
  		};
  		
          
          Date.prototype.format = function(format)
          {
          	var o = {
          	"M+" : this.getMonth()+1, //month
          	"d+" : this.getDate(),    //day
          	"h+" : this.getHours(),   //hour
           	"m+" : this.getMinutes(), //minute
          	"s+" : this.getSeconds(), //second
           	"q+" : Math.floor((this.getMonth()+3)/3),  //quarter
           	"S" : this.getMilliseconds() //millisecond
          	}

          	if(/(y+)/.test(format)) 
          	{
          		format=format.replace(RegExp.$1,(this.getFullYear()+"").substr(4 - RegExp.$1.length));
          	}
          	
           	for(var k in o)
          	{
          		if(new RegExp("("+ k +")").test(format))
          		{
           			format = format.replace(RegExp.$1,RegExp.$1.length==1 ? o[k] : ("00"+ o[k]).substr((""+ o[k]).length));
          		}
          	}
          	return format;
          }
          
          function changePlant_before(obj){
        		var str = "-1";
        		if(jquery(obj).val()!=null){
        			str = jquery(obj).val().toString();
        		}
        		changePlant(str);
        	}
//]]>
</script>
<a:form style="display:none">
 		<a:queue requestDelay="10" ignoreDupResponses="true" id="mainQueue"/>
        <a:jsFunction name="changePlant" eventsQueue="mainQueue"  action="#{marketPriceHome.changePlantTwo()}"  reRender="priceList" oncomplete="resetTable();change();">
        <a:actionparam name="param2" assignTo="#{marketPriceHome.plantStrTwo}"></a:actionparam>
        </a:jsFunction>
        <a:jsFunction name="changeDate" eventsQueue="mainQueue"  action="#{marketPriceHome.changeDateTwo()}" reRender="priceList" oncomplete="resetTable();change();">
        <a:actionparam name="param2" assignTo="#{marketPriceHome.oneDay}"></a:actionparam>
        </a:jsFunction>
</a:form>
</td>
</ui:define>

</ui:composition>
