<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<f:view xmlns="http://www.w3.org/1999/xhtml"
   xmlns:ui="http://java.sun.com/jsf/facelets"
   xmlns:f="http://java.sun.com/jsf/core"
   xmlns:h="http://java.sun.com/jsf/html"
   xmlns:a="http://richfaces.org/a4j"
   xmlns:s="http://jboss.com/products/seam/taglib"
   xmlns:rich="http://richfaces.org/rich"
   contentType="text/html">
<html> 
   <head>
		<s:decorate rendered="#{identity.isLoggedIn()}"> 
			<meta http-equiv="Refresh" content="0; URL=#{request.contextPath}#{sessionTake.getUrlTemp()}" />
		</s:decorate>
		<meta name="viewport" content="target-densitydpi=device-dpi, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, minimal-ui" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black" />
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
		<title>义田帮手简单实用的农场管理工具</title>
		<link rel="shortcut icon" href="#{request.contextPath}/favicon.ico"/>
		<link href="#{request.contextPath}/asset/css/bootstrap3.min.css" rel="stylesheet"/>
		<script type="text/javascript" src="#{request.contextPath}/asset/new/jquery.js"></script>
		<script type="text/javascript" src="#{request.contextPath}/asset/new/bootstrap.min.js"></script>
		<script type="text/javascript" src="#{request.contextPath}/asset/js/gt.js"/>
		<ui:insert name="head"/>
   </head>
<body>
<style>
body {    font-size: 12px;
    color: #000;
    font-family:"微软雅黑";background:#fff url(#{request.contextPath}/asset/images/login/bg.png) top repeat-x;
    line-height: 150%;
    margin: 0;
    padding: 0;
}
a:focus {
    outline:none;
    -moz-outline:none;
} 

h1, h2, h3, h4, h5, h6, ul, li, dl, dt, dd, form, img, p,input {
    border: medium none;
    list-style-type: none;
    margin: 0;
    padding: 0;
}
a{text-decoration:none;}

/*登陆页*/
.logo_company{margin:auto auto; display: block;}
.logo_box01{height: 64px;margin: 0 auto;width: 360px; margin-top:160px; border-bottom:1px #d8e2f3 dotted;}

.user_new{background: url(#{request.contextPath}/asset/images/login/man.png) no-repeat;height:36px;padding-bottom:20px;width:328px;}
.pass_new{background: url(#{request.contextPath}/asset/images/login/secret.png) no-repeat;height: 36px;padding-bottom: 17px;width: 328px;}
.write01{ height:34px; width:265px;float: right;background: none repeat;color: #B0B0B0;font-size: 14px;line-height: 34px; margin-right:5px;}
.login_new{ width:330px; margin:0 auto; margin-top:30px;}
.login_button{ padding-top:10px;}
.forget a{color: #3c779a;font-size: 12px;}
.forget{ height:45px;}
.bottom_text {
    background: url(#{request.contextPath}/asset/images/login/bg_bottom.png) repeat-x;
    bottom: 0;
    color: #8d9fb7;
    height: 50px;
    line-height: 50px;
    position: fixed;
    text-align: center;
    width: 100%;
}
.rich_messages01 {
    float: left;
    line-height: 33px;
    margin: 0 auto;
    min-width: 75px;
	margin-left:5px;
}
.ts_font {
    color: #ff0000;
    font-size: 14px;
     padding-left:10px;
}
.fuhao{position: relative; display: block; float: left; right: 1px; width:16px; height:16px;}
.font01{min-width:137px; display:inline-block;height: 35px;}
.btn {
	display: inline-block;
	padding: 6px 12px;
	margin-bottom: 0;
	font-size: 12px;
	font-weight: 400;
	line-height: 1.42857143;
	text-align: center;
	white-space: nowrap;
	vertical-align: middle;
	cursor: pointer;
	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
	user-select: none;
	background-image: none;
	border: 1px solid transparent;
	border-radius: 4px;
	width:328px;
}

.btn-info {
	color: #fff;
	background-color: #5bc0de;
	border-color: #46b8da
}

.btn-info:hover,.btn-info:focus,.btn-info:active,.btn-info.active,.open>.dropdown-toggle.btn-info
	{
	color: #fff;
	background-color: #31b0d5;
	border-color: #269abc
}

.btn-info:active,.btn-info.active,.open>.dropdown-toggle.btn-info {
	background-image: none
}

.btn-info.disabled,.btn-info[disabled],fieldset[disabled] .btn-info,.btn-info.disabled:hover,.btn-info[disabled]:hover,fieldset[disabled] .btn-info:hover,.btn-info.disabled:focus,.btn-info[disabled]:focus,fieldset[disabled] .btn-info:focus,.btn-info.disabled:active,.btn-info[disabled]:active,fieldset[disabled] .btn-info:active,.btn-info.disabled.active,.btn-info[disabled].active,fieldset[disabled] .btn-info.active
	{
	background-color: #5bc0de;
	border-color: #46b8da
}

.btn-info .badge {
	color: #5bc0de;
	background-color: #fff
}
.baidutongji a{height:0; display:none;}
.baidutongji a img{ display:none;}
.bs-example{position:fixed;top:0;width:100%;}
</style>
  <h:form id="loginForm">
			<!-- #{messages.right} -->
	<div class="logo_box01">
		<img class="logo_company" src="#{authenticator.logoName}"/>
	</div>
	<div class="login_new">
<table width="" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <td class="user_new" >
    	<h:inputText id="username" value="#{credentials.username}" styleClass="write01"/>
    </td>
    <td class="ts_font" height="40" align="left" >
    	<font class="font01" style="#{authenticator.messageString eq 1 ?'':'display:none;'}">
        	<img class="fuhao" src="#{request.contextPath}/asset/images/login/fuhao.png"/>
            <dl class="rich_messages01">
            <dt>
            <span >用户名错误！</span>
            </dt>
            </dl>
        </font>
        
        <font class="font01" style="#{authenticator.messageString eq 3 ?'':'display:none;'}">
        	<img class="fuhao" src="#{request.contextPath}/asset/images/login/fuhao.png"/>
            <dl class="rich_messages01">
            <dt>
            <span >未获得相应权限！</span>
            </dt>
            </dl>
        </font>
        <font class="font01" style="#{authenticator.messageString eq 4 ?'':'display:none;'}">
        	<img class="fuhao" src="#{request.contextPath}/asset/images/login/fuhao.png"/>
            <dl class="rich_messages01">
            <dt>
            <span >该用户已被暂停，请联系客服：400-8199-586</span>
            </dt>
            </dl>
        </font>
    </td>
  </tr>
  <tr>
    <td class="pass_new">
    	<h:inputSecret id="password" value="#{credentials.password}" styleClass="write01"/>
    </td>
    <td class="ts_font" height="40" align="center">
    	<font class="font01" style="#{authenticator.messageString eq 2 ?'':'display:none;'}">
        	<img class="fuhao" src="#{request.contextPath}/asset/images/login/fuhao.png"/>
            <dl class="rich_messages01">
            <dt>
            <span >密码错误！</span>
            </dt>
            </dl>
        </font>
    </td>
  </tr>
  <tr>
    <td class="login_button">
    	<h:inputHidden value="#{authenticator.versionId}" />
    	<h:commandButton id="submitId" styleClass="btn btn-info"  action="#{authenticator.login}" value="登录" style="display: none;"/>
    	<button id="btn" onclick="return verdict();" class="btn btn-info">登录</button>
    </td>
  </tr>
  <tr>
    <td align="right" class="forget"><a href="#{request.contextPath}/resetPwd.seam">忘记密码？</a></td>
  </tr>
</table>
</div>
<div id="popup-captcha"></div>
<div class="bs-example bs-example-standalone" style="display: none;">
    <div role="alert" class="alert alert-danger alert-dismissible fade in">
      <button data-dismiss="alert" class="close" type="button"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
      <h4>IE8以下已经不被支持</h4>
      <p>请您查看您的浏览器版本，升级到IE8或是使用火狐浏览器，Safari浏览器，谷歌浏览器，360浏览器查看。如需升级IE8版本请点击进入</p>
    </div>
</div>
<div class="baidutongji">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fef045bf50b01b351e1c52c334e160018' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript" src="#{request.contextPath}/asset/new/jquery.min.js"></script>
<script type="text/javascript">
//<![CDATA[
    var checkInfo = "#{authenticator.messageString}";  
    var logName =   "#{authenticator.logNameString}";
    if(logName != "" && checkInfo=="2"){
		$("#loginForm\\:username").val(logName);
    }
    var openVerify = "#{authenticator.openVerify}";//是否开户极验验证
	$(function() {
		var userAgent = window.navigator.userAgent.toLowerCase();
		$.browser.msie7 = $.browser.msie && /msie 7\.0/i.test(userAgent);
		$.browser.msie6 = !$.browser.msie8 && !$.browser.msie7 && $.browser.msie && /msie 6\.0/i.test(userAgent);
		if($.browser.msie7 || $.browser.msie6){
			$(".bs-example").show();
			$("#loginForm\\:submitId").attr("disabled","disabled");
			$("#btn").attr("disabled","disabled");
		}
		document.onkeydown = function(e){ 
		    var ev = document.all ? window.event : e;
		    if(ev.keyCode==13) {
		    	e.preventDefault();
		    	jQuery("#btn").click();
		     }
		}
		if(openVerify=='true'){			
			//极验验证码
		    var handlerPopup = function (captchaObj) {  
		    	jQuery("#popup-submit").click(function () {
		            var validate = captchaObj.getValidate();
		            if (!validate) {
		                alert('请先完成验证！');
		                return;
		            }
		            jQuery.ajax({
		                url: "VerifyLoginServlet", // 进行二次验证
		                type: "post",
		                dataType: "json",
		                data: {
		                    // 二次验证所需的三个值
		                    geetest_challenge: validate.geetest_challenge,
		                    geetest_validate: validate.geetest_validate,
		                    geetest_seccode: validate.geetest_seccode
		                },
		            });
		        });
		    	// 弹出式需要绑定触发验证码弹出按钮
				captchaObj.bindOn("#loginForm:submitId");
		        // 将验证码加到id为captcha的元素里
		        captchaObj.appendTo("#popup-captcha");
		    };
	
			jQuery.ajax({
		        // 获取id，challenge，success（是否启用failback）
		        url: "StartCaptchaServlet",
		        type: "get",
		        dataType: "json",
		        success: function (data) {
		            // 使用initGeetest接口
		            // 参数1：配置参数
		            // 参数2：回调，回调的第一个参数验证码对象，之后可以使用它做appendTo之类的事件
		            initGeetest({
		                gt: data.gt,
		                challenge: data.challenge,
		                product: "popup", // 产品形式，包括：float，embed，popup。注意只对PC版验证码有效
		                offline: !data.success // 表示用户后台检测极验服务器是否宕机，一般不需要关注
		            }, handlerPopup);
		        }
		    });
		}
	});
	function verdict(){
		var user_name = jQuery("#loginForm\\:username").val();
		var user_pwd = jQuery("#loginForm\\:password").val();
			if(user_name == ''){
				alert("用户名不能为空!")
				return false;
		}else if(user_pwd == ''){
			alert("密码不能为空!")
			return false;
		}
		jQuery("#loginForm\\:submitId").click();
		return false;
	}
//]]>
</script>
</div>
</h:form>
<div class="bottom_text">Copyright 北京奥科美技术服务有限公司</div>
</body>
</html>
</f:view>