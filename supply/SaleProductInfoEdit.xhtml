<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	template="/layout/template_new.xhtml">
	<ui:define name="body">
	<style >
	.lvl_show .bootstrap-select:not([class*=span]):not([class*=col-]):not([class*=form-control]):not(.input-group-btn) {
    width: 640px;}
    .hang span .icheckbox_minimal-blue{ margin-top:21px;margin-right:5px;}
	</style>
	#{saleProductInfoHome.work()}
	<link rel="stylesheet" type="text/css" href="#{request.contextPath}/asset/css/supply/CommodityXx.css"/>
	<link rel="stylesheet" type="text/css" href="#{request.contextPath}/asset/css/supply/skinBlue.css"/>
	<script type="text/javascript" src="#{request.contextPath}/asset/js/icheck.js"></script>
	<script type="text/javascript" src="#{request.contextPath}/asset/js/bootcss_checkedRadio.js"></script>
	          
	          <div class="box_back" id="login" style="display: none; z-index: 1000">
				<div id="login2"
					style="width: 60px; height: 60px; margin: 220px auto 0 auto;">
					<img src="../asset/images/loginda.gif" />
				</div>
			</div>
	           <td valign="top">
	           <h:form id="supply">
<div aria-hidden="false" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModalYz" class="modal fade in w600na" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">提示框</h4>
      </div>
      <div class="modal-body">
       <span id="productMsg">*号部分为必填项！</span>
        
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal">确认</button>
      </div>
    </div>
  </div>
</div>

<div aria-hidden="false" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="imageYz" class="modal fade in w600na" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">提示框</h4>
      </div>
      <div class="modal-body">
       <span id="imageMessYz">*号部分为必填项！</span>
        
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal">确认</button>
      </div>
    </div>
  </div>
</div>

<div aria-hidden="false" aria-labelledby="confirmModalLabel" role="dialog" tabindex="-1" id="confirmModal" class="modal fade in w600na" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="confirmModalLabel">提示框</h4>
      </div>
      <div class="modal-body">
       <span id="confirmMsg">*号部分为必填项！</span>
        
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal" onclick="submitSave()">是</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="backList()">否</button>
      </div>
    </div>
  </div>
</div>
	           
            <div class="right_c pt20 pb20" style="min-height:30px;">
                <!-- 面包屑导航 开始 -->
                <div class="breadNav_wap clear">
                     <div class="breadNav_lt" style="font-size:12px;">销售工具<span>&gt;</span><a href="#">供货管理</a></div>
                </div>  
                 <div class="breadNav_wap clear" style="margin-left:50px;">
                     <div class="titlefont" style="line-height:50px;">产品信息</div>
                </div> 
                <!-- 面包屑导航 结束 -->
                <!-- 内容开始 -->
                <div class="pContent" style="width: 789px;">
                    <div class="hang">
                        <span>商品名称</span>
                        <h:inputText style="width: 610px;" class="form-control nw635" id="saleName" value="#{saleProductInfoHome.saleProductInfo.name}"  />
                    </div>
                    <div class="hang" >
                        <span style=" margin-right: 16px;">作物种类</span>
						<input type="hidden" value="#{saleProductInfoHome.plantId}" id="aaa"/>
					 	<select id="aaa" class="selectpicker" data-live-search="true" style="display: none;" onchange="change1(this.value)">
					 		<option value="0">请选择</option>
							<a:repeat value="#{saleProductInfoHome.plantList}" var="var">
								<option value="#{var.plantId}">#{var.name}</option>
							</a:repeat>
                        </select>
                        <img src="#{request.contextPath}/asset/images/supply/important.png" alt="" />
                         <h:panelGroup id="zuowu">
                        <span class="mar90" style="margin-left: 65px;">作物品种</span>
						 <select id="check" class="selectpicker" data-live-search="true" title="请选择" style="display: none;" multiple="multiple" onchange="changeBreed1()">
							<a:repeat value="#{saleProductInfoHome.breedList}" var="var">
								<option value="#{var.breedId}">#{var.name}</option>
							</a:repeat>
                        </select>
                        <img src="#{request.contextPath}/asset/images/supply/important.png" alt="" />
                        <a href="" data-toggle="modal" data-target="#myModal" onclick="addBreed()"><img src="#{request.contextPath}/asset/images/supply/add.png" alt="" style="cursor: pointer;"/></a>
                    	</h:panelGroup>
                    </div>
                    <div class="hang">
                        <span>价格区间</span>
                        <h:inputText class="form-control nw100" id="minPrice" onkeyup="clearNoNum(this,event)" value="#{saleProductInfoHome.saleProductInfo.minPrice}"/>--<h:inputText class="form-control nw100" id="maxPrice" onkeyup="clearNoNum(this,event)" value="#{saleProductInfoHome.saleProductInfo.maxPrice}" /> 元/
                        <select id="unitInfo" class="selectpicker" style="display: none;">
							<a:repeat value="#{saleProductInfoHome.unitInfoList}" var="var">
								<option value="#{var.id}">#{var.name}</option>
							</a:repeat>
                        </select>  <img src="#{request.contextPath}/asset/images/supply/important.png" alt="" />                 
                    </div>
                    <div class="hang">
                        <span style="margin-right: 23px;margin-left:25px;">规格</span>
                        <h:inputText class="form-control nw220" value="#{saleProductInfoHome.saleProductInfo.specs}" />
                        <span class="mar90" style="margin-left: 88px;">参与活动</span>
                        <input type="hidden" value="#{saleProductInfoHome.topiceInfoId}" id="bbb"/>
						 <h:selectOneMenu class="selectpicker" value="#{saleProductInfoHome.topiceInfoId}">
						 	<f:selectItem itemValue="" itemLabel="请选择"/>
						 	<s:selectItems id="bbbt" value="#{saleProductInfoHome.topiceInfoList}" var="_obj" label="#{_obj[2]}-#{_obj[1]}" itemValue="#{_obj[0]}"/>
							<!-- <a:repeat value="#{saleProductInfoHome.topiceInfoList}" var="var">
								<option value="#{var[0]}">#{var[2]}-#{var[1]}</option>
							</a:repeat> -->
                        </h:selectOneMenu>                      
                    </div>
                    <div class="hang">
                        <span style="float:left">产品属性</span>
                        <ul style="float:left;">
							<a:repeat value="#{saleProductInfoHome.getDatadic()}" var="_pet" rowKeyVar="_index">
                          	 <li style="float:left">
                             <input type="checkbox" name="iCheck" id="iCheck" value="#{_pet[0]}" check="#{_pet[0]}"/> 
                             <label style="padding:0 15px 0 5px; display:inline; font-weight: normal">#{_pet[1]}</label>
                             </li>
                            </a:repeat>
                        </ul>
                    </div>
                    <div style="float:left;margin-top: -19px;" class="hang" >
                        <span style="float:left;" >产品标准</span>
                        
                        <h:panelGroup id="prostan" style="float:left;margin-top:12px;">
                        <h:selectOneMenu id="prostandard" styleClass="selectpicker" onchange="changeStand(this.value);" value="#{saleProductInfoHome.standard}">
							<s:selectItems id="stand" value="#{saleProductInfoHome.standardList}" var="_obj" label="#{_obj[1]}" itemValue="#{_obj[0]}"/>
						</h:selectOneMenu><img src="#{request.contextPath}/asset/images/supply/important.png" alt="" />
						</h:panelGroup>
						<div id="aaaa" style="display:none;">
							<span style="float:left;" ><h:inputHidden id="localpro" value="#{saleProductInfoHome.saleProductInfo.localProduct}" />
							<input type="checkbox" id="dbcp" name="dbcp" style="float:left;" />地标产品</span>
                    	</div>
                    	
                    </div>
                    <div style="float:left;margin-top: -19px;" class="hang" >
                        <span style="margin-right: 7px;">对应摄像头</span>
                        <h:panelGroup id="videoSelect">
							<select id="video" class="selectpicker" data-live-search="true" style="display: none;">
								<a:repeat value="#{saleProductInfoHome.videlList}" var="var">
									<h:outputText rendered="#{var[1] ne '' and var[1] ne null}" >
										<option value="#{var[0]}">#{var[1]}</option>
									</h:outputText>
								</a:repeat>
	                        </select>
                        </h:panelGroup>
                    </div>
                    <div class="hang_img">
                        <span class="fl" style="margin-right:20px; margin-top: 10px;">产品图片</span>
							<ul class="baseAddList">
                                <li class="baseAddLi">
                                	<h:inputHidden value="#{saleProductInfoHome.saleProductInfo.productImage}" id="productImage"/>
                                 	<iframe src="#{request.contextPath}/supply/SaleProductInfoImages.seam?aaiId=#{saleProductInfoHome.saleProductInfo.saleProductInfoId==null ? 0 :saleProductInfoHome.saleProductInfo.saleProductInfoId}" id="myframe2" name="myframe2" frameBorder="0" scrolling="no" width="" height="165" onLoad="" style="width:560px; height:165px"></iframe>
                                </li>
                         	</ul>
                    </div>
                    <div class="hang_world" style="float:left;position: relative;">
                    <span class="fl" style="margin-right:18px;margin-top:5px">产品介绍:</span>
                    <div style="margin-left: 78px; display: block;">
						<h:inputTextarea value="#{saleProductInfoHome.saleProductInfo.description}"  style="width:690px;height:400px"  id="description" name="description"/>
						<img src="#{request.contextPath}/asset/images/supply/important.png" alt="" style="position: absolute;bottom: 0;right: -31px;"/>
					</div>
                    </div>
                </div> 
                <div class="breadNav_wap clear" style="margin-left:50px;">
                     <div class="titlefont" style="line-height:50px;">供应信息</div>
                </div>
                <div class="pContent">
                	<!-- <div>
                        <ul class="blongsSelt clear" style="width:100%;">
							<li class="storehouseSeltLi01 fl">供应类型</li>
							<li class="fl mt10" style="margin-left:20px;">
								<input type="radio" class="stRadio" name="supplyTypeRadio" checked="checked" id="str1" value="1"></input>
								<label class="pr15 pl5" style="font-weight:normal;">现货</label>
							</li>
							<li class="fl mt10" style="margin-left: 10px;">
								<input type="radio" class="stRadio" name="supplyTypeRadio" value="0" id="str0"></input>
								<label class="pr15 pl5" style="font-weight:normal;">预售</label>
							</li>
						</ul>												
                    </div> -->
                    <div style="clear:both;"></div>
                    <div class="hang" id="supplyDiv" style="display:block;">
                        <span>供货日期</span> 
                        <div name="supplyTime" class="input-append date form_datetime " style="display:inline;">
							<h:inputText id="supplyBeginTime" readonly="#{facesContext.renderResponse}" value="#{saleProductInfoHome.saleProductInfo.supplyBeginTime}" autocomplete="off">
								<s:convertDateTime type="both" dateStyle="short" pattern="yyyy-MM-dd" />
							</h:inputText>
							<span class="add-on"><i class="icon-th" style="width: 22px"></i><span style="color:red">*</span></span>
                        </div>---
                        <div name="supplyTime" class="input-append date form_datetime " style="display:inline; margin-left:18px;">
							<h:inputText id="supplyEndTime" readonly="#{facesContext.renderResponse}" value="#{saleProductInfoHome.saleProductInfo.supplyEndTime}">
								<s:convertDateTime type="both" dateStyle="short" pattern="yyyy-MM-dd" />
							</h:inputText>
							<span class="add-on"><i class="icon-th" style="width: 22px"></i><span style="color:red">*</span></span>
                        </div>
                    </div>    
                    
                    <div class="hang">
                        <span style="margin-left:15px;">供货量</span>
                        <h:inputText class="form-control nw220" id="supplyNum" value="#{saleProductInfoHome.saleProductInfo.supplyNum}" onfocus="if(this.value=='请填写作物的总供货量'){this.value=''}" onblur="if(this.value==''){this.value='请填写作物的总供货量'}"/> kg<img src="#{request.contextPath}/asset/images/supply/important.png" alt="" />
                        <span style="margin-left:95px;">出货量</span>
                        <h:inputText class="form-control nw220" id="saleNum" value="#{saleProductInfoHome.saleProductInfo.saleNum}" onfocus="if(this.value=='0.0'){this.value=''}" onblur="if(this.value==''){this.value='0.0'}" /> kg/天
                    </div>
                       <div class="hang">
                        <span style="margin-left:16px;">剩余量</span>
                        <h:inputText class="form-control nw220" id="surplusNum" value="#{saleProductInfoHome.saleProductInfo.surplusNum}" onfocus="if(this.value=='请填写作物可以出售的产量'){this.value=''}" onblur="if(this.value==''){this.value='请填写作物可以出售的产量'}"/> kg<img src="#{request.contextPath}/asset/images/supply/important.png" alt="" />
                    </div>
                    <div>
							<!-- <li class="storehouseSeltLi01 fl">供应范围</li>
							<li class="fl mt10" style="margin-left:20px;">
								<input type="radio" name="supplyAreaRadio" checked="checked" value="1"></input>
								<label class="pr15 pl5" style="font-weight:normal;">本地</label>
							</li>
							<li class="fl mt10" style="margin-left: 10px;">
								<input type="radio" name="supplyAreaRadio" value="2"></input>
								<label class="pr15 pl5" style="font-weight:normal;">全国</label>
							</li> -->
							<div id="proviceDiv">
								<span style="display:inline-block;margin-left:0px;margin-right: 20px">供应范围</span>
								<div style="display:inline-block;margin-right: 10px">
								<select class="selectpicker" data-live-search="true"  multiple="multiple"  style="display: none;width:150px;margin-left:15px;" id="supplyProvince" title="请选择">	
	                                    <a:repeat value="#{saleProductInfoHome.supplyProvinceList}" var="_province">
	                                    	<s:fragment rendered="#{_province[0] eq saleProductInfoHome.local}">
	                                    		<option selected="selected" value="#{_province[0]}">#{_province[1]}</option>
	                                    	</s:fragment>
	                                    	<s:fragment rendered="#{_province[0] ne saleProductInfoHome.local}">
	                                    		<option  value="#{_province[0]}">#{_province[1]}</option>
	                                    	</s:fragment>
	                                    </a:repeat>
	                            </select>
	                            </div>
	                            <div class="through_year" style="display:inline-block;margin-top:9px;">
	                           		<input class="iCheck"  type="checkbox" id="supplyAreaFlag" name="supplyAreaFlag" /><label style="padding:0 15px 0 5px;">全国</label>
	                           	</div>
                            </div>
                            
                    </div>
                    <div style="clear:both;"></div>
                    <div class="hang" >
                        <h:panelGroup id="lvliSelect">
                        <span style="margin-left:0px;">履历展示</span>
                        <div class="lvl_show" style="display: inline;">	
							<select id="lvli"  class="selectpicker" data-live-search="true" style="display: none;" title="请选择对应绿色履历">
								<option value="-1">请选择对应绿色履历</option>
								<a:repeat  value="#{saleProductInfoHome.lvliList}" var="var" >
									<option value="#{var.productInfoId}">#{var.plantName}</option>
								</a:repeat>
                        </select>
                        </div>
                        </h:panelGroup>
                    </div>
		             <div class="ckd_button" style="text-align: center;">
		                <h:commandButton id="persist" value="保存" styleClass="btn btn-success" action="#{saleProductInfoHome.persist}"  rendered="#{saleProductInfoHome.saleProductInfo.saleProductInfoId eq null}"  onclick="return checkSubmit()"/>
		                <h:commandButton id="persistSubmit" value="提交并上架" styleClass="btn btn-primary" style="margin-left:10px" action="#{saleProductInfoHome.persist}"  rendered="#{saleProductInfoHome.saleProductInfo.saleProductInfoId eq null}"  onclick="return publishSubmit()"/>
				        <h:commandButton id="update" value="提交" styleClass="btn btn-primary" action="#{saleProductInfoHome.update}" rendered="#{saleProductInfoHome.saleProductInfo.saleProductInfoId ne null}"   onclick="return checkSubmit()"/>
				        <a href="javascript:void(0);"  id="bn_left6" style="margin-left:10px" onclick="backCheck();"><input type="button" class="btn btn-default" value="返回" />
				        </a>
		              </div>
                </div>
            </div>
            <h:inputHidden value="#{saleProductInfoHome.bIdString}" id="breedId"/>
            <h:inputHidden value="#{saleProductInfoHome.bIdString1}" id="breedId1"/>
            <h:inputHidden value="#{saleProductInfoHome.dicString}" id="dicSting"/>
            <h:inputHidden value="#{saleProductInfoHome.breedString}" id="breString" />
            <h:inputHidden value="#{saleProductInfoHome.productRecordId}" id="productRecordId"/>
            <h:inputHidden value="#{saleProductInfoHome.unitType}" id="unitTypeId"/>
            <h:inputHidden value="#{saleProductInfoHome.videoId}" id="videoId"/>
            <!-- <h:inputHidden value="#{saleProductInfoHome.supplyType}" id="supplyType"/> -->
            <h:inputHidden value="#{saleProductInfoHome.supplyArea}" id="supplyArea"/>
            <h:inputHidden value="#{saleProductInfoHome.supplyProvince}" id="supplyProvince"/>
            <h:inputHidden value="#{saleProductInfoHome.publish}" id="publish"/>
<!--             <h:inputHidden value="#{saleProductInfoHome.standard}" id="standard"/> -->
            </h:form>
            </td>  
            <!-- 作物品种添加 内容开始 -->
        <a:form id="pinzhong">
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog kuandu" style="margin-top: -239px;">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true" style="display:none;">&times;</span><span class="sr-only">Close</span></button>
            <h4 class="modal-title" id="myModalLabel">添加</h4>
          </div>
          <div class="modal-body">
                <div class="h50">
                    <span style="margin-left:30px">植物类型：</span>
						<span id="plantName"></span>
                </div> 
                <div class="h50">
                    <span style="margin-left:58px">名称：</span>
                    <h:inputText class="form-control" id="mingcheng" style="width: 220px; display: inline;" value="#{saleProductInfoHome.breedName}" />
                    <img src="#{request.contextPath}/asset/images/supply/important.png" alt="" />
                </div>
                <div class="h50">
                    <span style="margin-left:57px;">图片：</span>
          				<s:fileUpload id="picture" size="30" style="display:inline;"
							accept="image/png,image/jpeg,image/gif"
							contentType="image/png,image/jpeg,image/gif"
							fileName="#{saleProductInfoHome.pictureName}"
							data="#{saleProductInfoHome.imgUrl}"
							onchange="changeFileName(this.value)">
						</s:fileUpload>
                </div>
                <div class="h5">
                    <span style="margin-left:30px;">适合茬口：</span>
                    <h:inputText class="form-control" style="width: 220px; display: inline;" value="#{saleProductInfoHome.suitableCrops}" />
                </div>
                <div class="h90">
                    <span style="margin-left:60px; float:left;">产地：</span>
                    <h:inputTextarea class="form-control" rows="3" style="width: 450px; display: inline-block; margin-top:10px" value="#{saleProductInfoHome.origin}" />
                </div>
          </div>
          <div class="modal-footer">
            <a:commandButton id="persistModal" value="提交" styleClass="btn btn-primary" action="#{saleProductInfoHome.persistModal}" oncomplete="submithd()" reRender="zuowu"/>
            <a class="btn btn-default" id="btn-default" data-dismiss="modal">返回</a>
          </div>
        </div>
      </div>
    </div>
    </a:form>
    <!-- 模态框 内容结束 -->
            <a:form>
            <a:jsFunction name="change2" action="#{saleProductInfoHome.changePlant()}" reRender="zuowu,lvliSelect,videoSelect,prostan" oncomplete="huidiao()">
            	<a:actionparam name="plantId" assignTo="#{saleProductInfoHome.plantId}"/>
            </a:jsFunction>
             <a:jsFunction name="changeBreed2" action="#{saleProductInfoHome.changeBreed()}" reRender="lvliSelect,videoSelect" oncomplete="lvlihd()">
            	<a:actionparam name="b" assignTo="#{saleProductInfoHome.breedString}" />
            </a:jsFunction>
            <a:jsFunction name="changeStands" action="#{saleProductInfoHome.changeStandard()}" data="#{saleProductInfoHome.localProducts}" oncomplete="standsHuidiao(data)">
            	<a:actionparam name="standard" assignTo="#{saleProductInfoHome.standard}"/>
            	<a:actionparam name="plantId" assignTo="#{saleProductInfoHome.plantId}"/>
            </a:jsFunction>
            <a:jsFunction name="changeStands2" action="#{saleProductInfoHome.changeStandard()}" data="#{saleProductInfoHome.localProducts}" oncomplete="standsHuidiao2(data)">
            	<a:actionparam name="standard" assignTo="#{saleProductInfoHome.standard}"/>
            	<a:actionparam name="plantId" assignTo="#{saleProductInfoHome.plantId}"/>
            </a:jsFunction>
            </a:form>
<script type="text/javascript" src="#{request.contextPath}/asset/js/calendarIcheck.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/icheck.js"></script>  
<script type="text/javascript" src="#{request.contextPath}/asset/js/kindeditor/kindeditor.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/kindeditor/lang/zh_CN.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/gantt/jquery-1.10.2.js"></script>
<script type="text/javascript">
//<![CDATA[
var cs = "";
// var b = new Array();


jQuery(document).ready(function(){ 
	var service='#{saleProductInfoHome.resumeService}';
	if(service!='1'&& service!='3'){
		jQuery('#lvli').attr("disabled","false");
	}
	jQuery('.selectpicker').selectpicker();  //下拉菜单
	jquery('#aaa').next().selectpicker({noneSelectedText:"请选择"});
    jquery('#check').selectpicker({noneSelectedText:"请选择"});
    jquery('#lvli').selectpicker({noneSelectedText:"请选择对应绿色履历"});
    jquery('#video').selectpicker({noneSelectedText:"请选择作物生长区域对应摄像头"});
    jquery('#check').selectpicker('deselectAll');
    jquery("#unitInfo + div").css("width","100px");
// 	alert("#{saleProductInfoHome.dicString}")
    var spid="#{saleProductInfoHome.saleProductInfo.saleProductInfoId}";	
	var a = "#{saleProductInfoHome.dicString}".split(",");
	for(var i=0;i<a.length;i++){
		jquery('input[check='+a[i]+']').iCheck('check')
	}
	var p = "#{saleProductInfoHome.plantId}";
	jquery("#aaa").next().selectpicker("val",p)
	var s = "#{saleProductInfoHome.standard}";
	jquery('#supply\\:stand').selectpicker("val",s)
	var ui = "#{saleProductInfoHome.saleProductInfo.unitType.id}";
		
	if(null!=ui && ""!=ui){
		jquery('#unitInfo').selectpicker("val",ui)
	}else{
		//默认公斤
		jquery('#unitInfo').selectpicker("val",10)
	}	
	var vi = "#{saleProductInfoHome.saleProductInfo.video.videoId}";
	if(null!=vi && ""!=vi){
		jquery('#video').selectpicker("val",vi)
	}
	//供应类型（添加默认现货）
	/* var hs = "#{saleProductInfoHome.saleProductInfo.hasSpot}";	
	if((hs==1 || hs==null || hs=="")){
		jquery('input[name="supplyTypeRadio"][value=1]').iCheck('check');
		jquery("#spotDiv").css("display","");	
		jquery("#supplyDiv").css("display","none");	
	}else{
		jquery('input[name="supplyTypeRadio"][value=0]').iCheck('check');
		jquery("#supplyDiv").css("display","");	
		jquery("#spotDiv").css("display","none");		
	}	 */
	//供应范围（添加默认本地）
	/* var ha = "#{saleProductInfoHome.saleProductInfo.supplyArea}";
	if(ha=="" && ""!=spid){
		jquery('input[name="supplyAreaRadio"]:eq(1)').iCheck('check');
	}else{
		jquery('input[name="supplyAreaRadio"]:eq(2)').iCheck('check');
	} */
	var ha = "#{saleProductInfoHome.saleProductInfo.sale_area}";
	if(ha!="null"){
		var arr = ha.split(",");
		if(arr.length>1){
			jquery("#supplyProvince").selectpicker("val",arr);
		}else{
			jquery("#supplyProvince").selectpicker("val",ha);
		}
		
	}else{
		jquery('#supplyAreaFlag').iCheck('check');
		jquery('#supplyProvince').attr({"disabled":"false"});
	}
	
	
	/* jquery('input[class=stRadio]').on('ifChecked', function(event){
		var supplyType= jquery('input[name="supplyTypeRadio"]:checked').val();
		if(supplyType==1){
			jquery("#supplyDiv").css("display","none");

			jquery("#spotDiv").css("display","");
		}else if(supplyType==0){
			jquery("#supplyDiv").css("display","");

			jquery("#spotDiv").css("display","none");
		}	
	}); */

	
	var stands= '#{saleProductInfoHome.saleProductInfo.standard.dataDicId}';
	var plantId = jquery('#aaa').val();
	changeStands2(stands,plantId);
	
	var loca = '#{saleProductInfoHome.saleProductInfo.localProduct}';
	if(loca == 'true'){
		jquery('#dbcp').iCheck('check');
	}else{
		jquery('#dbcp').iCheck('uncheck');
	}
	
	var dates = '#{saleProductInfoHome.saleProductInfo.supplyBeginTime}';
	if(dates==''){
		var myDate = new Date();
		var date = formatDate(myDate,'yyyy-MM-dd');
		jquery('#supply\\:spotBeginTime').val(date);
	}
	jQuery('.selectpicker').selectpicker(); 

	jquery(".through_year .iCheck-helper").click(function(){
		if(document.getElementById('supplyAreaFlag').checked){
			jquery('#supplyProvince').attr({"disabled":"false"});
			jquery('#supplyProvince').selectpicker("val","");
		}else{
			jquery("#supplyProvince").removeAttr("disabled");
			jquery("#proviceDiv").find("li").removeAttr("class");
		}
	});

});

//格式化时间
	Date.prototype.format = function(format){ 
	var o = { 
	"M+" : this.getMonth()+1, //month 
	"d+" : this.getDate(), //day 
	"h+" : this.getHours(), //hour 
	"m+" : this.getMinutes(), //minute 
	"s+" : this.getSeconds(), //second 
	"q+" : Math.floor((this.getMonth()+3)/3), //quarter 
	"S" : this.getMilliseconds() //millisecond 
	} 
	if(/(y+)/.test(format)) { 
	format = format.replace(RegExp.$1, (this.getFullYear()+"").substr(4 - RegExp.$1.length)); 
	} 
	for(var k in o) { 
	if(new RegExp("("+ k +")").test(format)) { 
	format = format.replace(RegExp.$1, RegExp.$1.length==1 ? o[k] : ("00"+ o[k]).substr((""+ o[k]).length)); 
	} 
	} 
	return format; 
	} 
	function formatDate(date,format){ 
	        var paddNum = function(num){ 
	          num += ""; 
	          return num.replace(/^(\d)$/,"0$1"); 
	        } 
	        //指定格式字符 
	        var cfg = { 
	           yyyy : date.getFullYear() //年 : 4位 
	          ,yy : date.getFullYear().toString().substring(2)//年 : 2位 
	          ,M  : date.getMonth() + 1  //月 : 如果1位的时候不补0 
	          ,MM : paddNum(date.getMonth() + 1) //月 : 如果1位的时候补0 
	          ,d  : date.getDate()   //日 : 如果1位的时候不补0 
	          ,dd : paddNum(date.getDate())//日 : 如果1位的时候补0 
	          ,hh : date.getHours()  //时 
	          ,mm : date.getMinutes() //分 
	          ,ss : date.getSeconds() //秒 
	        } 
	        format || (format = "yyyy-MM-dd hh:mm:ss"); 
	        return format.replace(/([a-z])(\1)*/ig,function(m){return cfg[m];}); 
	} 
//格式化时间结束

	
jQuery(function($) { 
	var supply = "#{saleProductInfoHome.saleProductInfo.supplyNum}";  //初始值
	if(supply==null || supply==""){
		jquery("#supply\\:supplyNum").val("请填写作物的总供货量");
	}
	var saleNum = "#{saleProductInfoHome.saleProductInfo.saleNum}";
	if(saleNum==null || saleNum==""){
		jquery("#supply\\:saleNum").val("0.0");
		}
	var surplusNum = "#{saleProductInfoHome.saleProductInfo.surplusNum}";
	if(surplusNum ==null || surplusNum=="" ){
		jquery("#supply\\:surplusNum").val("请填写作物可以出售的产量");
		}
	
});
/* jquery("#supply\\:supplyNum").focus(function(){
	jquery("#supply\\:supplyNum").val("");
}); */

function huidiao(){
	 var service='#{saleProductInfoHome.resumeService}';
		if(service!='1'&& service!='3'){
			jQuery('#lvli').attr("disabled","false");
		}
	//jQuery('.selectpicker').selectpicker();
	jquery('.selectpicker').selectpicker();
    jquery('#check').selectpicker({noneSelectedText:"请选择"});
    jquery('#lvli').selectpicker({noneSelectedText:"请选择对应绿色履历"});
    jquery('#video').selectpicker({noneSelectedText:"请选择作物生长区域对应摄像头"});
    jquery('#check').selectpicker('deselectAll');
    
	var v = new Array();
	v = "#{saleProductInfoHome.bIdString1}".split(",");
	jquery("#check").selectpicker("val",v);//编辑时 品种取到选好的值
}

jquery("div[name=supplyTime]").datetimepicker({
     format: "yyyy-mm-dd",
     autoclose: true,
	 weekStart: 1,
	 language:  'zh-CN',
	 minView:2,
     pickerPosition: "bottom-left"
    });

jquery("#spotBeginTimeDiv").datetimepicker({
    format: "yyyy-mm-dd",
    autoclose: true,
	 weekStart: 1,
	 language:  'zh-CN',
	 minView:2,
	 startDate: '2000-01-01',
	 endDate:formatDate(new Date(),'yyyy-MM-dd'),
    pickerPosition: "bottom-left"
   });

jquery("#spotEndTimeDiv").datetimepicker({
    format: "yyyy-mm-dd",
    autoclose: true,
	 weekStart: 1,
	 language:  'zh-CN',
	 minView:2,
	 startDate: formatDate(new Date(),'yyyy-MM-dd'),
    pickerPosition: "bottom-left"
   });

jquery('input[name=iCheck]').iCheck({
    checkboxClass: 'icheckbox_minimal-blue',
    radioClass: 'iradio_minimal-blue',
    increaseArea: '20%' // optional
  });

var breedSelect = "";
function addBreed(){
// 	alert(jquery('#supply\\:aaa').next().find('.pull-left').text());
	jquery('#plantName').text(jquery('#aaa').next().next().find('.pull-left').text());
	breedSelect = jquery("#check").val();
	
	return true;
}

function change1(plantId){
	if(plantId == 0){
		return;
	}else{
		change2(plantId);
		jquery("#check").val(breedSelect);
		var stands= '#{saleProductInfoHome.saleProductInfo.standard.dataDicId}';
		if(stands == ''){
			changeStands(122,plantId);
		}
	}
}

function changeBreed1(){
	var a =""+jquery('#check').val();
// 	alert(a);
	changeBreed2(a);
//  	jquery('#supply\\:breedString').val(jquery('#check').val()); //小品种id集合
}

function changeTopice(){
	var a = jquery("#bbbt").val();
	jquery("#bbb").val(a);
}

KindEditor.ready(
		function(K) {
			editor = K.create('textarea[name="supply\\:description"]', {
			resizeType : 1,
			allowPreviewEmoticons : false,
			uploadJson : '#{request.contextPath}/asset/js/kindeditor/upload_json.jsp?directoryType=31&businessType=4&enterpriseId=' + #{sessionTake.getEnterpriseInfoId()},
			allowImageUpload : true,
			items:[
			        'source', '|', 'undo', 'redo', '|', 'preview', 'print', 'template', 'code', 'cut', 'copy', 'paste',
			        'plainpaste', 'wordpaste', '|', 'justifyleft', 'justifycenter', 'justifyright',
			        'justifyfull', 'insertorderedlist', 'insertunorderedlist', 'indent', 'outdent', 'subscript',
			        'superscript', 'clearhtml', 'quickformat', 'selectall', '|', 'fullscreen', '/',
			        'formatblock', 'fontname', 'fontsize', '|', 'forecolor', 'hilitecolor', 'bold',
			        'italic', 'underline', 'strikethrough', 'lineheight', 'removeformat', '|', 'image', 'multiimage',
			        'table', 'hr', 'emoticons', 'baidumap', 'pagebreak',
			        'anchor', 'link', 'unlink'
			],
		});
			jquery(".ke-edit-iframe ").contents().find(".ke-content").css("height","328")
	});
//提交并上架
function publishSubmit(){
	jquery("#supply\\:publish").val(1);
	return checkSubmit();
}	
function checkSubmit(){
	jquery('#supply\\:localpro').val(jquery('#dbcp').is(':checked'));
	//验证
	var baseid='#{sessionTake.getBaseModel().getBaseId()}';
	var saleName = jquery("#supply\\:saleName").val();
// 	var aa = jquery("#check").next().find(".btn-default").attr("title");
	var minPrice = jquery("#supply\\:minPrice").val();
	var maxPrice = jquery("#supply\\:maxPrice").val();
	var supplyNum = jquery("#supply\\:supplyNum").val();
	var saleNum = jquery("#supply\\:saleNum").val();
	var surplusNum = jquery("#supply\\:surplusNum").val();
	var supplyBeginTime = jquery("#supply\\:supplyBeginTime").val();
	var supplyEndTime = jquery("#supply\\:supplyEndTime").val();
	var cpjs = jquery(".ke-edit-iframe").contents().find("body").html();
	var plant = jquery("#aaa").next().val();
	var breed = jquery('#check').val();
	
	if(baseid==0){
		document.getElementById("productMsg").innerHTML = "请选择基地!";
		   jquery("#myModalYz").modal('show');
		   return false;
	}
	if(plant == "undefined" || plant == "" || plant == null){
		   document.getElementById("productMsg").innerHTML = "请选择作物种类!";
		   jquery("#myModalYz").modal('show');
		   return false;
	}
	if(breed == "undefined" || breed == "" || breed == null){
		   document.getElementById("productMsg").innerHTML = "请选择作物品种!";
		   jquery("#myModalYz").modal('show');
		   return false;
	}
	if(minPrice == "undefined" || minPrice ==""){
		   document.getElementById("productMsg").innerHTML = "最低价格不能为空!";
		   jquery("#myModalYz").modal('show');
		   return false;
	}else if(isNaN(minPrice)){
		   document.getElementById("productMsg").innerHTML = "最低价格只能是数字!";
		   jquery("#myModalYz").modal('show');
		   return false;
		}
	if(maxPrice == "undefined" || maxPrice ==""){
		   document.getElementById("productMsg").innerHTML = "最高价格不能为空!";
		   jquery("#myModalYz").modal('show');
		   return false;
	}else if(isNaN(maxPrice)){
		   document.getElementById("productMsg").innerHTML = "最高价格只能是数字!";
		   jquery("#myModalYz").modal('show');
		   return false;
		}
	if(eval(minPrice) > eval(maxPrice)){
		   document.getElementById("productMsg").innerHTML = "最高价格不应小于最低价格!";
		   jquery("#myModalYz").modal('show');
		   return false;
		}
	if(trim(cpjs) == "undefined" || trim(cpjs) =="" || trim(cpjs)=="<br>"){
		   document.getElementById("productMsg").innerHTML = "产品介绍不能为空!";
		   jquery("#myModalYz").modal('show');
		   return false; 
	}

	
	/* var supplyType= jquery('input[name="supplyTypeRadio"]:checked').val();
	if(supplyType==0){ */
		if(jquery('#supply\\:supplyBeginTime').val() == ''){
			document.getElementById("productMsg").innerHTML = "请选择预售开始日期!";
			   jquery("#myModalYz").modal('show');
			   return false;
		}
		if(jquery('#supply\\:supplyEndTime').val() == ''){
			document.getElementById("productMsg").innerHTML = "请选择预售终止日期!";
			   jquery("#myModalYz").modal('show');
			   return false;
		}
		jquery('#supply\\:spotBeginTime').val(jquery('#supply\\:supplyBeginTime').val());
		jquery('#supply\\:spotEndTime').val(jquery('#supply\\:supplyEndTime').val());
	/* }else{
		var myDate = new Date();
		var date = formatDate(myDate,'yyyy-MM-dd');
		if(jquery('#supply\\:spotBeginTime').val() == ''){
			document.getElementById("productMsg").innerHTML = "请选择供货开始日期!";
			jquery("#myModalYz").modal('show');
			return false;
		}else if(jquery('#supply\\:spotBeginTime').val() > date){
			document.getElementById("productMsg").innerHTML = "请修改供货开始日期!";
			jquery("#myModalYz").modal('show');
			return false;
		}
		
		if(jquery('#supply\\:spotEndTime').val() == ''){
			document.getElementById("productMsg").innerHTML = "请选择供货终止日期!";
			jquery("#myModalYz").modal('show');
			return false;
		}else if(jquery('#supply\\:spotEndTime').val() < date){
			document.getElementById("productMsg").innerHTML = "请修改供货终止日期!";
			jquery("#myModalYz").modal('show');
			return false;
		}
		

	} */
	
	
	var date1=null;
	var date2=null;
	if(supplyBeginTime == "undefined" || supplyBeginTime == ""){
		//document.getElementById("productMsg").innerHTML = "请选择供应开始时间!"; 
		//jquery("#myModalYz").modal("show");
		//return false;
	}else{
		date1 = new Date(Date.parse(supplyBeginTime));
	}
	if(supplyEndTime == "undefined" || supplyEndTime == ""){
		//document.getElementById("productMsg").innerHTML = "请选择供应结束时间!"; 
		//jquery("#myModalYz").modal("show");
		//return false;
	}else{
		date2 = new Date(Date.parse(supplyEndTime));
	}
		
    if (null !=date1 && null!=date2 && date1.getTime() > date2.getTime()) {  
		document.getElementById("productMsg").innerHTML = "结束时间不应小于开始时间!"; 
		jquery("#myModalYz").modal("show");
        return false;  
    } 
	if( trim(supplyNum) == "undefined" || trim(supplyNum) =="" ){
		   document.getElementById("productMsg").innerHTML = "供货量不能为空!";
		   jquery("#myModalYz").modal('show');
		   return false;
	}else if(isNaN(supplyNum)){
		   document.getElementById("productMsg").innerHTML = "供货量只能是数字!";
		   jquery("#myModalYz").modal('show');
		   return false; 
		}
// 	if(saleNum == "请填写作物可以出售的产量" || trim(saleNum) == ""){
// 		   jquery("#supply\\:saleNum").val(0);
// 	}else{
	if(trim(saleNum) == "undefined" || trim(saleNum) == ""){
		jquery("#supply\\:saleNum").val(0);
	}
	if(isNaN(saleNum)){
		   document.getElementById("productMsg").innerHTML = "出货量只能是数字!";
		   jquery("#myModalYz").modal('show');
		   return false;
		}
// 	}
	if( trim(surplusNum) == "undefined" || trim(surplusNum) == ""){
		   document.getElementById("productMsg").innerHTML = "剩余量不能为空!";
		   jquery("#myModalYz").modal('show');
		   return false;
	}else if(isNaN(surplusNum)){
		   document.getElementById("productMsg").innerHTML = "剩余量只能是数字!";
		   jquery("#myModalYz").modal('show');
		   return false;
		}
	if(eval(surplusNum) > eval(supplyNum)){
		   document.getElementById("productMsg").innerHTML = "剩余量不应大于供货量!";
		   jquery("#myModalYz").modal('show');
		   return false;
		}
	
    if(saleName == "undefined" || saleName == "" ){
    	 jquery("#supply\\:saleName").val(jquery('#aaa').next().next().find('.pull-left').text());
        }
	var outImg = "";
	jquery("#myframe2").contents().find(".plant_imgbd").each(function(){
		outImg +=jquery(this).attr('src')+",";
		})
	outImg = outImg.substr(0,outImg.length - 1)
// 		alert(outImg);
	jquery("#supply\\:productImage").attr('value',outImg);	
	jquery("#supply\\:unitTypeId").val(jquery("#unitInfo").val());
	jquery("#supply\\:videoId").val(jquery("#video").val());
	/* var supplyType= jquery('input[name="supplyTypeRadio"]:checked').val(); */
	//var supplyArea= jquery('input[name="supplyAreaRadio"]:checked').val();
	var provinceRadio = document.getElementById('supplyAreaFlag');
	var supplyProvince="";
	if(!provinceRadio.checked){
		supplyAreaArr = jquery("#supplyProvince").val();
		if(supplyAreaArr!=null){
			for(var i=0;i<supplyAreaArr.length;i++){
				supplyProvince += supplyAreaArr[i];
				if(i!=(supplyAreaArr.length-1)){
					supplyProvince +=",";
				}
			} 
		}
	}
	if(!provinceRadio.checked &&　jquery("#supplyProvince").val()　==　"-1"){
		 document.getElementById("productMsg").innerHTML = "请选择供应范围!";
		   jquery("#myModalYz").modal('show');
		   return false;
	}
	
	/* jquery("#supply\\:supplyType").val(supplyType); */
	//jquery("#supply\\:supplyArea").val(supplyArea);
	jquery("#supply\\:supplyProvince").val(supplyProvince);
	var checkString="";
	if('请选择'!=jquery("#check").next().find(".btn-default").attr("title")){
		jquery('#supply\\:breedId').val(jquery("#check").next().find(".btn-default").attr("title"));
	}

	jquery('#supply\\:breedId1').val(breed);
	jquery('#supply\\:productRecordId').val(jquery('#lvli').val());

	jquery('input[name=iCheck]').each(function(){
		if(jquery(this).is(':checked')){
			checkString += jquery(this).val() + ",";
		}
	})
	checkString = checkString.substr(0,checkString.length - 1)
		//alert(checkString);
// 		if(checkString == "undefined" || checkString == ""){
// 			document.getElementById("productMsg").innerHTML = "请选择产品属性!"; 
// 			jquery("#myModalYz").modal("show");
// 			return false;
// 			}
	jquery('#supply\\:dicSting').val(checkString);
// 	jquery('#supply\\:standard').val(jquery('#standard').val());	
	jQuery("#login").show();
	return true;
}
function backCheck(){
	document.getElementById("confirmMsg").innerHTML = "是否保存当前供应信息?"; 
	jquery("#confirmModal").modal("show");
}
function submitSave(){
	var pid="#{saleProductInfoHome.saleProductInfo.saleProductInfoId}";
	if(null!=pid && ""!=pid){
		jquery("#supply\\:update").click();
	}else{
		jquery("#supply\\:persist").click();
	}
}
function backList(){
	if("#{saleProductInfoHome.chartOrDetails}"=="0"){
		window.location.href="#{request.contextPath}/supply/SaleProductInfoList.seam?pageNum=#{saleProductInfoHome.pageNum}";
		}
	else{
		window.location.href="#{request.contextPath}/supply/SaleProductChart.seam?";
		}
}
//获取文件名称
function changeFileName(name){
	jQuery("#picture").val(name);
}

function trim(str){ //删除左右两端的空格
    return str.replace(/(^\s*)|(\s*$)/g, "");
}

function submithd(){
	jquery("#check").val(breedSelect);
	jquery('#check').selectpicker({noneSelectedText:"请选择"});
	//jQuery('.selectpicker').selectpicker();
	var mingcheng = jquery('#pinzhong\\:mingcheng').val();
	if(mingcheng == "undefined" || mingcheng == ""){
		document.getElementById("productMsg").innerHTML = "品种名称不能为空!"; 
		jquery("#myModalYz").modal("show");
		return false;
		}
	jquery("#myModal").modal("hide");
	
}

function lvlihd(){
	var service='#{saleProductInfoHome.resumeService}';
	
	if(service!='1'&& service!='3'){
		jQuery('#lvli').attr("disabled","false");
	}else{
		jQuery('.selectpicker').selectpicker();
		jQuery("#lvli").selectpicker("val",'#{saleProductInfoHome.productRecordId}');//进入编辑时取到所选到的履历
	}
	
	jQuery('.selectpicker').selectpicker();
	
	jQuery('#lvli').selectpicker({noneSelectedText:"请选择对应绿色履历"});
	jQuery('#video').selectpicker({noneSelectedText:"请选择作物生长区域对应摄像头"});
	//jquery("#lvli").selectpicker("val",'#{saleProductInfoHome.productRecordId}');//进入编辑时取到所选到的摄像头
	var vi = "#{saleProductInfoHome.saleProductInfo.video.videoId}";
	if(null!=vi && ""!=vi){
		jQuery('#video').selectpicker("val",vi)
	}
}

function clearNoNum(obj,event){
	var keyCode = event.keyCode;
// 	var val = obj.value;
// 	alert(val)
	if (keyCode < 37 || keyCode > 40) {
		if(!(keyCode >=48 && keyCode <=57)){
			obj.value = obj.value.replace(/[^\d.]/g,"");  //清除“数字”和“.”以外的字符  
			obj.value = obj.value.replace(/^\./g,"");  //验证第一个字符是数字而不是. 
			obj.value = obj.value.replace(/\.{2,}/g,"."); //只保留第一个. 清除多余的.   
			obj.value = obj.value.replace(".","$#$").replace(/\./g,"").replace("$#$",".");
		}
		
	}
}

function imageyz(){
	jquery("#imageYz").modal('show');
}

function changeStand(standard){
	var plantId = jquery('#aaa').val();
	
	changeStands(standard,plantId);
}
function standsHuidiao(data){
	
	if(data == 1){
		jquery("#aaaa").css("display","");
		jquery('#dbcp').iCheck('check');
	}else{
		jquery("#aaaa").css("display","none");
		jquery('#dbcp').iCheck('uncheck');
	}
}
function standsHuidiao2(data){
	if(data == 1){
		jquery("#aaaa").css("display","");
	}else{
		jquery("#aaaa").css("display","none");
	}
}


// function addProductimg(){
// 	jquery("#pic\\:imgUrl").val(jquery("#myframPic").contents().find("#imgUrl_id").attr("src","../asset/images/farmingIco15.jpg"));
// 	jquery("#pic\\:contentId").val('');
// 	jquery('#addMyFarming').show();
// }
//]]>
</script>

	
	</ui:define>

</ui:composition>
	