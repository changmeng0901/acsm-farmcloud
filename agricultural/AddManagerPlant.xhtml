<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j"
	template="/layout/template_new.xhtml">
	<ui:define name="head_next">
	<link rel="stylesheet" type="text/css" href="#{request.contextPath}/asset/css/base.css"/>
	<link rel="stylesheet" type="text/css" href="#{request.contextPath}/asset/css/notComplete_plan.css"/>
	<link rel="stylesheet" type="text/css" href="#{request.contextPath}/asset/css/skinBlue.css" />
	<link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/agricultural/easyFarm.css" />
	
	</ui:define>
	<ui:define name="body">
	<!--右边开始-->
            <td valign="top">
  <style>
  body{
  font-size:14px
  }
  .bootstrap-select:not([class*="span"]):not([class*="col-"]):not([class*="form-control"]):not(.input-group-btn){width: 190px;}
   .bootstrap-select.btn-group{float:left;}
   
   .farmPics{float: left; max-width: 640px;}
   .farmingInputs{margin-bottom:10px;}
   .jh .bootstrap-select.btn-group .dropdown-menu.inner{height:280px;}
   .baseWp{margin-bottom:20px;}
  .baseBd_reject{position:relative;}
  .baseBd_reject .reject{position:absolute;right:30px;top:50%;margin-top:-53px;}
    /* 02：农事查看页面   增加语音备注 */
	.voice_tag{
		float:left;
		border-radius:10px;
		height: 20px;
		line-height: 20px;
		padding:0 10px 0 26px;
		font-style: normal;
		font-size:14px;
		font-family: "arial";
		font-weight: bold;
		background: #5cb85c url(#{request.contextPath}/asset/images/icon_voice.png) no-repeat 10px 2px;
		margin-right:5px;
		color: #fff;
		} 
  </style>
   <script type="text/javascript" src="#{request.contextPath}/asset/js/icheck.js"></script>
            #{operateHome.initManagerPlant()}
            #{operateHome.initPlantList()}
            #{operateHome.initFarmerList()}
            #{operateHome.initTypeList()}
            #{operateHome.initStorageData()}
	<div style="width:100%;">
                <div class="right_c clear">
                	<!-- 公用头部 开始 -->
                	<div class="r_title clear">
                    	<div class="r_t_l fl">生产管理&#160;&gt;&#160;&#160;<font size="3"><s:link view="/agricultural/Manager.xhtml" style="color:black">农事管理</s:link></font></div>
                    </div>
					<!-- 公用头部 结束 -->
                    <!-- 农事管理内容 开始 -->
                    <table width="100%" cellpadding="0" cellspacing="0">
                    	<tr>
                        	<td colspan="2">
                        	
                            <dl class="baseDl_02 clear mt20">
                            	<dt class="fl"><s:div id="jihuaInfo_1">
                                	<p class="font18 fontFamS"><span>#{operateHome.plant.highTunnelInfoId.tunnelName}
                                	#{operateHome.plant.realPlantId.breedBreedId.plant.name}(#{operateHome.plant.realPlantId.breedBreedId.name})</span><strong>#{operateHome.plant.rfidTypeId.name}</strong></p>
                                	<em class="bgPurple_jh">计划</em><em class="bgRed_wwc">未完成</em>
                                	</s:div>
                                </dt>
                            </dl>
                            </td>
                        </tr>
                    	<tr>
                        	<td width="70%" valign="top">
                            <div class="cm_resumeLt pr20 pt20">
                            <!-- 驳回 开始-->
                            	
                            	<a4j:repeat value="#{operateHome.amagiList}" var="amag" >
                            	<div class="baseWp">
                                	<div class="baseHd">
                                    	<h2><img  src="#{request.contextPath}/asset/images/farmingIco22.png" />驳回情况</h2>
                                    </div>
                                    <s:div styleClass="baseBd baseBd_reject">
                                    	<img class="reject" src="#{request.contextPath}/asset/images/icon_reject.png" />
                                    	<table class="baseTable_11" width="100%" cellpadding="0" cellspacing="0">                                    	                                   	
                                    		<tr>
                                                <td colspan="2">
                                                	<p class="personName02" style="text-align:left;"><img src="#{request.contextPath}/asset/images/farmingIco26.png" />操作人：
                                                	<a4j:repeat value="#{amag.farList2}" var="var"><span class="operateStr" aa="#{var[0]}">#{var[1]}</span></a4j:repeat></p>
                                                </td>
                                            </tr>
                                        	<tr>
                                            	<td colspan="2">
                                                	<dl class="baseDl_02 clear">
                                                        <dd class="fl">
                                                            <span>#{dateUtil.getDateFormat(amag.operatingTime,'MM-dd HH:mm')}</span><span>#{amag.work_time}小时完成</span>
                                                        </dd>
                                                    </dl>
                                                </td>
                                            </tr>
                                            <tr style="#{amag.airTemp eq null or amag.airTemp eq ''?'display:none;':''}">
                                            	<td width="51" valign="middle"  align="right" style="padding-right:15px;">空气温度</td>
                                                <td valign="top">#{amag.airTemp}℃</td>
                                            </tr>
                                            <tr style="#{amag.airHumi eq null or amag.airHumi eq ''?'display:none;':''}">
                                            	<td width="51" valign="middle"  align="right" style="padding-right:15px;">空气湿度</td>
                                                <td valign="top">#{amag.airHumi}%</td>
                                            </tr>
                                            <tr style="#{amag.description eq null or amag.description eq ''?'display:none;':''}">
                                            	<td width="51" valign="middle"  align="right" style="padding-right:15px;">备&#160;&#160;&#160;&#160;&#160;&#160;&#160;注</td>
                                                <td valign="top">#{amag.description}</td>
                                            </tr>
                                            <tr style="#{amag.picList2.size() eq 0?'display:none;':''}">
                                            	<td width="51" valign="middle"  align="right" style="padding-right:15px;">农事图片</td>
                                                <td valign="top">
                                                	<ul class="farmingMage_pics2">
                                                    	<a4j:repeat value="#{amag.picList2}" var="_var"  rowKeyVar="row">
                                                    	<li>
                                                            <a href="javascript:;">
                                                            <h:panelGroup rendered="#{_var.imgWidth==null || _var.imgHeight==null || _var.imgWidth=='' || _var.imgHeight==''}">
                                                            	<img src="#{_var.pictureUrl}@40w_40h_1e_1c.src"  wi="#{_var.imgWidth}" he="#{_var.imgHeight}"/>
                                                            </h:panelGroup>
                                                            <h:panelGroup rendered="#{_var.imgWidth!=null &amp;&amp; _var.imgHeight!=null &amp;&amp; _var.imgWidth!='' &amp;&amp; _var.imgHeight!=''}">
                                                            	<h:panelGroup rendered="#{_var.minPictureUrl==null || _var.minPictureUrl==''}">
                                                            		<img src="#{_var.pictureUrl}@40w_40h_1e_1c.src" wi="#{_var.imgWidth}" he="#{_var.imgHeight}"/>
                                                            	</h:panelGroup>
                                                            	<h:panelGroup rendered="#{_var.minPictureUrl!=null &amp;&amp; _var.minPictureUrl!=''}">
                                                            		<img src="#{_var.minPictureUrl}@40w_40h_1e_1c.src"  wi="#{_var.imgWidth}" he="#{_var.imgHeight}"/>
                                                            	</h:panelGroup>
                                                            </h:panelGroup>
                                                            </a>
                                                            <div class="farmingMage_Magnifier2" style="position: fixed;z-index:1000;width:auto;height:auto;    margin-left: auto;    margin-top: auto;">
                                                            	<em class="MagnifierClose2" style="z-index: 1"><img src="#{request.contextPath}/asset/images/farmingIco05.png" width="28" height="28" /></em>
                                                                <div class="MagnifierBox"><img  id="zoomId" src="#{_var.pictureUrl}" />
                                                                <div class="mask">
                                                                <h:panelGroup rendered="#{_var.dateTime !=null}">
                                                               		<div class="fl mr20"><span> 拍摄时间：</span><span>#{_var.dateTime}</span></div>
                                                                </h:panelGroup>
                                                               	<h:panelGroup rendered="#{_var.model !=null}">
                                                               		<div class="fl mr20"><span>相机：</span><span>#{_var.model}</span></div>
                                                               	</h:panelGroup>
                                                               	<h:panelGroup rendered="#{_var.fnumber !=null}">
                                                               		<div class="fl mr20"><span>光圈：</span><span>#{_var.fnumber}</span></div>
                                                               	</h:panelGroup>
                                                               	<h:panelGroup rendered="#{_var.lensModel !=null}">
                                                               		<div class="fl mr20"><span>镜头：</span><span>#{_var.lensModel}</span></div>
                                                               	</h:panelGroup>
                                                               	<h:panelGroup rendered="#{_var.focalLength !=null}">
                                                               		<div class="fl mr20"><span> 焦距：</span><span>#{_var.focalLength}</span></div>
                                                               	</h:panelGroup>
                                                               	<h:panelGroup rendered="#{_var.iso !=null}">
                                                               	 	<div class="fl mr20"><span>ISO：</span><span>#{_var.iso}</span></div>
                                                               	</h:panelGroup>
                                                               	<h:panelGroup rendered="#{_var.exposureTime !=null}">
                                                               		<div class="fl mr20"><span>曝光时间：</span><span>#{_var.exposureTime}</span></div>
                                                               	</h:panelGroup>
                                                               		<h:panelGroup rendered="#{_var.longitude !=null &amp;&amp; _var.longitude !=(null) &amp;&amp; _var.longitude !=''}">
                                                               	<div class="fl mr20"><span>经度：</span><span>#{_var.longitude}</span></div>
                                                               	</h:panelGroup>
                                                               	<h:panelGroup rendered="#{_var.latitude !=null &amp;&amp; _var.latitude !=(null) &amp;&amp; _var.latitude !=''}">
                                                               		<div class="fl mr20"><span>纬度：</span><span>#{_var.latitude}</span></div>
                                                               	</h:panelGroup>
                                                                </div>
                                                        	
                                                                </div>
                                                            </div>
                                                        </li>
                                                    </a4j:repeat>
                                                    </ul>
                                                </td>
                                            </tr>
                                            <tr style="#{amag.inpList2.size() eq 0?'display:none;':''}">
                                            	<td width="51" valign="middle"  align="right" style="padding-right:15px;">投&#160;&#160;入&#160;&#160;品</td>
                                                <td valign="top">
                                                	<ul class="farmingMage_pics3">
                                                    	<a4j:repeat value="#{amag.inpList2}" var="var" >
                                                    	<ui:fragment rendered="#{!var.deleted}">
                                                           	<li>
	                                                        	<s:fragment rendered="#{var.inputsInfoId.packingImagesUrl eq null or var.inputsInfoId.packingImagesUrl eq ''}"><img src="#{request.contextPath}/asset/images/inputs/tourupin.jpg" width="128" height="128" /></s:fragment>
	                                                            <s:fragment rendered="#{var.inputsInfoId.packingImagesUrl ne null and var.inputsInfoId.packingImagesUrl ne ''}"><img src="#{var.inputsInfoId.packingImagesUrl}" width="128" height="128" /></s:fragment>
	                                                            <h3>#{var.inputsInfoId.name} #{var.amount}#{var.inputsInfoId.unitInfo.name}</h3>
	                                                        </li>                                                	
                                                        </ui:fragment>
                                                    	</a4j:repeat>
                                                    </ul>
                                                </td>
                                            </tr>
                                            <tr style="display: #{amag.soundsList.size() &gt; 0?'':'none;'}">
                                            	<td width="70" valign="middle"  align="right" style="padding-right:15px;">语音备注：</td>
                                                <td valign="top">
	                                                <div style="overflow:hidden;padding:10px 0;">
												         <a4j:repeat value="#{amag.soundsList}" var="sound_">
                                               			 	<p class="voice_tag" sound_src='#{sound_[1]}' onclick="audioPlay(this)" style="cursor: pointer;">#{sound_[0]}"</p> 
                                               			 </a4j:repeat>
												    </div>
                                            	</td>
                                            </tr>
                                            <tr>
                                            	<td colspan="2" align="right">
                                            		<div class="fl" style="color:#ffbb00;">
	                                            		<p style="display:inline-block;padding-right:30px;">驳回人：#{amag.rejectUserId.nickname}</p>  
	                                            		<p style="display:inline-block;">驳回时间：#{dateUtil.getDateFormat(amag.rejectDatetime,'yyyy-MM-dd HH:mm')}</p>
                                            		</div>
                                            		<div class="fr">
	                                                	<p class="release_info">
	                                                	<em >发布人：#{amag.insertUser.nickname}</em>
	                                                	<span>#{dateUtil.getDateFormat(amag.insertTime,'MM-dd HH:mm')}</span>
	                                                	<span>来自#{amag.sourceType==null||amag.sourceType==0||amag.sourceType==1?"网站":""}#{amag.sourceType==2?"手机":""}#{amag.sourceType==3?"农事终端":""}</span></p>
                                                	</div>
                                                </td>
                                            </tr>
                                        </table>
                                         
                                    </s:div>
                                </div>
                                </a4j:repeat>
                            	<!-- 驳回 结束-->
                            
                            	<!-- 完成情况 开始 -->
                            	<h:form id="agr">
                            		<div class="modal-header clear" style="padding: 0px;">
                            			<div class="baseWp" style="height:auto;">
											<div class="baseHd">
		                                    	<h2><img  src="#{request.contextPath}/asset/images/farmingIco22.png" />填写完成情况</h2>
		                                    </div>
							       			<div class="baseBd farmRecord farmNs clear" style="min-width:730px; padding-top:20px;height:auto;width:100%;position: initial; margin-left: 0px;">
					                    		<div class="choice ns" style="display:#{operateHome.enterpriseSettings.farmerChecked?'block;':'none;'}" dis="#{operateHome.enterpriseSettings.farmerChecked}">
						                        	<p class="item">操作人</p>
						                        	<input type="hidden" style="display: none;"  id="record_tunnel" name="record_tunnel" value="#{operateHome.plant.realPlantId.realPlantId}"/>	
		                                            <select style="display: none;" class="selectpicker" multiple="multiple" data-live-search="true" id="record_name" name="record_name">
		                                            	<a4j:repeat value="#{operateHome.farmerList}" var="var">
		                                     				<option value="#{var[0]}">#{var[1]}</option>
		                                    			</a4j:repeat>
		                                        	</select>
						                    	</div>
												<div class="choice ns">
							                        <p class="item">操作时间</p>
							                        <div class="input-append date form_datetime record_date" >
		                                            	<input size="26" type="text" value="" readonly="readonly"  style="text-indent: 0px;" id="record_date" name="record_date"/>
		                                                <span class="add-on"><i class="icon-th"></i></span>
		                                        	</div>
							                    </div>
							                    <div class="choice ns" style="display:#{operateHome.enterpriseSettings.workTimeChecked?'block;':'none;'}" dis="#{operateHome.enterpriseSettings.workTimeChecked}">
							                        <p class="item">工时</p>
							                        <input class="form-control nw130"  id="record_time" name="record_time"  type="text"/>
							                        <p class="unit">小时</p>
							                        <p class="unit" style="color:red;">*</p>
							                    </div>
							                    <div class="choice ns" style="display:#{operateHome.enterpriseSettings.environmentChecked?'block;':'none;'}" dis="#{operateHome.enterpriseSettings.environmentChecked}"> 
							                        <p class="item">环境温度</p>
							                       <input class="form-control nw130"  id="record_temp" name="record_temp" type="text"/>
							                        <p class="unit">℃</p>
							                    </div>
							                    <div class="choice ns" style="display:#{operateHome.enterpriseSettings.environmentChecked?'block;':'none;'}" dis="#{operateHome.enterpriseSettings.environmentChecked}">
							                        <p class="item">环境湿度</p>
							                        <input class="form-control nw130"  id="record_humi" name="record_humi" type="text"/>
							                        <p class="unit">%</p>
							                    </div>
							                    <div class="tup clear">
							                    	<div class="choice ns" style="margin-bottom: 0px;">
							                        	<p class="item farmHeight">农事图片</p>
							                        	<div class="farmPics">
								                        	<h:panelGroup id="picId">
			                                                	<a4j:repeat value="#{operateHome.farmingPicList}" var="var" id="farmingPicList" rowKeyVar="row">
				                                                	<div class="farmingInputs fl">
				                                                    	<a class="farmingInputs_pic" href="javascript:;"><img src="#{var[0]}" width="128" height="128" /></a>
				                                                        <em class="closeInputs" onclick="delfarmingPic(this,#{row})"><img src="#{request.contextPath}/asset/images/clo_04.jpg" /></em>
				                                                    </div>
				                                                </a4j:repeat>
			                                                	<input type="button" class="farmingInputs_add3" data-target="#addMyFarming" data-toggle="modal" style="margin-bottom:25px;float:none;" onclick="addFarming()"></input>
			                                                </h:panelGroup>
							                        	</div>
							                   		</div> 
							                        <div class="choice ns" style="margin-bottom: 0px;display:#{operateHome.enterpriseSettings.inputsInfoChecked?'block;':'none;'}" >
							                            <p class="item farmHeight">投入品</p>
							                            <div class="farmPics">
						                            		<s:div id="farmingInputs_wp" styleClass="farmingInputs_wp">
				                                              	<a4j:repeat value="#{operateHome.inpList2}" var="var" id="recordList" rowKeyVar="row">
				                                              		<ui:fragment rendered="#{!var.deleted}">
				                                               		<div class="farmingInputs fl">
				                                                       	<a class="farmingInputs_pic" href="javascript:;">
				                                                       	<s:fragment rendered="#{var.inputsInfoId.packingImagesUrl eq null or var.inputsInfoId.packingImagesUrl eq ''}"><img src="#{request.contextPath}/asset/images/inputs/tourupin.jpg" width="128" height="128" /></s:fragment>
				                                                      	    <s:fragment rendered="#{var.inputsInfoId.packingImagesUrl ne null and var.inputsInfoId.packingImagesUrl ne ''}"><img src="#{var.inputsInfoId.packingImagesUrl}" width="128" height="128" /></s:fragment>
				                                                       	<p>#{var.inputsInfoId.name} #{var.amount}#{var.inputsInfoId.unitInfo.name}</p>
				                                                       	</a>
				                                                           <em class="closeInputs" onclick="delRecordList(this,#{var.id_index})"><img src="#{request.contextPath}/asset/images/clo_04.jpg" /></em>
				                                                       </div>                                                                		
				                                                      </ui:fragment>
				                                              	</a4j:repeat>
			                                                    <div class="farmingInputs_add" style="position:static;">
			                                                    	<input type="button" class="farmingInputs_add3" style="margin-bottom:25px;" onclick="addRecord_1()"></input>
			                                         			</div>
			                                               </s:div>
			                                        	</div>
							                        </div> 
							                    </div>
							                    <div class="choice" style="display:#{operateHome.enterpriseSettings.inputsInfoChecked?'block;':'none;'}">
							                        <p class="item">农资成本</p>
							                        <s:div id="nsInputsCost">
							                        	<p class="unit" id="nsInputsCostVal">
							                        		<h:outputText value="#{operateHome.nsInputsCost}" ><f:convertNumber pattern="#.##"/></h:outputText>元
							                        	</p>
							                        </s:div>
							                    </div>
							                    <div class="choice ns" style="display:#{operateHome.enterpriseSettings.costChecked?'block;':'none;'}" dis="#{operateHome.enterpriseSettings.costChecked}">
							                        <p class="item">其他成本</p>
							                        <input type="text" class="form-control nw130" id="record_costing" name="record_costing"/>
							                        <p class="unit">元</p>
							                    </div>
				                    			<div class="choice ns" style="width:100%;">
				                        			<p class="item">备注</p>
				                        			<textarea id="record_remark" name="record_remark" class="form-control" rows="3"></textarea>
				                    			</div>
				                  			</div>
				                  			<div class="modal-footer">
						                    	<s:button value="返回" view="/agricultural/Manager.xhtml" styleClass="btn btn-default fr"/>
			                                    <h:commandButton id="hidFinAgrBtn" style="display:none" styleClass="btn btn-success fr mr5" action="#{operateHome.saveAgricultural}" value="提交"/>
			                                    <a4j:commandButton styleClass="btn btn-success fr mr5" value="提交" onclick="if(!checkAgr())return false;"/>
			                                </div>
                               			</div>
                                	</div>
                                </h:form>
                                <!-- 完成情况 结束 -->
                                <div style="height:130px;"></div>
                            </div>
                            </td>
                            <td width="30%" valign="top" style="min-width:270px;">
                            <div class="cm_resumeRt" style="min-width:270px;">
                            <!-- 农事管理内容 右侧 开始 -->
                                <!-- 农事计划 开始 -->
                                <div class="baseWp mt20">
                                	<div class="baseHd farmmingAdd">
                                    	<h2><img  src="#{request.contextPath}/asset/images/farmingIco25.png" />农事计划</h2>
                                        <input value="编辑" class="btn btn-default btn-xs fr" onclick="editRecord()" type="button" data-toggle="modal" data-target="#myModal5" style="padding:3px 12px; margin-top:5px;"/>
                                    </div>
                                    <a4j:outputPanel id="jihuaInfo">
	                                    <script type="text/javascript">
		                                    function resetInfo(){
		                                    	jquery("#record_tunnel").val('#{operateHome.plant.realPlantId.realPlantId}');
		                                    	jquery("#record_tunnel2").selectpicker("val",'#{operateHome.plant.realPlantId.realPlantId}');
		                                    	jquery("#record_operate2").selectpicker('val','#{operateHome.plant.rfidTypeId.id}');
		                                    	if(jquery("#record_operate2").val()==null){
		                                    		jquery("#record_operate2")[0].selectedIndex=0;
		                                    		jquery("#record_operate2").selectpicker("refresh");
		                                    	}
		                                    	var v = new Array();
		                                    	jquery(".operateStrjh").each(function(){
		                                    		v.push(jquery(this).attr("aa"));
		                                    	})
		                                    	jquery("#record_name2").selectpicker("val",v);
		                                    	var d = new Date();
		                                    	jquery("#record_date2").val("#{dateUtil.getDateFormat(operateHome.plant.operatingTime,'yyyy-MM-dd')}");
		                                    	jquery("#record_time2").val('#{operateHome.plant.work_time}');
		                                    	jquery("#record_remark2").val('#{operateHome.plant.description}');
		                                    	jquery('.record').modal('show')
		                                    }
	                                    </script>
                                    <div class="baseBd">
                                    	<div style="border-bottom:1px solid #ddd-;">
                                        <table class="baseTable_11" width="100%" cellpadding="0" cellspacing="0">
                                        	<tr>
                                                <td colspan="2">
                                                	<p class="personName02" style="color:#848484;"><img src="#{request.contextPath}/asset/images/farmingIco26.png" />操作人：
                                                	<a4j:repeat value="#{operateHome.farList}" var="var"><span class="operateStr operateStrjh" aa="#{var[0]}">#{var[1]}</span></a4j:repeat></p>
                                                </td>
                                            </tr>
                                            <tr>
                                            	<td colspan="2" style="border-bottom: 1px solid #ddd;">
                                                	<dl class="baseDl_02 clear">
                                                        <dd class="fl">
                                                            <span>#{dateUtil.getDateFormat(operateHome.plant.operatingTime,'MM-dd')}</span><span>#{operateHome.plant.work_time}小时完成</span>
                                                        </dd>
                                                    </dl>
                                                </td>
                                            </tr>
                                        	 <tr style="display: #{operateHome.plant.soundsList.size() &gt; 0?'':'none;'}">
                                                <td width="60" align="right" style="padding-right:10px;padding-top:20px;">语音备注：</td>
                                                 <td style="padding-top:20px;">
                                               		<a4j:repeat value="#{operateHome.plant.soundsList}" var="sound_">
                                             				<p class="voice_tag" sound_src='#{sound_[1]}' onclick="audioPlay(this)" style="cursor: pointer;">#{sound_[0]}"</p> 
                                             			</a4j:repeat>
                                                </td>
                                            </tr>
                                        </table>	
                                        </div>
                                        <div class="">
                                    	<table class="baseTable_11 color6464" width="100%" cellpadding="0" cellspacing="0">
                                        	<tr style="#{operateHome.plant.description==null||operateHome.plant.description==''?'display:none':''}">
                                                <td>备注：#{operateHome.plant.description}</td>
                                            </tr>
                                            <tr style="#{empty operateHome.inpList?'display:none':''}">
                                                <td>投入品</td>
                                            </tr>
                                            <tr style="#{empty operateHome.inpList?'display:none':''}">
                                                <td>
                                                	<ul class="farmingMage_pics3">
                                                    	<a4j:repeat value="#{operateHome.inpList}" var="var">
                                                    	<li>                                                       	
	                                                    	<s:fragment rendered="#{var.inputsInfoId.packingImagesUrl eq null or var.inputsInfoId.packingImagesUrl eq ''}"><img src="#{request.contextPath}/asset/images/inputs/tourupin.jpg" width="128" height="128" /></s:fragment>
	                                                        <s:fragment rendered="#{var.inputsInfoId.packingImagesUrl ne null and var.inputsInfoId.packingImagesUrl ne ''}"><img src="#{var.inputsInfoId.packingImagesUrl}" width="128" height="128" /></s:fragment>
                                                            <h3>#{var.inputsInfoId.name} #{var.amount}#{var.inputsInfoId.unitInfo.name}</h3>
                                                        </li>
                                                    </a4j:repeat>
                                                    </ul>
                                                </td>
                                            </tr>
                                            <tr>
                                            	<td align="right">
                                                	<p class="release_info"><em>发布人：#{operateHome.plant.insertUser.nickname}</em>
                                                	<span style="padding-left:5px">#{dateUtil.getDateFormat(operateHome.plant.insertTime,'MM-dd HH:mm')}</span>
                                                	<span style="padding-left:5px">来自#{operateHome.plant.sourceType==null||operateHome.plant.sourceType==0||operateHome.plant.sourceType==1?"网站":""}#{operateHome.plant.sourceType==2?"手机":""}#{operateHome.plant.sourceType==3?"农事终端":""}</span>
                                                	</p>
                                                </td>
                                            </tr>
                                        </table>
                                        </div>
                                    </div>
                                    
                                    </a4j:outputPanel>
                                </div>
                                <!-- 农事计划 结束 -->
                            <!-- 农事管理内容 右侧 结束 -->
                            </div>
                            </td>
                        </tr>
                    </table>
                    <!-- 农事管理内容 结束 -->
					
                </div><!--right_c结束-->
            </div>            
           <div class="modal fade record" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="z-index:100">
                                      <div class="modal-dialog farmRecord" id="addJihua">
							                	<div class="modal-content">
							                		<a4j:form ajaxSubmit="true" id="agr2">
							                  			<div class="modal-header">
	                                                    	<input type="button" class="close" data-dismiss="modal"> </input>
                                                    		<h4 class="modal-title font14" id="myModalLabel">编辑农事计划</h4>
	                                                    </div>
							                  			<div class="modal-body clear" style="height:auto;max-height: 423px;#{operateHome.enterpriseSettings.inputsInfoChecked?'overflow:auto;':'overflow:inherit;'}">
							                    			<div class="choice jh">
										                        <p class="item">区域</p>
										                        	<select style="display: none;" class="selectpicker" id="record_tunnel2" name="record_tunnel2"  data-live-search="true" onchange="tunnelValue()">
                                                                        <option value="" disabled="disabled">正在种植</option>
	                                                                    <a4j:repeat value="#{operateHome.plantList}" var="var">
                                                                        	<h:panelGroup rendered="#{var[12]=='realPlant'}">
	                                                                        	<option value="#{var[0]}" va="#{var[0]}" fa="#{var[10]}">&#160;#{var[2]}--#{var[4]}(#{var[3]})-#{var[8]}</option>
	                                                                    	</h:panelGroup>
	                                                                     </a4j:repeat>
                                                                        <option value="" disabled="disabled">计划种植</option>
                                                                        <a4j:repeat value="#{operateHome.planPlantList}" var="var">
	                                                                        <h:panelGroup rendered="#{var[12]=='realPlant'}">
	                                                                        	<option value="#{var[0]}" va="#{var[0]}" fa="#{var[10]}">&#160;#{var[2]}--#{var[4]}(#{var[3]})-#{var[8]}</option>
	                                                                       	</h:panelGroup>
                                                                        </a4j:repeat>
                                                                    </select>
										                    </div>
										                    <div class="choice" style="display:#{operateHome.enterpriseSettings.farmerChecked?'block;':'none;'}" dis2="#{operateHome.enterpriseSettings.farmerChecked}">
										                        <p class="item">操作人</p>
										                        <select style="display: none;" class="selectpicker" multiple="multiple" data-live-search="true" id="record_name2" name="record_name2">
                                                    					<a4j:repeat value="#{operateHome.farmerList}" var="var">
                                                    					<option value="#{var[0]}">#{var[1]}</option>
                                                    					</a4j:repeat>
                                                                </select>
										                    </div>
										                    <div class="choice">
										                        <p class="item">操作内容</p>
										                   		<s:div id="refreshOlist_" styleClass="jh">
                                                                	<select class="selectpicker" style="display: none;" id="record_operate2" name="record_operate2" data-live-search="true">
                                                                    <a4j:repeat value="#{operateHome.allTypeList}" var="var">
                                                                    <option value="#{var[0]}">#{var[1]}</option>
                                                                    </a4j:repeat>
                                                                    </select></s:div>
                                                                    <input type="button" class="farmingInputs_add2" onclick="jquery('#o_name_1').val('');jquery('#o_remark_1').val('');jquery('#add_operate2').show();"/>
                                                            </div>
										                    <div class="choice" style="display:#{operateHome.enterpriseSettings.workTimeChecked?'block;':'none;'}" dis2="#{operateHome.enterpriseSettings.workTimeChecked}">
										                        <p class="item">工时</p>
                                                                	<input class="form-control fl" style="width:108px; margin-right:5px;" type="text" id="record_time2" name="record_time2"/>
										                        <p class="unit">小时</p>
										                        <p class="unit" style="color:red;">*</p>
										                    </div>
										                    <div class="choice">
										                        <p class="item">操作时间</p>
			                                                    <div class="input-append date form_datetime record_date2" >
	                                                                <input size="26" type="text" value="" readonly="readonly" id="record_date2" name="record_date2" style="text-indent: 0px;"/>
	                                                                <span class="add-on"><i class="icon-th"></i></span>
                                                                </div>
										                    </div>
										                    <div class="tup clear">
										                        <div class="choice" style="margin-bottom: 0px;display:#{operateHome.enterpriseSettings.inputsInfoChecked?'block;':'none;'}" dis2t="#{operateHome.enterpriseSettings.inputsInfoChecked}">
										                            <p class="item farmHeight">投入品</p>
										                            <div class="farmPics">
										                            	<s:div id="farmingInputs_wp2" styleClass="farmingInputs_wp">
		                                                                	<a4j:repeat value="#{operateHome.inpList}" var="var" id="recordList" rowKeyVar="row">
		                                                                	<ui:fragment  rendered="#{!var.deleted}">                                                              	
			                                                                	<div class="farmingInputs fl">
		                                                                        	<a class="farmingInputs_pic" href="javascript:;">
		                                                                        	<s:fragment rendered="#{var.inputsInfoId.packingImagesUrl eq null or var.inputsInfoId.packingImagesUrl eq ''}"><img src="#{request.contextPath}/asset/images/inputs/tourupin.jpg" width="128" height="128" /></s:fragment>
			                                                                       	<s:fragment rendered="#{var.inputsInfoId.packingImagesUrl ne null and var.inputsInfoId.packingImagesUrl ne ''}"><img src="#{var.inputsInfoId.packingImagesUrl}" width="128" height="128" /></s:fragment>
		                                                                        	<p>#{var.inputsInfoId.name} #{var.amount}#{var.inputsInfoId.unitInfo.name}</p>
		                                                                        	</a>
		                                                                            <em class="closeInputs" onclick="delRecordList2(this,#{var.id_index})"><img src="#{request.contextPath}/asset/images/clo_04.jpg" /></em>
		                                                                        </div>
		                                                                    </ui:fragment>
		                                                                	</a4j:repeat>
		                                                                        <div class="farmingInputs_add" style="position:static;">
		                                                                        	<input type="button" class="farmingInputs_add3" style="margin-bottom:25px;" onclick="addRecord()"></input>
		                                                           				</div>
		                                                                    </s:div>
	                                                                </div>
										                        </div> 
										                    </div>
										                    <div class="choice" style="display:#{operateHome.enterpriseSettings.inputsInfoChecked?'block;':'none;'}">
										                        <p class="item">农资成本</p>
										                        <s:div id="jhInputsCost">
										                        	<p class="unit" id="jhInputsCostVal"><h:outputText value="#{operateHome.inputsCost}" ><f:convertNumber pattern="#.##"/></h:outputText>元</p>
										                        </s:div>
										                    </div>
										                    <div class="choice" style="display:#{operateHome.enterpriseSettings.costChecked?'block;':'none;'}" dis2="#{operateHome.enterpriseSettings.costChecked}">
										                        <p class="item">其他成本</p>
										                        <input type="text" class="form-control nw130" id="record_costing2" name="record_costing2"/>
										                        <p class="unit">元</p>
										                    </div>
							                    			<div class="choice" style="width:100%;">
							                        			<p class="item">备注</p>
                                                                	<textarea class="form-control" style="width:249px; resize:none; font-size:12px;" rows="3" id="record_remark2" name="record_remark2"></textarea>
							                    			</div>
							                  			</div>
							                  			<div class="modal-footer">
									                    	<a4j:commandButton id="hidEditAgrBtn" style="display:none;" styleClass="btn btn-success" action="#{operateHome.saveAgriculturalPlant()}" value="提交"  oncomplete="resetInfo();jquery('#myModal').modal('hide');jquery('#login').hide();" reRender="jihuaInfo,jihuaInfo_1"></a4j:commandButton>
		                                                    <a4j:commandButton styleClass="btn btn-success"  value="提交" onclick="if(!checkAgr2())return false;"></a4j:commandButton>
		                                                    <input class="btn btn-default" type="button" value="返回" onclick="jquery('#myModal').modal('hide')"></input>
                                                    	</div>
                                                   	</a4j:form>
							                  	</div>
							                </div>      
                                            
                                            <div class="farmingInputs_mini modal-dialog" id="addInputRecord" style="z-index:101;position:absolute; left:50%; top:65px; width:828px; margin-left:-414px; ">
                                                 <a4j:form ajaxSubmit="true" id="record_" autocomplete="on">
                                                     <div class="farmingInputs_miniHd"><h3>添加投入品</h3><input type="button" class="butt" onclick="jquery('#addInputRecord').hide()"/></div>
                                                          <div class="farmingInputs_miniBd" style="padding:0;">
                                                              <div class="box_padding20">
	                                                              <div id="iradio-InputProductInfo">
                                                                      <!-- 投入品搜索 -->
                                                                      <div class="farminputs_search clear">
                                                                           	<div class="public-search">
																				<span class="octicon-search02"></span>
																					<input class="form-control nw300 srarchfont" id="searchInputText" type="text" value="请输入查询内容" onfocus="FocusFn(this,'#333','请输入查询内容')" onblur="BlurFn(this,'#a8a8a8','请输入查询内容')"></input>
																			</div>
																			<p class="txt_name fl">投入品类型</p>
																			<div class="inputs_selectpicker">
																				<select class="selectpicker" id="inputType">
	                                                                                  <option value="2">农药</option>
	                                                                                  <option value="3">肥料</option>
	                                                                                  <option value="5">种子</option>
	                                                                                  <option value="4">其他</option>
                                                                                 </select>
                                                                             </div>
                                                                              <input type="button" class="btn btn-primary fl" onclick="searchInputs(1);" value="搜索"/>
                                                                      </div>
                                                                      <!-- 投入品表格上 -->
	                                                                   <h:panelGroup id="recordInputList">
                                                                       <div class="inputs_table" id="inputs_table">
                                                                            <table width="100%" cellpadding="0" cellspacing="0" id="inputsTable">
                                                                                <tr>
                                                                                	<th width="30" class="br_bt br_rt radius_lt"><span id="mn_checkall" class="mn_checkall" onclick="OutputCheckAll(this,'#inputs_table')"></span></th>
                                                                                	<th width="164" class="br_bt br_rt">投入品编号</th>
                                                                                	<th width="170" class="br_bt br_rt">投入品名称</th>
                                                                                	<th width="176" class="br_bt br_rt">投入品规格</th>
                                                                                	<th class="br_bt radius_lt">生产厂家</th>
                                                                                </tr>
                                                                                <a4j:repeat value="#{operateHome.goodsInfoList}" var="var">
                                                                                 <tr id="trp_#{var[0]}">
                                                                                 	<td class="br_bt br_rt"><span class="mn_check" id="check_#{var[0]}" onclick="OutputCheck(this,'#inputs_table','#mn_checkall','#{var[0]}')"></span>
                                                                                 		<input type="hidden" value="#{var[0]}"/>
                                                                                 		<input type="hidden" value="#{var[9]}"/>
                                                                                 	</td>
                                                                                 	<td class="br_bt br_rt"><p class="ellipsis">#{var[11]}</p></td>
                                                                                 	<td class="br_bt br_rt"><p class="ellipsis">#{var[1]}</p> </td>
                                                                                 	<td class="br_bt br_rt"><p class="ellipsis">#{var[5]}#{var[10]}<s:fragment rendered="#{not empty var[7]}">/#{var[7]}</s:fragment></p></td>
                                                                                 	<td class="br_bt"><p class="ellipsis">#{var[8]}</p></td>
                                                                                 </tr>
                                                                                </a4j:repeat>
                                                                             </table>
                                                                       </div>
                                                                        <!-- 分页 开始 -->
																	    <table class="pageModel-wap fr" cellpadding="0" cellspacing="0">
																	        <tr>
																	            <td>
																	                <div style="width:auto;">
																	                    <table class="pageModel" cellpadding="0" cellspacing="0">
																	                        <tr>
																	                            <td>
																	                            	<s:fragment rendered="#{operateHome.inputsPageNum ne 1 and operateHome.inputsTotalPageNum gt 0}">
																	                            		<span class="page_num"><a id="lastPage" href="javascript:inputsJump(1);">首页</a></span>
																		                            	<span class="page_num"><a href="javascript:inputsJump(#{operateHome.inputsPageNum-1});">&lt;&lt;</a></span>
																		                            </s:fragment>
																		                            <a4j:repeat value="#{operateHome.inputsPageList}" var="_page">
																		                            	<span class="page_num #{operateHome.inputsPageNum eq _page? 'page_Cur':''}"><a href="javascript:inputsJump(#{_page});">#{_page}</a></span>
																		                            </a4j:repeat>
																		                            <s:fragment rendered="#{operateHome.inputsPageNum ne operateHome.inputsTotalPageNum and operateHome.inputsTotalPageNum gt 0}">
																		                            	<span class="page_num"><a href="javascript:inputsJump(#{operateHome.inputsPageNum+1});">&gt;&gt;</a></span>
																		                            	<span class="page_num"><a id="lastPage" href="javascript:inputsJump(#{operateHome.inputsTotalPageNum});">尾页</a></span>
																		                            </s:fragment>																						                               
																	                                <span class="page_num pageCount page_last" style="border-right:0;"><a href="javascript:;" style="cursor:default;">共#{operateHome.inputsTotalPageNum}页</a></span>
																	                             </td>
																	                    	</tr>
																	                    </table>
																	                </div>
																	            </td>
																	        </tr>
																	    </table>
																	</h:panelGroup>
																</div>
                                                             </div>
														    <!-- 投入品表格下 -->
														    <div class="box_padding20 br_dd mb20 clear">
														    	<div class="inputs_table mt20">
                                                                   	<table width="100%" cellpadding="0" cellspacing="0" id="addInputsTable">
                                                                        <tr>
                                                                        	<th width="40" class="br_bt br_rt radius_lt">序号</th>
                                                                        	<th width="80" class="br_bt br_rt">投入品名称</th>
                                                                        	<th width="80" class="br_bt br_rt">规格</th>
                                                                        	<th width="60" class="br_bt br_rt">使用量</th>
                                                                        	<th width="60" class="br_bt br_rt">成本</th>
                                                                        	<th width="120" class="br_bt br_rt">出库</th>
                                                                        	<th width="150" class="br_bt br_rt">入库批次</th>
                                                                        	<th width="90" class="br_bt br_rt">经办人</th>
                                                                        	<th width="50" class="br_bt br_rt">库存量</th>
                                                                        	<th class="br_bt radius_lt">操作</th>
                                                                        </tr>
                                                                    </table>
                                                                 </div>
														    </div>
													</div>                                                                               
                                                 	<div class="farmingInputs_miniFt">                                                                               						
													<h:inputHidden value="#{operateHome.inputsInfoData}" id="inputsInfoData"/>
                                                    <div class="addInputRecord_a2" style="border-top: 0px;">
                                                       <a4j:commandButton id="submitInputs" value="提交" onclick="if(!submitRecord()){return false;}" reRender="farmingInputs_wp2,jhInputsCost" oncomplete="jquery('#addInputRecord').hide();jquery('#addJihua').show();farpicref();" action="#{operateHome.addInputsRecord_edit()}" styleClass="btn btn-success"/>
                                                       <input class="btn btn-default" onclick="jquery('#addInputRecord').hide();jquery('#addJihua').show();" type="button" value="返回" style="margin-left:5px"></input>
                                                    </div>
                                                    <div class="addInputRecord_a1" style="border-top: 0px;display:none;">
                                                       <a4j:commandButton value="提交" onclick="if(!submitRecord()){return false;}" reRender="farmingInputs_wp,nsInputsCost" oncomplete="jquery('#addInputRecord').hide();jquery('#myModal').modal('hide');farpicref();" action="#{operateHome.addInputsRecord2()}" styleClass="btn btn-success"/>
                                                       <input class="btn btn-default" onclick="jquery('#addInputRecord').hide();jquery('#myModal').modal('hide')" type="button" value="返回" style="margin-left:5px"></input>
                                                    </div>
                                               </div>
                                           </a4j:form>
                                       </div>

                                         <div class="farmingInputs_mini" id="add_operate2" style="display:none;position:absolute; left:50%; top:50%; margin-left:-173px; margin-top:-150px;z-index:100">
                                             <a4j:form ajaxSubmit="true">
                                                <div class="farmingInputs_miniHd"><h3>添加农事操作类型</h3>
                                                <input type="button" class="butt" onclick="jquery('#add_operate2').hide()"> </input>
                                                </div>
                                                <div class="farmingInputs_miniBd_min">
                                               
                                                <table>
                                                <tr>
                                                    <td width="60" align="right" valign="middle">名称</td>
                                                    <td style="padding-left:15px;">
                                                        <input class="form-control" id="o_name_1"  name="o_name" type="text" style="width:188px; float:left; display:inline; margin-right:5px;" />
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td width="60" align="right" valign="middle">描述</td>
                                                    <td style="padding-left:15px;">
                                                        <textarea class="form-control" id="o_remark_1" name="o_remark" style="width:200px; resize:none;" rows="3"></textarea>
                                                    </td>
                                                </tr>
                                                </table>
                                                </div>
                                                <div class="farmingInputs_miniFt">
                                                <a4j:commandButton value="提交" onclick="if(!checkOp1())return false" action="#{operateHome.addOperate()}" reRender="refreshO,refreshOlist,refreshOlist_" oncomplete="jquery('#record_operate,#record_operate2').selectpicker('refresh');jquery('#add_operate2').hide()" styleClass="btn btn-success" style=""/>
                                                    <input class="btn btn-default" type="button"  onclick="jquery('#add_operate2').hide()" value="返回"/>
                                                </div>
                                                </a4j:form>
                                           </div>                               
                                        	<div class="modal-dialog" id="addInput" style="display:none;width:660px;">
                                        	<a4j:form ajaxSubmit="true" id="inputs" autocomplete="on">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                    <input type="button" class="close_" onclick="jquery('#addInput').hide();jquery('#addJihua').show();jquery('#addInputRecord').show();"> </input>
                                                    <h4 class="modal-title font14 mlal" id="myModalLabel">添加农药</h4>
                                                    </div>
                                                    <div class="modal-body" style="padding-bottom:0;">
                                                   		<table class="farmingMageTab_jl">
                                                           <tr>
                                                            	<td width="62" align="right">投入品名称</td>
                                                                <td width="205" style="padding-left:15px;">
							               							<input type="text" class="form-control nw221" style="width:190px;float:left;margin-left:2px;" id="input_name" name="input_name" /><span style="color: red;">*</span>
                                                                </td>
                                                            	<td width="62" align="right">投入品类型</td>
                                                                <td width="240" style="padding-left:15px;">
							               							<input type="hidden" id="input_type" name="input_type"/>
							               							<select class="selectpicker data_dic" id="input_type_id" name="input_type_id" onchange="changeType();" data-live-search="true">
	                                                                       <a4j:repeat  value="#{operateHome.inputsTypeList}" var="var" >	
	                                                                       		<s:fragment rendered="#{var[2] eq true}">                                                                    		
	                                                                       			<option value="#{var[0]}"  disabled="disabled" aa="#{var[3]}">#{var[1]}</option>	   
	                                                                       		</s:fragment>   
	                                                                       		<s:fragment rendered="#{var[2] ne true}">                                                                    		
	                                                                       			<option value="#{var[0]}" aa="#{var[3]}">#{var[1]}</option>	   
	                                                                       		</s:fragment>                                                                    																						
																			</a4j:repeat>
                                                                     </select>
                                                                </td>                                                               
                                                            </tr>
                                                            <tr  class="input_h">                                                           	
                                                            	<td width="" align="right">保质期</td>
                                                                <td width="" style="padding-left:15px;">
                                                                	<input type="text" class="form-control nw221" style="width:180px;float:left;margin-left:2px;float:left" id="input_shelfLife" name="input_shelfLife"  />
                                                                	<div>月<span style="color: red;">*</span></div>
                                                                </td>
																<td width="62" align="right">规格</td>
                                                                <td width="218" style="padding-left:15px;">
                                                                	<input type="text" class="form-control nw221" style="width:70px;height:30px;float:left;margin-right:5px;" id="net_content" name="net_content"  />
												               		<div class="bootSelt-80" style="float:left;">
													               		
										                   			</div>
										                   			<p style="float:left; margin-right: 2px;margin-left: -5px;">/</p>
												               		<input type="text" class="form-control nw221" style="width:70px;height:30px;float:left;" id="input_spec" name="input_spec"  />
								               						<div style="clear:both;line-height:1;"><span style="color: red;">*</span>(净含量 单位规格/包装规格)</div>
								               						<div style="color: red;line-height:1;">投入品规格在提交投入品信息后不可修改！</div>
                                                                </td>
                                                            </tr>
                                                            <tr  class="input_h">
                                                            	<td width="" align="right">存储类型</td>
                                                                <td width="" style="padding-left:15px;">
                                                                	<h:selectOneMenu styleClass="selectpicker" id="goods_storage_type" style="" value="#{operateHome.goods_storage_type}">
										                   				<s:selectItems value="#{goodsInfoHome.goodsStorgeTypeList()}" var="plant" label="#{plant.name}" itemValue="#{plant.goodsStorageTypeId}"/>
										                   			</h:selectOneMenu>
										                   			<span style="color: red;">*</span>
                                                                </td>
                                                                <td width="" align="right">生产厂家</td>
                                                                <td width="" style="padding-left:15px;">
                                                                	<input type="text" class="form-control nw221" style="width:190px;float:left;margin-left:2px;" id="input_facture" name="input_facture"  />
                                                                	<span style="color: red;">*</span>
                                                                </td>
                                                            </tr>
                                                            <tr class="input_pest inpu">
                                                            	<td width="" align="right">有效成分</td>
                                                                <td width="" style="padding-left:15px;">
                                                                	<input type="text" class="form-control nw221" style="width:190px;" id="pest_active" name="pest_active"  />
                                                                </td>
                                                                <td width="" align="right">适用标准</td>
                                                                <td width="" style="padding-left:15px;">
                                                                	<select multiple="multiple" data-live-search="true" class="selectpicker data_dic" id="pest_data_dic" name="pest_data_dic">
																		<a4j:repeat  value="#{operateHome.ddList}" var="var" >
																		<option value="#{var.dataDicId}">#{var.name}</option>
																		</a4j:repeat>
																	</select>
                                                                </td>
                                                            </tr>
                                                             <tr class="input_pest inpu">
                                                            	<td width="" align="right">安全间隔期</td>
                                                                <td width="" style="padding-left:15px;">
                                                                	<input type="text" class="form-control nw221" style="width:190px;float:left" id="pest_interval" name="pest_interval"  /> 天
                                                                </td>
                                                                <td width="" align="right"></td>
                                                                <td width="" style="padding-left:15px;">                                                               	
                                                                </td>
                                                            </tr>
                                                            <tr class="input_pest inpu">
                                                            	<td width="" align="right">使用方法</td>
                                                                <td width="" style="padding-left:15px;">
                                                                	<textarea class="form-control" id="pest_method" name="pest_method" style="width:175px; resize:none; font-size:12px;" rows="3"></textarea>
                                                                </td>
                                                                <td width="" align="right">防治对象</td>
                                                                <td width="" style="padding-left:15px;">
                                                                	<textarea class="form-control" id="pest_control" name="pest_control" style="width:175px; resize:none; font-size:12px;" rows="3"></textarea>
                                                                </td>                                                               
                                                            </tr>
                                                            <tr class="input_fert inpu">
                                                            	<td width="" align="right">登记证号</td>
                                                                <td width="" style="padding-left:15px;">
                                                                	<input type="text" class="form-control nw221" style="width:190px;" id="fert_no" name="fert_no"  />
                                                                </td>
                                                                <td width="" align="right">养分含量</td>
                                                                <td width="" style="padding-left:15px;">
                                                                	<input type="text" class="form-control nw221" style="width:190px;" id="fert_content" name="fert_content"  />
                                                                </td>
                                                            </tr>
                                                            <tr class="input_fert inpu">
                                                            	<td width="" align="right">适用标准</td>
                                                                <td width="" style="padding-left:15px;">
                                                                	<select multiple="multiple" data-live-search="true" class="selectpicker data_dic" id="fert_data_dic" name="fert_data_dic">
																		<a4j:repeat  value="#{operateHome.ddList}" var="var" >
																		<option value="#{var.dataDicId}">#{var.name}</option>
																		</a4j:repeat>
																	</select>
                                                                </td>
                                                                <td width="" align="right"></td>
                                                                <td width="" style="padding-left:15px;">                                                                	
                                                                </td>
                                                            </tr>
                                                            <tr class="input_fert inpu">
                                                            	<td width="" align="right">施用方法</td>
                                                                <td width="" style="padding-left:15px;">
                                                                	<textarea class="form-control" id="fert_method" name="fert_method" style="width:175px; resize:none; font-size:12px;" rows="3"></textarea>
                                                                </td>
                                                                <td width="" align="right">适用作物</td>
                                                                <td width="" style="padding-left:15px;">
                                                                	<textarea class="form-control" id="fert_crop" name="fert_crop" style="width:175px; resize:none; font-size:12px;" rows="3"></textarea>
                                                                </td>                                                             
                                                            </tr>
                                                            <tr class="input_other inpu">
                                                            	<td width="" align="right">适用标准</td>
                                                                <td width="" style="padding-left:15px;">
                                                                	<select multiple="multiple" data-live-search="true" class="selectpicker data_dic" id="other_data_dic" name="other_data_dic">
																		<a4j:repeat  value="#{operateHome.ddList}" var="var" >
																		<option value="#{var.dataDicId}">#{var.name}</option>
																		</a4j:repeat>
																	</select>
                                                                </td>
                                                                <td width="" align="right"></td>
                                                                <td width="" style="padding-left:15px;">                                                                	
                                                                </td>
                                                            </tr>
                                                             <tr class="input_seed inpu">
                                                            	<td width="" align="right">适用标准</td>
                                                                <td width="" style="padding-left:15px;">
                                                                	<select multiple="multiple" data-live-search="true" class="selectpicker data_dic" id="seed_data_dic" name="seed_data_dic" title="请选择">
																		<a4j:repeat  value="#{operateHome.ddList}" var="var" >
																		<option value="#{var.dataDicId}">#{var.name}</option>
																		</a4j:repeat>
																	</select>
                                                                </td>
                                                                <td width="" align="right">茬口</td>
                                                                <td width="" style="padding-left:15px;"> 
                                                                <input type="text" class="form-control nw221" style="width:190px;float:left;margin-left:2px;" id="seed_crops" name="seed_crops"  /> <span style="color: red;">*</span>                                                              	
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                            	<td width="" align="right" valign="middle">备注</td>
                                                                <td width="" style="padding-left:15px;">
                                                                	<textarea class="form-control" id="input_description" name="input_description" style="width:175px; resize:none; font-size:12px;" rows="3"></textarea>
                                                                </td>
                                                                <td width="" align="right" valign="middle">图片上传：<input type="hidden" value="" id="url" name="url"/></td>
                                                                <td width="" style="padding-left:15px;">
                                                                	<iframe src="#{request.contextPath}/agricultural/InputsImage.seam" id="myframe" name="myframe" frameBorder="0" scrolling="no" width="200" onLoad="" ></iframe>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </div>
                                                    <div class="modal-footer modal-footer1">
                                                    <a4j:commandButton styleClass="btn btn-success" value="提交"  onclick="if(!checkInput())return false;"/>
                                                    <a4j:commandButton styleClass="btn btn-success" value="提交"  id="if1Btn" eventsQueue="mainQueue" style="cursor: pointer;display:none;" action="#{operateHome.updateInputs}" data="#{operateHome.re_inputs_Str}_#{operateHome.promptMessage}" oncomplete="updateInputs_next(data);"/>
                                                    <input class="btn btn-default" type="button" onclick="jquery('#addInput').hide();jquery('#addInputRecord').show();"  value="返回"></input>
                                                    </div>
                                                    <div class="modal-footer modal-footer2">
                                                    <a4j:commandButton styleClass="btn btn-success" value="提交"  onclick="if(!checkInput())return false;"/>
                                                    <a4j:commandButton styleClass="btn btn-success" value="提交"  id="if2Btn" eventsQueue="mainQueue" style="cursor: pointer;display:none;" action="#{operateHome.updateInputs}" data="#{operateHome.re_inputs_Str}_#{operateHome.promptMessage}" oncomplete="updateInputs_next_2(data);"/>
                                                    <input class="btn btn-default" type="button" onclick="jquery('#addInput').hide();jquery('#addJihua').show();jquery('#addInputRecord').show();"  value="返回"></input>
                                                    </div>
                                                </div>
                                                </a4j:form>
                                            </div>
                                        
                                        </div>
                                         <div class="modal fade farmingInputs_mini modal-dialog" id="addMyFarming" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="z-index:101;position:fixed; left:50%; top:50%; margin-left:-235px; margin-top:-260px;width:487px;height:474px;">
	                                       	<a4j:form ajaxSubmit="true" id="pic" autocomplete="on">
	                                       	<div class="farmingInputs_miniHd"><h3>添加农事图片</h3><input type="button" class="butt" onclick="jquery('#addMyFarming').hide()"/></div>
	                                           <div class="farmingInputs_miniBd_min">
	                                           <table>
	                                           <iframe src="#{request.contextPath}/agricultural/farmingPic.seam" id="myframPic" name="myframPic" frameBorder="0" scrolling="no" height="228px" width="320" onLoad="" ></iframe>
	
		 										<tr>
	                                           	<td width="100"><h3 class="all_te" style="margin-top:10px;">图片说明:</h3></td>
	                                               <td width="230" >
	                                               	<h:inputTextarea value="#{operateHome.centent}" styleClass="form-control" id="contentId" style="width:319px; float:left; display:inline; margin-right:5px;"/>
	                                               	<h:inputHidden value="#{operateHome.imgUrl}" id="imgUrl"/>
	                                               	<h:inputHidden value="#{operateHome.picJson}" id="picJson"/>
	                                                <span style="color:#f00;font-size:12px;font-family:'微软雅黑';">最多不能超过70字</span>
	                                               </td>
	                                           </tr>
	                                           </table>
	                                           </div>
	                                           <div class="farmingInputs_miniFt">
	                                           <a4j:commandButton value="提交" data-dismiss="modal"  onclick="if(!myPicUrl())return false" oncomplete="farpicref()" reRender="picId"  action="#{operateHome.farmingPic()}" styleClass="btn btn-success"/>
	                                           <input class="btn btn-default" data-dismiss="modal" onclick="jquery('#addMyFarming').hide();" type="button" value="返回" style="margin-left:5px"></input>
	                                           </div>
	                                           </a4j:form>
                                       </div>
	<audio></audio>
<a4j:form id="formid" >
	<a4j:queue requestDelay="10" ignoreDupResponses="true" id="mainQueue"/>
	<a4j:jsFunction eventsQueue="mainQueue" name="removeO" action="#{operateHome.removeOperate()}" reRender="refreshO,refreshOlist" oncomplete="jquery('#record_operate').selectpicker('refresh');">
		<a4j:actionparam name="param" assignTo="#{operateHome.param}"/>
	</a4j:jsFunction>
	<a4j:jsFunction eventsQueue="mainQueue" name="delRecordList_next2" action="#{operateHome.delRecordList_edit()}" reRender="jhInputsCost" oncomplete="jquery('#login').hide();">
		<a4j:actionparam name="param" assignTo="#{operateHome.param}" />
	</a4j:jsFunction>
	<a4j:jsFunction eventsQueue="mainQueue" name="delRecordList_next" action="#{operateHome.delRecordList2()}" reRender="nsInputsCost" oncomplete="jquery('#login').hide();">
		<a4j:actionparam name="param" assignTo="#{operateHome.param}" />
	</a4j:jsFunction>
	<a4j:jsFunction eventsQueue="mainQueue" name="resetRecordList_next" action="#{operateHome.resetRecordList()}" >
	</a4j:jsFunction>
	<a4j:jsFunction eventsQueue="mainQueue" name="searchInputsList" action="#{operateHome.searchGoodsInfoList()}" oncomplete="searchInputsList_next()" reRender="recordInputList">
		<a4j:actionparam name="param" assignTo="#{operateHome.param}" />
		<a4j:actionparam name="plantValues" assignTo="#{operateHome.plantValues}" />
		<a4j:actionparam name="searchInfo" assignTo="#{operateHome.searchInfo}" />
		<a4j:actionparam name="inputsPageNum" assignTo="#{operateHome.inputsPageNum}" />
	</a4j:jsFunction>
	<a4j:jsFunction eventsQueue="mainQueue" name="changeStorageRoom" action="#{operateHome.changeStorageRoom()}" data="#{operateHome.resultData}" oncomplete="changeRoom_next(data)">
		<a4j:actionparam name="storageRoomId" assignTo="#{operateHome.storageRoomId}" />
		<a4j:actionparam name="inputsInfoId" assignTo="#{operateHome.inputsInfoId}" />
	</a4j:jsFunction>
	<a4j:jsFunction eventsQueue="mainQueue" name="searchGoodsCount" action="#{operateHome.searchGoodsCount()}" data="#{operateHome.resultData}" oncomplete="changeGoodsBatch_next(data)">
		<a4j:actionparam name="goodsBatchIds" assignTo="#{operateHome.goodsBatchIds}" />
		<a4j:actionparam name="inputsInfoId" assignTo="#{operateHome.inputsInfoId}" />
	</a4j:jsFunction>
	<a4j:jsFunction eventsQueue="mainQueue" name="changeGoodsInfo" action="#{operateHome.searchStorageRoomList()}" data="#{operateHome.resultData}" oncomplete="storageCallback(data);">
		<a4j:actionparam name="inputsIds" assignTo="#{operateHome.inputsIds}" />
	</a4j:jsFunction>
		<a4j:jsFunction eventsQueue="mainQueue" name="getInputList" action="#{operateHome.getInputList()}" reRender="farmingInputs_wp2,jhInputsCost" oncomplete="farpicref()">		
		</a4j:jsFunction>
	</a4j:form>
 	<a4j:form>
      <a4j:jsFunction name="delfarmingPicList" reRender="picId" action="#{operateHome.delfarmingPicList()}" oncomplete="farpicref()">
   		<a4j:actionparam name="index" assignTo="#{operateHome.index}"/>
     </a4j:jsFunction>
     <a4j:jsFunction name="checkStorage"  action="#{operateHome.checkStorage()}" data="#{operateHome.messageStr}" oncomplete="submitAgr(data)" >
		<a4j:actionparam name="operType" assignTo="#{operateHome.operType}"/>
	</a4j:jsFunction>
</a4j:form>         
<script type="text/javascript">
//<![CDATA[
       function addFarming(){
		jquery("#pic\\:imgUrl").val(jquery("#myframPic").contents().find("#imgUrl_id").attr("src","../asset/images/farmingIco15.jpg"));
		jquery("#pic\\:contentId").val('');
		jquery('#addMyFarming').show();
		}
       function myPicUrl(){
       	jquery("#pic\\:imgUrl").val(jquery("#myframPic").contents().find("#imgUrl_id").attr("src"));
       	jquery("#pic\\:picJson").val(jquery("#myframPic").contents().find("#inputsImages\\:picJson").val());
       	if(jquery('#pic\\:contentId').val().length>70){
          	alert("图片说明字数需小于70字");
			return false;
         }
    	if(jquery("#myframPic").contents().find("#imgUrl_id").attr("src")=='../asset/images/farmingIco15.jpg'){
    		alert("上传图片不能为空！");
			return false;
         }
       	jquery('#addMyFarming').modal('hide');
		return true;

       }  
       function farpicref(){
       	jquery('.farmingInputs').mouseover(function(){
       		jquery(this).children('.closeInputs').css('display','block');	
       	});
       	jquery('.farmingInputs').mouseout(function(){
       		jquery(this).children('.closeInputs').css('display','none');	
       	});

/*         jquery('.farmHeight').eq(0).css('height',jquery('.farmPics').eq(0).height());
        if(jquery('.farmingInputs_wp').eq(0).find('.fl').length>=4){
            var va=parseInt((jquery('.farmingInputs_wp').eq(0).find('.fl').length+1)/4);
            var va_=parseInt((jquery('.farmingInputs_wp').eq(0).find('.fl').length+1)%4);
            if(va_>0){
            	va_=1;
            }
        	jquery('.farmHeight').eq(1).css('height',va*155+va*10+va_*155 );
        } */
       }       
              
      function delfarmingPic(obj,index){
   	   delfarmingPicList(index);
   	}        
           
jQuery(function(){
	jQuery('select:not(.data_dic)').selectpicker({dropupAuto:false});	
	jQuery('#pest_data_dic').selectpicker({noneSelectedText:"请选择"});
	jQuery('#fert_data_dic').selectpicker({noneSelectedText:"请选择"});
	jQuery('#other_data_dic').selectpicker({noneSelectedText:"请选择"});
	jquery('#input_type_id').selectpicker({noneSelectedText:"请选择"});
	jquery("#recordList_,#recordList_2").delegate('.farmingInputs','mouseenter mouseleave',function ( event ) {
	    if (event.type == 'mouseenter') {
	    	jquery(this).children('.closeInputs').css('display','block');	
	   } else {
		   jquery(this).children('.closeInputs').css('display','none');
	   }
	});
	var d = new Date();
	jquery("#record_date").val(d.format("yyyy-MM-dd hh:mm"));
	jquery("#record_time").val("1");
	jquery(".record_date").datetimepicker({
		format: "yyyy-mm-dd hh:ii",  
		autoclose: true,
		 weekStart: 1,
		 language:  'zh-CN',
		pickerPosition: "bottom-left"
	});

	jquery(".record_date2").datetimepicker({
		format: "yyyy-mm-dd",  
		autoclose: true,
		 weekStart: 1,
		 language:  'zh-CN',
		 startView: 3,
		minView: 2,
		maxView: 4,	
		pickerPosition: "bottom-left"
	});

	/*if(jquery('[dis=false]').length-1>0 && jquery('[dis=false]').length-1<3){
		jquery('.farmRecord ').css('height','362px');
		jquery('.baseWp').eq(0).css('height','490px');
	}else if(jquery('[dis=false]').length-1>0 && jquery('[dis=false]').length-1>2){
		jquery('.farmRecord ').css('height','320px');
		jquery('.baseWp').eq(0).css('height','445px');
	}else{
		jquery('.farmRecord').css('height','430px');
		jquery('.baseWp').eq(0).css('height','550px');
	}*/

	jquery('.ns ').css('min-width',jquery('.farmNs ').width()/2+'px');
});
jquery(window).resize(function() {
	jquery('.ns ').css('min-width',jquery('.farmNs ').width()/2+'px');
	 jquery('.farmHeight').eq(0).css('height',jquery('.farmPics').eq(0).height());
     if(jquery('.farmingInputs_wp').eq(0).find('.fl').length>=4){
         var va=parseInt((jquery('.farmingInputs_wp').eq(0).find('.fl').length+1)/4);
         var va_=parseInt((jquery('.farmingInputs_wp').eq(0).find('.fl').length+1)%4);
         if(va_>0){
         	va_=1;
         }
     	jquery('.farmHeight').eq(1).css('height',va*155+va*10+va_*155 );
     }
});

function checkAgr(){
	var v = "";
	jquery("#myframe2").contents().find(".plant_imgbd").each(function(){
		v +=jquery(this).attr('src')+",";
	})
	jquery("#record_url").val(v);
//	if(jquery("#record_name").val()==null||jquery("#record_name").val()==""){
//		alert("请选择操作人");
//		return false;
//	}
	if(jquery("#record_time").parent().css('display')!='none'){
		if(jquery("#record_time").val()==""){
			alert("请填写工时!");
			return false;
		}
		
		var rtime = jquery("#record_time").val();
		if(isNaN(rtime)){
			alert("工时请填写数字!");
			return false;
		}else{
			rtime = parseFloat(rtime);
			if(rtime>200){
				alert("工时不能超过200!");
				return false;
			}
		}
	}
	if(jquery("#record_temp").parent().css('display')!='none'){
		var temp = jquery("#record_temp").val();
		if(isNaN(temp)){
			alert("空气温度请填写数字!");
			return false;
		}else{
			temp = parseFloat(temp);
			//if(temp>99){
			//	alert("工时不能超过99!");
			//	return false;
			//}
		}
		
		var humi = jquery("#record_humi").val();
		if(isNaN(humi)){
			alert("空气湿度请填写数字!");
			return false;
		}else{
			humi = parseFloat(humi);
			//if(humi>99){
			//	alert("工时不能超过99!");
			//	return false;
			//}
		}
	}


	if(jquery("#record_costing").parent().css('display')!='none'){
		var costing = jquery("#record_costing").val();
		if(isNaN(costing)){
			alert("其他成本请填写数字!");
			return false;
		}else{
			costing = parseFloat(costing);
			if(costing>1000000){
				alert("其他成本不能超过1000000!");
				return false;
			}
		}
	}
	operType=4;
	checkStorage(4);
	jquery('#login').show();	
	return true;
}
 var operType=0;
function submitAgr(data){
	if(""!=data){
		alert(data);			
	}else{
		if(operType==5){
			jquery("#agr2\\:hidEditAgrBtn").click(); 
		}else{
			jquery("#agr\\:hidFinAgrBtn").click(); 
		}
			
	}
}
function editRecord(){
	resetInfo();
	jquery('#addJihua').show();
	jquery('#add_operate2').hide();
	jquery("#addInput").hide();
	jquery("#addInputRecord").hide();	
	jquery('.ns ').css('min-width',jquery('.farmNs ').width()/2+'px');
	jquery('.record').modal('show')
	getInputList();
}


function addRecord(){
	if(jquery("#record_tunnel2").val()==null||jquery("#record_tunnel2").val()==""){
		alert("请选择区域!");
		return false;
	}	
	//jquery('input[name="dateTypeRadio"]:eq(1)').iCheck('check');
	//将投入品信息置为默认值
	jquery('#inputType').selectpicker('val',2);
	jquery("#searchInputText").val("");
	searchInputs(1);
	jquery("#addInputsTable .Output_tr").remove();
	jquery(".addInputRecord_a1").hide();
	jquery(".addInputRecord_a2").show();
	jquery('#addInputRecord').show();
}

function addRecord_1(){
	//将投入品信息置为默认值
	jquery('#inputType').selectpicker('val',2);
	jquery("#searchInputText").val("");
	jquery("#addInputsTable .Output_tr").remove();
	searchInputs(1);
	jquery("#addInput").hide();
	jquery("#addJihua").hide();
	jquery("#myModal").modal('show')
	jquery(".addInputRecord_a1").show();
	jquery(".addInputRecord_a2").hide();
	jquery("#addInputRecord").show();
	jquery('.ns ').css('min-width',jquery('.farmNs ').width()/2+'px');
}

function hidee(){
 	var v = jquery("#myframe").contents();
	v.find(".photo_box2 li:eq(1)").show();
	v.find(".photo_box2 li:eq(0)").hide();
	v.find("#input_type").val(jquery("#input_type").val());
}

function addInputs (index){
	jquery("#input_description").val("");
	jquery("#addInput .form-control").val("");
	jquery("#url").val("");
	jquery("#input_type_id").selectpicker("val","");//默认类型为请选择，页面为其它类型页面
	hidee();	
	if(jquery(".addInputRecord_a1").is(":visible")){
		jquery(".modal-footer1").show();
		jquery(".modal-footer2").hide();
	}else{
		jquery(".modal-footer1").hide();
		jquery(".modal-footer2").show();
	}
	jquery("#addInput").show();
	jquery("#addInput").scrollTop(0);
}
function changeType(){	
	var index=jquery("#input_type_id").find("option:selected").attr("aa");
	jquery("#input_type").val(index);
	if(index==2){
		jquery(".inpu").hide();
		jquery(".mlal").html("添加农药");
		jquery(".input_pest").show();
	}else if(index==3){
		jquery(".inpu").hide();
		jquery(".input_fert").show();
		jquery(".mlal").html("添加肥料");		
	}else if(index==5){
		jquery(".inpu").hide();
		jquery(".input_seed").show();
		jquery(".mlal").html("添加种子");		
	}else{
		jquery(".inpu").hide();
		jquery(".input_other").show();
		jquery(".mlal").html("添加其他");
	}
}
var reg = new RegExp("^[0-9]*$");
function checkInput(){
	var inputType=jquery("#input_type").val();
	var inputTypeId=jquery("#input_type_id").val();
    var inputName=jquery("#input_name").val();
    if(trim(inputName)==""){
        alert("请填写投入品名称!");
        return false;
    }else if(inputName.length>20){
    	alert("投入品名称输入过长!");
        return false;
    }
    if(null==inputTypeId || ""==inputTypeId){
    	alert("请选择投入品类型!");
        return false;
    }
    var bzq=jquery("#input_shelfLife").val();
	if(trim(bzq)==""){
		alert("请填写保质期!");
		return false;
	}else if(!reg.test(bzq)){
		alert("请正确填写保质期!");
		return false;
	}else if(bzq<=0){
		alert("保质期需大于0!");
		return false;
	}
	var netContent=jquery("#net_content").val();
	var inputSpec=jquery("#input_spec").val();
	if(inputType==2 || inputType==3){
		if(trim(netContent)==""){
			alert("请填写净含量!");
			return false;
		}else if(!reg.test(netContent)){
			alert("请正确填写净含量!");
			return false;
		}else if(netContent>99999){
			alert("净含量输入太大!");
			return false;
		}		
		if(trim(inputSpec)==""){
			alert("请填写包装规格!");
			return false;
		}
	}else{
		if(trim(netContent)!="" && !reg.test(netContent)){
			alert("请正确填写净含量!");
			return false;
		}
	}
	var gst=jquery("#inputs\\:goods_storage_type").val();
	if(gst==null){
        alert("请添加存储类型!");
        return false;
    }
	var inputFacture=jquery("#input_facture").val();
	if(trim(inputFacture)==""){
		alert("请添加生产厂家!");
        return false;
	}else if(inputFacture.length>50){
		alert("生产厂家输入过长!");
		return false;
	}
	var dataDic="";
	if(inputType==2){
		dataDic=jquery("#pest_data_dic").val();		
		var pestActive=jquery("#pest_active").val();
		if(pestActive.length>20){
			alert("有效成分输入过长!");
			return false;
		}
		var pestInterval=jquery("#pest_interval").val();
		if(pestInterval.length>10){
			alert("安全间隔期输入过长!");
			return false;
		}else if(pestInterval!=""){
			if(!reg.test(pestInterval)){
				alert("请正确填写安全间隔期!");
				return false;
			}
		}
		var pestControl=jquery("#pest_control").val();
		if(pestControl.length>10){
			alert("防治对象输入过长!");
			return false;
		}
		var pestMethod=jquery("#pest_method").val();
		if(pestMethod.length>100){
			alert("使用方法输入过长!");
			return false;
		}
	}else if(inputType==3){
		dataDic=jquery("#fert_data_dic").val();
		var fertNo=jquery("#fert_no").val();
		if(fertNo!="" && fertNo.length>50){
			alert("登记证号长度过长最多50位!");
			return false;
		}
		var fertContent=jquery("#fert_content").val();
		if(fertContent.length>20){
			alert("养分含量输入过长!");
			return false;
		}
		var fertCrop=jquery("#fert_crop").val();
		if(fertCrop.length>10){
			alert("适用作物输入过长!");
			return false;
		}
		var fertMethod=jquery("#fert_method").val();
		if(fertMethod.length>100){
			alert("施用方法输入过长!");
			return false;
		}
	}else if(inputType==5){
		dataDic=jquery("#seed_data_dic").val();	
		var crops=jquery("#seed_crops").val();
		if(crops==null||crops==''){
			alert("茬口不能为空!");
			return false;
		}else if(crops.length>20){
			alert("茬口输入过长!");
			return false;
		}
	}else{
		dataDic=jquery("#other_data_dic").val();		
	}

	var inputDescription=jquery("#input_description").val();
	if(inputDescription.length>200){
		alert("备注输入过长!");
		return false;
	}
	/* var v = jquery("#myframe").contents().find("#url").val();
	jquery("#url").val(v); */

	//判断是否上传图片，没有则直接提交，否则先保存图片再提交
	var logoUrl=jquery("#myframe").contents().find("#inputsImages\\:logoUrl").val();
    if(""!=logoUrl){
    	jquery("#myframe").contents().find("#inputsImages\\:insertImages").click();
    }else{
    	if(jquery('.inputFooter1').is(":visible")){
			jquery("#inputs\\:if1Btn").click();
		}else{
			jquery("#inputs\\:if2Btn").click();
		}
    }
	return true;	
}

function updateInputs_next(data){
	var data1 = data.split("_")[0];
	var data2 = data.split("_")[1];
	if(data2 == ""){
		if(data1&&data1.length>0){
			var trType=jquery('#record_type1').val();
			changeInputsType(trType);
			jquery('#addInput').hide();
			jquery('#addInputRecord').show();
		}
	}else{
		alert(data2);
	}
}

function updateInputs_next_2(data){
	var data1 = data.split("_")[0];
	var data2 = data.split("_")[1];
	if(data2 == ""){
		if(data1&&data1.length>0){
			var trType=jquery('#record_type1').val();
			changeInputsType(trType);
			
			jquery("#record_input1").append(data);
			jquery("#record_input1").selectpicker('refresh');
	   		jquery('#addInput').hide();
	   		jquery('#addJihua').show();
	   		jquery('#addInputRecord').show();
		}
	}else{
		alert(data2);
	}
}
function checkOp1(){
	var name=jquery("#o_name_1").val();
	var remark=jquery("#o_remark_1").val();
	if(trim(name)==""){
		alert("请填写名称!");
		return false
	}else if(name.length>45){
		alert("名称不可超过45个字符!");
		return false
	}
	if(trim(remark)!="" && remark.length>200){
		alert("描述不可超过200个字符!");
		return false
	}
	return true;
}
function delRecordList(obj,index){
	jquery('#login').show();
	jquery(obj).parent().css('display','none');
	delRecordList_next(index);
}

function delRecordList2(obj,index){
	jquery('#login').show();
	jquery(obj).parent().css('display','none');
	delRecordList_next2(index);
}
function trim(str){
   	return str.replace(/(^\s+)|\s+$/g,"");
 }
function checkAgr2(){
	var v = "";
	if(jquery("#record_tunnel2").val()==null||jquery("#record_tunnel2").val()==""){
		alert("请选择区域!");
		return false;
	}
//	if(jquery("#record_name2").val()==null||jquery("#record_name2").val()==""){
//		alert("请选择操作人!");
//		return false;
//	}
	if(jquery("#record_time2").parent().css('display')!='none'){
		var rtime = jquery("#record_time2").val();
		if(trim(rtime)==""){
			alert("请填写工时!");
			return false;
		}	
		if(isNaN(rtime)){
			alert("工时请填写数字!");
			return false;
		}else{
			rtime = parseFloat(rtime);
			if(rtime>200){
				alert("工时不能超过200!");
				return false;
			}
		}
	}
	if(jquery("#record_remark2").val().length > 50){
		alert("备注字数不能超过50!");
		return false;
	}


	if(jquery("#record_costing2").parent().css('display')!='none'){
		var costing = jquery("#record_costing2").val();
		if(isNaN(costing)){
			alert("其他成本请填写数字!");
			return false;
		}else{
			costing = parseFloat(costing);
			if(costing>1000000){
				alert("其他成本不能超过1000000!");
				return false;
			}
		}
	}
	operType=5;
	checkStorage(5);
	jquery('#login').show();
	return true;
}

Date.prototype.format = function(format)
{
	var o = {
	"M+" : this.getMonth()+1, //month
	"d+" : this.getDate(),    //day
	"h+" : this.getHours(),   //hour
 	"m+" : this.getMinutes(), //minute
	"s+" : this.getSeconds(), //second
 	"q+" : Math.floor((this.getMonth()+3)/3),  //quarter
 	"S" : this.getMilliseconds() //millisecond
	}

	if(/(y+)/.test(format)) 
	{
		format=format.replace(RegExp.$1,(this.getFullYear()+"").substr(4 - RegExp.$1.length));
	}
	
 	for(var k in o)
	{
		if(new RegExp("("+ k +")").test(format))
		{
 			format = format.replace(RegExp.$1,RegExp.$1.length==1 ? o[k] : ("00"+ o[k]).substr((""+ o[k]).length));
		}
	}
	return format;
}
function clearNoNum(obj){
	obj.value = obj.value.replace(/[^\d.]/g,"");//清除“数字”和“.”以外的字符  
	obj.value = obj.value.replace(/^\./g,"");  //验证第一个字符是数字而不是. 
	obj.value = obj.value.replace(/\.{2,}/g,"."); //只保留第一个. 清除多余的.   
	obj.value = obj.value.replace(".","$#$").replace(/\./g,"").replace("$#$",".");
}
function clearOnlyNum(obj){
	obj.value = obj.value.replace(/[^\d]/g,"");//清除“数字”以外的字符  
}
function changeGoodsBatch(obj,inputsId){
    var batch=jquery(obj).val();
    if(null==batch){
    	batch="";
    }       
    searchGoodsCount(batch.toString(),inputsId);
    getCostByPrice(inputsId);
}
function searchInputsList_next(){
	var trLength=jQuery("#inputsTable tr").length;
	for(var i=1;i<trLength;i++){
		var inputIds=jQuery("#inputsTable tr:eq("+i+") td:eq(0) input:eq(0)").val();
		if(jquery("#addtr_"+inputIds).length>0){
			jquery("#check_"+inputIds).addClass('checked');
		}
	}
	var allNum = jQuery("#inputs_table").find('td .mn_check').length;
	var allLen = jQuery("#inputs_table").find('td .mn_check.checked').length;
	//alert('allNum:'+allNum+'allLen:'+allLen)
	//如果个数和选中的个数相等，则全选为选中状态
	if(allLen == allNum && allNum>0){
		jQuery("#mn_checkall").addClass('checked');
	}else{
		jQuery("#mn_checkall").removeClass('checked');
	}
	jQuery("#login").hide();
}
function changeRoom_next(data){
	var inputsId=data.inputsInfoId;   
	var goodsBatchSel="<select class='selectpicker' multiple='multiple' onchange='changeGoodsBatch(this,"+inputsId+")'>";
	var farmerInfoSel="<select class='selectpicker' >";

	if(typeof(data.goodsBatch) != "undefined"){
		goodsBatchSel+=data.goodsBatch;
	}
	if(typeof(data.farmerInfo) != "undefined"){
		farmerInfoSel+=data.farmerInfo;
	}  	
	if(typeof(data.goodsCount) != "undefined"){
		jquery('#goodsCount_'+inputsId).html(data.goodsCount);
		jquery('#goodsCount_'+inputsId).attr("title",data.goodsCount);
	}  
	if(typeof(data.unitinfoId) != "undefined"){
		jquery('#unit_'+inputsId).val(data.unitinfoId);
	}  		
	goodsBatchSel+="</select>";
	farmerInfoSel+="</select>";	
	jquery('#batch_'+inputsId).html(goodsBatchSel);
	jquery('#farmer_'+inputsId).html(farmerInfoSel);
	jquery('.selectpicker').selectpicker();	
	getCostByPrice(inputsId);
}
function changeGoodsBatch_next(data){
	var inputsId=data.inputsInfoId; 
	var msg=data.promptMessage;   
	if(typeof(data.goodsCount) != "undefined"){
		jquery('#goodsCount_'+inputsId).html(data.goodsCount);
		jquery('#goodsCount_'+inputsId).attr("title",data.goodsCount);
	}   
	if(msg!=""){
		alert("请选择同一单位的入库批次!");
		var goodsBatchids=jquery("#batch_"+inputsId+" select").val().toString();
		var batchValue=goodsBatchids.replace(","+msg,"").split(",");
		jquery("#batch_"+inputsId+" select").selectpicker('val',batchValue);			
	}
}
function isFloat(value){
	var mny =RegExp(/^([0-9]+(\.?))?[0-9]+$/);
	return mny.test(value);
}
var goodsCount=0.0;
//农事投入品提交验证
function submitRecord(){
	var trLength=jQuery("#addInputsTable tr").length;
	if(trLength<=1){
		alert("请选择投入品！");
		return false;
	}
	var inputsRecordStr='{"inputsDatas":[';
   	for(var i=1;i<trLength;i++){   	   	
   		var inputsId=jQuery("#addInputsTable tr:eq("+i+") td:eq(0) input:eq(0)").val();
   		var unitId=jQuery("#addInputsTable tr:eq("+i+") td:eq(0) input:eq(1)").val();
   		var inputsName=jQuery("#addInputsTable tr:eq("+i+") td:eq(1) p").html();
   		var useNum=jQuery("#addInputsTable tr:eq("+i+") td:eq(3) input:eq(0)").val();
   		var cost=jQuery("#addInputsTable tr:eq("+i+") td:eq(4) input:eq(0)").val();
   		var roomId=jQuery("#addInputsTable tr:eq("+i+") td:eq(5) select").val();
   		var batchId=jQuery("#addInputsTable tr:eq("+i+") td:eq(6) select").val();
   		var farmerId=jQuery("#addInputsTable tr:eq("+i+") td:eq(7) select").val();
   		var goodsCount=jQuery("#addInputsTable tr:eq("+i+") td:eq(8)").html();
			
   		if(""==goodsCount){
   			goodsCount=0;
   		}
   		if(null==useNum || ""==useNum){
   			alert(inputsName+"的使用量不能为空！");
   			return false;
   		}else if(!isFloat(useNum)){
   			alert("请输入正确的"+inputsName+"使用量！");
   			return false;
   		}else if(parseFloat(useNum)>9999999){
   			alert(inputsName+"的使用量不能大于9999999！");
   			return false;
   	   	}
   		if(null==cost || ""==cost){
   			alert(inputsName+"的成本不能为空！");
   			return false;
   		}else if(!isFloat(cost)){
   			alert("请输入正确的"+inputsName+"成本！");
   			return false;
   		}else if(parseFloat(cost)>9999999){
   			alert(inputsName+"的成本不能大于9999999！");
   		   	return false;
   		}
   		if("0"!=roomId){		
   			if(null==batchId || ""==batchId){
   				alert(inputsName+"的入库批次不能为空！");
   				return false;
   			}
   			if(null==farmerId || ""==farmerId){
   				alert(inputsName+"的经办人不能为空！");
   				return false;
   			}
   			if(useNum>parseFloat(goodsCount)){
   				alert(inputsName+"库存不足，请重新输入使用量！");
   				return false;
   			} 			
   		}	
   		inputsRecordStr+= "{'inputsId':'" +inputsId + "','useNum':'"+ useNum +"','cost':'"+ cost +"','roomId':'"+ roomId +
			"','batchId':'"+ batchId +"','farmerId':'"+ farmerId +"','unitId':'"+ unitId +"'},";			
   	}
   	inputsRecordStr = inputsRecordStr.substring(0, inputsRecordStr.length-1) + ']}';
   	jquery("#record_\\:inputsInfoData").val(inputsRecordStr);
	//document.getElementById('record_:submitInputs').disabled = true;
	return true;	
}
function changeRoom(room,inputsId){
	if(room=="0"){
		var goodsBatchSel="<select class='selectpicker' multiple='multiple' onchange='changeGoodsBatch(this,"+inputsId+")'></select>";
    	var farmerInfoSel="<select class='selectpicker' ></select>";
		jquery('#batch_'+inputsId ).html(goodsBatchSel);
		jquery('#farmer_'+inputsId).html(farmerInfoSel); 	
		jquery('#goodsCount_'+inputsId).html("0"); 	
		jquery('#goodsCount_'+inputsId).attr("title",0);
		jquery('.selectpicker').selectpicker();		
	}else{
		changeStorageRoom(room,inputsId);
	}
}
//回调将生成的编号赋值给input_code
function changeGoodsCode(goodsCode){
	document.getElementById("input_code").value=goodsCode;
	document.getElementById("auto_input_code").value=goodsCode;
}

function tunnelValue(){
	var tunVal=jquery('#record_tunnel2').val();
	var faVal=jquery('#record_name2').val();
	if(faVal!=null){
		jquery('#record_tunnel2 option').each(function(){
			if(jquery(this).attr('fa')!=null){
				for(var i=0;i<faVal.length;i++){
					if(faVal[i]==jquery(this).attr('fa')){
						faVal.splice(i,1);
						i--;
					}
				}
				
			}
		})
	}else{
		faVal=new Array();
	}
	
	if(tunVal!=null){
		if(jquery('[va='+tunVal+']').attr('fa')!=null){
			faVal.push(jquery('[va='+tunVal+']').attr('fa'));
		}
	}
	jquery('#record_name2').selectpicker("val",faVal);
}


function audioPlay(now){
	jquery('.voice_tag').each(function(){
		jquery(this).css('background','');	
	})
	jquery('audio').attr('src',jquery(now).attr('sound_src'));
	jquery('audio')[0].play();	
	jquery(now).css('background','#5cb85c url(/asset/images/icon_voice_soft.gif) no-repeat 10px 2px');	
}
jquery('audio').bind('ended',function(){
	var au_src=jquery('audio').attr('src');
	jquery("[sound_src='"+au_src+"']").css('background','');	
});

//新版添加农事投入品------
window.onload = function (){
	var searchStr = jQuery("#searchInfo_").val();
	if(searchStr == "" || searchStr == null){
		jQuery("#searchInfo_").val("请输入搜索条件");
		jQuery("#searchInfo_").css("color","#a8a8a8");
	}else if(searchStr == "请输入搜索条件"){
		jQuery("#searchInfo_").css("color","#a8a8a8");
	}else{
		jQuery("#searchInfo_").css("color","#000");
	}
}

//(1)删除投入品
function DeleteOutput(obj,inputsId){
	jQuery(obj).parents('.Output_tr').remove();
	jQuery("#check_"+inputsId).removeClass('checked');
	//取消全选
	if(jQuery("#mn_checkall").hasClass('checked')){   		
		jQuery("#mn_checkall").removeClass('checked');
	}
	resetIndex();  	
}
//添加投入品，由于删除，添加操作序号变乱，重新排序
function resetIndex(){
	var trLength=jQuery("#addInputsTable tr").length;
	for(var i=1;i<trLength;i++){
		jQuery("#addInputsTable tr:eq("+i+") td:eq(0) span").html(i);
  }
}
//(2-1)投入品表格复选框，全选功能
function OutputCheckAll(obj,oparents){
	if(jQuery(obj).hasClass('checked')){
		//取消全选
		jQuery(obj).removeClass('checked');
		jQuery(oparents).find('td .mn_check').removeClass('checked');
		//只取消本页的
		//jQuery("#addInputsTable .Output_tr").remove();
		var trLength=jQuery("#inputsTable tr").length;
		for(var i=0;i<trLength;i++){
			var inputIds=jQuery("#inputsTable tr:eq("+i+") td:eq(0) input:eq(0)").val();
			jQuery("#addtr_"+inputIds).remove();
  		}
		resetIndex();  	
	}else{   		
		//var trLength=jQuery("#inputsTable tr").length;
		//全选时，判断没有选中的添加到投入品，已添加的不在查询
		var inputIds="";   		
		var noCheckObj=jQuery("#inputs_table").find('td .mn_check ').not(".checked");
		var trLength=noCheckObj.length;
		
		for(var i=0;i<trLength;i++){
			//inputIds+=jQuery("#inputsTable tr:eq("+i+") td:eq(0) input:eq(0)").val()+",";
			inputIds+=jQuery(noCheckObj).eq(i).siblings("input:eq(0)").val()+",";
      } 
      if(trLength>1){
      	inputIds=inputIds.substring(0,inputIds.length-1);
      }
		//如果是空，则是没有选中状态,点击后全选
		jQuery(obj).addClass('checked');
		jQuery(oparents).find('td .mn_check').addClass('checked');
		//添加多个投入品，获取库存信息
		changeGoodsInfo(inputIds);  
		jQuery("#login").show();
	}
}
var tableStr="";
//(2-2)如果有一个复选框没有选中，则全选按钮为取消状态，否则相反
function OutputCheck(obj,oparents,oAll,inputsId){
	if(jQuery(obj).hasClass('checked')){
		//取消全选
		jQuery(obj).removeClass('checked');
		//如果一个取消，那么全选为取消状态
		jQuery(oAll).removeClass('checked');
		jQuery('#addtr_'+inputsId).remove();
		resetIndex();  	
	}else{
		jQuery(obj).addClass('checked');
		//如果是空，则是没有选中状态,点击后选择
		var allNum = jQuery(oparents).find('td .mn_check').length;
		var allLen = jQuery(oparents).find('td .mn_check.checked').length;
		//alert('allNum:'+allNum+'allLen:'+allLen)
		//如果个数和选中的个数相等，则全选为选中状态
		if(allLen == allNum){
  		jQuery(oAll).addClass('checked');
		}else{
  		jQuery(oAll).removeClass('checked');
		}
		//添加一个投入品，获取库存信息
		changeGoodsInfo(inputsId);    		
		jQuery("#login").show();
	}
}
//添加投入品-获取库存信息回调
function storageCallback(resultData){
  var inputList=resultData.result;
  jquery(inputList).each(function(index, data){
		var inputsId=data.inputsInfoId;
	        var rowNum=jQuery("#addInputsTable tr").length;
	    	var inputName=jQuery("#trp_"+inputsId+" td:eq(2) p").html();
	    	var unitName=jQuery("#trp_"+inputsId+" td:eq(3) p").html();
	    	var storageRoomSel="<select class='selectpicker'  onchange='changeRoom(this.value,"+inputsId+")'><option value='0'>无</option>";
	    	var goodsBatchSel="<select class='selectpicker' multiple='multiple' onchange='changeGoodsBatch(this,"+inputsId+")'>";
	    	var farmerInfoSel="<select class='selectpicker' >";
	    	if(typeof(data.storageRoom) != "undefined"){
	    		storageRoomSel+=data.storageRoom;
	    	} 
	    	if(typeof(data.goodsBatch) != "undefined"){
	    		goodsBatchSel+=data.goodsBatch;
	    	}
	    	if(typeof(data.farmerInfo) != "undefined"){
	    		farmerInfoSel+=data.farmerInfo;
	    	}  	
	    	storageRoomSel+="</select>";
	    	goodsBatchSel+="</select>";
	    	farmerInfoSel+="</select>";
	    	
	    	tableStr="<tr class=\"Output_tr\" id='addtr_"+inputsId+"'>"+
		    	"<td class=\"br_bt br_rt\">"+
	    		"<input type='hidden' value='"+inputsId+"'/>"+
		    		"<input type='hidden' value='' id='unit_"+inputsId+"'/><span>"+rowNum+"</span></td>"+
		    	"<td class=\"br_bt br_rt\"><p class=\"ellipsis\" title='"+inputName+"'>"+inputName+"</p></td>"+
		    	"<td class=\"br_bt br_rt\"><p class=\"ellipsis\" title='"+unitName+"'>"+unitName+"</p></td>"+   	
		    	"<td class=\"br_bt br_rt\">"+
		    		"<input class=\"Output_input\" onblur=\"useNumBlur(this.value,"+inputsId+")\"></input>"+
		    	"</td>"+
		    	"<td class=\"br_bt br_rt\">"+
		    		"<input class=\"Output_input\" value='0'></input>"+
		    	"</td>"+
		    	"<td class=\"br_bt br_rt\">"+
			    	"<div class=\"Output_selectpicker\" id='room_"+inputsId+"'>"+storageRoomSel+"</div>"+
		    	"</td>"+
		    	"<td class=\"br_bt br_rt\">"+
		    		"<div class=\"Output_selectpicker\" id='batch_"+inputsId+"'>"+goodsBatchSel+"</div>"+
		    	"</td>"+
		    	"<td class=\"br_bt br_rt\">"+
					"<div class=\"Output_selectpicker\" id='farmer_"+inputsId+"'>"+farmerInfoSel+"</div>"+
				"</td>"+
		    	"<td class=\"br_bt br_rt\" style='overflow: hidden;' id='goodsCount_"+inputsId+"'>0</td>"+
		    	"<td class=\"br_bt\">"+
		    		"<a href=\"javascript:;\" onclick=\"DeleteOutput(this,"+inputsId+")\">删除</a>"+
		    	"</td>"+
	    	"</tr>";
	    	jquery("#addInputsTable").append(tableStr);
	});    
	jquery('.selectpicker').selectpicker();			
	jQuery("#login").hide();
}
//(3)获取焦点，失去焦点
function FocusFn(obj,oColor,txt_val){
	if(jQuery(obj).val()==txt_val){
		jQuery(obj).val('');
		jQuery(obj).css('color',oColor)
	}
}
function BlurFn(obj,oColor,txt_val){
	if(jQuery(obj).val()==''){
		jQuery(obj).val(txt_val);
		jQuery(obj).css('color',oColor)
	}
}
//投入品列表信息查询
function searchInputs(pageNum){
	var plantValues="";
	if(jquery('#addJihua').is(":visible")){
		plantValues=jquery("#record_tunnel2").selectpicker("val");
	}else{
		plantValues=jquery("#record_tunnel").val();
	}	
	var inputType=jquery("#inputType").val();
	var searchText=jquery("#searchInputText").val();
	if(searchText=="请输入查询内容"){
		searchText="";
	}
	searchInputsList(inputType,"'"+plantValues+"'",searchText,pageNum);
	jquery("#login").show();
}
//翻页
function inputsJump(inputsPageNum){
	searchInputs(inputsPageNum);
}

function getCostByPrice(inputsId){
	var costObj=jQuery("#addtr_"+inputsId+" td:eq(4) input:eq(0)");
	var batchId=jQuery("#addtr_"+inputsId+" td:eq(6) select").val();
	var priceObj=jQuery("#addtr_"+inputsId+" td:eq(6) select").find("option:selected");

	if(batchId==null){//没有选择批次
		//jQuery(costObj).val(0);
		return;
	}
	var price=0;

    for(var i=0;i<batchId.length;i++){//循环选择的批次
		for(var i=0;i<priceObj.length;i++){//循环批次价格
			var batchPrice=jQuery(priceObj).attr("price");
			if(batchId[i]==jQuery(priceObj).val() && batchPrice>0){//匹配价格，多个批次取不为0的第一个价格
			 	price=batchPrice;
			 	break;
			}
		}
		if(price>0){
			break;
		}
    }
	var useNum=jQuery("#addtr_"+inputsId+" td:eq(3) input:eq(0)").val();
	if(null==useNum || ""==useNum){
		return false;
	}else if(!isFloat(useNum)){
		return false;
	}else if(price>0){
		jQuery(costObj).val((useNum*price).toFixed(2));
	}
}
//使用量失去焦点
function useNumBlur(useNum,inputsId){
	if(null==useNum || ""==useNum){
		return false;
	}else if(!isFloat(useNum)){
		return false;
	}
	getCostByPrice(inputsId);
}
//]]>
</script>
            </td>
	</ui:define>

</ui:composition>
