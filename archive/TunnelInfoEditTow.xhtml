<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	template="/layout/template.xhtml">

	<ui:define name="body">
	<style>
	.all_da{
	margin-left:165px;
	}
 .dr-mpnl-pnl{border:none; padding:0;}
 .dr-mpnl-shadow{background:none;}
 .dr-mpnl-pnl-b{padding:0; font-size:12px;}
.ts_div2{width:240px; height: 125px; border: 1px solid #81C5E9; margin: 0px auto; padding: 0 15px 15px;  background: url(#{request.contextPath}/asset/images/tck_bg_14.jpg) #ffffff repeat-x scroll center top;}
 </style>
            <!--右边开始-->
            <td valign="top" >
            <h:form id="tunnelInfoForm" enctype="multipart/form-data">
            <rich:modalPanel id="products" autosized="true" height="125"
				width="240" headerClass="modalHeader">
				<div class="ts_div2" id="div2">
				<div class="tck_ti"><a href="#"> <h:outputLink value="#"
					onclick="#{rich:component('products')}.hide(); return false;">
					<img src="#{request.contextPath}/asset/images/close_17.jpg"
						width="20" height="20" onclick="return closeMethod()" />
				</h:outputLink> </a></div>

				<table
					style="width: 100%; margin-top: 25px; table-layout: fixed; margin-left: 15px;">
					<tr>
						<td width="46" align="left"><img
							src="#{request.contextPath}/asset/images/tstc.jpg" width="46"
							height="46" /></td>
						<td align="left"
							style="font-family: '宋体'; color: #000000; font-size: 12px; padding-left: 15px;">
						<span id="productMsg">*号部分为必填项！</span></td>
					</tr>
				</table>
				</div>
			</rich:modalPanel>
			<!-- #{tunnelInfoHome.getFarmerMethod()} -->
                <div class="right_c">
                	<div class="r_title">
                    	<div class="r_t_l">
                    	<s:link propagation="none"  view="/record/RecordManagement.xhtml" style="text-decoration:none;color:black;" value="基础信息 "/>
                    	&#160;&gt;&#160;&#160;<font size="3">大棚信息</font></div>
						<div class="r_t_r">
						<ul>
								<li >
								<a href="#{request.contextPath}/record/PrintRecordList.seam" style="text-decoration:none;color:black;" >
			                 		<img src="#{request.contextPath}/asset/images/0001_03.jpg" width="11" height="9" />
			              			打印记录
			              		</a>
			        			</li>
								<li style="border-right:1px solid #ccc;">
									<a href="#{request.contextPath}/record/ProductBaseInfoList.seam" style="text-decoration:none;color:black;" >
									<img src="#{request.contextPath}/asset/images/newlvli_03.jpg" width="11" height="9" />
			                      	  履历管理
			                      	  </a>
			                    </li>
		     			</ul>
					</div>
                    </div>
				<!--入库订单列表开始-->
                	<div class="all_d3">
                    	<div class="all_da all_w01" >
                        	<table>
                                <tr>
                                    <td class="all_te">温室名称：</td>
                                    <td>
                                       <h:inputText id="tunnelName" styleClass="r_c_text" value="#{tunnelInfoHome.instance.tunnelName}"/>
                                       <font color="#FF0000">*</font>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    	<div class="all_da all_w01">
                        	<table>
                            	<tr>
                                	<td class="all_te">单元名称：</td>
                                    <td><h:inputText class="r_c_text" value="#{tunnelInfoHome.instance.tunnelChildName}" /></td>
                            	</tr>
                            </table>
                        </div>
                        <div class="all_da all_w01" >
                        	<table>
                                <tr>
                                    <td class="all_te">农场监督：</td>
                                    <td>
                                    	<h:selectOneMenu  id="masterInfo"  style="width:150px;" value="#{tunnelInfoHome.instance.masterInfo}">
											<s:selectItems value="#{tunnelInfoHome.masterListTwo}" var="obj" label="#{obj.name}"/>
											<s:convertEntity />
										</h:selectOneMenu>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    	<div class="all_da all_w01">
                        	<table>
                            	<tr>
                                	<td class="all_te">农场管家：</td>
                                    <td>
                                    	<h:selectOneMenu  style="width:150px;" value="#{tunnelInfoHome.instance.keeperInfo}">
											<s:selectItems value="#{tunnelInfoHome.keeperListTwo}" var="obj"   label="#{obj.name}"/>
											<s:convertEntity />
										</h:selectOneMenu>
                                   </td>
                            	</tr>
                            </table>
                        </div>
                    	<div class="all_da all_w01">
                        	<table>
                                <tr>
                                    <td class="all_te">基地名称：</td>
                                    <td align="left">
                                    <h:inputText id="address"  value="#{tunnelInfoHome.instance.address}"	styleClass="r_c_text" />
                                    </td>
                                </tr>
                            </table>
                        </div>
                    	<div class="all_da all_w01">
                        	<table>
                                <tr>
                                    <td class="all_te">面积：</td>
                                    <td align="left"><h:inputText id="area"  value="#{tunnelInfoHome.instance.area}"	styleClass="r_c_text_date" />㎡</td>
                                </tr>
                            </table>
                        </div>
                    	<div class="all_da all_w01">
                        	<table>
                                <tr>
                                    <td class="all_te">图片：</td>
                                    <td align="left">
                                       <s:fileUpload id="imgIphoneUrl" size="40" accept="image/png,image/jpeg,image/gif" contentType="image/png,image/jpeg,image/gif" fileName="#{tunnelInfoHome.instance.pictureName}"
											data="#{tunnelInfoHome.instance.picture}">
											</s:fileUpload>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    	<div class="all_da all_w01">
                        	<table>
                                <tr>
                                    <td class="all_te">描述：</td>
                                    <td>
                                         <h:inputText id="desc"    value="#{tunnelInfoHome.instance.description}" styleClass="r_c_text" />
                                    </td>
                                </tr>
                            </table>
                        </div>
                        
                        
                      <div class="r_title">
                    	<div style="text-align:center;" width="100%"><font size="4"><strong>该大棚种植信息</strong></font></div>
                    </div>
                        <br/>
                        <br/>
                        <s:decorate rendered="#{empty tunnelInfoHome.rpList}" >
								<div class="all_da all_w01" style="*height:36px; *overflow:hidden; ">
		                        	<table width="100%">
		                                <tr>
		                                    <td class="all_te" >种植品种：</td>
		                                    <td>
		                                    	<h:selectOneMenu immediate="true" styleClass="small2" id="breedBreedId" style="margin:0 auto;" value="#{tunnelInfoHome.rpInfo.breedBreedId}">
													<s:selectItems value="#{tunnelInfoHome.getBreedList()}" var="var" label="#{var.name}" />
													<s:convertEntity />
												</h:selectOneMenu>
		                                    </td>
		                                </tr>
		                            </table>
		                        </div>
		                        <div class="all_da all_w01" style="*height:36px; *overflow:hidden; ">
		                        	<table width="100%">
		                                <tr>
		                                    <td class="all_te" >种植标准：</td>
		                                    <td>
												<h:selectOneMenu style="margin:0 auto;"  styleClass="small2" id="plantingPattern" value="#{tunnelInfoHome.rpInfo.plantStandard}">
													<s:selectItems value="#{realPlantHome.getPlMethod()}" var="var" label="#{var.name}" itemValue="#{var.dataDicId}"/>
												</h:selectOneMenu>
		                                    </td>
		                                </tr>
		                            </table>
		                        </div>
		                        <div class="all_da all_w01">
		                        	<table width="100%">
		                            	<tr>
		                                	<td class="all_te" >种植时间：</td>
		                                    <td>
		                                    <rich:calendar id="plantBeginTime"  datePattern="yyyy-MM-dd"  value="#{tunnelInfoHome.rpInfo.plantBeginTime}"/>
		                                    <font color="#FF0000">*</font>
		                                    </td>
		                            	</tr>
		                            </table>
		                        </div>
                        </s:decorate>
                        <h:panelGroup id="persistList"> 
                        <s:decorate rendered="#{not empty tunnelInfoHome.rpList}" >
                       	<div class="tjan_04" style = "display: #{tunnelInfoHome.alertString eq 1 ?'block':'none'};">
                    		<a href="#" onclick="getrpInfo(0);return false;" ><img src="../asset/images/tj_03.jpg" width="44" height="30" /></a>
                    	</div>
                        <table width="100%" class="ze_table" cellpadding="0" cellspacing="0">
	                    	<tr>
	                    		<td width="5" height="4"><img src="#{request.contextPath}/asset/images/table_d_40.jpg" width="5" height="4" /></td>
	                    		<td colspan="8" style="border-top:1px solid #e1e1e1; background:#f0f5fb;"></td>
	                            <td width="5" height="4"><img src="#{request.contextPath}/asset/images/table_d_43.jpg" width="5" height="4" /></td>
	                    	</tr>
	                    	<tr>
	                    		<th class="ze_bg ze_bt_le" width="5" height="4"></th>
	                            
	                    		<th class="ze_bg" width="20%">种植品种</th>
	                    		<th class="ze_bg" width="20%">种植时间</th>
	                    		<th class="ze_bg" width="20%">结束时间</th>
	                    		<th class="ze_bg" width="20%">种植状态</th>
	                    		<th class="ze_bg" width="20%">操作</th>
	                            
	                            <th class="ze_bg ze_bt_ri" width="5" height="4"></th>
	                    	</tr>
							<ui:repeat value="#{tunnelInfoHome.rpList}" var="_rp" rowKeyVar="_index">
	                    	<tr>
	                    		<td class="ze_bg2 ze_bt_le" width="5" height="4"></td>
	                            
	                    		<td class="ze_bg2"><h:outputText value="#{_rp.breedBreedId.name}" /></td>
	                    		<td class="ze_bg2"><h:outputText value="#{_rp.plantBeginTime}"><s:convertDateTime type="both" dateStyle="short" pattern="yyyy-MM-dd HH:mm:ss" /></h:outputText></td>
	                    		<td class="ze_bg2"><h:outputText value="#{_rp.plantEndTime}"><s:convertDateTime type="both" dateStyle="short" pattern="yyyy-MM-dd HH:mm:ss" /></h:outputText></td>
	                    		<td class="ze_bg2"><h:outputText value="#{_rp.plantStauts eq 1 ? '正在种植':'种植结束'}"/></td>
	                    		<td class="ze_bg2">
	                    		 <a class="print_fa" href="#" onclick="getrpInfo(#{_rp.realPlantId});return false;" style="display:#{_rp.plantStauts eq 1 ? 'inline-block':'none'};">种植结束</a> &#160;
	                    		 <a class="print_fa" href="#" onclick="deleterpInfo(#{_rp.realPlantId});">删除</a>
	                            </td>
	                            <td class="ze_bg2 ze_bt_ri" width="5" height="4"></td>
	                    	</tr>
	                    	</ui:repeat>
	                    </table>
                        </s:decorate>
                        </h:panelGroup>
                         <div class="clear"></div>
                   </div>
                        	<table width="280" style="margin:35px auto 0 auto;">
                               <tr>
							<td>
						<h:commandButton id="persistTow"  styleClass="edit_save" action="#{tunnelInfoHome.persistTow}" rendered="#{!tunnelInfoHome.managed}" onclick="return checkSubmit(1)"/>
		            	<h:commandButton id="updateTow"  styleClass="edit_save" action="#{tunnelInfoHome.updateTow}" rendered="#{tunnelInfoHome.managed}" onclick="return checkSubmit(1)" />
		            	&#160;<h:commandButton id="remove"  styleClass="edit_delete" action="#{tunnelInfoHome.removeTow}" rendered="#{tunnelInfoHome.managed}" style="margin-left:10px"  onclick="return confirm('确定删除吗？');"/>
		    			&#160;<s:button view="/record/RecordManagement.xhtml"  styleClass="edit_back" id="bn_left6" style="margin-left:10px" />
                            </td>
						</tr>
                            </table>
                        
                        <div class="clear"></div>

				<!--入库订单列表结束-->
                    <div class="clear"></div>
                </div><!--right_c结束-->
                <div class="clear"></div>
    <!--右边结束-->
    <style>
    .rich-calendar-button{
     margin-left:-8px
    }
    </style>
    </h:form>
     <a4j:form>
		<a4j:jsFunction name="updateRps" action="#{tunnelInfoHome.updateRps}" reRender="product" oncomplete="#{rich:component('product')}.show();www();return false;"  >
			<a4j:actionparam name="rpId" assignTo="#{tunnelInfoHome.rpId}"/>
		</a4j:jsFunction>
		<a4j:jsFunction name="removeRp" action="#{tunnelInfoHome.removeRp}" reRender="persistList">
			<a4j:actionparam name="rpId" assignTo="#{tunnelInfoHome.rpId}"/>
		</a4j:jsFunction>
	</a4j:form>
     <rich:modalPanel id="product" autosized="true" height="173" width="400" headerClass="modalHeader" >
						<div class="tck_div" style="width: 400px;">
       						<div class="tck_ti" style="width: 400px;">
       							<h:outputLink value="#" onclick="#{rich:component('product')}.hide(); return false;">
                    				<img src="../asset/images/close_17.jpg" width="20" height="20"/>
				                </h:outputLink>
				        	</div>
				        	<h:panelGroup id="gbInfo"> 
       						<h:form id="goodsBatch" >
								<div class="all_da all_w01" style="*height:36px; *overflow:hidden; margin-left: 0px; margin-top:15px;">
		                        	<table width="100%">
		                                <tr>
		                                    <td class="all_te">种植品种：</td>
		                                    <td>
		                                    	<h:selectOneMenu immediate="true" id="breedBreedId" style="width:146px;" value="#{tunnelInfoHome.rpInfo.breedBreedId}">
													<s:selectItems value="#{tunnelInfoHome.getBreedList()}" var="var" label="#{var.name}" />
													<s:convertEntity />
												</h:selectOneMenu>
		                                    </td>
		                                </tr>
		                            </table>
		                        </div>
		                        <div class="all_da all_w01" style="*height:36px; *overflow:hidden; margin-left: 0px;">
		                        	<table width="100%">
		                            	<tr>
		                                	<td class="all_te" >种植时间：</td>
		                                    <td>
		                                    <rich:calendar id="plantBeginTime"  datePattern="yyyy-MM-dd"  value="#{tunnelInfoHome.rpInfo.plantBeginTime}"/>
		                                    <font color="#FF0000">*</font>
		                                    </td>
		                            	</tr>
		                            </table>
		                        </div>
		                       <div class="all_da all_w01" style="*height:36px; *overflow:hidden; margin-left: 0px;display: #{!tunnelInfoHome.flag ?'block':'none'};">
		                        	<table width="100%">
		                            	<tr>
		                                	<td class="all_te">结束时间：</td>
		                                    <td><rich:calendar id="plantEndTime"  datePattern="yyyy-MM-dd"  value="#{tunnelInfoHome.rpInfo.plantEndTime}"/>
		                                    <font color="#FF0000">*</font>
		                                    </td>
		                            	</tr>
		                            </table>
		                        </div>
								<div style="text-align:center;">
						            	<a4j:commandButton id="persistRp" value="保存" image="../images/safe.jpg"   style="width:74px;height:26px; margin-right:10px;" action="#{tunnelInfoHome.persistRp}" rendered="#{tunnelInfoHome.flag}" reRender="persistList" oncomplete="#{rich:component('product')}.hide();" eventsQueue="default" onclick="if(!checkSubmit2()) return false;"/>
						            	<a4j:commandButton id="updateRp" value="修改" image="../images/safe.jpg"   style="width:74px;height:26px; margin-right:10px;" action="#{tunnelInfoHome.updateRp}" rendered="#{!tunnelInfoHome.flag}" reRender="persistList" oncomplete="#{rich:component('product')}.hide();" eventsQueue="default" onclick="if(!checkSubmit3()) return false;"/>
						    			<h:outputLink value="#" onclick="#{rich:component('product')}.hide(); return false;"><img class="er_buttton" src="../images/button_17.jpg" width="74" height="26" /></h:outputLink>
						    	</div>
							</h:form>
							</h:panelGroup>
				       </div>
				   </rich:modalPanel>
<script type="text/javascript">

//<![CDATA[	
    jquery(".rich-calendar-input").addClass("r_c_text_date12");
	jquery(".rich-calendar-input").removeClass("rich-calendar-input");
	function checkSubmit(obj){
		   var tunnelName = document.getElementById("tunnelInfoForm:tunnelName").value; //温室名称
		   var area = document.getElementById("tunnelInfoForm:area").value;
			var regNum = /^[1-9]+[0-9]*]*$/; 
			var regDNum = /^[+|-]?\d*\.?\d*$/;
		   if(tunnelName == ""){
				document.getElementById("productMsg").innerHTML = "温室名称不能为空";
				#{rich:component('products')}.show();
				return false;
			}
			if(area != "" && !regDNum.test(area)){
				document.getElementById("productMsg").innerHTML = "面积输入不正确";
				#{rich:component('products')}.show();
				return false;
			}
			if(obj == 1){
				var plantBeginTime = document.getElementById("tunnelInfoForm:j_id97:plantBeginTimeInputDate").value;
				if(plantBeginTime == ""){
					document.getElementById("productMsg").innerHTML = "种植时间不能为空";
					#{rich:component('products')}.show();
					return false;
				}
			}
			if(obj == 2){
				
				var plantBeginTime = document.getElementById("goodsBatch:plantBeginTimeInputDate").value;
			    var plantEndTime = document.getElementById("goodsBatch:plantEndTimeInputDate").value;
				if(plantBeginTime == ""){
					document.getElementById("productMsg").innerHTML = "种植时间不能为空";
					#{rich:component('products')}.show();
					return false;
				}
				if(plantEndTime == ""){
					document.getElementById("productMsg").innerHTML = "种植结束时间不能为空";
					#{rich:component('products')}.show();
					return false;
				}
			}
	}
	function checkSubmit2(obj){
		var plantBeginTime = document.getElementById("goodsBatch:plantBeginTimeInputDate").value;
		if(plantBeginTime == ""){
			document.getElementById("productMsg").innerHTML = "种植时间不能为空";
			#{rich:component('products')}.show();
			return false;
		}
		return true;
	}
	function checkSubmit3(obj){
	    var plantEndTime = document.getElementById("goodsBatch:plantEndTimeInputDate").value;
		if(plantEndTime == ""){
			document.getElementById("productMsg").innerHTML = "种植结束时间不能为空";
			#{rich:component('products')}.show();
			return false;
		}
		return true;
	}
	
	function closeMethod(){
		var tunnelName = document.getElementById("tunnelInfoForm:tunnelName").value; //温室名称
		   var area = document.getElementById("tunnelInfoForm:area").value;
		   var regNum = /^[1-9]+[0-9]*]*$/; 
			var regDNum = /^[+|-]?\d*\.?\d*$/;
		   if(tunnelName == ""){
			   document.getElementById("tunnelInfoForm:tunnelName").focus();
			   return false;
			}
			if(area != "" && !regDNum.test(area)){
				document.getElementById("tunnelInfoForm:area").focus();
				   return false;
			}
	}
	//]]>
</script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/superfish.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/supersubs.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/hoverIntent.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/jquery.flot.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/jquery-ui.js"></script>

<script type="text/javascript" src="#{request.contextPath}/asset/js/form/jquery-ui-select.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/customInput.jquery.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/jquery.dataTables.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/jquery.fancybox-1.3.4.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/jquery.filestyle.mini.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/jquery-ui-timepicker-addon.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/jquery.treeview.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/jquery.tipsy.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/jquery.wysiwyg.js"></script>
<script type="text/javascript" src="#{request.contextPath}/asset/js/form/inline.js"></script>
<script type="text/javascript">
function getrpInfo(rpId){
	updateRps(rpId);
}
function deleterpInfo(rpId){
	if (confirm('确定删除吗？')) {
		removeRp(rpId);
	}
	
}
www = function(){
    jquery(".ui-selectmenu").remove();
	jquery('select').selectmenu({style:'dropdown'})
	jquery(".rich-calendar-input").addClass("r_c_text_date");
	jquery(".rich-calendar-input").removeClass("rich-calendar-input");
}

</script>
            </td> 
	</ui:define>

</ui:composition>
