<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j"
	template="/layout/empty_template.xhtml"
	xmlns:a="http://richfaces.org/a4j">

	<ui:define name="body">
		<link rel="stylesheet" type="text/css" href="#{request.contextPath}/asset/css/orderManage/AllOrder.css"/>
		<link rel="stylesheet" type="text/css" href="#{request.contextPath}/asset/css/orderManage/skinBlue.css"/>
		#{refundOperateList.refundOperateListInit()}
		<td valign="top" >
				<div class="content">	
				    <table width="100%" height="100%" cellpadding="0" cellspacing="0">
				    	<tr>
				        <td valign="top" width="210" style=" border-right:1px solid #e1e4eb;">
				        <div class="levelMenu_list3" style="min-height:500px;">
				        	<ul class="levelMenu_ul3">
				            	<li><a class="link #{refundOperateList.orderStatus == 0 ? 'curLink' : ''}" href="../orderManage/OrderOperateList.seam?orderStatus=0&amp;pages=1"><img src="../asset/images/orderManage/levelMenu50.png" />全部订单<em class="num">#{refundOperateList.orderNumberArr[0]}</em></a></li>
				        		<h:outputText rendered="#{sessionTake.orderAudit}">
				        		<li><a class="link #{refundOperateList.orderStatus == 11 ? 'curLink' : ''}" href="../orderManage/OrderReturnList.seam?orderStatus=11&amp;pages=1"><img src="../asset/images/orderManage/levelMenu006.png" />订单已驳回<em class="num">#{refundOperateList.orderNumberArr[11]}</em></a></li>
				            	</h:outputText>
<!-- 				            	<h:outputText rendered="#{sessionTake.orderReceive}"> -->
				            	<li><a class="link #{refundOperateList.orderStatus == 13 ? 'curLink' : ''}" href="../orderManage/OrderAcceptList.seam?orderStatus=13&amp;pages=1"><img src="../asset/images/orderManage/levelMenu51.png" />订单待接受<em class="num">#{refundOperateList.orderNumberArr[13]}</em></a></li>
<!-- 				        		</h:outputText> -->
				        		<h:outputText rendered="#{sessionTake.orderAudit}">
				        		<li><a class="link #{refundOperateList.orderStatus == 1 ? 'curLink' : ''}" href="../orderManage/OrderAuditList.seam?orderStatus=1&amp;pages=1"><img src="../asset/images/orderManage/levelMenu51.png" />订单待审核<em class="num">#{refundOperateList.orderNumberArr[1]}</em></a></li>
				                </h:outputText>
				                <h:outputText rendered="#{sessionTake.orderHandle}">
				                <li><a class="link #{refundOperateList.orderStatus == 2 ? 'curLink' : ''}" href="../orderManage/OrderDisposeList.seam?orderStatus=2&amp;pages=1"><img src="../asset/images/orderManage/levelMenu52.png" />订单待处理<em class="num">#{refundOperateList.orderNumberArr[2]}</em></a></li>
				               	</h:outputText>
				               	<h:outputText rendered="#{sessionTake.orderTally}">
				                <li><a class="link #{refundOperateList.orderStatus == 14 ? 'curLink' : ''}" href="../orderManage/OrderTallyList.seam?orderStatus=14&amp;pages=1"><img src="../asset/images/orderManage/lihuo-icon.png" />订单理货中<em class="num">#{refundOperateList.orderNumberArr[14]}</em></a></li>
				                </h:outputText>
				                <h:outputText rendered="#{sessionTake.orderShipments}">
				                <li><a class="link #{refundOperateList.orderStatus == 3 ? 'curLink' : ''}" href="../orderManage/OrderDeliveryList.seam?orderStatus=3&amp;pages=1"><img src="../asset/images/orderManage/levelMenu53.png" />订单待发货<em class="num">#{refundOperateList.orderNumberArr[3]}</em></a></li>
				                </h:outputText>
				                <h:outputText rendered="#{sessionTake.orderDispatching}">
				                <li><a class="link #{refundOperateList.orderStatus == 4 ? 'curLink' : ''}" href="../orderManage/OrderTransportList.seam?orderStatus=4&amp;pages=1"><img src="../asset/images/orderManage/levelMenu54.png" />订单配送中<em class="num">#{refundOperateList.orderNumberArr[4]}</em></a></li>
				                </h:outputText>
				                <li><a class="link #{refundOperateList.orderStatus == 5 ? 'curLink' : ''}" href="../orderManage/OrderFinishList.seam?orderStatus=5&amp;pages=1"><img src="../asset/images/orderManage/levelMenu55.png" />订单已完成<em class="num">#{refundOperateList.orderNumberArr[5]}</em></a></li>
				                <li><a class="link #{refundOperateList.orderStatus == 6 ? 'curLink' : ''}" href="../orderManage/OrderDeleteList.seam?orderStatus=6&amp;pages=1"><img src="../asset/images/orderManage/levelMenu56.png" />订单已删除<em class="num">#{refundOperateList.orderNumberArr[6]}</em></a></li>
				                <li class="line"></li>
				                <s:fragment rendered="#{sessionTake.refundAudit == true}">
				            	<li><a class="link #{refundOperateList.orderStatus == 12 ? 'curLink' : ''}" href="../orderManage/RefundOperateList.seam?orderStatus=12&amp;pages=1"><img src="../asset/images/orderManage/levelMenu57.png" />退货单已驳回<em class="num">#{refundOperateList.orderNumberArr[12]}</em></a></li>
				            	<li><a class="link #{refundOperateList.orderStatus == 9 ? 'curLink' : ''}" href="../orderManage/RefundOperateList.seam?orderStatus=9&amp;pages=1"><img src="../asset/images/orderManage/levelMenu57.png" />订单待退货<em class="num">#{refundOperateList.orderNumberArr[9]}</em></a></li>
				                </s:fragment>
				                <li><a class="link #{refundOperateList.orderStatus == 10 ? 'curLink' : ''}" href="../orderManage/RefundOperateList.seam?orderStatus=10&amp;pages=1"><img src="../asset/images/orderManage/levelMenu58.png" />订单已退货<em class="num">#{refundOperateList.orderNumberArr[10]}</em></a></li>
				            </ul>
				        </div>
				        </td>
				        <td valign="top">
				        <div class="right_c clear" style="padding-top:20px; padding-bottom:20px;">
				            <div class="r_title clear" style="margin-top:0;">
				                <div class="r_t_l fl">采销存<span style="padding:0 5px;">&gt;</span>订单管理<span style="padding:0 5px;">&gt;</span><font size="3">#{refundOperateList.orderLabelArr[refundOperateList.orderStatus]}<span class="num">(<i>#{refundOperateList.orderNumberArr[refundOperateList.orderStatus]}</i>)</span></font></div>
				                <div class="fr" style="margin-bottom:-1px;">
				                    <ul class="cm_resumeList clear">
				                        <li>
				                            <a class="borderBt" href="#{request.contextPath}/orderManage/RefundOperateList.seam"><img src="../asset/images/orderManage/resumeIco50.jpg"/><span>订单管理</span></a>
				                        </li>
				                        <li>
				                            <a href="#{request.contextPath}/order/MemberInfoListOne.seam"><img src="../asset/images/orderManage/resumeIco51.jpg" /><span>客户管理</span></a>
				                        </li>
				                        <li>
				                            <a href="#{request.contextPath}/card/CardInfoList.seam?cardType=0"><img src="../asset/images/orderManage/resumeIco51.jpg" /><span>会员卡管理</span></a>
				                        </li>
				                        <h:panelGroup rendered="#{s:hasRole('coupon')}">
					                        <li >
				                                <a href="#{request.contextPath}/order/CouponList.seam"><img src="../asset/images/order/resumeIco150.jpg" /><span>红包管理</span></a>
				                            </li>
			                            </h:panelGroup>
				                    </ul>
				                </div>
				            </div>
				            <div class="allOrder_wap">
				            	<div class="allOrder_header mb20">
				                    <div class="search-header" style="margin-top:10px; margin-bottom:-5px;">
				                    	<h:form id="orderSearch">
											<input type="hidden" value="1" name="pages" />
					                        <div class="search-header-lt">
					                            <div class="public-search">
					                            	<h:inputText class="form-control mt5" autocomplete="off" id="orderSearch" value="#{refundOperateList.orderSearch}" style="width:240px;height:24px; line-height:22px; padding:0 5px; color:#b3b5b5; font-size:12px;" onfocus="if(this.value=='请输入订单编号/退单编号/收货人/销售人/手机'){this.value=''}" onblur="if(this.value==''){this.value='请输入订单编号/退单编号/收货人/销售人/手机'}"/>
					                            </div>
				                            	<h:commandButton id="orderCommand" styleClass="btn btn-primary mt5" style="height:24px; padding:0 10px;" action="/orderManage/RefundOperateList.xhtml" value="搜索"></h:commandButton>
					                        </div>
				                        </h:form>
				                    </div>
				                </div>
				                <div class="allOrder_body">
				                	<s:div id="contentList">
				                	<a:repeat value="#{refundOperateList.resultList}" var="_refund" rowKeyVar="_index">
				                		<div class="allOrder_items #{_refund.orderStatusCss}">
						                    <div class="itemsCon">
						                        <div class="itemsHd">
						                            <p class="orderNum fl">退单编号：<span>#{_refund.refundCode}</span></p>
						                            <p class="orderNum fl">订单编号：<span>#{_refund.orderInfo.orderCode}</span></p>
						                            <p class="fr">下单时间：
						                            	<span>
						                            		<h:outputText value="#{_refund.orderInfo.insertTime}">
										        				<s:convertDateTime type="both" dateStyle="short" pattern="yyyy-MM-dd HH:mm" />
										        			</h:outputText>
						                            	</span>
					                            	</p>
					                            	<h:outputText rendered="#{_refund.orderInfo.orderType eq 6}" >
				                                    	<p class="orderNum fl" style="margin-top:5px;margin-left: 30px;" title="微商城"><img src="../../asset/images/orderManage/wsc.png" alt=""/></p>
				                                    </h:outputText>
						                        </div>
						                        <div class="itemsBd">
						                            <table width="100%" cellspacing="0" cellpadding="0">
						                                <tbody>
						                                	<tr>
							                                    <td width="20%" style="padding-left:0;" class="tdLine"><span class="explain">收货人：</span>#{_refund.refundName}</td>
							                                    <td width="18%" class="tdLine"><span class="explain">销售人：</span>#{_refund.orderInfo.memberInfo.farmerInfoId != null ?_refund.orderInfo.memberInfo.farmerInfoId.name : ""}</td>
							                                    <td width="22%" class="tdLine"><span class="explain">退货时间：</span>
							                                    	<h:outputText value="#{_refund.insertTime}">
												        				<s:convertDateTime type="both" dateStyle="short" pattern="yyyy-MM-dd HH:mm" />
												        			</h:outputText>
							                                    </td>
							                                    <td width="18%"  class="tdLine"><span class="explain">支付状态：</span>#{_refund.orderInfo.paymentStatus == true ? '已支付' : '未支付'}</td>
							                                    <td align="center" width="22%">
							                                        <span class="auditBtn">
							                                        	<a href="javascript:void(0);" class="btn btn-primary" onclick="refundCauseControl(1, '#{_refund.orderInfo.orderCode}', '#{_refund.refundCause}');">查看退货原因</a>
							                                        	<s:fragment rendered="#{_refund.refundStatus == orderConstant.getWaitRefundStatus() and (s:hasRole('return_audit') or (sessionTake.levelId == 3 and sessionTake.admin == true))}">
							                                        		<a class="btn btn-primary" href="javascript:void(0);" onclick="refundAuditInitJs(#{_refund.refundInfoId}, '#{_refund.orderInfo.orderCode}', '#{_refund.refundTime}');">退货审核</a>
							                                        	</s:fragment>
							                                        </span>
							                                    </td>
							                                </tr>
							                                <tr>
							                                    <td style="padding-left:0;" class="tdLine"><span class="explain">联系方式：</span>#{_refund.refundPhone}</td>
							                                    <td class="tdLine"><span class="explain">金额：</span>¥<h:outputText value="#{_refund.totalAccount}" ><f:convertNumber pattern="#0.00"/></h:outputText></td>
							                                    <td class="tdLine">
							                                    	<span class="explain">配送时间：</span>
								                                    <h:outputText value="#{_refund.orderInfo.deliverTime}">
												        				<s:convertDateTime type="both" dateStyle="short" pattern="yyyy-MM-dd" />
												        			</h:outputText>
												        			<s:fragment rendered="#{_refund.orderInfo.timeSlot == 0}">全天</s:fragment>
												        			<s:fragment rendered="#{_refund.orderInfo.timeSlot == 1}">上午</s:fragment>
												        			<s:fragment rendered="#{_refund.orderInfo.timeSlot == 2}">下午</s:fragment>
												        			<s:fragment rendered="#{_refund.orderInfo.timeSlot == 3}">晚上</s:fragment>
							                                    </td>
							                                    <td style="padding-left:5px;" class="tdLine">
							                                    <h:outputText rendered="#{refundOperateList.getCardcodes(_refund.orderInfo.orderInfoId) ne ''}">
							                                    	<span class="explain" style="width: 100px;">使用会员卡名称：</span>
							                                    	<h:outputText value="#{refundOperateList.getCardcodes(_refund.orderInfo.orderInfoId)}" />
							                                    </h:outputText>
						                                    	</td>
							                                    <td align="center">
							                                    	<span class="btnsSet">
							                                        	<s:link view="/orderManage/RefundView.xhtml" title="查看" style="text-decoration:none;" propagation="#{empty from ? 'none' : 'default'}" id="refundViewId">
							                                    			<img src="../asset/images/orderManage/table_ico100.png" width="18" height="18" />
															                <f:param name="refundInfoId" value="#{_refund.refundInfoId}"/>
															                <f:param name="orderStatus" value="#{refundOperateList.orderStatus}"/>
															            </s:link>
															            <s:link view="/orderManage/RefundOperateList.xhtml" title="删除" style="text-decoration:none;" onclick="return confirm('确定删除吗？');" id="refundRemoveId" action="#{orderOperate.refundRemove}" rendered="#{refundOperateList.orderStatus == 9}">
															            	<img src="../asset/images/orderManage/table_ico102.png" width="18" height="18" />
															                <f:param name="refundInfoId" value="#{_refund.refundInfoId}"/>
															                <f:param name="refundStatus" value="#{refundOperateList.orderStatus}"/>
															            </s:link>
							                                        </span>
							                                    </td>
							                                </tr>
						                            	</tbody>
						                            </table>
						                        </div>
						                    </div>
					                    </div>
				                	</a:repeat>
				                	</s:div>
				                </div>
				                <s:div id="paging">
				                <input type="hidden" value="#{refundOperateList.orderStatus}" id="orderStatus" />
				                <input type="hidden" value="#{refundOperateList.orderSearch}" id="orderSearch" />
					            <table cellspacing="0" cellpadding="0" style="height:30px; margin:40px auto 20px auto;">
					                <tr>
					                	<td><img width="4" height="32" src="../asset/images/orderManage/page_67.jpg"></img></td>
					                	<td class="td_t_b">
					                		<s:link view="/orderManage/RefundOperateList.xhtml" value="首页" id="firstPage">
												<f:param name="pages" value="1"/>
												<f:param name="orderStatus" value="#{refundOperateList.orderStatus}"/>
												<f:param name="orderSearch" value="#{refundOperateList.orderSearch}"/>
											</s:link>
					                	</td>
					                	<s:fragment rendered="#{refundOperateList.previousExists}">
						                    <td class="td_t_b td_t_t">
					                    		<s:link view="/orderManage/RefundOperateList.xhtml" value="&lt;&lt;" id="previousPage" styleClass="no_n">
													<f:param name="pages" value="#{refundOperateList.previousFirstResult}"/>
													<f:param name="orderStatus" value="#{refundOperateList.orderStatus}"/>
													<f:param name="orderSearch" value="#{refundOperateList.orderSearch}"/>
												</s:link>
						                    </td>
					                    </s:fragment>
					                    <s:fragment rendered="#{refundOperateList.pageNoList.size() > 0}">
					                    	<a:repeat value="#{refundOperateList.pageNoList}" var="_pageNo" >
						                    	<td class="td_t_b td_t_t #{refundOperateList.pages == _pageNo ? 'onp' : ''}">
						                    		<s:link view="/orderManage/RefundOperateList.xhtml" value="#{_pageNo}">
														<f:param name="pages" value="#{_pageNo}"/>
														<f:param name="orderStatus" value="#{refundOperateList.orderStatus}"/>
														<f:param name="orderSearch" value="#{refundOperateList.orderSearch}"/>
													</s:link>
						                    	</td>
											</a:repeat>
					                    </s:fragment>
										<s:fragment rendered="#{refundOperateList.nextExists}">
											<td class="td_t_b td_t_t">
						                    	<s:link view="/orderManage/RefundOperateList.xhtml" value="&gt;&gt;" id="nextPage" styleClass="no_d" >
													<f:param name="pages" value="#{refundOperateList.nextFirstResult}"/>
													<f:param name="orderStatus" value="#{refundOperateList.orderStatus}"/>
													<f:param name="orderSearch" value="#{refundOperateList.orderSearch}"/>
												</s:link>
						                    </td>
						                    <td class="td_t_b td_t_t">
						                    	<s:link view="/orderManage/RefundOperateList.xhtml"  value="尾页" id="lastPage">
													<f:param name="pages" value="#{refundOperateList.lastFirstResult}"/>
													<f:param name="orderStatus" value="#{refundOperateList.orderStatus}"/>
													<f:param name="orderSearch" value="#{refundOperateList.orderSearch}"/>
												</s:link>
											</td>
										</s:fragment>
					                    <td class="td_t_b td_t_t"><span style="color:#9a9a9a;">共#{refundOperateList.pageCount}页</span></td>
					                    <td><img width="4" height="32" src="../asset/images/orderManage/page_70.jpg"></img></td>
					                </tr>
					            </table>
					            </s:div>
				        	</div>
			        	</div>
			        </td>
					</tr>
			   </table>
			</div>
			
			<div class="modal fade" id="refundCauseDiv" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
			<div class="modal-dialog" style="position:absolute; left:50%; top:50%; width:570px; margin-left:-285px; margin-top:-170px;">
			<div class="modal-content">
			    <div class="modal-header">
			        <button type="button" class="close" data-dismiss="modal" style="margin-top:5px;"></button>
			        <h4 class="modal-title" id="myModalLabel" style="font-size:16px;">退货原因</h4>
			    </div>
			    <div class="modal-body" style="height:160px; overflow:auto; padding:30px;">
			    	<table class="modalTable_minni" width="100%" cellpadding="0" cellspacing="0">
			        	<tr>
			            	<td width="80" align="right" class="pr10">订单编号</td>
			                <td id="orderCode">DD2015004839783</td>
			            </tr>
			            <tr>
			            	<td align="right" class="pr10">退货原因</td>
			                <td id="refundCause"></td>
			            </tr>
			        </table>     
			    </div>
			    <div class="modal-footer">
			        <a class="btn btn-default" data-dismiss="modal" href="javascript:void(0);">取消</a>
			    </div>
			</div>
			</div>
			</div>
			
			<div class="modal fade" id="refundAuditDiv" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
			<div class="modal-dialog" style="position:absolute; left:50%; top:50%; width:680px; margin-left:-340px; margin-top:-248px;">
			<div class="modal-content">
			    <div class="modal-header">
			        <button type="button" class="close" data-dismiss="modal" style="margin-top:5px;"></button>
			        <h4 class="modal-title" id="myModalLabel" style="font-size:16px;">退货审核</h4>
			    </div>
			    <div class="modal-body" style="height:340px; overflow:auto; padding:20px 30px;">
			    	<p class="user_returnXxTip">订单编号：<span class="num" id="refundAuditCode"></span>退货时间：<span class="time" id="refundAuditTime"></span></p>
			    	<div style="overflow:hidden;">
				    	<span style="float:left;font-size:13px;">审核原因：</span>
				    	<div class="controlLen_area fl" style="display:block;height:60px;width:550px;">
				    		<textarea class="form-control" id="refundRemark" onkeyup="words_deal('refundRemark', 100);"></textarea><em class="num"><span id="refundRemarkNum">0</span>/100</em>
			    		</div>
		    		</div>
			    	<div class="listGoods_con returnSH_list mt20 mb20" style="border-bottom:1px solid #e1e1e1; overflow:hidden;">
			            <table class="tableModel thead" width="100%" cellpadding="0" cellspacing="0">
			                <thead>
			                <tr>
			                    <th width="20%">商品编号</th>
			                    <th width="18%">商品名称</th>
			                    <th width="12%">商品规格</th>
			                    <th width="10%">数量</th>
			                    <th width="12%">商品原价</th>
			                    <th width="12%">商品单价</th>
			                    <th width="12%">商品总价</th>
			                </tr>
			                </thead>
			            </table>
			            <div class="tableFixed_scroll" style="height:156px; margin-bottom:-1px;">
			            	<table class="tableModel tbody" width="100%" cellpadding="0" cellspacing="0" id="refundProductDiv" >
				                
				            </table>
			            </div>
			        </div>   
			    </div>
			    <div class="modal-footer">
			        <a class="btn btn-success" href="javascript:void(0);" onclick="refundAuditAction(1);">通过</a>
			        <a class="btn btn-danger" href="javascript:void(0);" onclick="refundAuditAction(2);">不通过</a>
			        <a class="btn btn-default" href="javascript:void(0);" onclick="refundAuditControl(2);">返回</a>
			    </div>
			</div>
			</div>
			</div>
			
			<div aria-hidden="false" id="messageDiv" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" class="modal fade in w600na" style="display: none;z-index:11;">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true"></span><span class="sr-only">Close</span></button>
							<h4 class="modal-title" id="messageTitle">提示</h4>
						</div>
						<div class="modal-body">
							<span id="messageValue"></span>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-primary" data-dismiss="modal">确认</button>
						</div>
					</div>
				</div>
			</div>
			
		</td>
		
		<a:form>
	  		<a:queue requestDelay="10" ignoreDupResponses="true"/>
			<a:jsFunction name="refundAuditInit" action="#{orderOperate.refundAuditInit}" data="#{orderOperate.showOrderProductStr}" oncomplete="refundAuditInitComplete(data);">
				<a:actionparam name="refundInfoId" assignTo="#{orderOperate.refundInfoId}"/>
			</a:jsFunction>
			<a:jsFunction name="refundAuditFind" action="#{orderOperate.refundAuditFind}" oncomplete="refundAuditComplete();">
				<a:actionparam name="refundInfoId" assignTo="#{orderOperate.refundInfoId}"/>
				<a:actionparam name="refundAuditType" assignTo="#{orderOperate.refundAuditType}"/>
				<a:actionparam name="orderRemark" assignTo="#{orderOperate.orderRemark}"/>
			</a:jsFunction>
			<a:jsFunction name="refresh" action="#{refundOperateList.refundOperateListInit}" reRender="contentList,paging" >
				<a:actionparam name="pages" assignTo="#{orderOperateList.pages}"/>
				<a:actionparam name="orderStatus" assignTo="#{orderOperateList.orderStatus}"/>
				<a:actionparam name="orderSearch" assignTo="#{orderOperateList.orderSearch}"/>
			</a:jsFunction>
		</a:form>
		
		<script type="text/javascript">
		//<![CDATA[
		
			var operateRefundId;//操作退货单id

			jQuery(function(){
				
			});

			//字数验证
			function words_deal(controlName, max){ 
				var curLength = jQuery("#" + controlName).val().length;
				if(curLength > max){ 
					var textVlaue = jQuery("#" + controlName).val().substr(0,max); 
					jQuery("#" + controlName).val(textVlaue); 
					jQuery("#" + controlName + "Num").html(max);
					alert("超过字数限制，最多输入" + max + "字！"); 
				}else{
					jQuery("#" + controlName + "Num").html(curLength);
				} 
			} 

			//退单审核保存 1通过 2不通过
			function refundAuditAction(type){
				if (type == 1) {
					refundAuditFind(Number(operateRefundId), Number(type), "");
				} else {
					var refundRemark = jQuery("#refundRemark").val();
					if (refundRemark != null && refundRemark != '') {
						refundAuditFind(Number(operateRefundId), Number(type), refundRemark);
					} else {
						jQuery("#messageValue").html("请填写退货审核原因！");
						jQuery("#messageDiv").modal('show');
					}
				}
			}

			//退货审核回调
			function refundAuditComplete(){
				var orderStatus = '#{refundOperateList.orderStatus}';
				window.location.href = "#{request.contextPath}/orderManage/RefundOperateList.seam?orderStatus=" + orderStatus + "&pages=1";
			}

			//退货审核初始化js
			function refundAuditInitJs(rId, orderCode, refundTime){
				operateRefundId = rId;
				jQuery("#refundAuditCode").html(orderCode);
				jQuery("#refundAuditTime").html(refundTime);
				refundAuditInit(Number(operateRefundId));
			}

			//退单审核模块控制
			function refundAuditControl(type){
				if (type == 1) {
					jQuery("#refundAuditDiv").modal('show');
				} else {
					jQuery("#refundAuditDiv").modal('hide');
				}
			}

			//退货审核初始化回调
			function refundAuditInitComplete(data){
				jQuery("#refundProductDiv").empty();
				jQuery("#refundProductDiv").append(data);
				refundAuditControl(1);
			}
			jQuery(function($){
				//回车搜索事件
				jQuery("#orderSearch\\:orderSearch").keydown(function(e){
					if(e.keyCode==13){
						jquery('#orderSearch\\:orderCommand').trigger("click");
					}
				}); 
				
				var searchVal="#{refundOperateList.orderSearch}";
				if(searchVal==null || searchVal==""){
					jQuery("#orderSearch\\:orderSearch").val("请输入订单编号/退单编号/收货人/销售人/手机");
				}
			});
			//查看退货原因控制div
			function refundCauseControl(type, orderCode, refundCause){
				if (type == 1) {
					jQuery("#orderCode").text(orderCode);
					jQuery("#refundCause").text(refundCause);
					jQuery("#refundCauseDiv").modal('show');
				} else {
					jQuery("#refundCauseDiv").modal('hide');
				}
			}
			jQuery(function(){
				/* var myDate = new Date();
				var mytime=myDate.toLocaleTimeString();     //获取当前时间
				console.log("开始："+mytime); */
				//setTimeout('myrefresh()', 1000*60 ); //指定60秒刷新一次  
			});
			
			function myrefresh(){ 
				/* var myDate = new Date();
				var mytime=myDate.toLocaleTimeString();     //获取当前时间
				console.log(mytime); */
				var pages = '#{refundOperateList.pages}';
				var orderStatus = jQuery("#orderStatus").val();
				var orderSearch = jQuery("#orderSearch").val();
				
				//setTimeout('myrefresh()', 1000*60 ); //指定60秒刷新一次  
				refresh(pages,sortType,orderStatus,orderSearch);
			} 
			document.onkeydown=function(event){
				var e = event || window.event || arguments.callee.caller.arguments[0];
		        if(e && e.keyCode==13){ // enter 键
		            //要做的事情
		        	jQuery('#orderSearch\\:orderCommand').click();
		        }
			}; 
		//]]>
		</script>
	</ui:define>
</ui:composition>
