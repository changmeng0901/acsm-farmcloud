<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:s="http://jboss.com/products/seam/taglib"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:a="http://richfaces.org/a4j"
    xmlns:rich="http://richfaces.org/rich"
    template="/layout/template_new.xhtml">
	<ui:define name="body">
	<link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/settings/EnterpriseSettings.css" />
    <script type="text/javascript" src="#{request.contextPath}/asset/js/EnterpriseLeftMenu.js"></script>
    
	   <!---弹出框2开始-->
		<style>
		.form-control{
			float:left;
		}
		.goodSelect20 .bootstrap-select:not([class*="span"]):not([class*="col-"]):not([class*="form-control"]):not(.input-group-btn){ width:100px; margin-right:0;}
		
		/*导入样式*/	
		.modal .modal-header .close, .modal .modal-header .close:link {background:  url("../asset/images/farmingIco16.jpg") no-repeat scroll 0 0; border: medium none;float: right;height: 11px;margin-top: 5px;opacity: 1;width: 11px;filter:alpha(opacity=100);}
		.modal .modal-header .close:hover, .modal-header .close:focus {background:  url("../asset/images/farmingIco17.jpg") no-repeat scroll 0 0;opacity: 1;filter:alpha(opacity=100);width:11px;}
		
		.baseFile_onload{ display:block; float:left; width:130px; height:130px; margin:25px 50px 25px 0;border:none;background: url("../asset/images/farmingIco15.jpg") no-repeat scroll 0 0; cursor:pointer;}
		.baseFile_onload:hover{ background: url("../asset/images/farmingIco15.jpg") no-repeat scroll 0 0; border:none;}
		.baseFile_onload input{ position:absolute; right:0; top:0; width:130px; height:130px; opacity:0; filter:alpha(opacity=0); cursor:pointer;}
		
		.dr-pnl {
		    padding: 0px;
		    border: none;
		}
		.dr-pnl-b {
		    padding: 0px;
		    border: none;
		}
		.kuanDu {width: 510px; left: 50%; margin-left: -255px; top: 50%; margin-top: -234px; margin-bottom: 0; position: absolute;}
		.nw221 {width: 221px;}
		.modal-body table td {padding: 10px 0;}
		.modal-body table td.rys {text-align: right; padding-right: 15px;}
		.yuan{position: absolute; top: 81px;right: 135px;}
		/* 弹窗 */
.farmingInputs_mini{ position:absolute; top:54px; left:0; z-index:10; width:346px; border:1px solid #e5e5e5; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5); background-clip: padding-box; background-color: #fff; border: 1px solid rgba(0, 0, 0, 0.2); border-radius:6px; outline: 0 none;}
.farmingInputs_mini{ display:none;}
.farmingInputs_miniHd{ overflow:hidden; border-bottom:1px solid #e5e5e5; min-height:16.43px; padding:15px;}
.farmingInputs_miniHd .butt{ float:right; width:11px; height:11px; margin-top:3px; background:url(../images/farmingIco16.jpg) no-repeat; border:none; zoom:1;}
.farmingInputs_miniHd .butt:hover, .farmingInputs_miniHd .butt:focus{ background-image:url(../images/farmingIco17.jpg); zoom:1;}
.farmingInputs_miniHd h3{ float:left; font-size:14px; margin:0;}
.farmingInputs_miniHd button{ float:right; width:11px; height:11px; margin-top:3px; background:url(../images/farmingIco16.jpg) no-repeat; border:none; zoom:1;}
.farmingInputs_miniHd button:hover, .farmingInputs_miniHd button:focus{ background-image:url(../images/farmingIco17.jpg); zoom:1;}
.farmingInputs_miniBd{ position:relative; padding:20px 15px 0;}
.farmingInputs_miniBd td{ padding-bottom:20px; height:34px; line-height:34px;}
.farmingInputs_miniBd .bootstrap-select.btn-group:not(.input-group-btn), .bootstrap-select.btn-group[class*="span"]{ float:left; display:inline; margin-right:5px;}
.farmingInputs_miniBd .bootstrap-select > .btn{ width:190px; padding:7px 12px;}
.farmingInputs_add2{ float:left; width:34px; height:34px; background:url(../images/farmingIco14.jpg) no-repeat; border:none;}
.farmingbgIco18{ width:64px; height:30px; line-height:30px; border:none; padding:0 10px 0 12px; font-size:12px; zoom:1; background:none; float:left;}
.farmingInputs_add3{ float:left; width:130px; height:130px;background:url(../images/farmingIco15.jpg) no-repeat; border:none;}
.farmingInputs_miniFt{ padding:15px; border-top: 1px solid #e5e5e5; text-align:right; overflow:hidden;}
.farmingInputs_miniFt button{ margin-left:5px; float:right;}

/* 结束 */
		</style>
<!---弹出框2结束-->
	   
                <td valign="top">
                <div class="inbentory_file_main">
                <!--左侧二级导航 -->
                <div class="inbentory_level_wap">
                    <div class="inbentory_level">
                        <strong class="inben_first inben_first2">
                            <a href="javascript:;"><i class="icon_L icon_rkgl"></i>基础设置</a><b class="b_arrow"></b>
                        </strong>
                        <ol class="inben_second">
                            <li class="sed_item" onclick="window.open('#{request.contextPath}/user/UpdateEnterpriseSettings.seam?enterpriseId=#{sessionTake.enterpriseInfoId}','_self')" >
                            	<i class="icon_sed"></i>企业设置                   	
                            </li>
                            <!-- 管理版和以前的版本（标准、白金...)显示 -->
                            <h:panelGroup rendered="#{sessionTake.nowVersionService.basicService.basicServiceId==10 or sessionTake.nowVersionService.basicService.serviceType eq 1}">
                            	<li class="sed_item" onclick="window.open('#{request.contextPath}/user/ModuleSettings.seam','_self')" ><i class="icon_sed"></i>模块配置</li>
                            </h:panelGroup>
                            <li class="sed_item" onclick="window.open('#{request.contextPath}/dictionary/DataDicinfoList.seam','_self')" ><i class="icon_sed"></i>字段管理</li>
                            <li class="sed_item" onclick="window.open('#{request.contextPath}/user/EnterpriseCommunityList.seam','_self')" ><i class="icon_sed"></i>角色管理</li>
                            <s:fragment rendered="#{enterpriseInfoHome.enterpriseInfo.govState}">
	                        	<li class="sed_item" onclick="window.open('#{request.contextPath}/user/AuditInformationList.seam','_self')" ><i class="icon_sed"></i>审核信息</li>
	                        </s:fragment>
                            <li class="sed_item" onclick="window.open('#{request.contextPath}/system/RecycleInfoList_1.seam','_self')" ><i class="icon_sed"></i>回收站</li>
                        </ol>
                        <strong class="inben_first inben_first2">
                            <a href="javascript:;"><i class="icon_L icon_ckgl"></i>生产管理设置</a><b class="b_arrow"></b>
                        </strong>
                        <ol class="inben_second">
                            <h:panelGroup rendered="#{s:hasRole('certification')}">
                            	<li class="sed_item" onclick="window.open('#{request.contextPath}/map/CertificationList.seam','_self')" ><i class="icon_sed"></i>认证信息</li>
                            </h:panelGroup>
                            <li class="sed_item" onclick="window.open('#{request.contextPath}/message/TunnelGroupList.seam','_self')" ><i class="icon_sed"></i>分组管理</li>
                            <li class="sed_item" onclick="window.open('#{request.contextPath}/product/InputsInfoList.seam?goodsTypeInfoId=5','_self')" ><i class="icon_sed"></i>投入品信息</li>
                        </ol>
                        <strong class="inben_first inben_first2">
                            <a href="javascript:;"><i class="icon_L icon_zkgl"></i>销售管理设置</a><b class="b_arrow"></b>
                        </strong>
                        <ol class="inben_second">
                            <li class="sed_item sed_cur" onclick="window.open('#{request.contextPath}/product/GoodsInfoList.seam','_self')"><i class="icon_sed"></i>物料信息</li>
                            <li class="sed_item" onclick="window.open('#{request.contextPath}/product/ProductInfoList.seam','_self')" ><i class="icon_sed"></i>商品信息</li>
                        </ol>
                        <strong class="inben_first inben_first2">
                            <a href="javascript:;"><i class="icon_L icon_pdgl"></i>硬件管理设置</a><b class="b_arrow"></b>
                        </strong>
                        <ol class="inben_second">
                            <li class="sed_item" onclick="window.open('#{request.contextPath}/device/DeviceList.seam','_self')"><i class="icon_sed"></i>设备管理</li>
                            <li class="sed_item" onclick="window.open('#{request.contextPath}/device/VideoList.seam','_self')" ><i class="icon_sed"></i>视频管理</li>
                            <li class="sed_item" onclick="window.open('#{request.contextPath}/farming/AmRfidInfoList.seam','_self')" ><i class="icon_sed"></i>RFID卡管理</li>
                        </ol>
                    </div>
                    <i class="collapse_btn"></i>
                </div>
                <!--左侧二级导航 -->
				<!--右侧 -->
                <div class="inbentory_content">
                <div class="right_c">
	                <div class="box_back" id="login" style="display: none; z-index: 1000">
					<div id="login2"
						style="width: 60px; height: 60px; margin: 220px auto 0 auto;">
						<img src="../asset/images/loginda.gif" />
					</div>
					</div>
                	<div class="r_title">
                    	<div class="r_t_l"> 
                    	<font size="4">物料信息 </font>
                    	</div>
                    </div>
                    <br/>
                    				<!--入库订单列表开始-->
                    <h:form id="productInfo" enctype="multipart/form-data">
                 <!-- Modal -->
<div aria-hidden="false" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal" class="modal fade in w600na" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">提示框</h4>
      </div>
      <div class="modal-body">
       <span id="spanValue">*号部分为必填项！</span>
        
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal">确认</button>
      </div>
    </div>
  </div>
</div>


		<!-- 添加/编辑等级模态框 开始 -->         
		<div class="modal fade zzmodal" id="levelModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-dialog" style="position:absolute; left:50%; top:50%; width:460px; height:180px; margin-left:-215px; margin-top:-150px;">
		<div class="modal-content">
		    <div class="modal-header" style="padding:10px;">
		        
		        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
		        <h4 class="modal-title" id="myModalLabel" style="font-size:16px;">编辑物料等级</h4>
		    </div>
		    <div class="modal-body" style="height:116px; overflow:auto; padding:20px 0 0;">
		    	<table class="modalTable_minni" width="100%" cellpadding="0" cellspacing="0">
		        	<tr>
		            	<td class="pr10" width="100" align="right" style="padding-right: 10px">等级名称</td>
		                <td>
		                	<span class="bootSelt21">
								<input class="form-control" type="text" id="editLevelName" placeholder="请输入等级名称" onkeyup="checkLevel();"/>								
		                    </span>
		                    <span class="finput"  style="color:#FF0000;display:none;" id="nameMsg">等级名称不能为空！</span>
		                </td>
		            </tr>
		            <tr>
		            	<td class="pr10" align="right" valign="top" style="line-height:34px;padding-right: 10px;">物料单价</td>
		                <td>	
                            <span class="bootSelt21">
                            	<input class="form-control" type="text" id="editPrice" style="width:90%;" onkeyup="checkLevel();"/><span class="finput">元</span>
                            </span>
                            <span class="finput"  style="color:#FF0000;display:none;" id="priceMsg">请填写正确的物料单价！</span>
		                </td>
		            </tr>
		        </table>     
		    </div>
		    <div class="modal-footer">
		        <a class="btn btn-primary zzcontrol" href="javascript:void(0);" onclick="submitEditLevel();">提交</a>
		        <a class="btn btn-default" data-dismiss="modal" href="javascript:;">返回</a>
		    </div>
		</div>
		</div>
		<div class="farmingInputs_mini modal-dialog" id="messageDialog" style="z-index:9999;position:absolute; left:50%; top:50%; margin-left:-285px; margin-top:-30px;width:430px;">
 			<div class="farmingInputs_miniHd"><h3>提示框</h3><input type="button" class="butt" onclick="closeMesDialog();"/></div>
     		<div class="farmingInputs_miniBd" id="messageContent">			</div>
		     <div class="farmingInputs_miniFt">
		     	<button type="button" class="btn btn-default" onclick="closeMesDialog();">取消</button>
		        <button type="button" class="btn btn-primary"  onclick="closeMesDialog();">确认</button>
		     </div>
		</div>   
		<!-- 编辑等级提示框结束 -->
		</div>
		<!-- 添加/编辑等级模态框 结束 -->

                	<div class="all_d3" style="margin-top: 0;">
                		<div class="all_da all_w01">
                        	<table>
                                <tr>
                                    <td class="all_te">物料编号：</td>
                                    <td>
										<h:inputText id="goodsCode"
						                        maxlength="18" readonly="true" styleClass="form-control nw221" style="margin-right:0px;"
						                          value="#{goodsInfoHome.instance.goodsCode}">
						                </h:inputText>
						                <span class="finput"  style="color:#FF0000">*</span>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="all_da all_w01">
                        	<table>
                                <tr>
                                    <td class="all_te">物料名称：</td>
                                    <td>
										<h:inputText id="barcode"  maxlength="50"
						                        styleClass="form-control nw221" style="margin-right:0px;"
						                          value="#{goodsInfoHome.instance.name}" >
						                </h:inputText>
						                <span class="finput"  style="color:#FF0000">*</span>
                                    </td>
                                    
                                </tr>
                            </table>
                        </div>
                		<div class="all_da all_w01">
                        	<table>
                                <tr>
                                    <td class="all_te">物料类型：</td>
                                    <td style="width: 266px;">
                                    	<h:selectOneMenu onchange="hiddenDiv()" disabled="true" styleClass="selectpicker"  id="goodsTypeInfo" style="width:146px;" value="#{goodsInfoHome.instance.goodsTypeInfo}" >
                                    		<s:selectItems value="#{goodsInfoHome.goodsTypeList}" var="_goodsType" label="#{_goodsType.name}" itemValue="#{_goodsType.id}" />
										</h:selectOneMenu>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="all_da all_w01" id="showPlant">
                        	<table>
                                <tr>
                                    <td class="all_te">作物种类：</td>
                                    <td style="width: 266px;">
                                    	<h:inputHidden value="#{goodsInfoHome.plantId}" />
                                    	<h:selectOneMenu styleClass="selectpicker aaa" disabled="true" id="plantInfo" style="width:146px;" value="#{goodsInfoHome.plantId}">
                                    		<s:selectItems value="#{goodsInfoHome.getPlist()}" var="_plant" label="#{_plant.name}" itemValue="#{_plant.plantId}"/>
										</h:selectOneMenu>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="all_da all_w01">
                        	<table>
                                <tr>
                                    <td class="all_te">存储类型：</td>
                                    <td style="width: 266px;">
                                    	<h:selectOneMenu styleClass="selectpicker" id="productType" style="width: 286px;display:none;" value="#{goodsInfoHome.goodsStorageTypeId}">
			                   				<s:selectItems value="#{goodsInfoHome.goodsStorgeTypeList()}" var="plant" label="#{plant.name}" itemValue="#{plant.goodsStorageTypeId}"/>
			                   			</h:selectOneMenu>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="all_da all_w01">
                        	<table>
                                <tr>
                                    <td class="all_te">保质期：</td>
                                    <td>
										<h:inputText id="expirationDate"  styleClass="form-control nw221" maxlength="11"
						                          value="#{goodsInfoHome.instance.expireDate}" style="margin-right:0px;">
						                </h:inputText>
						                 <span class="finput">天</span><span class="finput"  style="color:#FF0000">*</span>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="all_da all_w01" id="recordTypeDiv">
                        	<table>
                                <tr>
                                    <td class="all_te">类型 ：</td>
                                    <td>
                                    	<h:selectOneMenu styleClass="selectpicker" id="record_type" style="width: 286px;display:none;" value="#{goodsInfoHome.instance.inputsType}">
                                    		<f:selectItem itemLabel="农药" itemValue="2"/>
			                   				<f:selectItem itemLabel="肥料" itemValue="3"/>
			                   				<f:selectItem itemLabel="其他" itemValue="4"/>
			                   			</h:selectOneMenu>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="all_da all_w01" style="width:724px;">
                        	<table>
                                <tr>
                                    <td class="all_te">物料规格：</td>
                                    <td>
                                    	<h:inputText id="netContent"  maxlength="50"
						                        styleClass="form-control nw90 fl" style="margin-right:10px;"
						                          value="#{goodsInfoHome.instance.netContent}">						                         
						                </h:inputText>
						                 <h:panelGroup id="isMe">
						                <div class="goodSelect20 fl" id="ylUnitDiv">
						                	<h:selectOneMenu styleClass="selectpicker" id="goodsUnitSelect" style="width: 286px;" value="#{goodsInfoHome.instance.goodsUnit}">
				                   				<s:selectItems value="#{goodsInfoHome.getAllSpecifications()}" var="unit" label="#{unit.name}" itemValue="#{unit.id}"/>
				                   			</h:selectOneMenu>
			                   			</div>
	
			                   			</h:panelGroup>
			                   			<span style="float:left; line-height:30px; padding:0 5px;" id="separateSpan">/</span>
			                   			<h:inputHidden value="#{goodsInfoHome.goodsUnit}" id="goodsUnitHidden"/>
										<h:inputText id="packSpec"  maxlength="50"
						                        styleClass="form-control nw90" style="margin-right:0px;"
						                          value="#{goodsInfoHome.instance.packSpec}">
						                </h:inputText>
						                <span style="line-height: 30px;margin-left:10px;" id="unitRemark">(净含量    单位规格/包装规格)</span>
                                    </td>
                                    
                                </tr>
                                
                            </table>
                        </div>
                        <div class="all_da all_w01" style="width:90%;">
                        	<table>
                                <tr>
                                    <td class="all_te">图片：</td>
                                    <td align="left">
										<span style="float: left;margin-top: 25px;padding-right:10px;" id="preview"> 
											<h:outputText value="" rendered="#{goodsInfoHome.instance.packingImagesUrl ne null}" >
												<img  class="plant_imgbd" src="#{goodsInfoHome.instance.packingImagesUrl}"  width="150" height="140" />
											</h:outputText>
										</span>
										<span class="baseFile_onload" style="margin-top: 25px;margin-right:10px;">
												<s:fileUpload id="picture" size="30"
													accept="image/png,image/jpeg,image/gif"
													contentType="image/png,image/jpeg,image/gif"
													fileName="#{goodsInfoHome.instance.pictureName}"
													data="#{goodsInfoHome.picture}"
													onchange="previewImage(this)" style="font-size:42px;">
												</s:fileUpload>
										</span>										
						            </td>
						             <td align="left" style="padding-left:10px;">	
						             	<span id="uploadMsg">未选择任何文件</span><br />
										<span><font color="#FF0000">支持格式：jpg,gif,png,jpeg,bmp,3gp</font></span>
						            </td>
                                </tr>
                            </table>
                        </div>
                        <div class="all_da all_w01" style="width:90%;">
                        	<table>
                                <tr>
								<td class="all_te">描述：</td>
								<td>
									<h:inputTextarea id="description" styleClass="form-control nw420" rows="3"  value="#{goodsInfoHome.instance.description}" />
	                            </td>
								</tr>
                            </table>
                        </div>
                        <div class="clear"></div>
                   </div>
                   <!-- 等级排序开始 -->
                   <div id="levelInfoDiv">
                   		<div class="right_c" style="min-height:30px;">
							<div class="r_title">
								<div class="r_t_l"><font size="3">物料等级</font></div>
							</div>
							<div class="clear"></div>
						</div>
						<div class="cm_tjfxHd02 pt20">
							<ul class="clear">
								<li class="fl" style="font-size: 14px; line-height:34px; margin-right:20px;">等级添加</li>
								<li class="fl">
									<span class="octicon-search02"></span>
									<input id="addGoodsName" style="padding:0px;" onclick="removeMe()"  type="text" value="请输入物料等级" class="form-control nw300 srarchfont"></input>
								</li>
								<li class="fr" style="padding-left:5px;float:left;">
									<button class="btn btn-success" type="button" onclick="addLevel('N')">添加</button>
								</li>
							</ul>
						</div>
						<div class="cm_tjfxBd">
							<div class="right_c">
								<div class="">
									<!-- #{goodsInfoHome.setLevelListValue()} -->
									<rich:panel id="showPanel" style="width:100%;">
										<table class="ze_table" width="100%" cellpadding="0" cellspacing="0">
	
											<tbody id="levelTabel">
												<tr class="alt">
													<td height="4" width="5"><img src="#{request.contextPath}/asset/images/table_d_40.jpg" height="4" width="5"></img></td>
													<td colspan="4" style="border-top:1px solid #e1e1e1; background:#f0f5fb;"></td>
													<td height="4" width="5"><img src="#{request.contextPath}/asset/images/table_d_43.jpg" height="4" width="5"></img></td>
					                            </tr>
												<tr class="">
													<th class="ze_bg ze_bt_le" height="4" width="5"></th>
													<th class="ze_bg" width="30%">等级名称</th>
													<th class="ze_bg" width="30%">物料单价(元)</th>
													<th class="ze_bg" width="30%">创建时间</th>
													<th class="ze_bg" width="10%">操作</th>
													<th class="ze_bg ze_bt_ri" height="4" width="5"></th>
												</tr>
												
												<a:repeat value="#{goodsInfoHome.levelList}" var="_goodsLevel" rowKeyVar="_index">
													<tr class="#{_index % 2 == 0 ? 'alt' : ''}">
														<td class="ze_bg2 ze_bt_le" height="4" width="5"></td>
														<td class="ze_bg2">#{_goodsLevel.name}</td>
														<td class="ze_bg2">
															<h:outputText value="#{_goodsLevel.unitPrice}" rendered="#{_goodsLevel.unitPrice ne 0.0}"></h:outputText>	
															<h:outputText value="0" rendered="#{_goodsLevel.unitPrice eq 0.0}"></h:outputText>														
														 </td>
														<td class="ze_bg2"><h:outputText value="#{_goodsLevel.insertTime}" ><s:convertDateTime type="both" dateStyle="short" pattern="yyyy-MM-dd HH:mm" /></h:outputText></td>
														<td class="ze_bg2">
															<a href="javascript:void(0);" onclick="editLevel(this,#{_index});"  title="编辑" class="list_edit"></a>
															<a href="javascript:void(0);" onclick="removeLevel(this,#{_index});" title="删除" class="list_delete"></a>
														</td>
														<td class="ze_bg2 ze_bt_ri" height="4" width="5"></td>
													</tr>
												</a:repeat>												
											</tbody>											
										</table>
									</rich:panel>
								</div>  
							</div>
						</div>
                   </div>
                   <!-- 等级排序结束 -->
                    <div class="ckd_button" style="text-align:center;">
                    	<h:commandButton action="#{goodsInfoHome.persist}" value="隐藏提交" id="persist" style="display:none;"/>
                    	<h:outputText rendered="#{!goodsInfoHome.managed}" >
                   	 	<a  class="btn btn-primary"    onclick="checkSubmit(1)">提交</a>
                   	 	</h:outputText>
		            	<h:commandButton id="update" value="提交" styleClass="btn btn-primary" action="#{goodsInfoHome.update}" rendered="#{goodsInfoHome.managed}"   onclick="return checkSubmit(2)"/>
		            	<s:button view="/product/GoodsInfoList.seam" styleClass="btn btn-default" value="返回" id="bn_left6" style="margin-left:10px">
		            	<f:param name="pageNum" value="#{goodsInfoHome.pageNum}" />
		            	</s:button>
                    </div>
                    <!--按钮结束-->
                    <div class="clear"></div>
                    </h:form>
                </div><!--right_c结束-->
                <a:form>
                	<a:queue  ignoreDupResponses="true"/>
				 	<a:jsFunction name="getGoodsCode"  action="#{goodsInfoHome.getGoodsInfoCode()}" data="#{goodsInfoHome.goodsCode}" oncomplete="changeGoodsCode(data)" >
		           		<a:actionparam name="gt" assignTo="#{goodsInfoHome.goodsType}"/>
		           		<a:actionparam name="gtc" assignTo="#{goodsInfoHome.goodsTypeCode}"/>
			   		</a:jsFunction>
			   		<a:jsFunction name="searchUnit"  action="#{goodsInfoHome.getAllSpecifications()}" reRender="isMe" oncomplete="huidiao()" >
				        <a:actionparam name="gcode" assignTo="#{goodsInfoHome.goodsTypeCode}"/>
				 	</a:jsFunction>
				 	<a:jsFunction name="editGoodsLevels"  action="#{goodsInfoHome.editGoodsLevels()}" data="#{goodsInfoHome.promptMessage}" reRender="showPanel" oncomplete="levelBack(data)">
				        <a:actionparam name="lname" assignTo="#{goodsInfoHome.goodsLevel.name}"/>
				        <a:actionparam name="uprice" assignTo="#{goodsInfoHome.goodsLevel.unitPrice}"/>
				        <a:actionparam name="itime" assignTo="#{goodsInfoHome.goodsLevel.insertTime}"/>
				        <a:actionparam name="del" assignTo="#{goodsInfoHome.goodsLevel.deleted}"/>
				        <a:actionparam name="operType" assignTo="#{goodsInfoHome.operType}"/>
				        <a:actionparam name="indexNum" assignTo="#{goodsInfoHome.indexNum}"/>
				        <a:actionparam name="chongfu" assignTo="#{goodsInfoHome.chongfu}"/>
				 	</a:jsFunction>
				 	<a:jsFunction name="search2"  action="#{goodsInfoHome.serarchGoodsInfo}" data="#{goodsInfoHome.messageStr}" oncomplete="goodsinfo(data)">
				        <a:actionparam name="plantId" assignTo="#{goodsInfoHome.plantId}"/>
				 	</a:jsFunction>
				</a:form>  
				<!--入库订单列表结束-->
				</div>
				</div>
            </td>    
    <!--右边结束-->
 <!--添加按钮结束-->
<script type="text/javascript">
//<![CDATA[
           var promptMessage = "#{goodsInfoHome.promptMessage}";
			if(promptMessage != ""){
				document.getElementById("spanValue").innerHTML = promptMessage;
				jquery("#myModal").modal('show');
			}
           var m3="#{goodsInfoHome.messageStr}";
		   if(m3!=""){
			document.getElementById("spanValue").innerHTML = m3;
			jquery("#myModal").modal('show');
		   }
		   var goodsType = "#{goodsInfoHome.instance.goodsTypeInfo}";
		   if(goodsType == "7"){
				jquery("#productInfo\\:barcode").attr("readonly","readonly");
			}
		   
           function goodsinfo(data){
				if(data!=""){
					document.getElementById("spanValue").innerHTML = data;
					jquery("#myModal").modal('show');
				}else{
					 jquery("#login").show();
					jquery("#productInfo\\:persist").click();
				}
           }
           function checkInteger(obj){
			  if(obj.value!=""){
				var v = obj.value;
				var reg = /^[1-9]+[0-9]*]*$/; 
					if (!reg.test(v)){
						return false;
					}
			  }
						return true;
			}
			
           function checkSubmit(num){
        	   var goodsTypeInfo = document.getElementById("productInfo:goodsTypeInfo").value;
        	   var a1 =  document.getElementById("productInfo:goodsCode").value;
               var b1 =  document.getElementById("productInfo:barcode").value;
               var p1 =  document.getElementById("productInfo:plantInfo").value;
               var description =  document.getElementById("productInfo:description").value;
               
	           var trObj=jquery("#levelTabel tr");   
	        	if(trObj.length<3 &&　goodsTypeInfo==1){
					 document.getElementById("spanValue").innerHTML = "原料至少有一条等级";
	        		 jquery("#myModal").modal('show');return false;
	            }
               if(jquery('#productInfo\\:productType').val()==null){
            	   document.getElementById("spanValue").innerHTML = "请添加存储类型";
        		   jquery("#myModal").modal('show');return false;
               }
        	   if(a1==""){
        		   document.getElementById("spanValue").innerHTML = "物料编号不能为空";
        		   jquery("#myModal").modal('show');return false;
        	   }
        	   if(trim(b1)==""){
        		   document.getElementById("spanValue").innerHTML = "物料名称不能为空";
        		   jquery("#myModal").modal('show');return false;
        	   }
        	   var expDate=document.getElementById("productInfo:expirationDate").value;
        	   var c1 = checkInteger(document.getElementById("productInfo:expirationDate"));
				if(expDate==""){
					document.getElementById("spanValue").innerHTML = "保质期不能为空";
	        		   jquery("#myModal").modal('show');return false;
				}else if(!c1){
        		   document.getElementById("spanValue").innerHTML = "请填写正确的保质期数字";
        		   jquery("#myModal").modal('show');return false;
        	   }
	           var netContent=document.getElementById("productInfo:netContent").value;
	           if(goodsTypeInfo!=1 && isNaN(netContent) && ""!=netContent){
	        	   document.getElementById("spanValue").innerHTML = "请填写正确的净含量";
        		   jquery("#myModal").modal('show');return false;
		       }
	           if(description.length>200){
					document.getElementById("productMsg").innerHTML = "商品描述输入过长";
					jquery("#myModal").modal('show');
					return false;
				}
	           if(num==1){
	        	   search2(p1);
		       }else{
		    	   jquery("#login").show();
		    	   return true;
			   }
	          
        	   
           }
           function closeMethod(){
        	   var a2 =  document.getElementById("productInfo:goodsCode").value;
               var b2 =  document.getElementById("productInfo:barcode").value;
               var c1 = checkInteger(document.getElementById("productInfo:expirationDate"));
        	   if(a2==""){
        	   		document.getElementById("productInfo:goodsCode").focus();
        	   }else if(b2==""){
        		   document.getElementById("productInfo:barcode").focus();
        	   }else if(!c1){
        		   document.getElementById("productInfo:expirationDate").focus();
        	   }
           }

           jquery(document).ready(function(){
        	   hiddenDiv(); 
        	   var c = '#{goodsInfoHome.instance.goodsTypeInfo}';
               if(c!='1' && c!='' && c!='0'){
            	   jquery("#showPlant").hide();
               }
               jquery('.aaa').attr("data-live-search","true");
               jquery('.selectpicker').selectpicker();
               
           });
           function hiddenDiv(){ 	       	      	    
          	   var a =  document.getElementById("productInfo:goodsTypeInfo").value;
          	   var obj =document.getElementById("productInfo:goodsTypeInfo");  	
          	   var goodsType=obj.options[obj.selectedIndex].innerHTML;      	 
          	   getGoodsCode(goodsType,a);//物料类型改变，编号随着变化
          	   searchUnit(a);//原料与其它类型切换，单位随着变化
          	   if(a != 1){
          		 jquery("#showPlant").hide();//作物种类
          		 jquery("#levelInfoDiv").hide();//等级管理
          		//物料规格
          		jquery("#productInfo\\:netContent").show();
          		jquery("#separateSpan").show();
          		jquery("#productInfo\\:packSpec").show();
          		jquery("#unitRemark").show();
          		jquery("#recordTypeDiv").hide();//投入品类型
          		jquery("#productInfo\\:plantInfo").val('');
          		if(a==5){
          			jquery("#recordTypeDiv").show();
              	}
          	   }
          	   if(a == 1){
          		 jquery("#showPlant").show();//作物种类
          		 jquery("#levelInfoDiv").show();//等级管理
          		//物料规格
          		jquery("#productInfo\\:netContent").hide();
          		jquery("#separateSpan").hide();
          		jquery("#productInfo\\:packSpec").hide();
          		jquery("#unitRemark").hide();
          		jquery("#recordTypeDiv").hide();//投入品类型
           	   }
           }
           //回调将生成的编号赋值给goodsCode
           function changeGoodsCode(goodsCode){
        	   document.getElementById("productInfo:goodsCode").value=goodsCode;
           }    
         	//移除等级
           function removeLevel(obj,index){
	       	   var tdObj=jquery(obj).parent().siblings("td");			
	       	   var levelName=jquery(tdObj[1]).html();
	       	   var price=jquery(tdObj[2]).html();
	       	   var insertTime=jquery(tdObj[3]).html();
	       	   editGoodsLevels(levelName,price,insertTime,1,'del',index,'N');
           }
           function levelBack(promptMessage){
        	   if(promptMessage != ""){
            	   if(promptMessage.indexOf("我们会为您恢复等级信息,是否确定")>0){
            		   if(confirm(promptMessage)){
            			   addLevel('Y')
           			   }
                   }else{
                	   document.getElementById("spanValue").innerHTML = promptMessage;
   	   					jquery("#myModal").modal('show');
                   }	   				
   			   }
        	 jquery("#addGoodsName").attr("onclick","removeMe()");
			 jquery('#addGoodsName').val("请输入物料等级");
           }
           //添加等级
           function addLevel(flag){
				var levelName=jquery("#addGoodsName").val();
				if("请输入物料等级"==levelName || ""==trim(levelName)){
					document.getElementById("spanValue").innerHTML ="物料等级不能为空";
					jquery("#myModal").modal('show');
				}else{
					var idate=new Date();					
					editGoodsLevels(levelName,0,idate.format("yyyy-MM-dd hh:mm:ss"),0,'add',100,flag);
				}		
										
           }
           var operObj;
           var indexNum;
           //编辑等级
          function editLevel(obj,index){
        	   operObj=obj;
        	   indexNum=index;
			   var tdObj=jquery(obj).parent().siblings("td");			
        	   var levelName=jquery(tdObj[1]).html();
        	   var price=jquery(tdObj[2]).html();
        	   jquery("#editLevelName").val(levelName);
        	   if(trim(price)=="" || "0.0"==price){
        		   jquery("#editPrice").val(0);
               }else{
            	   jquery("#editPrice").val(price);
               }       	  
        	   jquery("#nameMsg").html("");
        	   jquery("#priceMsg").html("");
			   jquery('#levelModal').modal('show');
           }
          
         function trim(str){
       	   	return str.replace(/(^\s+)|\s+$/g,"");
       	 }
       	 //关闭提示框
       	 function closeMesDialog(){
       		jquery('#messageDialog').hide();
         }
       
          //编辑等级提交
        function submitEditLevel(){    
        	var levelName=jquery("#editLevelName").val();
            var price=jquery("#editPrice").val(); 
			if(""==price){
				price=0;
			}                	                  
      	   	if(""==trim(levelName)){
				//jquery("#messageContent").html("等级名称不能为空");
				//jquery('#messageDialog').show();
				jquery("#nameMsg").html("等级名称不能为空!");
          	}else if(isNaN(price)){
				//jquery("#messageContent").html("请填写正确的物料单价");
				//jquery('#messageDialog').show();
				jquery("#priceMsg").html("请填写正确的物料单价!");
        	}else{        		        		
               	var tdObj=jquery(operObj).parent().siblings("td");			
          	  	//jquery(tdObj[1]).html(levelName);
          	   //jquery(tdObj[2]).html(price);
          	  	editGoodsLevels(levelName,price,jquery(tdObj[3]).html(),0,'edit',indexNum,'N');
          	    jquery("#levelModal").modal('hide');
            }    	  	
        }
        function checkLevel(){
        	var levelName=jquery("#editLevelName").val();
            var price=jquery("#editPrice").val();                	                  
      	   	if(""==trim(levelName)){
				jquery("#nameMsg").html("等级名称不能为空!");
				jquery('#nameMsg').show();
          	}else{
          		jquery("#nameMsg").html("");
            }
          	if(isNaN(price)){
				jquery("#priceMsg").html("请填写正确的物料单价!");
				jquery('#priceMsg').show();
        	}else{
          		jquery("#priceMsg").html("");
            }
        }
   		function removeMe(){
			jquery("#addGoodsName").removeAttr("onclick");
			jquery("#addGoodsName").val("");
		}
   		Date.prototype.format = function(format)
   		{
   			var o = {
   			"M+" : this.getMonth()+1, //month
   			"d+" : this.getDate(),    //day
   			"h+" : this.getHours(),   //hour
   		 	"m+" : this.getMinutes(), //minute
   			"s+" : this.getSeconds(), //second
   		 	"q+" : Math.floor((this.getMonth()+3)/3),  //quarter
   		 	"S" : this.getMilliseconds() //millisecond
   			}

   			if(/(y+)/.test(format)) 
   			{
   				format=format.replace(RegExp.$1,(this.getFullYear()+"").substr(4 - RegExp.$1.length));
   			}
   			
   		 	for(var k in o)
   			{
   				if(new RegExp("("+ k +")").test(format))
   				{
   		 			format = format.replace(RegExp.$1,RegExp.$1.length==1 ? o[k] : ("00"+ o[k]).substr((""+ o[k]).length));
   				}
   			}
   			return format;
   		}
   	//获取文件名称
   		function changeFileName(name){
   			jQuery("#uploadMsg").html(name);
   		}	
        function previewImage(file){
          var MAXWIDTH  = 150; 
          var MAXHEIGHT = 140;
          var div = document.getElementById('preview');
          if (file.files && file.files[0]){
              div.innerHTML ='<img id=imghead>';
              var img = document.getElementById('imghead');
              img.onload = function(){
                var rect = clacImgZoomParam(MAXWIDTH, MAXHEIGHT, img.offsetWidth, img.offsetHeight);
                img.width  =  rect.width;
                img.height =  rect.height;
//                 img.style.marginLeft = rect.left+'px';
                img.style.marginTop = rect.top+'px';
              }
              var reader = new FileReader();
              reader.onload = function(evt){img.src = evt.target.result;}
              reader.readAsDataURL(file.files[0]);
          }else{//兼容IE
            var sFilter='filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale,src="';
            file.select();
            file.blur();
            var src = document.selection.createRange().text;
            div.innerHTML = '<img id=imghead>';
            var img = document.getElementById('imghead');
            //img.filters.item('DXImageTransform.Microsoft.AlphaImageLoader').src = src;
            img.src = src;
            var rect = clacImgZoomParam(MAXWIDTH, MAXHEIGHT, img.offsetWidth, img.offsetHeight);
            status =('rect:'+rect.top+','+rect.left+','+rect.width+','+rect.height);
            div.innerHTML = "<div id=divhead style='width:"+MAXWIDTH+"px;height:"+MAXHEIGHT+"px;"+sFilter+src+"\"'></div>";
            //alert(jquery("#preview").html());
          }
          jQuery("#uploadMsg").html(name);
        }
        function clacImgZoomParam( maxWidth, maxHeight, width, height ){
            var param = {top:0, left:0, width:width, height:height};
            if( width>maxWidth || height>maxHeight )
            {
                rateWidth = width / maxWidth;
                rateHeight = height / maxHeight;
                 
                if( rateWidth > rateHeight )
                {
                    param.width =  maxWidth;
                    param.height = Math.round(height / rateWidth);
                }else
                {
                    param.width = Math.round(width / rateHeight);
                    param.height = maxHeight;
                }
            }
             
            param.left = Math.round((maxWidth - param.width) / 2);
            param.top = Math.round((maxHeight - param.height) / 2);
            return param;
        }
  //]]>
	</script>
	<style >
	.rich-picklist-source-items, .rich-picklist-target-items {
    background-color: #FFFFFF;
    border-color: #afc4d7;
    border-style: solid;
    border-width: 1px;
}

.rich-list-picklist-button {
    background-color: #E3DED5;
    background-image: url(#{request.contextPath}/asset/images/001.jpg);
	background-repeat:repeat-x;
    color: #000000;
    font-family: Arial,Verdana,sans-serif;
    font-size: 12px;
}
.rich-picklist-control-top, .rich-picklist-control-bottom, .rich-picklist-control-up, .rich-picklist-control-down, .rich-picklist-control-copyall, .rich-picklist-control-copy, .rich-picklist-control-remove, .rich-picklist-control-removeall {
    border-color: #66a1d2;
}
.rich-picklist-control-disabled{ border-color: #eaeaea;}

.rich-list-picklist-button-disabled {
    background-color: #E3DED5;
    background-image: url(#{request.contextPath}/asset/images/002.jpg);
    color: #B1ADA7;
    font-family: Arial,Verdana,sans-serif;
    font-size: 12px;
}
	
	</style>
<style>
	.VMsgDiv{
		line-height: 85%;
		width: 100%;
		text-align: center;
		padding-top: 3px;
		color: red;
	}
	</style>

	<script type="text/javascript">
	//<![CDATA[
	function huidiao(){
	    jquery('.selectpicker').selectpicker();

	}
	function changeUnit(obj){
		if(obj != null){
			jquery("#productInfo\\:goodsUnitHidden").val(obj);
		}
	}
	//]]>
	</script>
</ui:define>
</ui:composition>
