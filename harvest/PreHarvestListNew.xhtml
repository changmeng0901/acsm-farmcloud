<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:s="http://jboss.com/products/seam/taglib"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:a="http://richfaces.org/a4j"
    template="/layout/template_new.xhtml">
<ui:define name="body">
	  <link rel="stylesheet" type="text/css" href="#{request.contextPath}/asset/css/lsll.css"/>
<!-- 新增css开始 -->
    <link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/bootstrap/bootstrap.min.css" />
    <link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/bootstrap/bootstrap-select.min.css" />
    <link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/bootstrap/bootstrap-datetimepicker.css" />
    <link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/commons/style.css"/>
    <link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/commons/commons.css"/>
    <script type="text/javascript" src="#{request.contextPath}/asset/js/jquery-1.10.2.min.js"></script>
	<script type="text/javascript" src="#{request.contextPath}/asset/new/bootstrap-select.min.js"></script>
	<script type="text/javascript" src="#{request.contextPath}/asset/new/bootstrap-datetimepicker.js"></script>
	<script type="text/javascript" src="#{request.contextPath}/asset/new/bootstrap-datetimepicker.zh-CN.js"></script>
<!-- 新增css结束 -->
<style type="text/css">
    [class^="icon-"], [class*=" icon-"] {
    background-image: url("#{request.contextPath}/asset/images/bootstrap/glyphicons-halflings.png");
}
.bootSelt180 .bootstrap-select:not([class*="span"]):not([class*="col-"]):not([class*="form-control"]):not(.input-group-btn) {
    width: 115px;
}
.search_header_rt .dropdown-menu{left:inherit;right:0;min-width:100%;max-width:100%;}
.choosebase_dialog{
			position: fixed;
			left: 50%;
			top: 16%;
			margin-left: -300px;
			width: 600px;
		}
		.choosebase_dialog .modal-title{
			font-size: 14px;
		}
		.choosebase_dialog .modal-footer{
			text-align: center;
		}
		.choosebase_dialog .modal-body{
			min-height: 105px;
			max-height: 200px;
			padding: 25px 0 30px 0;
			box-sizing: border-box;
			overflow-y: auto;
		}
		.choose_list{
			width: 500px;
			margin: auto;
		}
		.choose_list li{
			position: relative;
			float: left;
			width: 166px;
			height: 40px;
			line-height: 38px;
			margin: 5px 29px 5px;
			border: 1px solid #e5e5e5;
			border-radius: 5px;
			box-sizing: border-box;
			text-align: center;
			font-size: 14px;
			color: #9b9b9b;
			cursor: pointer;
			list-style:none;
		}
		.choose_list li:hover{
			box-shadow: 0 0 10px 2px #c8ebfe;
		}
		.choose_list li:after{
			position: absolute;
			right: -1px;
			bottom: -1px;
			z-index: 1;
			width: 22px;
			height: 21px;
			border-radius: 0 0 5px 0;
			content: '';
		}
		.choose_list li.lCur{
			color: #4c96d5;
			border-color: #4c96d5;
		}
		.choose_list li.lCur:after{
			background: url(#{request.contextPath}/asset/images/icon_duihao.png);
		}
		.basename{display:inline-block;max-width:120px;height:20px; line-height:20px;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;}
		.txt_name{max-width: 170px;height: 20px;line-height: 20px;text-align:center;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;}
</style>
		#{preHarvestListNew.preHarvestListInit()}
       <td valign="top">
       <!-- Modal -->      
<div aria-hidden="false" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModalYz" class="modal fade in w600na" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">提示框</h4>
      </div>
      <div class="modal-body">
       <span id="productMsg">*号部分为必填项！</span>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="selectYes()">确认</button>
      </div>
    </div>
  </div>
</div>      
<div aria-hidden="false" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal2" class="modal fade in w600na" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">提示框</h4>
      </div>
      <div class="modal-body">
       <span id="productMsg">*号部分为必填项！</span>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal">确认</button>
      </div>
    </div>
  </div>
</div>    
<div class="modal" id="choosebaseModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog choosebase_dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true"></span><span class="sr-only"></span></button>
                <h4 class="modal-title" id="myModalLabel">选择基地</h4>
            </div>
            <div class="modal-body">
				<ul class="choose_list">
					<a:repeat value="#{sessionTake.baseModel.baseList}" var="_var" rowKeyVar="_index">
						<li onclick="Transfer(#{_var.id})">
						<a class="basename"  href="javascript:void(0)" >#{_var.name}
					    </a>
					    </li>
					</a:repeat>
					<h:inputHidden value="0" name="hide" id="hideId"/>
					<h:inputHidden value="" name="typeHide" id="typeHide"/>
                </ul>
            </div>
            <div class="modal-footer">
            	<button class="btn btn-primary" onclick=" return selectOk();">确认</button>
            	<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            </div>
        </div>
        </div>
    </div>    
		<div class="right_c">
					<div class="r_title">
                	<div class="r_t_l cm_r_t_l"><span>采销存&#160;&gt;&#160;&#160;采收</span><em>&gt;</em><font size="3">预采管理</font></div>
                        <div class="fr" style="margin-bottom:-1px;float:right;">
                        	<ul class="cm_resumeList clear">
                                <li>
                                	<a href="#{request.contextPath}#{sessionTake.harvestParam eq 1?'/realplant/HarvestRecordsList.seam':'/realplant/RealPlantList.seam'}"><img src="../asset/images/caishoujilu01.png"/><span>采收记录</span></a>
                                </li> 
								<li>
                                	<a href="javascript:void(0)" disabled="true" class="borderBt" style="cursor:default;"><img src="../asset/images/yucai01.png"/><span>预采管理</span></a>
                                </li> 
                                
                                <li>
                                	<a href="#{request.contextPath}/harvest/PreSalesList.seam"><img src="../asset/images/yushou01.png"/><span>预售管理</span></a>
                                </li>  
                             </ul>                    
                        	</div>
                    </div>
                    <br/>
                  <!--  新搜索开始 -->
                <div class="search_header clear" style="padding-right:150px;">
                    <div class="search_selected fl">
                        <dl style="width:320px;" class="se_selt180 fl">
                            <dt style="width:100px;">预采收时间：</dt>
                            <dd class="inline_block bootSelt180">
                                <div class="input-append date form_datetime ">
                                	<h:inputText size="26" type="text" value="" readonly="" style="padding:0;" id = "preHarvestTimeId" />
                                	<span class="add-on"><i class="icon-th"></i></span>
                            	</div>
                            </dd>
                        </dl>
                        <dl style="width:250px;" class="se_selt180 fl">
                            <dt style="width:126px;">预采时间类型：</dt>
                            <dd class="inline_block bootSelt180">
                                <select class="selectpicker" id = "preHarTimeTypeId">
                                    <option selected="selected" value="0">全部</option>
                                    <option  value="1">按日</option> 
                                    <option  value="2">按周</option> 
                                    <option  value="3">按月</option> 
                                    <option  value="4">按年</option>                             
                                </select> 
                            </dd> 
                        </dl>
                        <dl style="width:250px;" class="se_selt180 fl">
                            <dt style="width:100px;">预采类型：</dt>
                            <dd class="inline_block bootSelt180">
                                <select class="selectpicker" id = "preHarTypeId">
                                    <option selected="selected" value="0">全部</option>
                                    <option  value="2">按大棚</option>  
                                    <option  value="1">按作物</option>                           
                                </select> 
                            </dd>
                        </dl>
                        <button type="button" style="width:70px;" class="btn btn-primary" onclick="searchByTime()" >搜索</button>
                    </div>
                    <div class="search_header_rt">
                    	<div class="btn-group bootstrap_select fr" style="margin-left:3px;">
					    	<button type="button" class="btn dropdown-toggle selectpicker btn-default" data-toggle="dropdown"><span id="">添加预采</span><span class="caret"></span></button>
							<ul class="dropdown-menu" role="menu">
								<li>
									<a  href="javascript:void(0);" onclick="addPreHarvestHuiDiaoDaPeng();" >按大棚</a>
							    </li>
							    <li>
							    	<a  href="javascript:void(0);" onclick="addPreHarvestHuiDiaoZuoWu();" >按作物</a>
							    </li>
							</ul>
					  </div>
				  </div>
                </div>                  
                  <!--  新搜索结束 -->
          <!-- table开始 -->
          <h:panelGroup id = "refreshPreHarvestList" >
          	<div class="table_modal comment_table mt15">
                    <table width="100%" cellpadding="0" cellspacing="0" style="table-layout: fixed;">
                    <tr>
                        <th width="12%">预采时间</th>
                        <th width="12%">预采类型</th>
                        <th width="12%">预采棚数量</th>
                        <th width="12%">预采作物数量</th>
                        <th width="12%">预采总量</th>
                        <th width="12%">录入人</th>
                        <th width="12%">录入时间</th>
                        <th width="16%">操作</th>
                    </tr>
                    <a:repeat value="#{preHarvestListNew.preHarvestListData}" var="preHarvest">
                     <tr class="trItem even">
                     	<h:panelGroup rendered="#{preHarvest[1] ne null}" >
                        	<td>
                        	<p class="txt_name" title="#{preHarvest[1]}">#{preHarvest[1]}</p>
                        	</td>
                        </h:panelGroup>
                        <h:panelGroup rendered="#{preHarvest[1] eq null}" >
                        	<td>旧数据</td>
                        </h:panelGroup>
                        <h:panelGroup rendered="#{preHarvest[2] eq 1}" >
                        	<td>按作物预采</td>
                        </h:panelGroup>
                        <h:panelGroup rendered="#{preHarvest[2] eq 2}" >
                        	<td>按大棚预采</td>
                        </h:panelGroup>
                        <h:panelGroup rendered="#{preHarvest[2] eq null}" >
                        	<td>旧数据无采收类型</td>
                        </h:panelGroup>
                        <h:panelGroup rendered="#{preHarvest[3] ne null}" >
                        	<td>#{preHarvest[3]}</td>
                        </h:panelGroup>
                        <h:panelGroup rendered="#{preHarvest[3] eq null}" >
                        	<td>--</td>
                        </h:panelGroup>
                        <h:panelGroup rendered="#{preHarvest[4] ne null}" >
                        	<td>#{preHarvest[4]}</td>
                        </h:panelGroup>
                        <h:panelGroup rendered="#{preHarvest[4] eq null}" >
                        	<td>--</td>
                        </h:panelGroup>     
                        <h:panelGroup rendered="#{preHarvest[5] ne null}" >
                        	<td>
                        	<p class="txt_name" title="#{preHarvest[5]}">#{preHarvest[5]}</p>
                        	</td>
                        </h:panelGroup> 
                        <h:panelGroup rendered="#{preHarvest[5] eq null}" >
                        	<td>0.0kg+0.0</td>
                        </h:panelGroup>                   
                        <td>#{preHarvest[6]}</td>
                        <td>#{preHarvest[7]}</td>
                        <td>
                           	<s:link propagation="none" view="/harvest/PreHarvestAdd.xhtml" styleclass="list_view" title="查看" >
								<f:param name="preHarvestType" value = "#{preHarvest[2]}" />
								<f:param name="addOrUp" value = "see" />
								<f:param name="preHarvestId" value="#{preHarvest[0]}" />			
								<f:param name="selectPageNum" value="#{preHarvestListNew.selectPageNum}" />
								<f:param name="preHarvestTime" value="#{preHarvestListNew.preHarvestTime}" />
								<f:param name="preHarType" value="#{preHarvestListNew.preHarType}" />
								<f:param name="preHarTimeType" value="#{preHarvestListNew.preHarTimeType}" />	
                       			<img class="icon_delete"  src="#{request.contextPath}/asset/images/commons/cjsearch_bg.png" />
							</s:link>        
							<s:link propagation="none" view="/harvest/PreHarvestAdd.xhtml" styleclass="list_view" title="编辑" >
								<f:param name="preHarvestType" value = "#{preHarvest[2]}" />
								<f:param name="addOrUp" value = "update" />
								<f:param name="preHarvestId" value="#{preHarvest[0]}" />
								<f:param name="selectPageNum" value="#{preHarvestListNew.selectPageNum}" />
								<f:param name="preHarvestTime" value="#{preHarvestListNew.preHarvestTime}" />
								<f:param name="preHarType" value="#{preHarvestListNew.preHarType}" />
								<f:param name="preHarTimeType" value="#{preHarvestListNew.preHarTimeType}" />		
							    <img class="icon_delete"  src="#{request.contextPath}/asset/images/commons/tableIco_edit.png" />
							</s:link>
                        	<a title="删除" href='javascript:;' onclick="deletePreHarvest(#{preHarvest[0]})">
                        		<img class="icon_delete"  src="#{request.contextPath}/asset/images/commons/cheng.png" />
                        	</a>                        
                        	<s:link propagation="none" view="/harvest/PreHarvestListNew.xhtml" styleclass="list_view" action="#{preHarvestProductList.exportExcel}" title="导出" >
								<!-- <f:param name="preHarvestType" value = "#{preHarvest[2]}" /> -->
								<!-- <f:param name="addOrUp" value = "update" /> -->
								<f:param name="preHarId" value="#{preHarvest[0]}" />
								<f:param name="preHarvestId" value="#{preHarvest[0]}" />
								<f:param name="selectPageNum" value="#{preHarvestListNew.selectPageNum}" />
								<f:param name="preHarvestTime" value="#{preHarvestListNew.preHarvestTime}" />
								<f:param name="preHarType" value="#{preHarvestListNew.preHarType}" />
								<f:param name="preHarTimeType" value="#{preHarvestListNew.preHarTimeType}" />		
							    <img class="icon_delete"  src="#{request.contextPath}/asset/images/commons/left.png" />
							</s:link>                       	
                         	<h:panelGroup rendered="#{preHarvest[8] eq 1 and preHarvest[2] eq 2 and preHarvestListNew.preProductType eq 1}" >
                         		<s:link propagation="none" view="/harvest/PreHarvestControlNew.xhtml" styleclass="list_view" title="包装" >
									<f:param name="preHarvestId" value="#{preHarvest[0]}" />
									<f:param name="preHarvestStartTime" value="#{preHarvest[9]}" />
									<f:param name="preHarvestEndTime" value="#{preHarvest[10]}" />
									<f:param name="selectPageNum" value="#{preHarvestListNew.selectPageNum}" />
									<f:param name="preHarvestTime" value="#{preHarvestListNew.preHarvestTime}" />
									<f:param name="preHarType" value="#{preHarvestListNew.preHarType}" />
									<f:param name="preHarTimeType" value="#{preHarvestListNew.preHarTimeType}" />
							    	<img class="icon_delete"  src="#{request.contextPath}/asset/images/commons/hua.png" />
								</s:link>
                        	</h:panelGroup>
                        </td>
                    </tr> 
                   </a:repeat>                  
                </table>
                </div>
        <!-- table结束 -->
                   <!--分页开始-->
                   <h:inputHidden value="#{preHarvestListNew.selectPageNum}" id="thisPageId"/>
					<div class="pageModel_wap" style="padding:50px 0 30px;">
						<h:form id="pageFrom" rendered="#{null ne preHarvestListNew.preHarvestListData and preHarvestListNew.preHarvestListData.size() gt 0}">
							<table style="height:30px; margin:40px auto 0 auto;" cellpadding="0" cellspacing="0">
								<tr>
									<s:fragment rendered="#{!preHarvestListNew.hasPreviousPage }">
										<td><img src="#{request.contextPath}/asset/images/page_68.jpg" width="4" height="32" /></td>
									</s:fragment>
									<s:fragment rendered="#{preHarvestListNew.hasPreviousPage and preHarvestListNew.totalPages > 1}">
										<td><img src="#{request.contextPath}/asset/images/page_67.jpg" width="4" height="32" /></td>
										<td class="td_t_b">
											<a:commandLink style="color:#333333;" id="firstPage" onclick="queryByPage(1)" rendered="#{preHarvestListNew.hasPreviousPage and preHarvestListNew.totalPages > 1}" >首页</a:commandLink>
										</td>
										<td class="td_t_b td_t_t" style="padding:0; width:30px;">
											<a:commandLink styleClass="no_n" id="previousPage" onclick="queryByPage(#{preHarvestListNew.prePageNum})"  >&lt;</a:commandLink>
										</td>
									</s:fragment>
									<a:repeat var="_page" value="#{preHarvestListNew.showPageList}" rowKeyVar="_index">
										<s:fragment rendered="#{_page gt 0 and _page le preHarvestListNew.totalPages}">
											<td class="td_t_b #{preHarvestListNew.hasPreviousPage  or _index >0 ?' td_t_t' : ''} #{_page eq preHarvestListNew.selectPageNum ? 'onp' : ''}" >
												<a:commandLink id="thisPage"  onclick="queryByPage(#{_page})"  >#{_page}</a:commandLink>
											</td>
										</s:fragment>
									</a:repeat>
									<s:fragment rendered="#{preHarvestListNew.flag}">
										<td class="td_t_b td_t_t">
											<a:commandLink styleClass="no_d"  id="nextPage" onclick="queryByPage(#{preHarvestListNew.nextPageNum})" rendered="#{preHarvestListNew.hasNextPage and preHarvestListNew.totalPages > 1}" >&gt;</a:commandLink>
										</td>
										<td class="td_t_b td_t_t">
											<a:commandLink style="color:#333333;"  id="lastPage" onclick="queryByPage(#{preHarvestListNew.totalPages})" rendered="#{preHarvestListNew.hasNextPage and preHarvestListNew.totalPages > 1}" >尾页</a:commandLink>
										</td>
									</s:fragment>
									<td class="td_t_b td_t_t" style=" color:#9a9a9c;">共#{preHarvestListNew.totalPages}页</td>
									<td ><img src="#{request.contextPath}/asset/images/page_70.jpg" width="4" height="32" /></td>
								</tr>
							</table>
						</h:form>	
					</div> 
           		   <!--分页结束-->
           		   <!-- 提示信息开始 --> 		
                     <s:div styleClass="farming_nodata" rendered="#{empty preHarvestListNew.preHarvestListData}">
                     	<div class="warning_noData">
                        	<em>很遗憾，没有预采信息</em>
                           	<p>快来添加吧！</p>
                        </div>
                     </s:div>
          			<!-- 提示信息结束-->  
          			<h:inputHidden value="#{preHarvestListNew.preHarvestTime}" id = "preHarvestTimeHId"/>
          			<h:inputHidden value="#{preHarvestListNew.preHarType}" id = "preHarTypeHId"/>
          			<h:inputHidden value="#{preHarvestListNew.preHarTimeType}" id = "preHarTimeTypeHId"/>
          </h:panelGroup>
                    <div class="clear"></div>
                </div><!--right_c结束-->
	</td>
<!-- 异步请求开始 -->
<a:form>
	<!-- 搜索 -->
	<a:jsFunction name="searchPreHarvestListByTime" action="#{preHarvestListNew.preHarvestListInit()}" reRender="refreshPreHarvestList" >
		<a:actionparam name="preHarvestTime" assignTo="#{preHarvestListNew.preHarvestTime}" />
		<a:actionparam name="preHarType" assignTo="#{preHarvestListNew.preHarType}" />
		<a:actionparam name="preHarTimeType" assignTo="#{preHarvestListNew.preHarTimeType}" />
		<a:actionparam name="selectPageNum" assignTo="#{preHarvestListNew.selectPageNum}" />
	</a:jsFunction>
	<!-- 分页 -->
	<a:jsFunction name="queryPreHarvestListByPage" action="#{preHarvestListNew.preHarvestListInit()}" reRender="refreshPreHarvestList" >
		<a:actionparam name="selectPageNum" assignTo="#{preHarvestListNew.selectPageNum}" />
		<a:actionparam name="preHarvestTime" assignTo="#{preHarvestListNew.preHarvestTime}" />
		<a:actionparam name="preHarType" assignTo="#{preHarvestListNew.preHarType}" />
		<a:actionparam name="preHarTimeType" assignTo="#{preHarvestListNew.preHarTimeType}" />
	</a:jsFunction>
	<!-- 删除 -->
	<a:jsFunction name="deletePreHarvestById" action="#{preHarvestListNew.preHarvestDeleteById()}" reRender="refreshPreHarvestList" >
		<a:actionparam name="preHarvestId" assignTo="#{preHarvestListNew.preHarvestId}" />
		<a:actionparam name="selectPageNum" assignTo="#{preHarvestListNew.selectPageNum}" />
		<a:actionparam name="preHarvestTime" assignTo="#{preHarvestListNew.preHarvestTime}" />
		<a:actionparam name="preHarType" assignTo="#{preHarvestListNew.preHarType}" />
		<a:actionparam name="preHarTimeType" assignTo="#{preHarvestListNew.preHarTimeType}" />
	</a:jsFunction>
	<a:jsFunction name="queryBaseIdDaPeng" action="#{preHarvestListNew.queryBase()}" data="#{preHarvestListNew.hasBaseId}" oncomplete="addPreHarvestHuiDiaoDaPeng(data);">		
	</a:jsFunction>
	<a:jsFunction name="queryBaseIdZuoWu" action="#{preHarvestListNew.queryBase()}" data="#{preHarvestListNew.hasBaseId}" oncomplete="addPreHarvestHuiDiaoZuoWu(data);">		
	</a:jsFunction>
	<a:jsFunction name="chooseBaseAndRedirect1" action="#{baseChooseHome.chooseBaseAndRedirect()}"  oncomplete="redirect()">
		<a:actionparam name="baseId" assignTo="#{baseChooseHome.baseId}" />
	</a:jsFunction>
	<a:queue requestDelay="10" ignoreDupResponses="true"/>
</a:form>
<!-- 异步请求结束 -->
<script type="text/javascript">
//<![CDATA[
	    $(document).ready(function() {
	        $('.selectpicker').selectpicker();
	        $(".form_datetime").datetimepicker({
	            format: "yyyy-mm-dd",  /* 控制显示格式，默认为空，显示小时分钟 */
	            autoclose: true,
	            weekStart: 1,
	            //startDate: "2014-08-14 10:00",
	            language:  'zh-CN',
	            startView: 3,
	            minView: 2,
	            maxView: 4,     
	            pickerPosition: "bottom-left"
	        }); 
	    //返回的时候数据回显
			var preHarvestTime = "#{preHarvestListNew.preHarvestTime}";
			var preHarType = "#{preHarvestListNew.preHarType}";
			var preHarTimeType = "#{preHarvestListNew.preHarTimeType}";
			$("#preHarvestTimeId").val(preHarvestTime);
			$("#preHarTimeTypeId").selectpicker("val",preHarTimeType);
			$("#preHarTypeId").selectpicker("val",preHarType);   

			jquery('.choose_list li').click(function(){
					jquery(this).addClass('lCur').siblings().removeClass('lCur');
				});
	    });	 
	    /* 搜索  */  
	    	function searchByTime(){
		    	var selectPageNum = 1;
		    	var preHarvestTime = $("#preHarvestTimeId").val();
		    	var preHarType = $("#preHarTypeId").val();
		    	var preHarTimeType = $("#preHarTimeTypeId").val();
		    	if(preHarvestTime!=null){
		    		preHarvestTime = trim(preHarvestTime);
			    	}
	    		searchPreHarvestListByTime(preHarvestTime,preHarType,preHarTimeType,selectPageNum);
		    }
	   /*  分页 */
	   	    function queryByPage(page){
		   	 	var selectPageNum = page;
		   	 	var preHarvestTime = $("#preHarvestTimeHId").val();
		    	var preHarType = $("#preHarTypeHId").val();
		    	var preHarTimeType = $("#preHarTimeTypeHId").val();
		    	if(preHarvestTime!=null){
		    		preHarvestTime = trim(preHarvestTime);
			    	}
	   	    	queryPreHarvestListByPage(Number(selectPageNum),preHarvestTime,preHarType,preHarTimeType);
		    }
		/* 删除 */ 
			var getId;
		    function deletePreHarvest(id){
	    	   	document.getElementById("productMsg").innerHTML = "您确定要删除本条记录么？"; 
		    	jquery("#myModalYz").modal("show");
		    	getId = id;
			}
   			function selectYes(){
		   	 	var selectPageNum = $("#thisPageId").val();
		   	 	var preHarvestTime = $("#preHarvestTimeHId").val();
		    	var preHarType = $("#preHarTypeHId").val();
		    	var preHarTimeType = $("#preHarTimeTypeHId").val();
		    	if(preHarvestTime!=null){
		    		preHarvestTime = trim(preHarvestTime);
			    	}
		    	var preHarvestId = getId;
		    	deletePreHarvestById(Number(preHarvestId),Number(selectPageNum),preHarvestTime,preHarType,preHarTimeType);
	   		}
		 	function addPreHarvestHuiDiaoDaPeng(){//回调
			 	if(checkBase(1)){
			 		var preHarvestType = $("#addPreHarvestId").val();
			   	 	var selectPageNum = $("#thisPageId").val();
			   	 	var preHarvestTime = $("#preHarvestTimeHId").val();
			    	var preHarType = $("#preHarTypeHId").val();
			    	var preHarTimeType = $("#preHarTimeTypeHId").val();
					window.location.href="#{request.contextPath}/harvest/PreHarvestAdd.seam?&preHarvestType=2&addOrUp=add"+"&selectPageNum="+selectPageNum+"&preHarvestTime="+preHarvestTime+"&preHarType="+preHarType+"&preHarTimeType="+preHarTimeType;
				}
			}
		 	function addPreHarvestHuiDiaoZuoWu(){//回调
		 		if(checkBase(2)){
				 	var preHarvestType = $("#addPreHarvestId").val();
			   	 	var selectPageNum = $("#thisPageId").val();
			   	 	var preHarvestTime = $("#preHarvestTimeHId").val();
			    	var preHarType = $("#preHarTypeHId").val();
			    	var preHarTimeType = $("#preHarTimeTypeHId").val();
					window.location.href="#{request.contextPath}/harvest/PreHarvestAdd.seam?&preHarvestType=1&addOrUp=add"+"&selectPageNum="+selectPageNum+"&preHarvestTime="+preHarvestTime+"&preHarType="+preHarType+"&preHarTimeType="+preHarTimeType;	
		 		}
		 	}
	   	 	function trim(str){
	   	   		return str.replace(/(^\s+)|\s+$/g,"");
	   		 }
	   	//校验基地
	   		var level = #{sessionTake.levelId};
	   		var baseListLen = #{sessionTake.baseModel.baseNum};
	   		function checkBase(type){
	   			var selectVal = jquery('.siteSeleHd').text();
	   			if(baseListLen == 0){
	   				document.getElementById("topSpanValue").innerHTML = "请先添加基地！";
	   				jquery("#topModel").modal('show');
	   				return false;
	   			}else if(level < 4 && selectVal == "全部" && baseListLen != 1){
	   				showModal(type);
	   				return false;
	   			}
	   			return true;
	   		}
	   			//基地选择模态框中，选择基地
	   			function Transfer(id){
	   				jquery("#hideId").val(id);
	   			}
	   			function showModal(type){
		   			jquery("#typeHide").val(type);
	   				jquery("#choosebaseModal").modal("show");
	   			}
	   			function selectOk(){
		   			
	   				var baseId = jquery("#hideId").val();
	   				if(baseId == "0"){
	   					alert("请选择基地");
	   					return false;
	   				}
	   				chooseBaseAndRedirect1(baseId,'');
	   			}
	   			function redirect(){
	   				var type = jquery("#typeHide").val();
	   				if("1" == type){
	   					var preHarvestType = $("#addPreHarvestId").val();
				   	 	var selectPageNum = $("#thisPageId").val();
				   	 	var preHarvestTime = $("#preHarvestTimeHId").val();
				    	var preHarType = $("#preHarTypeHId").val();
				    	var preHarTimeType = $("#preHarTimeTypeHId").val();
						window.location.href="#{request.contextPath}/harvest/PreHarvestAdd.seam?&preHarvestType=2&addOrUp=add"+"&selectPageNum="+selectPageNum+"&preHarvestTime="+preHarvestTime+"&preHarType="+preHarType+"&preHarTimeType="+preHarTimeType;
		   			}else if("2" == type){
		   				var preHarvestType = $("#addPreHarvestId").val();
				   	 	var selectPageNum = $("#thisPageId").val();
				   	 	var preHarvestTime = $("#preHarvestTimeHId").val();
				    	var preHarType = $("#preHarTypeHId").val();
				    	var preHarTimeType = $("#preHarTimeTypeHId").val();
						window.location.href="#{request.contextPath}/harvest/PreHarvestAdd.seam?&preHarvestType=1&addOrUp=add"+"&selectPageNum="+selectPageNum+"&preHarvestTime="+preHarvestTime+"&preHarType="+preHarType+"&preHarTimeType="+preHarTimeType;	
			   		}
		   		}
//]]>
</script>
	</ui:define>
</ui:composition>
