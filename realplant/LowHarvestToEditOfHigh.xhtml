<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j"
	template="/layout/template_new.xhtml"
	xmlns:a="http://richfaces.org/a4j">
<ui:define name="body">
	
	<link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/purchase/bootstrap/bootstrap.min.css" />
    <link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/purchase/bootstrap/bootstrap-select.min.css" />
    <link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/model/style.css"/>
    <link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/model/commons.css"/>
    <link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/model/SeedInput.css" />	
	<script type="text/javascript">
		jquery = jQuery.noConflict();
		  	jquery(function(){
			 });
	</script>
	<style>
		/* /* 标题的位置*/
		    .edit_title_wap {
		    width: 85%;
		    margin: 0 auto;
		    border-bottom: 1px solid #ddd;
			}
			/* 标题的位置*/
			/* 标题的字体大小*/
			.edit_title_wap .text_title {
			    height: 34px;
			    line-height: 34px;
			    font-size: 16px;
			    color: #000;
			    font-weight: bold;
			
			}
			/* 标题的字体大小*/
			[class^="icon-"], [class*=" icon-"] {background-image: url("../images/bootstrap/glyphicons-halflings.png");} */
			.inline_block{ display:inline-block;}]
		.bootSelt220 { width:220px;}
		.bootSelt220 .bootstrap-select:not([class*="span"]):not([class*="col-"]):not([class*="form-control"]):not(.input-group-btn){ width:220px;}
		.w450{width:450px;}
		.w900{ width: 900px;clear:both;}
		.edit_infor_table{ font-size:12px;}
		.edit_infor_table .td_lt{ float:left; width:150px; line-height:34px; box-sizing:border-box; padding:0 15px 20px 0; text-align:right;}
		.edit_infor_table .td_rt{ float:left; width:300px; line-height:34px; box-sizing:border-box; padding:0 15px 20px 0;}
	</style>
	#{harvestRecordsHome.theEditorOfHigh()}
		<td valign="top">
			<div aria-hidden="false" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal" class="modal fade in w600na" style="display: none;">
				  <div class="modal-dialog">
				    <div class="modal-content">
				      <div class="modal-header">
				        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
				        <h4 class="modal-title" id="myModalLabel">提示框</h4>
				      </div>
				      <div class="modal-body">
				       <span id="spanValue">*号部分为必填项！</span>
				      </div>
				      <div class="modal-footer">
				        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
				        <button type="button" class="btn btn-primary" data-dismiss="modal">确认</button>
				      </div>
				    </div>
				  </div>
				</div>
            <div class="right_c" style="min-height:30px; padding-bottom:15px; padding-top:15px;">
            	<!-- 面包屑导航 开始 -->
                <div class="breadNav_wap mb15 clear">
                    <div class="breadNav_lt"><a href="#">加工</a><span>&gt;</span><a href="#">采收</a><span>&gt;</span><strong>添加采收</strong></div>
                </div>
                <h:form id="xiu">
                <!-- 种子投入品信息主体 开始 -->
                <div class="edit_title_wap mt20 mb20 clear">
                	<h2 class="text_title">作物信息</h2>
                </div>
                <div class="edit_infor_table" >
                <s:fragment rendered="#{harvestRecordsHome.definedType eq 0}">
                    <div id="xeasy">
                    	<div class="w450 fl">
	                    	<p class="td_lt">采收作物</p>
	                        <div class="td_rt">
	                        	<div class="inline_block bootSelt220 fl">
	                                <h:selectOneMenu id="plantIds" styleClass="selectpicker nw200 xb1" data-live-search="true" value="#{harvestRecordsHome.realPlantId}" onchange="changePlant2(this)">
										<s:selectItems value="#{harvestRecordsHome.realList}" var="var" label="#{var[2]}#{var[3]}" itemValue="#{var[0]}">
										</s:selectItems>
									</h:selectOneMenu>
	                            </div>      
	                        </div>
	                     </div>
                         <s:fragment rendered="#{sessionTake.harvestLevelCheck}">
                         <h:panelGroup id="xidObj" style="float:left;">
                         <div class="w450 fl">
	                        <p class="td_lt">等级</p>
	                        <div class="td_rt">
	                            <div class="inline_block bootSelt220 fl">
										<h:selectOneMenu styleClass="selectpicker" id="leveIds" value="#{harvestRecordsHome.level1}" onchange="xleveprice();">
											<s:selectItems value="#{harvestRecordsHome.leveList}" var="var" label="#{var.name}" itemValue="#{var.goodsLevelId}" />
										</h:selectOneMenu>
	                            </div>
	                        </div>
	                     </div>
	                     </h:panelGroup>
                        </s:fragment>
                    </div>
                    </s:fragment>
                    <s:fragment rendered="#{harvestRecordsHome.definedType eq 1}">
                     <div id="xdiff1" >
                     	<div class="w450 fl">
	                    	<p class="td_lt">采收作物</p>
	                        <div class="td_rt">
	                        	<div class="inline_block bootSelt220 fl">
	                               <h:selectOneMenu id="plantListId" styleClass="selectpicker nw200 xc1" data-live-search="true" value="#{harvestRecordsHome.plantListId}" onchange="xplantlevechange(this.value);">
										<s:selectItems value="#{harvestRecordsHome.plantList}" var="var" label="#{var[1]}" itemValue="#{var[0]}" />
									</h:selectOneMenu>
	                            </div>      
	                        </div>
	                     </div>
	                     <div class="w450 fl">
                         	<p class="td_lt">采收区域</p>
                        	<div class="td_rt">
	                            <div class="inline_block bootSelt220 fl">
	                               <h:panelGroup id="tunnelInfoId" style="float:left;">
										<h:selectOneMenu styleClass="selectpicker xc2" id="tunnelId" value="#{harvestRecordsHome.tunnelId}" onchange="xtunnelbian();">
											<f:selectItem itemLabel="无" itemValue="0"></f:selectItem>
											<s:selectItems value="#{harvestRecordsHome.tunnelList}" var="var" label="#{var.tunnelName}" itemValue="#{var.tunnelInfoId}" />
										</h:selectOneMenu>
									</h:panelGroup>
	                            </div>
                        	</div>
                    	</div>
                    </div>
                     	<div id="diff2" >
                     	<div class="w450 fl">
                    		<p class="td_lt">定植日期</p>
                        	<div class="td_rt">
	                        	<div class="inline_block bootSelt220 fl">
	                               <h:panelGroup id="xtimeId" style="float:left;">
										<select id="planttimeId" class="selectpicker nw200 xc3" name="planttimeId">
											<a:repeat value="#{harvestRecordsHome.realList}" var="var">
												<option value="#{var[0]}">#{var[1]}#{var[2]}</option>
											</a:repeat>
											<option value="0">无</option>
										</select>
									</h:panelGroup>
	                            </div>      
                        	</div>
                        </div>
                         <s:fragment rendered="#{sessionTake.harvestLevelCheck}">
                          <rich:panel id="xidObjs" style="margin:0; border:none; padding: 0;">
                         	<div class="w450 fl">
		                        <p class="td_lt">等级</p>
		                        <div class="td_rt">
		                            <div class="inline_block bootSelt220 fl">
											<h:selectOneMenu styleClass="selectpicker xc4" id="goodsLeve" value="#{harvestRecordsHome.goodsLevelId}" onchange="xgoodleveprice();">
												<s:selectItems value="#{harvestRecordsHome.goodLeveList}" var="var" label="#{var.name}" itemValue="#{var.goodsLevelId}" />
											</h:selectOneMenu>
		                            </div>
		                        </div>
		                    </div>
		                    </rich:panel>
                        </s:fragment>
                    </div>
                    </s:fragment>
                    <s:fragment rendered="#{sessionTake.harvestPriceCheck}">
	                    <div class="w450 fl">
	                        <p class="td_lt">单价</p>
	                        <div class="td_rt">
	                            <h:inputText value="#{harvestRecordsHome.instance.unitPrice}" id="money" class="form-control w220 mr5 fl" type="text" style="width:165px;" />
	                            <span style="float:left;line-height:34px;">元</span>
	                        </div>
	                    </div>
                    </s:fragment>
                </div>
                <div class="edit_title_wap mt20 mb20 clear">
                	<h2 class="text_title">采收信息</h2>
                </div>
                <div class="edit_infor_table" >
                	<s:fragment rendered="#{sessionTake.harvestHarvesterCheck}">
                	<div class="w450 fl">
                    	<p class="td_lt">采收人</p>
                        <div class="td_rt" >
                        	<div class="inline_block bootSelt220 fl">
                                <h:panelGroup id="farmerIds">
									<h:selectOneMenu style="display: block;" styleClass="selectpicker nw200 xa3" id="operatorIds" value="#{harvestRecordsHome.operatorFarmId}">
										<s:selectItems value="#{harvestRecordsHome.personLists}" var="var" label="#{var[1]}" itemValue="#{var[0]}" />
									</h:selectOneMenu>
								</h:panelGroup>
                            </div>
                        </div>
                    </div>
                    </s:fragment>
                    <div class="w450 fl">
                        <p class="td_lt" >采收时间</p>
                       	<div class="td_rt" >
                            <div class="bootData220">
                                <div class="input-append date form_datetime " style="position:relative; width:220px" >
								<h:inputText style="width:190px;" id="xshij" readonly="true" value="#{harvestRecordsHome.product.reciveTime}">
									<s:convertDateTime type="both" dateStyle="short" pattern="yyyy-MM-dd HH:mm" />
								</h:inputText>
								<h:inputHidden value="#{harvestRecordsHome.reciveTim}" id="xshij1" />
                                <span class="add-on" style="position:absolute; right:10px; top:10px;">
                                	<i class="icon-th" style="margin:0; "></i>
                                </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <s:fragment rendered="#{harvestRecordsHome.product.outputCheck ne null and harvestRecordsHome.product.outputCheck and harvestRecordsHome.definedType eq 0}">
                	<div class="w450 fl" id="cropDiv11">
                    	<p class="td_lt">产出品</p>
                        <div class="td_rt">
                        	<div class="inline_block bootSelt220 fl">
                        	<h:panelGroup id="outputPanel1" style="float:left;">
									<h:selectOneMenu style="display: none;" styleClass="selectpicker a3" id="outputId1" value="#{harvestRecordsHome.outputsId1}" onchange="changeOutpus1()">
										<s:selectItems value="#{harvestRecordsHome.outputsList1}" var="var" label="#{var[1]}" itemValue="#{var[0]}" />
									</h:selectOneMenu>
							</h:panelGroup>
                            </div>
                        </div>
                    </div>
                    <div class="w450 fl" id="cropDiv12">
                        <p class="td_lt">采收部位</p>
                        <div class="td_rt">
                            <div class="inline_block bootSelt220 fl">
                            <h:panelGroup id="sitePanel1" style="float:left;">
                                #{harvestRecordsHome.cropSiteStr1}
                                </h:panelGroup>
                            </div>
                        </div>
                    </div>
                    </s:fragment>
                     
                    <s:fragment rendered="#{harvestRecordsHome.product.outputCheck ne null and harvestRecordsHome.product.outputCheck and harvestRecordsHome.definedType eq 1}">
                    <div class="w450 fl" id="cropDiv21" >
                    	<p class="td_lt">产出品</p>
                        <div class="td_rt">
                        	<div class="inline_block bootSelt220 fl">
                        	<h:panelGroup id="outputPanel2" style="float:left;">
									<h:selectOneMenu style="display: none;" styleClass="selectpicker a3" id="outputId2" value="#{harvestRecordsHome.outputsId2}" onchange="changeOutpus2()">
										<s:selectItems value="#{harvestRecordsHome.outputsList2}" var="var" label="#{var[1]}" itemValue="#{var[0]}" />
									</h:selectOneMenu>
							</h:panelGroup>
                            </div>
                        </div>
                    </div>
                    <div class="w450 fl" id="cropDiv22" >
                        <p class="td_lt">采收部位</p>
                        <div class="td_rt">
                            <div class="inline_block bootSelt220 fl">
                            <h:panelGroup id="sitePanel2" style="float:left;">
                                 #{harvestRecordsHome.cropSiteStr2}
                            </h:panelGroup>
                            </div>
                        </div>
                    </div>
                    </s:fragment>
                	 <div class="w450 fl" >
                        <p class="td_lt">采收重量</p>
                        <div class="td_rt">
                        	<h:inputText value="#{harvestRecordsHome.instance.weight}" id="zhongl2" class="form-control fl" type="text" style="width:165px;" /> 
                        	<h:panelGroup id="xin" style="float:left;">
								<span class="pl5">#{goodsInfoConstant.getGoodUnitLabel(harvestRecordsHome.info.goodsUnit)}</span>
							</h:panelGroup>
                        </div>
                    </div>
                    <s:fragment rendered="#{sessionTake.harvestEarthCheck}">
                    <div class="w450 fl" >
                       <p class="td_lt">扣土重</p>
                       <div class="td_rt">
                           <h:inputText value="#{harvestRecordsHome.harvestEarthWeight}" class="form-control w220 mr5 fl" id="earthWeight" style="width:165px;"/>
                           <h:panelGroup id="earth" style="float:left;">
                           	<span style="float:left;line-height:34px;">#{goodsInfoConstant.getGoodUnitLabel(harvestRecordsHome.info.goodsUnit)}</span>
                       	</h:panelGroup>
                       </div>
                   </div>
                   </s:fragment>
                   <s:fragment rendered="#{sessionTake.harvesttareCheck}">
                   		<div class="w450 fl" >
	                        <p class="td_lt">皮重</p>
	                        <div class="td_rt">
	                            <h:inputText value="#{harvestRecordsHome.harvestTareWeight}" class="form-control w220 mr5 fl" id="tareWeight" style="width:165px;"/>
	                            <h:panelGroup id="tare" style="float:left;">
	                            	<span style="float:left;line-height:34px;">#{goodsInfoConstant.getGoodUnitLabel(harvestRecordsHome.info.goodsUnit)}</span>
	                        	</h:panelGroup>
	                        </div>
	                    </div>
	              </s:fragment>
                   <s:fragment rendered="#{sessionTake.harvestDishCheck}">
                   		<div class="w450 fl" >
                        	<p class="td_lt">净菜重</p>
                       		<div class="td_rt">
	                           <h:inputText value="#{harvestRecordsHome.harvestDishWeight}" class="form-control w220 mr5 fl" id="dishWeight" style="width:165px;"/>
	                           <h:panelGroup id="dish" style="float:left;">
	                           	<span style="float:left;line-height:34px;">#{goodsInfoConstant.getGoodUnitLabel(harvestRecordsHome.info.goodsUnit)}</span>
	                       		</h:panelGroup>
                      		</div>
                      	</div>
                   </s:fragment>
                	
                </div>
                <div class="edit_title_wap mt20 mb20 clear">
                	<h2 class="text_title">运输及储存</h2>
                </div>
                <div class="edit_infor_table" >
                	
                	<s:fragment rendered="#{sessionTake.harvestCarsCheck}">
                	<div class="w450 fl">
                    	<p class="td_lt" >车辆数</p>
                        <div class="td_rt" >
                        	<h:inputText value="#{harvestRecordsHome.harvestCarsNum}" class="form-control w220 mr5 fl" id="carsNum" style="width:165px;"/>
                            <span style="float:left;line-height:34px;">辆</span>
                        </div>
                    </div>
                    </s:fragment>
                     <s:fragment rendered="#{harvestRecordsHome.storageRoomId ne 0}">
	                    <div class="w450 fl">
	                    	<p class="td_lt" >采收入库</p>
	                        <div class="td_rt">
		                            <div class="inline_block bootSelt220 fl">
										<h:panelGroup id="editInStorage" style="float:left;">
											<h:selectOneMenu styleClass="selectpicker sfrk" value="#{harvestRecordsHome.storageRoomId}" id="storageRoomId" onchange="storageChange(2);">
												<f:selectItem itemLabel="无" itemValue="0"></f:selectItem>
												<s:selectItems var="_storage" value="#{harvestRecordsHome.storageRoomList}" label="#{_storage.name}" itemValue="#{_storage.storageRoomId}" />
											</h:selectOneMenu>
										</h:panelGroup>
		                            </div>
	                        </div>
                    	</div>
                    </s:fragment >
                    <s:fragment rendered="#{harvestRecordsHome.storageRoomId eq 0}">
                    	<s:fragment rendered="#{sessionTake.harvestInstockCheck}">
		                    <div class="w450 fl">
		                    	<p class="td_lt" >采收入库</p>
		                        <div class="td_rt">
			                            <div class="inline_block bootSelt220 fl">
											<h:panelGroup id="editInStorage0" style="float:left;">
												<h:selectOneMenu styleClass="selectpicker sfrk" value="#{harvestRecordsHome.storageRoomId}" id="storageRoomId0" onchange="storageChange(2);">
													<f:selectItem itemLabel="无" itemValue="0"></f:selectItem>
													<s:selectItems var="_storage" value="#{harvestRecordsHome.storageRoomList}" label="#{_storage.name}" itemValue="#{_storage.storageRoomId}" />
												</h:selectOneMenu>
											</h:panelGroup>
			                            </div>
		                        </div>
	                    	</div>
                    	</s:fragment>
                    </s:fragment >
                  <s:fragment rendered="#{sessionTake.harvestOperatorCheck}">
                  		<div class="w450 fl">
	                        <p class="td_lt">经办人</p>
	                        <div class="td_rt">
	                            <div class="inline_block bootSelt220 fl">
	                                <h:selectOneMenu styleClass="selectpicker sfrk hand1" value="#{harvestRecordsHome.handleId}" id="handleId">
										<s:selectItems var="var" value="#{harvestRecordsHome.operatorList}" label="#{var[1]}" itemValue="#{var[0]}" />
									</h:selectOneMenu>
	                            </div>
	                        </div>
	                   	</div>
                   </s:fragment>
                   <s:fragment rendered="#{harvestRecordsHome.instance.outWeight ne null and harvestRecordsHome.instance.outWeight ne 0}">
                   		<div class="w450 fl">
                            <p class="td_lt">采收出库</p>
                        	<div class="td_rt">
		                        <h:inputText value="#{harvestRecordsHome.instance.outWeight}" id="output" class="form-control fl" type="text" style="width:165px;" /> 
		                        <h:panelGroup id="xout" style="float:left;">
									<span class="pl5">#{goodsInfoConstant.getGoodUnitLabel(harvestRecordsHome.info.goodsUnit)}</span>
								</h:panelGroup>
                       	 	</div>
                       	</div>
                    </s:fragment>
                   <s:fragment rendered="#{harvestRecordsHome.instance.outWeight eq null or harvestRecordsHome.instance.outWeight eq 0}">
	                   <s:fragment rendered="#{sessionTake.harvestOutstockCheck and sessionTake.harvestInstockCheck}">
	                   		<div class="w450 fl">
	                            <p class="td_lt">采收出库</p>
	                        	<div class="td_rt">
			                        <h:inputText value="#{harvestRecordsHome.instance.outWeight}" id="output1" class="form-control fl" type="text" style="width:165px;" /> 
			                        <h:panelGroup id="xout1" style="float:left;">
										<span class="pl5">#{goodsInfoConstant.getGoodUnitLabel(harvestRecordsHome.info.goodsUnit)}</span>
									</h:panelGroup>
	                       	 	</div>
	                       	</div>
	                    </s:fragment>
                    </s:fragment>
                <s:fragment rendered="#{sessionTake.harvestMethodCheck}">
                	<div class="w900 fl">
                        <p class="td_lt">采收方法</p>
                        <div class="td_rt" >
                            <div class="textarea400" style="width:650px;">
                                <h:inputTextarea class="form-control" style="width:650px; height:100px;" id="harvestMethod" value="#{harvestRecordsHome.harvestMethod}" />
                            </div>
                        </div>
                    </div>
                </s:fragment>
                    <div class="w900 fl">
                        <p class="td_lt">备注</p>
                        <div class="td_rt" >
                            <div class="textarea400" style="width:650px;">
                               <h:inputTextarea id="descript" style="width:650px; height:100px;resize:none; font-size:12px;" rows="3" class="form-control" value="#{harvestRecordsHome.product.remark}" />
                            </div>
                        </div>
                    </div>
                	
                
                </div>
                <div style="padding:50px 0;text-align:center;clear:both;display:none">
               <s:fragment rendered="#{harvestRecordsHome.definedType ne 1}">
                	<h:commandButton id="up" styleClass="btn btn-primary bianjibutton"  action="#{harvestRecordsHome.up}" value="保存"  >
					</h:commandButton>
				</s:fragment>
					 <s:fragment rendered="#{harvestRecordsHome.definedType eq 1}">
						<h:commandButton id="update" styleClass="btn btn-primary bianjisavebutton" action="#{harvestRecordsHome.update}" value="提交" >
						</h:commandButton>
					</s:fragment>
                	<a href="/realplant/RealPlantList.seam" class="btn btn-default">返回</a>
                </div>
                <!-- 种子投入品信息主体 结束 -->
                </h:form>
                <div style="padding:50px 0;text-align:center;clear:both;">
                	<s:fragment rendered="#{harvestRecordsHome.definedType ne 1}">
						<input type="button" onclick="validationt(1,this)" class="btn btn-primary bianjibutton" value="保存"> </input>
					</s:fragment>
					 <s:fragment rendered="#{harvestRecordsHome.definedType eq 1}">
						<input type="button" onclick="validationt(2,this)" class="btn btn-primary bianjisavebutton" value="保存"> </input>
					</s:fragment>
					<a href="/realplant/HarvestRecordsList.seam" class="btn btn-default">返回</a>
                </div>
            </div>
            </td>    
		<a4j:form>
			<a4j:queue requestDelay="10" ignoreDupResponses="true" id="mainQueue" />
			<a4j:jsFunction name="xunitPirce" eventsQueue="mainQueue" action="#{harvestRecordsHome.price}" data="#{harvestRecordsHome.goodsLevel.unitPrice}" oncomplete="xprice(data);">
				<a4j:actionparam name="leveId" assignTo="#{harvestRecordsHome.leveId}" />
			</a4j:jsFunction>
			<a4j:jsFunction name="unitPirce" eventsQueue="mainQueue" action="#{harvestRecordsHome.price}" data="#{harvestRecordsHome.goodsLevel.unitPrice}" oncomplete="price(data);">
				<a4j:actionparam name="leveId" assignTo="#{harvestRecordsHome.leveId}" />
			</a4j:jsFunction>
			<a4j:jsFunction name="tunnelchange" eventsQueue="mainQueue" action="#{harvestRecordsHome.tunnelChange}" reRender="timeId,operator" oncomplete="tunnel();">
				<a4j:actionparam name="plantListId" assignTo="#{harvestRecordsHome.plantListId}" />
				<a4j:actionparam name="tunnelId" assignTo="#{harvestRecordsHome.tunnelId}" />
			</a4j:jsFunction>
			<a4j:jsFunction name="goodPirce" eventsQueue="mainQueue" action="#{harvestRecordsHome.goodprice}" data="#{harvestRecordsHome.goodLeveList[0].unitPrice}" oncomplete="goodprice(data);">
				<a4j:actionparam name="goodsLevelId" assignTo="#{harvestRecordsHome.goodsLevelId}" />
			</a4j:jsFunction>
			<a4j:jsFunction name="validateSafeTime" action="#{harvestRecordsHome.validateSafeTime}" data="#{harvestRecordsHome.msg}" oncomplete="safeTime(data);">
				<a4j:actionparam name="realPlantId" assignTo="#{harvestRecordsHome.realPlantId}" />
				<a4j:actionparam name="sval" value="#{harvestRecordsHome.sval}" />
				<a4j:actionparam name="mark" assignTo="#{harvestRecordsHome.mark}" />
				<a4j:actionparam name="tunnelId" assignTo="#{harvestRecordsHome.tunnelId}" />
			</a4j:jsFunction>
			<a4j:jsFunction name="queryCropSiteByOutputs1" action="#{harvestRecordsHome.queryCropSiteByOutputs1}" reRender="sitePanel1,xidObj,earth,tare,dish,money" oncomplete="xhuidao();">
				<a4j:actionparam name="outputsId1" assignTo="#{harvestRecordsHome.outputsId1}" />
				<a4j:actionparam name="plantId" assignTo="#{harvestRecordsHome.plantId}" />
			</a4j:jsFunction>
			<a4j:jsFunction name="queryCropSiteByOutputs2" action="#{harvestRecordsHome.queryCropSiteByOutputs2}" reRender="sitePanel2,xidObjs,earth,tare,dish,money" oncomplete="xhuidao();">
				<a4j:actionparam name="outputsId2" assignTo="#{harvestRecordsHome.outputsId2}" />
				<a4j:actionparam name="plantListId" assignTo="#{harvestRecordsHome.plantListId}" />
			</a4j:jsFunction>
			<a4j:jsFunction name="xplantlevel"  action="#{harvestRecordsHome.levechange}"  reRender="xidObjs,money,xin,xout,earth,tare,dish,outputPanel2,sitePanel2,"  oncomplete="xhuidao();">
				<a4j:actionparam name="plantListId" assignTo="#{harvestRecordsHome.plantListId}" />
			</a4j:jsFunction>
			<a4j:jsFunction name="xtunnelchange" eventsQueue="mainQueue" action="#{harvestRecordsHome.xtunnelChange}" reRender="xtimeId,farmerIds" oncomplete="xtunnel();">
				<a4j:actionparam name="plantListId" assignTo="#{harvestRecordsHome.plantListId}" />
				<a4j:actionparam name="tunnelId" assignTo="#{harvestRecordsHome.tunnelId}" />
			</a4j:jsFunction>
			<a4j:jsFunction name="xgoodPirce" eventsQueue="mainQueue" action="#{harvestRecordsHome.goodprice}" data="#{harvestRecordsHome.goodLeveList[0].unitPrice}" oncomplete="xgoodprice(data);">
				<a4j:actionparam name="goodsLevelId" assignTo="#{harvestRecordsHome.goodsLevelId}" />
			</a4j:jsFunction>
			<a4j:jsFunction name="xlevebian" eventsQueue="mainQueue" action="#{harvestRecordsHome.xlevebian}" reRender="xidObj,money,xin,xout,earth,tare,dish,editInStorage,outputPanel1,sitePanel1"  oncomplete="xhuidao()">
				<a4j:actionparam name="plantId" assignTo="#{harvestRecordsHome.plantId}" />
			</a4j:jsFunction>
		</a4j:form>
	<script type="text/javascript"	src="#{request.contextPath}/asset/js/checkBox/icheck.js"></script>
	<script type="text/javascript">
	//<![CDATA[
	
	// JavaScript Document
		var harvestLevel = #{sessionTake.harvestLevelCheck};
		var harvestOutStock = #{sessionTake.harvestOutstockCheck};
		var harvester = #{sessionTake.harvestHarvesterCheck};
		var harvestInStock = #{sessionTake.harvestInstockCheck};
		var storageRoom = "#{harvestRecordsHome.storageRoomId}";
		var outStockNum = "#{harvestRecordsHome.instance.outWeight}";
		jquery(function(){
			// (1)下拉框
			jquery('.selectpicker').selectpicker();	
			var tim=getNowTime();
				jquery(".form_datetime").datetimepicker({
					format: "yyyy-mm-dd hh:ii",  /* 控制显示格式，默认为空，显示小时分钟 */
					autoclose: true,
					weekStart: 1,
					language:  'zh-CN',
					/* startView: 3,
					minView: 2,
					maxView: 2, */		
					pickerPosition: "bottom-left"
				    });

				if(harvestOutStock && harvestInStock){
					if(storageRoom == "0" && harvestInStock){
						jquery("#xiu\\:output").attr("disabled",true);
					}
				}
		});
		

		  function plantlevechange(obj){
				plantlevel(obj);
		  }
		  function huidao(){
			  jquery('.selectpicker').selectpicker();
			  jquery(".c3").selectpicker("val",jquery(".c3 option:last").val());
		  }
		  //默认模式等级价格级联
		  function leveprice(){
				var leveId=jquery("#leveId").val();
				unitPirce(leveId);
		  }
		//默认价格
		  function price(data){
			  jquery('.selectpicker').selectpicker();
			  if(data==null){
				  document.getElementById("xiu:unitPrice").value="";
			  }else{
				  document.getElementById("xiu:unitPrice").value=data;
			  }
		  }

		//区域变更
		  function tunnelbian(){
			var plantId=jquery("#xiu\\:plantListId").val();
			var tunnelId=jquery("#xiu\\:tunnelId").val();
			tunnelchange(plantId,tunnelId);
		  }
		//区域回调
		  function tunnel(){
			  jquery('.a3').attr("data-live-search","true");
			 jquery('.selectpicker').selectpicker();
			 
		  }
		//自定义模式等级价格级联
		  function goodleveprice(){
			  var leveId=jquery("#goodsLeve").val();
				goodPirce(leveId);
		  }
		//自定义价格
		  function goodprice(data){
			  if(data==null){
				  document.getElementById("xiu:unitPrice").value="";
			  }else{
				  document.getElementById("xiu:unitPrice").value=data;
			  }
			  
		  }

		  //获取当前时间
		  function getNowTime(){
			  var date = new Date();
				var seperator1 = "-";
				var seperator2 = ":";
				var month = date.getMonth()+1;
				if(month >= 1 && month <=9){
					month = "0" + month;
				}
				var strDate = date.getDate();
				if(strDate >=0 && strDate <=9){
					strDate ="0"+strDate;
				}
				var minutes = date.getMinutes();
				if(minutes >=0 && minutes <=9){
					minutes ="0"+minutes;
				}
				var currentDate = date.getFullYear() + seperator1 + month + seperator1 + strDate +" " + date.getHours() + seperator2 + minutes
				return currentDate;
		}

		//修改验证
		  function validationt(type,obj){
			  jquery(obj).attr("disabled",true);
			  if(document.getElementById("xiu:zhongl2").value == ""){
			    	alert("采收量不能为空！");
			    	 jquery(obj).attr("disabled",false);
					return false;
			    }else{
			    	if(isNaN(document.getElementById("xiu:zhongl2").value) || parseFloat(document.getElementById("xiu:zhongl2").value) < 0){
						jquery("#spanValue").html("采收量请输入正确数字");
						 jquery("#myModal").modal('show');
						 jquery(obj).attr("disabled",false);
						 return false;
					}
				 }
			  if(document.getElementById("xiu:zhongl2").value ==0){
			    	alert("采收量不能为0！");
			    	jquery(obj).attr("disabled",false);
					return false;
			   }else{
				   var cval;
				   if(outStockNum != "" && outStockNum != "0"){
					   cval=jquery("#xiu\\:output").val();
					 }else{
						if(harvestInStock && harvestOutStock){
							cval=jquery("#xiu\\:output1").val();
						}
					}
					
					var zval=document.getElementById("xiu:zhongl2").value;
					if(eval(zval)<0){
						alert("采收量不能小于0!");
						jquery(obj).attr("disabled",false);
						return false;
					}
					if(harvestOutStock){
						if(cval!=null && cval !=""){
							if(isNaN(cval) || eval(cval)<0){
								alert("出库量请输入正确数字!");
								jquery(obj).attr("disabled",false);
								return false;
							}
							if(eval(cval)>eval(zval)){
								alert("出库量不能大于采收量！");
								jquery(obj).attr("disabled",false);
								return false;
							}
						}
					}
			   }
			  if(!checkOfHarvest(obj)){
					return false;
				}
			  var harvestMethod = jquery("#xiu\\:descript").val().trim();
				if(harvestMethod.length > 200){
					jquery("#spanValue").html("备注不能大于200字");
					 jquery("#myModal").modal('show');
					 jquery(obj).attr("disabled",false);
					return false;
				}
			 jquery("#xiu\\:xshij1").val(jquery("#xiu\\:xshij").val());
			 if(type == 1){
					jquery("#xiu\\:up").click();
				}else if(type == 2){
					jquery("#xiu\\:update").click();
				}		
			}

		  function safeTime(data){
				if(data == "OK"){
					var val=jquery("#replace").html().trim();
					if(val=="没有合适的采收作物？试试其他录入模式"){
						jquery('#xiu\\:saveBtn').trigger('click');
					}else{
						jquery('#xiu\\:saveBtn1').trigger('click');
					}
				}
				if(data == "NO"){
					jquery("#login").hide();
					jquery('#myModalWarn').modal('show');
				}
			}  

		function changeOutpus1(){
			var outputsId = jquery("#xiu\\:outputId1").val();
			var plantid = jquery("#xiu\\:plantIds").val();
			queryCropSiteByOutputs1(outputsId,plantid);
		}
		function changeOutpus2(){
			var outputsId = jquery("#xiu\\:outputId2").val();
			var plantid = jquery("#xiu\\:tunnelId").val();
			queryCropSiteByOutputs2(outputsId,plantid);
		}

		function isajax(timeid,num,plantId){
			 if(num!=0){
					document.getElementById("productMsg").innerHTML = "请切换到复杂界面下进行修改！";
					jquery("#prompt2").modal('show');
				}else{
					 var obj =checkSelectNew();
					 if(obj){
						 theEditor(timeid,plantId);
						 jquery('.selectpicker').selectpicker();
					}
				}
	 }


		//修改等级价格级联
		  function xleveprice(){
			  var leveId=jquery("#xiu\\:leveIds").val();
				xunitPirce(leveId);
		   }
		//修改等级价格级联回调
		  function xprice(data){
			  if(data==null){
				  document.getElementById("xiu:money").value="";
			  }else{
				  document.getElementById("xiu:money").value=data;
			  }
			  
		  }
		  function xplantlevechange(obj){
				xplantlevel(obj);
		}
		  function xhuidao(){
			  jquery('.selectpicker').selectpicker();
		  }
		//修改区域变更
		  function xtunnelbian(){
			var plantId=jquery("#xiu\\:plantListId").val();
			var tunnelId=jquery("#xiu\\:tunnelId").val();
			xtunnelchange(plantId,tunnelId);
		  }
		//修改区域回调
		  function xtunnel(){
			 jquery('.selectpicker').selectpicker();
			 jquery('.xc3').attr("data-live-search","true");
		  }
		//修改自定义模式等级价格级联
		  function xgoodleveprice(){
			  var leveId=jquery("#xiu\\:goodsLeve").val();
				xgoodPirce(leveId);
		  }
		//修改自定义模式等级价格级联回调
		  function xgoodprice(data){
			  if(data==null){
				  document.getElementById("xiu:money").value="";
			  }else{
				  document.getElementById("xiu:money").value=data;
			  }
		  }

		  function changePlant2(obj){
				var plant = jquery(obj).val();
				xlevebian(plant);
			}
		  function checkOfHarvest(){
				var earthCheck = #{sessionTake.harvestEarthCheck};
				var tareCheck = #{sessionTake.harvesttareCheck};
				var dishCheck = #{sessionTake.harvestDishCheck};
				var methodCheck = #{sessionTake.harvestMethodCheck};
				var carsNumCheck = #{sessionTake.harvestCarsCheck};
				var priceCheck = #{sessionTake.harvestPriceCheck};
				if(earthCheck){
					var ew = jquery("#xiu\\:earthWeight").val();
					if(isNaN(ew) || parseFloat(ew) < 0){
						jquery("#spanValue").html("扣土重请输入正确数字");
						 jquery("#myModal").modal('show');
						 jquery(obj).attr("disabled",false);
						 return false;
					}
				}
				if(tareCheck){
					var ew = jquery("#xiu\\:tareWeight").val();
					if(isNaN(ew) || parseFloat(ew) < 0){
						jquery("#spanValue").html("皮重请输入正确数字");
						 jquery("#myModal").modal('show');
						 jquery(obj).attr("disabled",false);
						 return false;
					}
				}
				if(dishCheck){
					var ew = jquery("#xiu\\:dishWeight").val();
					if(isNaN(ew) || parseFloat(ew) < 0){
						jquery("#spanValue").html("净菜重请输入正确数字");
						 jquery("#myModal").modal('show');
						 jquery(obj).attr("disabled",false);
						 return false;
					}
				}
				var r = /^\+?[1-9][0-9]*$/;　　//正整数
				if(carsNumCheck ){
					var ew = jquery("#xiu\\:carsNum").val().trim();
					if(ew != ""){
						if(isNaN(ew) || !r.test(ew)){
							jquery("#spanValue").html("车辆数请输入正确数字");
							 jquery("#myModal").modal('show');
							 jquery(obj).attr("disabled",false);
							 return false;
						}
					}
				}
				if(methodCheck){
					var harvestMethod = jquery("#xiu\\:harvestMethod").val().trim();
					if(harvestMethod.length > 200){
						jquery("#spanValue").html("采收方法不能大于200字");
						 jquery("#myModal").modal('show');
						 jquery(obj).attr("disabled",false);
						return false;
					}
				}
				if(priceCheck){
					var price = jquery("#xiu\\:money").val().trim();
					if(price != ""){
						if(isNaN(price) || parseFloat(price) < 0){
							jquery("#spanValue").html("价格请输入正确数字");
							 jquery("#myModal").modal('show');
							 jquery(obj).attr("disabled",false);
							 return false;
						}
					}
				}
				return true;
			}

		  function storageChange(obj){
			  	var instorageRoom = instorageRoom = jquery(obj).val();;
				var outStorage = "";
				if(jquery("#xiu\\:output").val() != undefined){
					outStorage = "#xiu\\:output";
				}
				if(jquery("#xiu\\:output1").val() != undefined){
					outStorage = "#xiu\\:output1";
				}
				if(outStorage != "" ){
					if(instorageRoom == "0"){
						jquery(outStorage).attr("disabled",true);
					}else{
						jquery(outStorage).attr("disabled",false);
					}
				}
			}
	//]]>
	</script>
</ui:define>
</ui:composition>
