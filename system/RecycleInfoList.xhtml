<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	template="/layout/template_new.xhtml">

	<ui:define name="body">
	<style>
	.bootstrap-select:not([class*=span]):not([class*=col-]):not([class*=form-control]):not(.input-group-btn){width:115px;margin-right: 5px;}
	</style>
	<script type="text/javascript">
  window.onload = function () {
    jquery('.selectpicker').selectpicker();
  };
</script>

	<td valign="top" width="210" style=" border-right:1px solid #e1e4eb;">
                <div class="left_c2">
                	<ul class="lt_c_ul">
                    	<li>
                        	<a href="#{request.contextPath}/user/EnterpriseInfoList.seam" ><strong><img class="tbimg" src="#{request.contextPath}/asset/images/enterpriseInfo_10.png"/>&#160;企业管理</strong></a>
                        </li>
                    	<li><a href="#{request.contextPath}/user/UserList.seam"  ><img class="tbimg" src="#{request.contextPath}/asset/images/user_17.png"/>&#160;用户管理</a></li>
                    	<li><a href="#{request.contextPath}/user/EnterpriseGroupList.seam"><img class="tbimg" src="#{request.contextPath}/asset/images/en.png"/>&#160;企业组管理</a></li>
                    	<li><a href="#{request.contextPath}/user/CommunityList.seam"><img class="tbimg" src="#{request.contextPath}/asset/images/community_23.png"/>&#160;角色管理</a></li>
                    	<li>
                        	<a href="#{request.contextPath}/user/RoleList.seam"><img class="tbimg" src="#{request.contextPath}/asset/images/role.png"/>&#160;权限管理</a>
                        </li>
                        <li>
                        	<a href="#{request.contextPath}/user/AdministratorList.seam" ><img class="tbimg" src="#{request.contextPath}/asset/images/userqie.png"/>&#160;用户切换管理</a>
                        </li>
                        <li>
                        	<a href="#{request.contextPath}/user/DataDicList.seam"><img class="tbimg" src="#{request.contextPath}/asset/images/dataDic.png"/>&#160;字典管理</a>
                        </li>
                         <li>
                        	<a href="#{request.contextPath}/user/DeviceTypeList.seam"><img class="tbimg" src="#{request.contextPath}/asset/images/shebei.png"/>&#160;设备类型</a>
                        </li>
                        <li>
                        	<a href="#{request.contextPath}/user/SkinInfoList.seam" ><img class="tbimg" src="#{request.contextPath}/asset/images/pifu.png"/>&#160;皮肤管理</a>
                        </li>
                        <li>
                        	<a href="#{request.contextPath}/user/LoginMessageList.seam"><img class="tbimg" src="#{request.contextPath}/asset/images/denglu.png"/>&#160;登录统计</a>
                        </li>
                        <li>
                        	<a href="#{request.contextPath}/user/BugInfoList.seam"><img class="tbimg" src="#{request.contextPath}/asset/images/shouji.png"/>&#160;手机日志管理</a>
                        </li>
                        <li  class="fon_07">
                        	<a href="#{request.contextPath}/system/RecycleInfoList_1.seam"><img class="tbimg" src="#{request.contextPath}/asset/images/huishouzhantupian.png"/>&#160;回收站</a>
                        </li>
                    </ul>
                	<div class="clear"></div>
                </div>
            </td>
       <td valign="top" >
					<!-- Modal -->
		<div class="right_c">
                	<div class="r_title">
                    	<div class="r_t_l"><font size="4">回收站</font></div>
                    </div>
					<br/>
                    <div class="z_r_ser">
                    <h:form id="storageTypeSearch">
                    	<table cellpadding="0" cellspacing="0">
                        	<tr>
                        		<td style="font-size:14px;">查询条件：</td>
                                <td>
                                	<h:inputText styleClass="form-control nw150" style="margin-right:5px;" id="searchStr" value="#{recycleInfoList.searchStr}"  />
                                </td>
                                <td>
                                <h:commandButton id="search" action="/system/RecycleInfoList.xhtml" styleClass="btn btn-primary" value="搜索" >
                                </h:commandButton>
                                <s:fragment rendered="#{s:hasRole('recycleBinReduction') or true}">
			        		<a class="btn btn-primary mr5"  href="javascript:void(0);" onclick="restoreFind();">还原</a>
			        	</s:fragment>
			        	<s:fragment rendered="#{s:hasRole('recycleBinDel') or true}">
			        		<a class="btn btn-primary"  href="javascript:void(0);" onclick="removeFind();">删除</a>
			        	</s:fragment>
                                </td>
                           </tr>
                       </table> 
                    </h:form>                         
                    </div>
                     <!--添加按钮开始-->
                    <!--添加按钮结束-->
                     <table width="100%" class="ze_table" cellpadding="0" cellspacing="0">
                    	<tr>
                    		<td width="5" height="4"><img src="#{request.contextPath}/asset/images/table_d_40.jpg" width="5" height="4" /></td>
                    		<td colspan="8" style="border-top:1px solid #e1e1e1; background:#f0f5fb;"></td>
                            <td width="5" height="4"><img src="#{request.contextPath}/asset/images/table_d_43.jpg" width="5" height="4" /></td>
                    	</tr>
	        <tr>
	        <th class="ze_bg ze_bt_le" width="5" height="4"></th>
	            <th class="ze_bg" width="5%"><input id="recycleAll" type="checkbox" class="iCheck" /></th>
	            <th class="ze_bg" width="15%">名称</th>
	            <th class="ze_bg" width="15%">模块名称</th>
	            <th class="ze_bg" width="15%">所属基地</th>
	            <th class="ze_bg" width="15%">所属企业</th>
	            <th class="ze_bg" width="15%">删除时间</th>
	            <th class="ze_bg" width="15%">删除用户</th>
	            <th class="ze_bg" width="5%">操作</th>
	              <th class="ze_bg ze_bt_ri" width="5" height="4"></th>
	        </tr>
	        <a:repeat value="#{recycleInfoList.resultList}" var="_recycle" rendered="#{not empty recycleInfoList.resultList}" rowKeyVar="_index">
	        	<tr class="#{_index % 2 == 0 ? '' : 'odd'}">
	        	<td class="ze_bg2 ze_bt_le" width="5" height="4"></td>
		            <td class="ze_bg2">
		            	<s:fragment rendered="#{_recycle.restore == false}">
		            		<input id="recycle#{_recycle.recycleInfoId}" type="checkbox" class="iCheck" name="checkItem" value="#{_recycle.recycleInfoId}"/>
		            	</s:fragment>
	            	</td>
		            <td class="ze_bg2">#{_recycle.name}</td>
		            <td class="ze_bg2">#{_recycle.modelName}</td>
		            <td class="ze_bg2">#{_recycle.base == null ? "" : _recycle.base.name}</td>
		            <td class="ze_bg2">#{_recycle.enterpriseInfo == null ? "" : _recycle.enterpriseInfo.name}</td>
		            <td class="ze_bg2">
		            	<h:outputText value="#{_recycle.insertTime}">
							<s:convertDateTime type="both" dateStyle="short" pattern="yyyy-MM-dd HH:mm:ss" />
						</h:outputText>
		            </td>
		            <td class="ze_bg2">#{_recycle.insertUser.nickname}</td>
		            <td class="ze_bg2">
		            	<s:link view="/system/#{empty from ? 'RecycleInfo' : from}.xhtml" title="查看" style="text-decoration:none;" propagation="#{empty from ? 'none' : 'default'}" id="recycleInfoIdViewId">
			                <f:param name="recycleInfoId" value="#{_recycle.recycleInfoId}"/>
			                <img src="#{request.contextPath}/asset/images/cjsearch_bg.png"/>
			            </s:link>
			           	<s:fragment rendered="#{s:hasRole('recycleBinDel') or true}">
				            <s:link view="/system/RecycleInfo.xhtml" title="删除" style="text-decoration:none;" propagation="none" action="#{recycleInfoHome.remove}" onclick="return confirm('确定删除吗？');" id="delete" rendered="#{empty from and _recycle.restore == false}">
								<f:param name="recycleInfoId" value="#{_recycle.recycleInfoId}"/>
								<img src="#{request.contextPath}/asset/images/02_62.png"/>
							</s:link> 
						</s:fragment>
						<s:link view="/system/RecycleInfo.xhtml" title="还原" style="text-decoration:none;" propagation="none" action="#{recycleInfoHome.restore}" onclick="return confirm('确定还原吗？');" id="restore" rendered="#{empty from and _recycle.restore == false}">
							<f:param name="recycleInfoId" value="#{_recycle.recycleInfoId}"/>
							<img src="#{request.contextPath}/asset/images/fanhui_01.png"/>
						</s:link> 
		            </td>
		           <td class="ze_bg2 ze_bt_ri" width="5" height="4"></td>
		        </tr>
	        </a:repeat>
	    </table>
                    <!--翻页开始-->
                    <table style="height:30px; margin:40px auto 0 auto;" cellpadding="0" cellspacing="0">
                    	<tr>
                    	<s:div rendered="#{not empty recycleInfoList.resultList}">
			                <s:decorate rendered="#{!recycleInfoList.previousExists }">
			                <td><img src="#{request.contextPath}/asset/images/page_68.jpg" width="4" height="30" /></td>
			                </s:decorate>
			                 <s:decorate rendered="#{recycleInfoList.previousExists }">
			                <td><img src="#{request.contextPath}/asset/images/page_67.jpg" width="4" height="30" /></td>
			                </s:decorate>
			                <s:decorate rendered="#{recycleInfoList.previousExists }">
                             <td class="td_t_b">
                            <s:link propagation="none"  view="/system/RecycleInfoList.xhtml"  >首页
                            <f:param name="pageNum" value="0" />
                            </s:link>
                            </td>
                            <td class="td_t_b td_t_t" style="padding:0; width:30px;">
                            <s:link propagation="none"  view="/system/RecycleInfoList.xhtml"  styleClass="no_n">
                            <f:param name="pageNum" value="#{recycleInfoList.previousFirstResult}"/>
                            &lt;
                            </s:link>
                            </td>
                            </s:decorate>
                            
					         <a:repeat var="_page" value="#{recycleInfoList.pageList}" rowKeyVar="_index">
									<td class="td_t_b #{recycleInfoList.previousExists or _index >0 ?'td_t_t':''} #{_page eq recycleInfoList.pageNum?'onp':''}"> 
									<s:link propagation="none"  view="/system/RecycleInfoList.xhtml" value="#{_page}" id="previousPage">
										<f:param name="pageNum" value="#{_page}" />
									</s:link></td>
							</a:repeat>
							
							<s:decorate rendered="#{recycleInfoList.nextExists}">
                            <td class="td_t_b td_t_t">
                            <s:link propagation="none"  view="/system/RecycleInfoList.xhtml"   styleClass="no_d">
                            <f:param name="pageNum" value="#{recycleInfoList.nextFirstResult}" />
                            &gt;
                            </s:link>
                            </td>
                            
                            <td class="td_t_b td_t_t">
							 <s:link propagation="none"  view="/system/RecycleInfoList.xhtml"  >尾页
							 <f:param name="pageNum" value="#{recycleInfoList.PAGE_COUNT}" />
							 </s:link></td>
							
							
                           </s:decorate>
                             <td class="td_t_b td_t_t" style=" color:#9a9a9c;">共#{recycleInfoList.PAGE_COUNT}页</td>
							<td><img src="#{request.contextPath}/asset/images/page_70.jpg" width="4" height="30" /></td>
							</s:div>
                    	</tr>
                    </table>
                    <!--翻页结束-->
                    <div class="clear"></div>
                </div><!--right_c结束-->
         <a:form>
  		<a:queue requestDelay="10" ignoreDupResponses="true"/>
		<a:jsFunction name="modifyRestore" action="#{recycleInfoList.modifyRestore}" data="#{recycleInfoList.searchStr}" oncomplete="oncomplete(data);">
			<a:actionparam name="recyleInfoIds" assignTo="#{recycleInfoList.recyleInfoIds}"/>
		</a:jsFunction>
		<a:jsFunction name="removeRecycleInfo" action="#{recycleInfoList.removeRecycleInfo}" data="#{recycleInfoList.searchStr}" oncomplete="oncomplete(data);">
			<a:actionparam name="recyleInfoIds" assignTo="#{recycleInfoList.recyleInfoIds}"/>
		</a:jsFunction>
		<a:jsFunction name="queryFind" action="#{recycleInfoList.queryFind}" data="#{recycleInfoList.searchStr}" oncomplete="oncomplete(data);">
			<a:actionparam name="searchStr" assignTo="#{recycleInfoList.searchStr}"/>
		</a:jsFunction>
	</a:form>
	<link rel="stylesheet" type="text/css" href="#{request.contextPath}/asset/css/checkBox/skinBlue.css"/>
<script type="text/javascript" src="#{request.contextPath}/asset/js/checkBox/icheck.js"></script>
	<script type="text/javascript">
	//<![CDATA[
		var recycleInfoIds;
		var recycleIdSize = 0;
	
		jQuery(function(){
			/* 下拉框js */
			jQuery('.selectpicker').selectpicker();	  
			//隔行换色
			jQuery('.tableModel tr').mouseover(function(){
				jQuery(this).addClass('hover');
			});
			jQuery('.tableModel tr').mouseout(function(){
				jQuery(this).removeClass('hover');
			});	

			/* 单选按钮 复选框js */
			jQuery('input[class=iCheck]').iCheck({
			    checkboxClass: 'icheckbox_minimal-blue',
			});
			jQuery('input[class=iRadio]').iCheck({
			    radioClass: 'iradio_minimal-blue',
			});
			recycleIdSize = jQuery("input[name='checkItem']:checkbox").size();
		});

		jQuery(document).ready(function(){
			jQuery("#recycleAll").on("ifClicked", function(event){
				if (this.checked) {
					jQuery("input[name='checkItem']").iCheck("uncheck"); 
				} else {
					jQuery("input[name='checkItem']").iCheck("check"); 
				}
				recycleInfoIds = "";
				jQuery("input[name='checkItem']:checkbox:checked").each(function(){
					recycleInfoIds += jQuery(this).val() + ",";
				});
				if (recycleInfoIds != null && recycleInfoIds != '') {
					recycleInfoIds = recycleInfoIds.substring(0, recycleInfoIds.length - 1);
				}
			});

			jQuery("input[name='checkItem']:checkbox").on("ifChanged", function(event){
				recycleInfoIds = "";
				jQuery("input[name='checkItem']:checkbox:checked").each(function(){
					recycleInfoIds += jQuery(this).val() + ",";
				});
				if (recycleInfoIds != null && recycleInfoIds != '') {
					recycleInfoIds = recycleInfoIds.substring(0, recycleInfoIds.length - 1);
				}
				var idSize = recycleInfoIds.split(","); 
				if (recycleIdSize == idSize.length) {
					jQuery("#recycleAll").iCheck("check"); 
				}else {
					jQuery("#recycleAll").iCheck("uncheck"); 
				}
			});
		});

		function restoreFind(){
			if (recycleInfoIds != null && recycleInfoIds != '' && recycleInfoIds != undefined) {
				modifyRestore(recycleInfoIds);
			}
		}

		function removeFind(){
			if (recycleInfoIds != null && recycleInfoIds != '' && recycleInfoIds != undefined) {
				removeRecycleInfo(recycleInfoIds);
			}
		}

		function queryActionFind(){
			queryFind(jQuery("#recycleInfoSearch\\:searchStr").val());
		}
		
		function oncomplete(data){
			window.location.href='#{request.contextPath}/system/RecycleInfoList.seam?searchStr=' + jQuery("#storageTypeSearch\\:searchStr").val();
		}
	//]]>
	</script>
</td>

	</ui:define>

</ui:composition>
