<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:c="http://java.sun.com/jstl/core"
	template="/layout/template_new.xhtml">
	
	<ui:define name="body">
	<link type="text/css" rel="stylesheet" href="#{request.contextPath}/asset/css/settings/EnterpriseSettings.css" />
    <script type="text/javascript" src="#{request.contextPath}/asset/js/EnterpriseLeftMenu.js"></script>
    
	<style>
		.fr{float:right;}
	.r_ulli1{float:right;}
	</style>
	
	<style>
.form-control{
	float:left;
}
	   html, body, #map-canvas {
        height: 100%;
        margin: 0px;
        padding: 0px
      }
.maptck{ border-collapse:collapse; position:absolute; z-index:10000; left:150px; top:150px;}
.titlefont{ font-size:16px; color:#e8e8e8; font-weight:bold;}
.numfont{ font-size:12px; color:#dadada; font-weight:normal; padding-left:20px;}
.closed{ margin-right:10px;}
.ludian{ height:19px; line-height:19px; padding-left:10px; background:url(#{request.contextPath}/asset/images/tckbg.png) left center no-repeat; display:inline-block; float:left;}
.ludian span{ min-width:30px; height:19px; line-height:19px; margin-right:-10px; padding-right:10px; color:#fff; background:url(#{request.contextPath}/asset/images/tckbg.png) right center no-repeat; display:inline-block; float:left; font-size:12px;}
.shidu{ height:19px; line-height:19px; padding-left:10px; float:left; color:#fff;}
.shuju{ width:100%; table-layout:fixed; margin-top:10px;padding-left:30px}
.shujutd{ color:#fff; background:url(#{request.contextPath}/asset/images/shuline.png) right repeat-y;}
.fottable{ height:22px; line-height:22px; background:url(#{request.contextPath}/asset/images/tckkbg5.png) repeat;}
.ckxx{ color:#0878bf; font-size:14px; text-decoration:underline; padding-left:25px; text-align:left; font-weight:bold;}
.qckxx2{ color:#0878bf; font-size:14px; text-decoration:underline; margin:0 auto; font-weight:bold; padding-top:5px; display:block;}
.cjtime{ text-align:right; color:#dddddd; padding-right:15px;}
.tdimg{padding-top:10px; padding-bottom:10px;}

.qixz{ border-collapse:collapse; position:absolute; z-index:10000; left:650px; top:150px;}
.qingt{ color:#fff; font-size:14px;}
.box_back{background:url(asset/images/bg_png3.png) repeat; width:100%; height:100%; position:fixed; z-index:8888; display:none;}

.gm-style-iw{ position:relative; z-index:100;margin-left:10px; }
.div_012{width:220px;}

.zw_bgt2{ width:88px;   position: absolute; z-index:3;}
.zw_libg_img2{ width:88px;  z-index:2; position:absolute;  margin-left:auto; margin-right:auto;display:block; cursor:pointer; }
.ret_pic2{width:92px; height:52px; float:left; position:relative; top:-33px; top:-23px\9;}
.div_width{ width:225px; padding:0px; background:#efefef; margin:0px auto;}
.div_dl2{position:relative; width:95px; *width:130px;  top:-8px; top:-6px\9; [;top:0px;]; margin-left:8px;}
.div_dt2{ font-size:14px; color:#171717; line-height:18px; font-family:"微软雅黑";}
.div_dt3{ font-size:14px; color:#e75467; line-height:20px;}
.div_dt4{ width:91px; *width:130px; height:20px; overflow:hidden; font-family:"黑体"; font-size:14px; color:#686868; line-height:22px;}
.modal-dialog2 {
    margin: 30px auto;
    width: 765px;
    height:580px;
}
.fr{float:right;}
.r_ulli1{float:right;}

  .r_t #topModel{width:600px;}
  .r_t #topModel .modal-dialog{ width:600px;}
</style>
	<script type="text/javascript">
	document.getElementById("selectBaseDiv").style.display="none";
	</script>
	<td valign="top">
                <div class="inbentory_file_main">
                <!--左侧二级导航 -->
                <div class="inbentory_level_wap">
                    <div class="inbentory_level">
                        <strong class="inben_first inben_first2">
                            <a href="javascript:;"><i class="icon_L icon_rkgl"></i>基础设置</a><b class="b_arrow"></b>
                        </strong>
                        <ol class="inben_second">
                            <li class="sed_item" onclick="window.open('#{request.contextPath}/user/UpdateEnterpriseSettings.seam?enterpriseId=#{sessionTake.enterpriseInfoId}','_self')" >
                            	<i class="icon_sed"></i>企业设置                   	
                            </li>
                            <!-- 管理版和以前的版本（标准、白金...)显示 -->
                            <h:panelGroup rendered="#{sessionTake.nowVersionService.basicService.basicServiceId==10 or sessionTake.nowVersionService.basicService.serviceType eq 1}">
                            	<li class="sed_item" onclick="window.open('#{request.contextPath}/user/ModuleSettings.seam','_self')" ><i class="icon_sed"></i>模块配置</li>
                            </h:panelGroup>
                            <li class="sed_item" onclick="window.open('#{request.contextPath}/dictionary/DataDicinfoList.seam','_self')" ><i class="icon_sed"></i>字段管理</li>
                            <li class="sed_item" onclick="window.open('#{request.contextPath}/user/EnterpriseCommunityList.seam','_self')" ><i class="icon_sed"></i>角色管理</li>
                            <s:fragment rendered="#{enterpriseInfoHome.enterpriseInfo.govState}">
	                        	<li class="sed_item" onclick="window.open('#{request.contextPath}/user/AuditInformationList.seam','_self')" ><i class="icon_sed"></i>审核信息</li>
	                        </s:fragment>
                            <li class="sed_item" onclick="window.open('#{request.contextPath}/system/RecycleInfoList_1.seam','_self')" ><i class="icon_sed"></i>回收站</li>
                        </ol>
                        <strong class="inben_first inben_first2">
                            <a href="javascript:;"><i class="icon_L icon_ckgl"></i>生产管理设置</a><b class="b_arrow"></b>
                        </strong>
                        <ol class="inben_second">
                            <h:panelGroup rendered="#{s:hasRole('certification')}">
                            	<li class="sed_item" onclick="window.open('#{request.contextPath}/map/CertificationList.seam','_self')" ><i class="icon_sed"></i>认证信息</li>
                            </h:panelGroup>
                            <li class="sed_item" onclick="window.open('#{request.contextPath}/message/TunnelGroupList.seam','_self')" ><i class="icon_sed"></i>分组管理</li>
                            <li class="sed_item" onclick="window.open('#{request.contextPath}/product/InputsInfoList.seam?goodsTypeInfoId=5','_self')" ><i class="icon_sed"></i>投入品信息</li>
                        </ol>
                        <strong class="inben_first inben_first2">
                            <a href="javascript:;"><i class="icon_L icon_zkgl"></i>销售管理设置</a><b class="b_arrow"></b>
                        </strong>
                        <ol class="inben_second">
                            <li class="sed_item" onclick="window.open('#{request.contextPath}/product/GoodsInfoList.seam','_self')"><i class="icon_sed"></i>物料信息</li>
                            <li class="sed_item" onclick="window.open('#{request.contextPath}/product/ProductInfoList.seam','_self')" ><i class="icon_sed"></i>商品信息</li>
                        </ol>
                        <strong class="inben_first inben_first2">
                            <a href="javascript:;"><i class="icon_L icon_pdgl"></i>硬件管理设置</a><b class="b_arrow"></b>
                        </strong>
                        <ol class="inben_second">
                            <li class="sed_item" onclick="window.open('#{request.contextPath}/device/DeviceList.seam','_self')"><i class="icon_sed"></i>设备管理</li>
                            <li class="sed_item sed_cur" onclick="window.open('#{request.contextPath}/device/VideoList.seam','_self')" ><i class="icon_sed"></i>视频管理</li>
                            <li class="sed_item" onclick="window.open('#{request.contextPath}/farming/AmRfidInfoList.seam','_self')" ><i class="icon_sed"></i>RFID卡管理</li>
                        </ol>
                    </div>
                    <i class="collapse_btn"></i>
                </div>
                <!--左侧二级导航 -->
				<!--右侧 -->
                <div class="inbentory_content">
		<h:form id="user" enctype="multipart/form-data">
		<h:inputHidden value="3" id="plantingPattern" name="plantingPattern" />
						<!-- Modal -->
<div aria-hidden="false" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal" class="modal fade in w600na" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">提示框</h4>
      </div>
      <div class="modal-body">
       <span id="productMsg1">*号部分为必填项！</span>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal">确认</button>
      </div>
    </div>
  </div>
</div>
                <div class="right_c">
                	<div class="r_title">
                    	<div class="r_t_l"><font size="3"><a href="#{request.contextPath}/device/VideoList.seam">视频管理</a></font></div>
                    	
                    </div>
                    <h:inputHidden value="#{videoHome.instance.coordinateX}" id="device_coordinateX" name="device_coordinateX"/>
                    <h:inputHidden value="#{videoHome.instance.coordinateY}" id="device_coordinateY" name="device_coordinateY"/>
                    <h:inputHidden value="#{videoHome.partitionId}" id="partition_id" name="partition_id"/>
                    <h:inputHidden value="#{videoHome.tunnel}" id="tunnel_id" name="tunnel_id"/>

				<!--入库订单列表开始-->
				<div class="all_d3">
				<!-- #{videoHome.methods2()} -->
				<!-- #{videoHome.showMap()} -->
				<!-- #{videoHome.queryParAndTunnel()} -->
				 
					<s:div styleClass="all_da all_w01" rendered="#{sessionTake.baseModel.baseNum ne null and sessionTake.baseModel.baseNum gt 1}">
                        	<table>
                                <tr>
                                    <td class="all_te">基地：</td>
                                    <td>
									<h:selectOneMenu styleClass="selectpicker" value="#{videoHome.baseId}"  id="provincialId" required="true">
									<s:selectItems var="_base" value="#{sessionTake.baseModel.baseList}" label="#{_base.name}" itemValue="#{_base.id}"/>
									</h:selectOneMenu>
                                    </td>
                                    <td style="color:red; padding-left: 5px;">*</td>
                                </tr>
                            </table>
                        </s:div>
                        <s:div styleClass="all_da all_w01" rendered="#{sessionTake.baseModel.baseNum le 1}">
                        	<table>
                                <tr>
                                    <td class="all_te">基地名称：</td>
                                    <td>
                                    <h:outputText value="#{sessionTake.baseModel.baseName}" />
                                    </td>
                                    <td style="color:red; padding-left: 5px;">*</td>
                                </tr>
                            </table>
                        </s:div>
                        
                         <div class="all_da all_w01">
                        	<table>
                                <tr>
                                    <td class="all_te">设备名称：</td>
                                    <td>
										 <h:inputText id="name" styleClass="form-control nw221"  value="#{videoHome.instance.name}"/>
                                    </td>
                                    <td style="color:red; padding-left: 5px;">*</td>
                                </tr>
                            </table>
                        </div>
                        
                        <div class="all_da all_w01">
                        	<table>
                                <tr>
                                    <td class="all_te">设备厂商：</td>
                                    <td>
										<h:selectOneMenu  styleClass="selectpicker" id="deviceTypeId" style="width:146px;"  value="#{videoHome.instance.deviceTypeId}" onchange="changeVideoType(this)">
											<s:selectItems value="#{videoHome.deviceTypeList}" var="var" label="#{var.name}" itemValue="#{var.id}"/>
										</h:selectOneMenu>
                                    </td>
                                    <td style="color:red; padding-left: 5px;">*</td>
                                </tr>
                            </table>
                        </div>
                        
                        <div class="all_da all_w01" name="hk">
                        	<table>
                                <tr>
                                    <td class="all_te">设备型号：</td>
                                    <td>
										<h:selectOneMenu styleClass="selectpicker" id = "type" style="width:146px;" value="#{videoHome.instance.accessWay}"  onchange="changeHtml(this)">
											<f:selectItem itemLabel="硬盘录像机" itemValue="1" />
											<f:selectItem itemLabel="新硬盘录像机" itemValue="3" />
										</h:selectOneMenu> 
                                    </td>
                                </tr>
                            </table>
                        </div>
                        
                      
                        <div class="all_da all_w01" >
                        	<table>
                                <tr>
                                    <td class="all_te">IP/域名：</td>
                                    <td>
										<h:inputText id="appIp" styleClass="form-control nw221"  value="#{videoHome.instance.appIp}"/>
									</td>
									<td style="color:red;padding-left: 5px;"><a id="help" href="#{request.contextPath}/help/hkVideoHelp.seam" target="_blank"><img src="#{request.contextPath}/asset/images/ico_help.png" /></a></td>
                                </tr>
                            </table>
                        </div>
                        
                        
                        <div class="all_da all_w01" name="new_hk">
                        	<table>
                                <tr>
                                    <td class="all_te">HTTP端口：</td>
                                    <td>
										<h:inputText id="HttpPort" styleClass="form-control nw221"  value="#{videoHome.instance.appWebPort}"/>
									</td>
									<td style="color:red;padding-left: 5px;"></td>
                                </tr>
                            </table>
                        </div>
                        <div class="all_da all_w01" name="new_sp">
                        	<table>
                                <tr>
                                    <td class="all_te">RTSP端口：</td>
                                    <td>
										<h:inputText id="RtspPort" styleClass="form-control nw221"  value="#{videoHome.instance.devicePort}"/>
									</td>
									<td style="color:red;padding-left: 5px;"></td>
                                </tr>
                            </table>
                        </div>
                        
                    	<div class="all_da all_w01" name="new_fw">
                        	<table>
                                <tr>
                                    <td class="all_te">服务端口：</td>
                                    <td>
										<h:inputText id="appPort" styleClass="form-control nw221"  value="#{videoHome.instance.appPort}"/>
									</td>
                                </tr>
                            </table>
                        </div>
                        <div class="all_da all_w01" >
                        	<table>
                                <tr>
                                    <td class="all_te">用户名称：</td>
                                    <td>
										<h:inputText id="appUsername" styleClass="form-control nw221"  value="#{videoHome.instance.appUsername}"/>
									</td>
									<td style="color:red;padding-left: 5px;"></td>
                                </tr>
                            </table>
                        </div>
                         <div class="all_da all_w01">
                        	<table>
                                <tr>
                                    <td class="all_te">用户密码：</td>
                                    <td>
										<h:inputText id="appPassword" styleClass="form-control nw221"  value="#{videoHome.instance.appPassword}"/>
									</td>
									<td style="color:red;padding-left: 5px;"></td>
                                </tr>
                            </table>
                        </div>
                        <div class="all_da all_w01" name="hk">
                        	<table>
                                <tr>
                                    <td class="all_te ziyuanid">通道号：</td>
                                    <td style="width: 145px;">
										<h:inputText id="appDeviceVideoChannelNo" styleClass="form-control nw221" style="width: 145px;" value="#{videoHome.instance.appDeviceVideoChannelNo}"/>
										<select id="channels" style="width: 145px; height: 30px;display:none;" onchange="ChannelNoChange();" ></select>
									</td>
									<td style="color:red;padding-left: 5px;"></td>
									<td style="padding-left: 5px;"><input id="getOn" type="button" value="获取通道号" onclick="getAppDeviceVideoChannelNo();"/></td>
                                </tr>
                            </table>
                        </div>
                        
                        <div class="all_da all_w01" name="sp">
                        	<table>
                                <tr>
                                    <td class="all_te ziyuanid">拍照上传编号：</td>
                                    <td>
										<h:inputText id="imgUpNo" styleClass="form-control nw221"  value="#{videoHome.instance.sn}"/>
									</td>
                                </tr>
                            </table>
                        </div>
                        <div class="all_da all_w01">
                        	<table>
                                <tr>
                                    <td class="all_te ziyuanid"></td>
                                    <td>
										<a href="#"  class="btn btn-default" onclick="showMapMe()">设备定位</a>
									</td>
                                </tr>
                            </table>
                        </div>
                        </div>
                        <div id="divPlugin" class="plugin" style="width:0;height:0;"></div>
					<table class="r_c_table" style="margin-bottom:30px; margin-top:0;" cellpadding="0" cellspacing="0">
                       <tr>
							<td class="r_c_td"></td>
							<td>
						<a:commandButton id="persist"  data-toggle="modal" data-target="#myModal"  value="提交" styleClass="btn btn-primary" action="#{videoHome.judgmentNo}" rendered="#{!videoHome.managed}" onclick="if(!checkSubmit()) return false;" data="#{videoHome.videoSnType}" oncomplete="showMessage(data,1)"/>
		            	<a:commandButton id="update" data-toggle="modal" data-target="#myModal"  value="提交" styleClass="btn btn-primary"  action="#{videoHome.judgmentNo}" rendered="#{videoHome.managed}" onclick="if(!checkSubmit()) return false;" data="#{videoHome.videoSnType}" oncomplete="showMessage(data,2)"/>
		    			<h:commandButton id="updateHidden1"  styleClass="aaa" style="display:none;" action="#{videoHome.persist}"/>
		            	<h:commandButton id="updateHidden2"  styleClass="bbb" style="display:none;" action="#{videoHome.update}"/>
		    			&#160;<s:button view="/device/VideoList.xhtml" styleClass="btn btn-default" value="返回" id="bn_left6" style="margin-left:10px" >
		    					<f:param name="pageNum" value="#{videoHome.pageNum}"/>
		    			</s:button>
                            </td>
						</tr>
					</table>
				<!--入库订单列表结束-->
                    <div class="clear"></div>
                </div><!--right_c结束-->
                <div class="clear"></div>
                
		<a:form>
	  		<a:queue requestDelay="10" ignoreDupResponses="true"/>
			<a:jsFunction name="judgmentNos"  action="#{videoHome.judgmentNo()}"  data="#{videoHome.videoSnType}" oncomplete="SnType(data);">
				<a:actionparam name="video_sn" assignTo="#{videoHome.video_sn}"/>
			</a:jsFunction>
			
		</a:form>
              <script  type="text/javascript">
				//<![CDATA[
				jquery(".rich-calendar-input").addClass("r_c_text_date");
				jquery(".rich-calendar-input").removeClass("rich-calendar-input");
				 www = function(){
					    jquery(".ui-selectmenu").remove();
						jquery('select').selectmenu({style:'dropdown'})
						jquery(".rich-calendar-input").addClass("r_c_text_date");
						jquery(".rich-calendar-input").removeClass("rich-calendar-input");
					}

				//]]>
				</script>
				<script type="text/javascript">
				//<![CDATA[
				
				jquery(".form_datetime").datetimepicker({
			    format: "yyyy-mm-dd",
			    autoclose: true,
				 weekStart: 1,
				  //startDate: "2014-08-14 10:00",
				 language:  'zh-CN',
			    minView:2,
			    pickerPosition: "bottom-left"
			    });

				jquery(function(){
					jquery('.selectpicker').selectpicker();
				    var obj = document.getElementById("user:deviceTypeId");
				    var ty = '#{videoHome.instance.accessWay}';
				    if(ty==''||ty==null){
				    	jquery("#user\\:type").selectpicker("val",3)
					}
				    changeVideoType(obj);
				    jquery('#channels').hide();

				    jQuery("#user\\:partition_id").val(#{videoHome.instance.partitionId.id});
				    jquery("#user\\:tunnel_id").val(#{videoHome.instance.tunnelId.tunnelInfoId});
				    
				});
				
			  function changeVideoType(obj){
				    if(obj.value==301){
				    	jquery('div[name=hk]').show();
				    	if(jquery('#user\\:type').val()==1){
				    		jquery('div[name=new_hk]').hide();
				    		jquery('div[name=new_sp]').hide();
				    		jquery('#getOn').hide();
					    }else{
					    	jquery('div[name=new_hk]').show();
					    	jquery('div[name=new_sp]').show();
					    	jquery('#getOn').show();
						}
				    	jquery('div[name=new_fw]').show();
				    	jquery('div[name=sp]').hide();
				    	jQuery('#help').show();
				    	jQuery('#help').attr("href","#{request.contextPath}/help/hkVideoHelp.seam"); 
				    }else if(obj.value==303){
				    	jquery('div[name=hk]').hide();
				    	jquery('div[name=new_hk]').hide();
				    	jquery('div[name=sp]').hide();
				    	jquery('div[name=new_sp]').show();
				    	jquery('div[name=new_fw]').hide();
				    	jQuery('#help').hide();
				    	jquery('#user\\:appDeviceVideoChannelNo').val("");
				    }else if(obj.value==304){
				    	jquery('div[name=hk]').hide();
				    	jquery('div[name=new_hk]').hide();
				    	jquery('div[name=sp]').hide();
				    	jquery('div[name=new_sp]').show();
				    	jquery('div[name=new_fw]').hide();
				    	jQuery('#help').hide();
				    	jquery('#user\\:appDeviceVideoChannelNo').val("");
				    }else if(obj.value==305){
				    	jquery('div[name=hk]').hide();
				    	jquery('div[name=new_hk]').show();
				    	jquery('div[name=new_sp]').show();
				    	jquery('div[name=sp]').show();
				    	jquery('div[name=new_fw]').show();
				    	jQuery('#help').show();
				    	jQuery('#help').attr("href","#{request.contextPath}/help/spVideoHelp.seam"); 
				    	jquery('#user\\:appDeviceVideoChannelNo').val("");
				    }
				}
			  
			  function changeHtml(obj){
				  if(jquery('#user\\:type').val()==1){
			    		jquery('div[name=new_hk]').hide();
			    		jquery('div[name=new_sp]').hide();
			    		jquery('#getOn').hide();
				    }else{
				    	jquery('div[name=new_hk]').show();
				    	jquery('div[name=new_sp]').show();
				    	jquery('#getOn').show();
					}
			  }

			  function showMessage(data,index){
					if(data>0){
						jquery("#productMsg1").html('拍照上传编号已存在！');
						jquery("#myModal").modal('show');
				        return false;
					}else{
						if(index == 1){
							jquery('.aaa').trigger("click");
						}else{
							jquery('.bbb').trigger("click");
						}
					}
				}
			function checkSubmit(){
				var name = jquery('#user\\:name').val();
				var appIp = jquery('#user\\:appIp').val();
				var appUsername = jquery('#user\\:appUsername').val();
				var appPassword = jquery('#user\\:appPassword').val();
				var appPort = jquery('#user\\:appPort').val();
				//var ip= /^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;
				var ip=/^[a-zA-Z0-9\.]*$/;
				var reg = /^[1-9]+[0-9]*]*$/; 

				if(appPort!='' && !reg.test(appPort)){
					alert('服务端口输入不正确');
					return false;
				}
				if(name==null||name==''){
					alert('设备名称不能为空');
					return false;
				}
				if(name.length>30){
					alert('设备名称输入过长');
					return false;
				}
				/* if(appIp==null||appIp==''){
					alert('IP/域名不能为空');
					return false;
				} */
				if(appIp!='' && !ip.test(appIp)){
					alert('IP/域名输入不正确');
					return false;
				}
				if(appIp.length>30){
					alert('IP/域名输入过长');
					return false;
				}
				/* if(appUsername==null||appUsername==''){
					alert('用户名称不能为空');
					return false;
				} */
				if(appUsername.length>30){
					alert('用户名称输入过长');
					return false;
				}
				/* if(appPassword==null||appPassword==''){
					alert('用户密码不能为空');
					return false;
				} */
				if(appPassword.length>20){
					alert('用户密码输入过长');
					return false;
				}
				var deviceTypeId = jquery('#user\\:deviceTypeId').val();
				if(deviceTypeId == 301){
					var appDeviceVideoChannelNo = jquery('#user\\:appDeviceVideoChannelNo').val();
					/* if(appDeviceVideoChannelNo==null||appDeviceVideoChannelNo==''){
						alert('通道号不能为空');
						return false;
					} */

					if(appDeviceVideoChannelNo.length>20){
						alert('通道号输入过长');
						return false;
					}
					if(jquery('#user\\:type').val()!=1){
						var HttpPort = jquery('#user\\:HttpPort').val();
						var RtspPort = jquery('#user\\:RtspPort').val();
						/* if(HttpPort==null||HttpPort==''){
							alert('HTTP端口不能为空');
							return false;
						} */
						if(HttpPort !='' && !reg.test(HttpPort)){
							alert('HTTP端口输入不正确');
							return false;
						}
						if(HttpPort.length>20){
							alert('HTTP端口输入过长');
							return false;
						}
						/* if(RtspPort==null||RtspPort==''){
							alert('RTSP端口不能为空');
							return false;
						} */
						if(RtspPort!='' && !reg.test(RtspPort)){
							alert('RTSP端口输入不正确');
							return false;
						}
						if(RtspPort.length>20){
							alert('RTSP端口输入过长');
							return false;
						}
					}
				}else if(deviceTypeId == 303){
					var RtspPort = jquery('#user\\:RtspPort').val();
					/* if(RtspPort==null||RtspPort==''){
						alert('RTSP端口不能为空');
						return false;
					} */
					if(RtspPort !='' && !reg.test(RtspPort)){
						alert('RTSP端口输入不正确');
						return false;
					}
					if(RtspPort.length>20){
						alert('RTSP端口输入过长');
						return false;
					}
				}else if(deviceTypeId == 304){
					var RtspPort = jquery('#user\\:RtspPort').val();
					/* if(RtspPort==null||RtspPort==''){
						alert('RTSP端口不能为空');
						return false;
					} */
					if(RtspPort !='' && !reg.test(RtspPort)){
						alert('RTSP端口输入不正确');
						return false;
					}
					if(RtspPort.length>20){
						alert('RTSP端口输入过长');
						return false;
					}
				}else if(deviceTypeId == 305){
					var HttpPort = jquery('#user\\:HttpPort').val();
					var RtspPort = jquery('#user\\:RtspPort').val();
					/* if(HttpPort==null||HttpPort==''){
						alert('HTTP端口不能为空');
						return false;
					} */
					if(HttpPort !='' && !reg.test(HttpPort)){
						alert('HTTP端口输入不正确');
						return false;
					}
					if(HttpPort.length>20){
						alert('HTTP端口输入过长');
						return false;
					}
					/* if(RtspPort==null||RtspPort==''){
						alert('RTSP端口不能为空');
						return false;
					} */
					if(RtspPort !='' && !reg.test(RtspPort)){
						alert('RTSP端口输入不正确');
						return false;
					}
					if(RtspPort.length>20){
						alert('RTSP端口输入过长');
						return false;
					}
					var imgUpNo = jquery('#user\\:imgUpNo').val();
					if(imgUpNo!=null && imgUpNo!='' && imgUpNo.length>20){
						alert('拍照上传编号输入过长');
						return false;
					}
				}
				return true;
			}


			function getAppDeviceVideoChannelNo(){
				var appIp = jquery('#user\\:appIp').val();
				var appUsername = jquery('#user\\:appUsername').val();
				var appPassword = jquery('#user\\:appPassword').val();
				var HttpPort = jquery('#user\\:HttpPort').val();
				if(appIp==null||appIp==''||appUsername==null||appUsername==''||appPassword==null||appPassword==''||HttpPort==null||HttpPort==''){
					alert('您添加的参数不完整，获取不到通道号');
				}else{
					jquery('#user\\:appDeviceVideoChannelNo').hide();
					jquery('#channels').show();
					// 检查插件是否已经安装过
					if (-1 == WebVideoCtrl.I_CheckPluginInstall()) {
						alert("您还未安装过插件，双击开发包目录里的WebComponents.exe安装！");
						return;
					}
					// 初始化插件参数及插入插件
					WebVideoCtrl.I_InitPlugin(500, 300, {
				        iWndowType: 2,
						cbSelWnd: function (xmlDoc) {
							g_iWndIndex = jquery(xmlDoc).find("SelectWnd").eq(0).text();
						}
					});
					WebVideoCtrl.I_InsertOBJECTPlugin("divPlugin");
					jquery('embed').width(0).height(0);  
					jquery('.selectpicker').selectpicker();
					var iRet = WebVideoCtrl.I_Login(appIp, 1, HttpPort, appUsername, appPassword, {
							success: function (xmlDoc) {
								 var szIP = appIp,
									oSel = jquery("#channels").empty(),
									nAnalogChannel = 0;
								if ("" == szIP) {
									return;
								}
								// 模拟通道
								WebVideoCtrl.I_GetAnalogChannelInfo(szIP, {
									async: false,
									success: function (xmlDoc) {
										var oChannels = jquery(xmlDoc).find("VideoInputChannel");
										nAnalogChannel = oChannels.length;

										jquery.each(oChannels, function (i) {
											var id = parseInt(jquery(this).find("id").eq(0).text(), 10),
												name = jquery(this).find("name").eq(0).text();
											if ("" == name) {
												name = "Camera " + (id < 9 ? "0" + id : id);
											}
											oSel.append("<option value='" + id + "' bZero='false'>" + name + "</option>");
										});
									},
									error: function () {
									}
								});
								// 数字通道
								WebVideoCtrl.I_GetDigitalChannelInfo(szIP, {
									async: false,
									success: function (xmlDoc) {
										var oChannels = jquery(xmlDoc).find("InputProxyChannelStatus");

										jquery.each(oChannels, function (i) {
											var id = parseInt(jquery(this).find("id").eq(0).text(), 10),
												name = jquery(this).find("name").eq(0).text(),
												online = jquery(this).find("online").eq(0).text();
											if ("false" == online) {// 过滤禁用的数字通道
												return true;
											}
											if ("" == name) {
												name = "IPCamera " + ((id - nAnalogChannel) < 9 ? "0" + (id - nAnalogChannel) : (id - nAnalogChannel));
											}
											oSel.append("<option value='" + id + "' bZero='false'>" + name + "</option>");
										});
									},
									error: function () {
									}
								});
								// 零通道
								WebVideoCtrl.I_GetZeroChannelInfo(szIP, {
									async: false,
									success: function (xmlDoc) {
										var oChannels = jquery(xmlDoc).find("ZeroVideoChannel");
										
										jquery.each(oChannels, function (i) {
											var id = parseInt(jquery(this).find("id").eq(0).text(), 10),
												name = jquery(this).find("name").eq(0).text();
											if ("" == name) {
												name = "Zero Channel " + (id < 9 ? "0" + id : id);
											}
											if ("true" == jquery(this).find("enabled").eq(0).text()) {// 过滤禁用的零通道
												oSel.append("<option value='" + id + "' bZero='true'>" + name + "</option>");
											}
										});
									},
									error: function () {
									}
								});
								jquery('#user\\:appDeviceVideoChannelNo').val(jquery('#channels').val());
							},
							error: function () {
								console.log("登录失败...");
							}
						 });
						 if (-1 == iRet) {
							 alert('已获取到');
							console.log("已登录过...");
						 }
				}
				
			}
			function ChannelNoChange(){
				jquery('#user\\:appDeviceVideoChannelNo').val(jquery('#channels').val());
			}

			/* document.body.onload = function(){
			   var new_element=document.createElement('script');
			   new_element.setAttribute("type","text/javascript");
			   new_element.setAttribute("src","http://ditu.google.cn/maps/api/js?v=3.25&amp;key=AIzaSyB2mG9FLX3dYDFycXGkmidn-OZU-FL1rLM&amp;sensor=false&amp;libraries=drawing");
			   document.body.appendChild(new_element);

			} */
			//]]>
			</script>
				</h:form>
				</div>
				</div>
            </td> 
<style>
 .form-control{
	float:left;
}
.inbentory_content{
	height:100%;
}
</style>
<script type="text/javascript" src="#{request.contextPath}/asset/monitoring/js/webVideoCtrl.js"/>
<script type="text/javascript">
_Q = jQuery.noConflict();
</script>

<div aria-hidden="false" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal2" class="modal fade in" style="display: bleak;">
  <div class="modal-dialog2">
    <div class="modal-content" >
    	<div style="  position: absolute; right: -19px;  top: -16px; z-index: 10;cursor: pointer;" onclick="_Q('#myModal2').modal('hide');" ><img src="#{request.contextPath}/asset/images/new_close03.png" /></div>
      <div class="modal-body" style="padding:0px;">
       <div style="width: 100%; height:580px;">
        <div id="map-canvas" class="gm-style"> </div>
        <script type="text/javascript">
      //<![CDATA[ 
				var workpath = "#{request.contextPath}";
				var _center = "#{videoHome.center}";
				var markstr = #{videoHome.baseString};
                var secondstr = #{videoHome.partitionString};
                var thirdstr = #{videoHome.groupString};
                var colors = #{videoHome.dicColor};
				var collects = #{videoHome.collect};
				//var allList = #{deviceHome.allList};
				var envTypeList = #{videoHome.entTypeString};
				var realPlantJson = #{videoHome.realPlantJson};
				var ret = 1;
				var videoStr = #{videoHome.videoStr};
				var lastStr;
				var addOrUpdate = #{videoHome.managed};
				var drugObj = '#{videoHome.drugObj}';
				var head = document.getElementsByTagName('head')[0];
				var insertBefore = head.insertBefore;
				head.insertBefore = function (newElement, referenceElement) {
				    if (newElement.href && (newElement.href.indexOf('https://fonts.googleapis.com/css?family=') === 0 || newElement.href.indexOf('http://fonts.googleapis.com/css?family=') === 0)) {
				        //console.info('Prevented Roboto from loading!');
				        return;
				    }
				    insertBefore.call(head, newElement, referenceElement);
				};
				//]]>  
				//alert(drugObj);
                </script>
	    <script type="text/javascript" src="#{request.contextPath}/asset/js/map/JsMap.js"> </script> 
	    <script type="text/javascript" src="#{request.contextPath}/asset/js/jquery-ui2.js"></script> 
	    <script src="http://ditu.google.cn/maps/api/js?v=3.25&amp;key=AIzaSyB2mG9FLX3dYDFycXGkmidn-OZU-FL1rLM&amp;sensor=false&amp;libraries=drawing" type="text/javascript"></script>
		<script src="#{request.contextPath}/asset/js/map/device_map2.js" type="text/javascript"></script>
       </div>
      </div>
    </div>
  </div>
</div>
<div aria-hidden="false" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal3" class="modal fade in w600na" style="display: none;width:100%;">
  <div class="modal-dialog">
    <div class="modal-content">
      <button class="close"></button>
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">提示框</h4>
      </div>
      <div class="modal-body">
       <span id="productMsg">是否定位此设备？</span>
        
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal" onclick="save_no()">取消</button>
        <button type="button" class="btn btn-primary sure" data-dismiss="modal" onclick="save_ok()">确认</button>
      </div>
    </div>
  </div>
</div>
<div aria-hidden="false" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal4" class="modal fade in w600na" style="display: none;width:100%;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">提示框</h4>
      </div>
      <div class="modal-body">
       <span id="productMsg">是否定位此设备？</span>
        
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="save_ok_move()">确认</button>
      </div>
    </div>
  </div>
</div>

	</ui:define>

</ui:composition>